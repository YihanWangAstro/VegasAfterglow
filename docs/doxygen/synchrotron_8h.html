<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: synchrotron.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('synchrotron_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">synchrotron.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="medium_8h_source.html">medium.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mesh_8h_source.html">mesh.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="shock_8h_source.html">shock.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for synchrotron.h:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h__incl.png" border="0" usemap="#asynchrotron_8h" alt=""/></div>
<map name="asynchrotron_8h" id="asynchrotron_8h">
<area shape="rect" title=" " alt="" coords="161,5,272,31"/>
<area shape="rect" title=" " alt="" coords="5,79,68,104"/>
<area shape="poly" title=" " alt="" coords="189,33,80,76,78,71,187,28"/>
<area shape="rect" href="medium_8h.html" title=" " alt="" coords="62,225,150,251"/>
<area shape="poly" title=" " alt="" coords="213,32,151,153,120,214,115,212,146,151,208,29"/>
<area shape="rect" href="mesh_8h.html" title=" " alt="" coords="623,372,693,397"/>
<area shape="poly" title=" " alt="" coords="272,21,395,35,539,62,605,80,660,103,681,116,697,130,708,146,711,163,711,239,708,274,698,307,674,361,669,359,693,305,702,273,706,239,706,164,703,148,693,134,678,120,657,108,604,85,538,67,394,41,272,26"/>
<area shape="rect" href="shock_8h.html" title=" " alt="" coords="293,79,365,104"/>
<area shape="poly" title=" " alt="" coords="236,28,300,69,297,73,233,33"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="141,453,223,478"/>
<area shape="poly" title=" " alt="" coords="109,251,118,314,127,356,140,396,167,441,162,443,136,398,122,357,113,315,104,251"/>
<area shape="rect" href="utilities_8h.html" title=" " alt="" coords="291,299,374,324"/>
<area shape="poly" title=" " alt="" coords="143,248,284,292,282,297,142,253"/>
<area shape="rect" title=" " alt="" coords="107,533,166,559"/>
<area shape="poly" title=" " alt="" coords="178,480,153,523,148,520,173,477"/>
<area shape="rect" title=" " alt="" coords="190,533,265,559"/>
<area shape="poly" title=" " alt="" coords="191,477,216,520,211,523,186,480"/>
<area shape="poly" title=" " alt="" coords="306,327,270,346,235,374,210,407,194,441,189,439,206,404,231,370,267,342,304,322"/>
<area shape="rect" title=" " alt="" coords="245,372,337,397"/>
<area shape="poly" title=" " alt="" coords="328,326,307,361,303,359,324,323"/>
<area shape="rect" title=" " alt="" coords="361,372,421,397"/>
<area shape="poly" title=" " alt="" coords="344,323,375,360,371,363,340,326"/>
<area shape="poly" title=" " alt="" coords="375,319,610,370,608,375,374,324"/>
<area shape="poly" title=" " alt="" coords="623,394,237,458,236,452,622,389"/>
<area shape="rect" title=" " alt="" coords="316,453,379,478"/>
<area shape="poly" title=" " alt="" coords="623,394,518,414,391,448,385,450,383,445,389,443,517,409,622,389"/>
<area shape="rect" title=" " alt="" coords="1367,445,1509,485"/>
<area shape="poly" title=" " alt="" coords="694,385,964,400,1155,417,1353,442,1353,448,1154,423,963,406,693,390"/>
<area shape="rect" title=" " alt="" coords="403,445,545,485"/>
<area shape="poly" title=" " alt="" coords="632,400,532,442,530,438,630,395"/>
<area shape="rect" title=" " alt="" coords="569,453,747,478"/>
<area shape="poly" title=" " alt="" coords="661,398,661,439,655,439,655,398"/>
<area shape="rect" title=" " alt="" coords="771,453,961,478"/>
<area shape="poly" title=" " alt="" coords="689,395,824,445,822,450,687,400"/>
<area shape="rect" title=" " alt="" coords="986,453,1135,478"/>
<area shape="poly" title=" " alt="" coords="694,390,975,443,996,447,995,452,973,448,693,395"/>
<area shape="rect" title=" " alt="" coords="1160,453,1343,478"/>
<area shape="poly" title=" " alt="" coords="694,387,888,408,1148,443,1179,448,1178,453,1147,448,887,414,693,392"/>
<area shape="poly" title=" " alt="" coords="294,105,240,124,184,154,150,184,124,216,120,213,146,181,180,150,237,119,292,100"/>
<area shape="poly" title=" " alt="" coords="365,92,432,97,512,108,586,125,614,136,633,150,651,174,663,201,670,230,673,259,672,315,666,359,661,358,667,314,668,259,665,231,657,203,646,177,629,154,611,141,584,130,511,113,432,103,365,97"/>
<area shape="rect" title=" " alt="" coords="301,152,356,177"/>
<area shape="poly" title=" " alt="" coords="331,104,331,138,326,138,326,104"/>
<area shape="rect" title=" " alt="" coords="432,152,620,177"/>
<area shape="poly" title=" " alt="" coords="361,102,482,145,480,150,359,107"/>
<area shape="rect" href="jet_8h.html" title=" " alt="" coords="485,225,535,251"/>
<area shape="poly" title=" " alt="" coords="342,102,376,136,421,175,481,216,478,220,418,179,373,140,338,106"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="194,152,277,177"/>
<area shape="poly" title=" " alt="" coords="315,106,263,146,260,141,312,102"/>
<area shape="poly" title=" " alt="" coords="486,252,375,296,373,291,484,247"/>
<area shape="poly" title=" " alt="" coords="514,251,514,280,511,318,500,360,480,399,444,421,386,449,384,445,441,417,476,396,495,358,505,317,509,279,508,251"/>
<area shape="poly" title=" " alt="" coords="216,180,141,221,138,216,213,175"/>
<area shape="poly" title=" " alt="" coords="236,178,189,439,184,438,231,177"/>
<area shape="poly" title=" " alt="" coords="278,172,289,175,364,183,424,184,453,186,482,192,514,204,549,223,584,253,613,290,636,327,651,358,646,361,631,330,609,293,581,257,546,228,512,208,481,197,452,191,424,189,363,188,288,180,277,178"/>
<area shape="poly" title=" " alt="" coords="257,175,300,204,352,247,378,274,402,304,421,336,435,371,438,385,435,398,413,427,385,448,382,444,409,423,430,396,433,385,430,373,417,339,397,307,374,278,349,251,297,208,254,180"/>
<area shape="poly" title=" " alt="" coords="278,174,467,223,472,224,470,229,465,228,276,179"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h__dep__incl.png" border="0" usemap="#asynchrotron_8hdep" alt=""/></div>
<map name="asynchrotron_8hdep" id="asynchrotron_8hdep">
<area shape="rect" title=" " alt="" coords="205,5,316,31"/>
<area shape="rect" href="IO_8h.html" title=" " alt="" coords="121,79,169,104"/>
<area shape="poly" title=" " alt="" coords="232,40,165,81,162,76,229,35"/>
<area shape="rect" href="afterglow_8h.html" title=" " alt="" coords="159,152,253,177"/>
<area shape="poly" title=" " alt="" coords="250,44,234,80,211,152,206,151,229,78,245,42"/>
<area shape="rect" href="synchrotron_8cpp.html" title=" " alt="" coords="416,225,543,251"/>
<area shape="poly" title=" " alt="" coords="329,32,376,48,425,73,470,106,488,127,503,151,508,171,505,192,490,226,485,224,500,191,503,171,498,153,484,130,466,110,422,77,374,53,327,37"/>
<area shape="rect" href="inverse-compton_8h.html" title=" " alt="" coords="243,79,387,104"/>
<area shape="poly" title=" " alt="" coords="280,40,309,77,304,80,276,43"/>
<area shape="rect" href="IO_8cpp.html" title=" " alt="" coords="72,152,135,177"/>
<area shape="poly" title=" " alt="" coords="133,117,112,153,108,151,129,115"/>
<area shape="poly" title=" " alt="" coords="166,113,198,150,194,154,162,116"/>
<area shape="rect" href="mcmc_8h.html" title=" " alt="" coords="317,225,391,251"/>
<area shape="poly" title=" " alt="" coords="243,181,331,223,329,228,241,186"/>
<area shape="rect" href="observer_8h.html" title=" " alt="" coords="37,225,127,251"/>
<area shape="poly" title=" " alt="" coords="169,186,97,227,94,223,166,181"/>
<area shape="rect" href="pymodel_8cpp.html" title=" " alt="" coords="135,299,242,324"/>
<area shape="poly" title=" " alt="" coords="201,191,193,226,190,266,191,298,185,298,185,265,187,225,195,190"/>
<area shape="rect" href="pymodel_8h.html" title=" " alt="" coords="202,225,293,251"/>
<area shape="poly" title=" " alt="" coords="222,188,243,224,238,227,217,191"/>
<area shape="poly" title=" " alt="" coords="264,178,436,223,434,228,262,183"/>
<area shape="rect" href="mcmc_8cpp.html" title=" " alt="" coords="384,299,473,324"/>
<area shape="poly" title=" " alt="" coords="378,258,418,297,415,300,374,262"/>
<area shape="rect" href="pybind_8cpp.html" title=" " alt="" coords="266,299,359,324"/>
<area shape="poly" title=" " alt="" coords="343,264,322,300,317,297,338,261"/>
<area shape="poly" title=" " alt="" coords="120,217,192,175,194,180,122,221"/>
<area shape="rect" href="observer_8cpp.html" title=" " alt="" coords="5,299,111,324"/>
<area shape="poly" title=" " alt="" coords="76,265,64,299,59,298,71,263"/>
<area shape="poly" title=" " alt="" coords="269,259,304,297,300,300,265,263"/>
<area shape="poly" title=" " alt="" coords="231,263,200,300,196,297,227,260"/>
<area shape="poly" title=" " alt="" coords="288,114,225,154,222,150,285,109"/>
<area shape="poly" title=" " alt="" coords="312,118,311,148,314,163,320,176,337,189,365,202,432,223,431,228,363,207,334,194,316,179,309,164,305,148,307,118"/>
<area shape="rect" href="inverse-compton_8cpp.html" title=" " alt="" coords="329,152,488,177"/>
<area shape="poly" title=" " alt="" coords="343,110,395,150,392,154,339,114"/>
</map>
</div>
</div>
<p><a href="synchrotron_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structInverseComptonY.html">InverseComptonY</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles Inverse Compton Y parameter calculations and related threshold values.  <a href="structInverseComptonY.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSynElectrons.html">SynElectrons</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents synchrotron-emitting electrons in the comoving frame along with their energy distribution and properties.  <a href="structSynElectrons.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSynPhotons.html">SynPhotons</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents synchrotron photons in the comoving frame and provides spectral functions.  <a href="structSynPhotons.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a0ab8637927d98b2552ae0f5b9eb5e5c2" id="r_a0ab8637927d98b2552ae0f5b9eb5e5c2"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> = xt::xtensor&lt; <a class="el" href="structSynPhotons.html">SynPhotons</a>, 3 &gt;</td></tr>
<tr class="memdesc:a0ab8637927d98b2552ae0f5b9eb5e5c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D grid of synchrotron photons.  <br /></td></tr>
<tr class="separator:a0ab8637927d98b2552ae0f5b9eb5e5c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed93cca9de717545d10f8619effaf3a" id="r_a1ed93cca9de717545d10f8619effaf3a"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> = xt::xtensor&lt; <a class="el" href="structSynElectrons.html">SynElectrons</a>, 3 &gt;</td></tr>
<tr class="memdesc:a1ed93cca9de717545d10f8619effaf3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D grid of synchrotron electrons.  <br /></td></tr>
<tr class="separator:a1ed93cca9de717545d10f8619effaf3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4fdbd47450e56475b4be4656e288854e" id="r_a4fdbd47450e56475b4be4656e288854e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#a4fdbd47450e56475b4be4656e288854e">generate_syn_electrons</a> (<a class="el" href="classShock.html">Shock</a> const &amp;shock, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> p, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> xi=1)</td></tr>
<tr class="memdesc:a4fdbd47450e56475b4be4656e288854e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and returns a new electron grid based on shock parameters.  <br /></td></tr>
<tr class="separator:a4fdbd47450e56475b4be4656e288854e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a901300e562505fb294c074fa1e678308" id="r_a901300e562505fb294c074fa1e678308"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#a901300e562505fb294c074fa1e678308">generate_syn_electrons</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;electrons, <a class="el" href="classShock.html">Shock</a> const &amp;shock, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> p, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> xi=1)</td></tr>
<tr class="memdesc:a901300e562505fb294c074fa1e678308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populates an existing electron grid with values based on shock parameters.  <br /></td></tr>
<tr class="separator:a901300e562505fb294c074fa1e678308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a331f545228d2b18e84e0252510e295f8" id="r_a331f545228d2b18e84e0252510e295f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a> (<a class="el" href="classShock.html">Shock</a> const &amp;shock, <a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> const &amp;electrons)</td></tr>
<tr class="memdesc:a331f545228d2b18e84e0252510e295f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and returns a new photon grid based on shock and electron grid.  <br /></td></tr>
<tr class="separator:a331f545228d2b18e84e0252510e295f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f78089bdc9e329056d89812794298b9" id="r_a0f78089bdc9e329056d89812794298b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#a0f78089bdc9e329056d89812794298b9">generate_syn_photons</a> (<a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;photons, <a class="el" href="classShock.html">Shock</a> const &amp;shock, <a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> const &amp;electrons)</td></tr>
<tr class="memdesc:a0f78089bdc9e329056d89812794298b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populates an existing photon grid with values based on shock and electron grid.  <br /></td></tr>
<tr class="separator:a0f78089bdc9e329056d89812794298b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecff2eca5f5a9c7e2a94481eb96e597f" id="r_aecff2eca5f5a9c7e2a94481eb96e597f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#aecff2eca5f5a9c7e2a94481eb96e597f">update_electrons_4Y</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;e, <a class="el" href="classShock.html">Shock</a> const &amp;shock)</td></tr>
<tr class="memdesc:aecff2eca5f5a9c7e2a94481eb96e597f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates electron properties throughout the grid based on shock parameters and IC Y values.  <br /></td></tr>
<tr class="separator:aecff2eca5f5a9c7e2a94481eb96e597f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e34d49dd7497d65ea5261e80d615d4" id="r_a52e34d49dd7497d65ea5261e80d615d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#a52e34d49dd7497d65ea5261e80d615d4">compute_gamma_c</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_com, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> B, <a class="el" href="structInverseComptonY.html">InverseComptonY</a> const &amp;Ys, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> p)</td></tr>
<tr class="memdesc:a52e34d49dd7497d65ea5261e80d615d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters.  <br /></td></tr>
<tr class="separator:a52e34d49dd7497d65ea5261e80d615d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f1c40226e12d8dee51a76c99524fd11" id="r_a5f1c40226e12d8dee51a76c99524fd11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#a5f1c40226e12d8dee51a76c99524fd11">compute_gamma_peak</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_a, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_m, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_c)</td></tr>
<tr class="memdesc:a5f1c40226e12d8dee51a76c99524fd11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the electron Lorentz factor at which the number density peaks.  <br /></td></tr>
<tr class="separator:a5f1c40226e12d8dee51a76c99524fd11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a936bfaa522ec8295a21d253e5453188d" id="r_a936bfaa522ec8295a21d253e5453188d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="synchrotron_8h.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> B)</td></tr>
<tr class="memdesc:a936bfaa522ec8295a21d253e5453188d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates synchrotron frequency for a given Lorentz factor and magnetic field.  <br /></td></tr>
<tr class="separator:a936bfaa522ec8295a21d253e5453188d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a1ed93cca9de717545d10f8619effaf3a" name="a1ed93cca9de717545d10f8619effaf3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed93cca9de717545d10f8619effaf3a">&#9670;&#160;</a></span>SynElectronGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> =  xt::xtensor&lt;<a class="el" href="structSynElectrons.html">SynElectrons</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D grid of synchrotron electrons. </p>

<p class="definition">Definition at line <a class="el" href="synchrotron_8h_source.html#l00249">249</a> of file <a class="el" href="synchrotron_8h_source.html">synchrotron.h</a>.</p>

</div>
</div>
<a id="a0ab8637927d98b2552ae0f5b9eb5e5c2" name="a0ab8637927d98b2552ae0f5b9eb5e5c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ab8637927d98b2552ae0f5b9eb5e5c2">&#9670;&#160;</a></span>SynPhotonGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> =  xt::xtensor&lt;<a class="el" href="structSynPhotons.html">SynPhotons</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D grid of synchrotron photons. </p>

<p class="definition">Definition at line <a class="el" href="synchrotron_8h_source.html#l00247">247</a> of file <a class="el" href="synchrotron_8h_source.html">synchrotron.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a52e34d49dd7497d65ea5261e80d615d4" name="a52e34d49dd7497d65ea5261e80d615d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52e34d49dd7497d65ea5261e80d615d4">&#9670;&#160;</a></span>compute_gamma_c()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> compute_gamma_c </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_com</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structInverseComptonY.html">InverseComptonY</a> const &amp;&#160;</td>
          <td class="paramname"><em>Ys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters. </p>
<p>Accounts for synchrotron and inverse Compton cooling using an iterative approach to handle the Lorentz factor dependent IC cooling. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_com</td><td>Comoving time </td></tr>
    <tr><td class="paramname">B</td><td>Magnetic field </td></tr>
    <tr><td class="paramname">Ys</td><td>Inverse Compton Y parameters </td></tr>
    <tr><td class="paramname">p</td><td>Power-law index for electron energy distribution </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The cooling Lorentz factor </dd></dl>

<p class="definition">Definition at line <a class="el" href="synchrotron_8cpp_source.html#l00572">572</a> of file <a class="el" href="synchrotron_8cpp_source.html">synchrotron.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  572</span>                                                                            {</div>
<div class="line"><span class="lineno">  573</span>    <span class="comment">// t_com = (6*pi*gamma*me*c^2) /(gamma^2*beta^2*sigma_T*c*B^2*(1 + Y_tilt))</span></div>
<div class="line"><span class="lineno">  574</span>    <span class="comment">// Real gamma_c = 6 * con::pi * con::me * con::c / (con::sigmaT * B * B * (1 + Y_tilt) * t_com);</span></div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y0 = <a class="code hl_function" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f">InverseComptonY::compute_Y_Thompson</a>(Ys);</div>
<div class="line"><span class="lineno">  577</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_bar = (6 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> * <a class="code hl_variable" href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a> / <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a>) / (B * B * (1 + Y0) * t_com);</div>
<div class="line"><span class="lineno">  578</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_c = (gamma_bar + std::sqrt(gamma_bar * gamma_bar + 4)) / 2;</div>
<div class="line"><span class="lineno">  579</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y1 = <a class="code hl_function" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb">InverseComptonY::compute_Y_tilt_at_gamma</a>(Ys, gamma_c, p);</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    <span class="keywordflow">for</span> (; std::fabs((Y1 - Y0) / Y0) &gt; 1<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>-3;) {</div>
<div class="line"><span class="lineno">  582</span>        gamma_bar = (6 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> * <a class="code hl_variable" href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a> / <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a>) / (B * B * (1 + Y1) * t_com);</div>
<div class="line"><span class="lineno">  583</span>        gamma_c = (gamma_bar + std::sqrt(gamma_bar * gamma_bar + 4)) / 2;</div>
<div class="line"><span class="lineno">  584</span>        Y0 = Y1;</div>
<div class="line"><span class="lineno">  585</span>        Y1 = <a class="code hl_function" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb">InverseComptonY::compute_Y_tilt_at_gamma</a>(Ys, gamma_c, p);</div>
<div class="line"><span class="lineno">  586</span>    }</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>    <span class="keywordflow">return</span> gamma_c;</div>
<div class="line"><span class="lineno">  589</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00022">macros.h:22</a></div></div>
<div class="ttc" id="anamespacecon_html_a2ff3edf57629ccb9a49d5bde7278a7c4"><div class="ttname"><a href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a></div><div class="ttdeci">constexpr Real c</div><div class="ttdoc">Speed of light (normalized to 1 in code units)</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00081">macros.h:81</a></div></div>
<div class="ttc" id="anamespacecon_html_a740c8edb3d4f2d904a1c76002f84fb7e"><div class="ttname"><a href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a></div><div class="ttdeci">constexpr Real me</div><div class="ttdoc">Electron mass in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00084">macros.h:84</a></div></div>
<div class="ttc" id="anamespacecon_html_aa0ccd904b754d0f907898a942516d121"><div class="ttname"><a href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a></div><div class="ttdeci">constexpr Real pi</div><div class="ttdoc">Pi.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00089">macros.h:89</a></div></div>
<div class="ttc" id="anamespacecon_html_ad19e5b64c85c3e709fd0944358be97f6"><div class="ttname"><a href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a></div><div class="ttdeci">constexpr Real sigmaT</div><div class="ttdoc">Thomson cross-section in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00090">macros.h:90</a></div></div>
<div class="ttc" id="anamespacecon_html_af12a6df01bfe61fa034307dfcaa1fe7f"><div class="ttname"><a href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">con::e</a></div><div class="ttdeci">constexpr Real e</div><div class="ttdoc">Elementary charge in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00086">macros.h:86</a></div></div>
<div class="ttc" id="astructInverseComptonY_html_a05b76b4d84f50b82728333a42362fc0f"><div class="ttname"><a href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f">InverseComptonY::compute_Y_Thompson</a></div><div class="ttdeci">static Real compute_Y_Thompson(InverseComptonY const &amp;Ys)</div><div class="ttdoc">Returns the Thomson Y parameter from the provided InverseComptonY object.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00106">synchrotron.cpp:106</a></div></div>
<div class="ttc" id="astructInverseComptonY_html_a9a35d3af9bd23acdde9d09d38ee116eb"><div class="ttname"><a href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb">InverseComptonY::compute_Y_tilt_at_gamma</a></div><div class="ttdeci">static Real compute_Y_tilt_at_gamma(InverseComptonY const &amp;Ys, Real gamma, Real p)</div><div class="ttdoc">Calculates the effective Y parameter at a specific Lorentz factor and spectral index.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00115">synchrotron.cpp:115</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_a52e34d49dd7497d65ea5261e80d615d4_cgraph.png" border="0" usemap="#asynchrotron_8h_a52e34d49dd7497d65ea5261e80d615d4_cgraph" alt=""/></div>
<map name="asynchrotron_8h_a52e34d49dd7497d65ea5261e80d615d4_cgraph" id="asynchrotron_8h_a52e34d49dd7497d65ea5261e80d615d4_cgraph">
<area shape="rect" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="5,45,156,70"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="204,5,404,45"/>
<area shape="poly" title=" " alt="" coords="156,44,190,39,191,44,156,49"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="204,69,404,109"/>
<area shape="poly" title=" " alt="" coords="156,65,191,70,190,76,156,71"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="452,69,652,109"/>
<area shape="poly" title=" " alt="" coords="404,87,438,87,438,92,404,92"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="700,51,781,77"/>
<area shape="poly" title=" " alt="" coords="652,73,686,69,687,74,653,78"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="708,101,773,126"/>
<area shape="poly" title=" " alt="" coords="653,99,695,105,694,110,652,105"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="829,27,916,53"/>
<area shape="poly" title=" " alt="" coords="781,54,815,48,816,53,782,59"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="831,77,914,102"/>
<area shape="poly" title=" " alt="" coords="782,69,818,76,817,81,781,74"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_a52e34d49dd7497d65ea5261e80d615d4_icgraph.png" border="0" usemap="#asynchrotron_8h_a52e34d49dd7497d65ea5261e80d615d4_icgraph" alt=""/></div>
<map name="asynchrotron_8h_a52e34d49dd7497d65ea5261e80d615d4_icgraph" id="asynchrotron_8h_a52e34d49dd7497d65ea5261e80d615d4_icgraph">
<area shape="rect" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="415,80,565,105"/>
<area shape="rect" href="inverse-compton_8cpp.html#a54bc152dfd9a704c9362782e822b2cff" title=" " alt="" coords="205,5,351,31"/>
<area shape="poly" title=" " alt="" coords="448,77,366,45,329,33,331,28,368,39,450,72"/>
<area shape="rect" href="synchrotron_8cpp.html#afd4184652bfb1fac7ee55a159f618767" title="Creates and returns a new electron grid based on shock parameters." alt="" coords="189,104,367,129"/>
<area shape="poly" title=" " alt="" coords="401,105,367,109,366,104,400,100"/>
<area shape="rect" href="synchrotron_8cpp.html#a6fb32a514d942797b3beffa16aaf467a" title="Populates an existing electron grid with values based on shock parameters." alt="" coords="189,153,367,179"/>
<area shape="poly" title=" " alt="" coords="449,113,368,145,330,156,329,151,366,139,447,108"/>
<area shape="rect" href="synchrotron_8cpp.html#aecff2eca5f5a9c7e2a94481eb96e597f" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="199,55,357,80"/>
<area shape="poly" title=" " alt="" coords="401,85,356,79,357,74,401,79"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad7c1306e2402033ff31ce1f00cf1e3f2" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="26,5,121,31"/>
<area shape="poly" title=" " alt="" coords="191,21,121,21,121,15,191,15"/>
<area shape="rect" href="inverse-compton_8cpp.html#ae4c1495aa74372b72c2d5d61d1d53b62" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,55,141,80"/>
<area shape="poly" title=" " alt="" coords="212,36,127,57,126,52,211,31"/>
<area shape="poly" title=" " alt="" coords="211,54,120,32,122,27,212,49"/>
<area shape="poly" title=" " alt="" coords="186,70,142,70,142,65,186,65"/>
</map>
</div>

</div>
</div>
<a id="a5f1c40226e12d8dee51a76c99524fd11" name="a5f1c40226e12d8dee51a76c99524fd11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f1c40226e12d8dee51a76c99524fd11">&#9670;&#160;</a></span>compute_gamma_peak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> compute_gamma_peak </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the electron Lorentz factor at which the number density peaks. </p>
<p>Based on the relative ordering of absorption, minimum, and cooling Lorentz factors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gamma_a</td><td>Absorption Lorentz factor </td></tr>
    <tr><td class="paramname">gamma_m</td><td>Minimum electron Lorentz factor </td></tr>
    <tr><td class="paramname">gamma_c</td><td>Cooling electron Lorentz factor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Peak Lorentz factor </dd></dl>

<p class="definition">Definition at line <a class="el" href="synchrotron_8cpp_source.html#l00636">636</a> of file <a class="el" href="synchrotron_8cpp_source.html">synchrotron.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  636</span>                                                                  {</div>
<div class="line"><span class="lineno">  637</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_peak = std::min(gamma_m, gamma_c);</div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordflow">if</span> (gamma_a &gt; gamma_c) {</div>
<div class="line"><span class="lineno">  639</span>        <span class="keywordflow">return</span> gamma_a;</div>
<div class="line"><span class="lineno">  640</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  641</span>        <span class="keywordflow">return</span> gamma_peak;</div>
<div class="line"><span class="lineno">  642</span>    }</div>
<div class="line"><span class="lineno">  643</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_a5f1c40226e12d8dee51a76c99524fd11_icgraph.png" border="0" usemap="#asynchrotron_8h_a5f1c40226e12d8dee51a76c99524fd11_icgraph" alt=""/></div>
<map name="asynchrotron_8h_a5f1c40226e12d8dee51a76c99524fd11_icgraph" id="asynchrotron_8h_a5f1c40226e12d8dee51a76c99524fd11_icgraph">
<area shape="rect" title="Determines the electron Lorentz factor at which the number density peaks." alt="" coords="228,5,403,31"/>
<area shape="rect" href="synchrotron_8cpp.html#a71dd98bf97f7ca32d046bef60ebe11c4" title="Determines the peak Lorentz factor directly from a SynElectrons object." alt="" coords="5,5,180,31"/>
<area shape="poly" title=" " alt="" coords="214,21,180,21,180,15,214,15"/>
</map>
</div>

</div>
</div>
<a id="a936bfaa522ec8295a21d253e5453188d" name="a936bfaa522ec8295a21d253e5453188d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a936bfaa522ec8295a21d253e5453188d">&#9670;&#160;</a></span>compute_syn_freq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> compute_syn_freq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates synchrotron frequency for a given Lorentz factor and magnetic field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gamma</td><td>Electron Lorentz factor </td></tr>
    <tr><td class="paramname">B</td><td>Magnetic field </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The synchrotron frequency </dd></dl>

<p class="definition">Definition at line <a class="el" href="synchrotron_8cpp_source.html#l00493">493</a> of file <a class="el" href="synchrotron_8cpp_source.html">synchrotron.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  493</span>                                          {</div>
<div class="line"><span class="lineno">  494</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> nu = 3 * <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">con::e</a> / (4 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> * <a class="code hl_variable" href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a>) * B * gamma * gamma;</div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordflow">return</span> nu;</div>
<div class="line"><span class="lineno">  496</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_a936bfaa522ec8295a21d253e5453188d_icgraph.png" border="0" usemap="#asynchrotron_8h_a936bfaa522ec8295a21d253e5453188d_icgraph" alt=""/></div>
<map name="asynchrotron_8h_a936bfaa522ec8295a21d253e5453188d_icgraph" id="asynchrotron_8h_a936bfaa522ec8295a21d253e5453188d_icgraph">
<area shape="rect" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="653,129,796,155"/>
<area shape="rect" href="synchrotron_8cpp.html#a5b1694deb534f1df0ba3515fdf52b65a" title=" " alt="" coords="419,55,601,80"/>
<area shape="poly" title=" " alt="" coords="684,126,604,94,566,83,568,77,606,89,686,121"/>
<area shape="rect" href="synchrotron_8cpp.html#a68ca390be3c37e7c5f3286335daba749" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="425,104,595,129"/>
<area shape="poly" title=" " alt="" coords="640,135,595,129,595,124,640,129"/>
<area shape="rect" href="synchrotron_8cpp.html#ac2384d3417ed32a6ce6e55e6cf3be655" title="Populates an existing photon grid with values based on shock and electron grid." alt="" coords="425,153,595,179"/>
<area shape="poly" title=" " alt="" coords="640,154,595,159,595,154,640,149"/>
<area shape="rect" href="structInverseComptonY.html#ae2e1d231f5adf0f9a49bd915d6c616e3" title="Initializes an InverseComptonY object with frequency thresholds, magnetic field and Y parameter." alt="" coords="415,203,605,243"/>
<area shape="poly" title=" " alt="" coords="683,163,606,194,573,206,571,201,604,189,681,158"/>
<area shape="rect" href="synchrotron_8cpp.html#afd4184652bfb1fac7ee55a159f618767" title="Creates and returns a new electron grid based on shock parameters." alt="" coords="189,5,367,31"/>
<area shape="poly" title=" " alt="" coords="436,54,338,33,339,28,437,49"/>
<area shape="rect" href="synchrotron_8cpp.html#a6fb32a514d942797b3beffa16aaf467a" title="Populates an existing electron grid with values based on shock parameters." alt="" coords="189,55,367,80"/>
<area shape="poly" title=" " alt="" coords="405,70,367,70,367,65,405,65"/>
<area shape="rect" href="synchrotron_8cpp.html#aecff2eca5f5a9c7e2a94481eb96e597f" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="199,104,357,129"/>
<area shape="poly" title=" " alt="" coords="437,85,339,107,338,101,436,80"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad7c1306e2402033ff31ce1f00cf1e3f2" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="26,79,121,104"/>
<area shape="poly" title=" " alt="" coords="185,108,120,100,121,94,186,103"/>
<area shape="rect" href="inverse-compton_8cpp.html#ae4c1495aa74372b72c2d5d61d1d53b62" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,128,141,153"/>
<area shape="poly" title=" " alt="" coords="186,130,142,135,141,130,185,125"/>
</map>
</div>

</div>
</div>
<a id="a4fdbd47450e56475b4be4656e288854e" name="a4fdbd47450e56475b4be4656e288854e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fdbd47450e56475b4be4656e288854e">&#9670;&#160;</a></span>generate_syn_electrons() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> generate_syn_electrons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> const &amp;&#160;</td>
          <td class="paramname"><em>shock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>xi</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and returns a new electron grid based on shock parameters. </p>
<p>Initializes all electron properties including Lorentz factors, column densities, and peak intensities for each grid cell. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shock</td><td>The shock object containing physical properties </td></tr>
    <tr><td class="paramname">p</td><td>Power-law index for the electron energy distribution </td></tr>
    <tr><td class="paramname">xi</td><td>Energy partitioning parameter (default: 1) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new grid of synchrotron electrons </dd></dl>

<p class="definition">Definition at line <a class="el" href="synchrotron_8cpp_source.html#l00688">688</a> of file <a class="el" href="synchrotron_8cpp_source.html">synchrotron.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  688</span>                                                                            {</div>
<div class="line"><span class="lineno">  689</span>    <span class="keyword">auto</span> [phi_size, theta_size, t_size] = shock.shape();</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>    <a class="code hl_typedef" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> electrons({phi_size, theta_size, t_size});</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_cyclotron = 3;</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; phi_size; ++i) {</div>
<div class="line"><span class="lineno">  696</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; theta_size; ++j) {</div>
<div class="line"><span class="lineno">  697</span>            <span class="keywordtype">size_t</span> k_inj = shock.injection_idx(i, j);</div>
<div class="line"><span class="lineno">  698</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; t_size; ++k) {</div>
<div class="line"><span class="lineno">  699</span>                <span class="keywordflow">if</span> (shock.required(i, j, k) == 0) {</div>
<div class="line"><span class="lineno">  700</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  701</span>                }</div>
<div class="line"><span class="lineno">  702</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma_rel = shock.Gamma_rel(i, j, k);</div>
<div class="line"><span class="lineno">  703</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_com = shock.t_comv(i, j, k);</div>
<div class="line"><span class="lineno">  704</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> B = shock.B(i, j, k);</div>
<div class="line"><span class="lineno">  705</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Sigma = shock.column_num_den(i, j, k);</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>                <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a> = electrons(i, j, k);</div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_M = <a class="code hl_function" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567">compute_syn_gamma_M</a>(B, electrons(i, j, k).Ys, p);</div>
<div class="line"><span class="lineno">  710</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m = <a class="code hl_function" href="synchrotron_8cpp.html#a0095a83d7309c92bcf2d807436b2615c">compute_syn_gamma_m</a>(Gamma_rel, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_M, shock.eps_e, p, xi);</div>
<div class="line"><span class="lineno">  711</span>                <span class="comment">// Fraction of synchrotron electrons; the rest are cyclotron</span></div>
<div class="line"><span class="lineno">  712</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> f = 1.;</div>
<div class="line"><span class="lineno">  713</span>                <span class="keywordflow">if</span> (1 &lt; <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m &amp;&amp; <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m &lt; gamma_cyclotron) {</div>
<div class="line"><span class="lineno">  714</span>                    f = std::min(<a class="code hl_function" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404">fast_pow</a>((gamma_cyclotron - 1) / (<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m - 1), 1 - p), 1_r);</div>
<div class="line"><span class="lineno">  715</span>                    <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m = gamma_cyclotron;</div>
<div class="line"><span class="lineno">  716</span>                }</div>
<div class="line"><span class="lineno">  717</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.column_num_den = Sigma * f * xi;</div>
<div class="line"><span class="lineno">  718</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.I_nu_peak = <a class="code hl_function" href="synchrotron_8cpp.html#a7f6b35414b0d45eff0677786294fc97c">compute_syn_peak_power</a>(B, p) * <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.column_num_den / (4 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>);</div>
<div class="line"><span class="lineno">  719</span>                <span class="keywordflow">if</span> (k &lt;= k_inj) {</div>
<div class="line"><span class="lineno">  720</span>                    <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c = <a class="code hl_function" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4">compute_gamma_c</a>(t_com, B, electrons(i, j, k).Ys, p);</div>
<div class="line"><span class="lineno">  721</span>                } <span class="keywordflow">else</span> {  <span class="comment">// no shocked electron injection, just adiabatic cooling</span></div>
<div class="line"><span class="lineno">  722</span>                    <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c = electrons(i, j, k_inj).gamma_c * <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m / electrons(i, j, k_inj).gamma_m;</div>
<div class="line"><span class="lineno">  723</span>                    <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_M = <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c;</div>
<div class="line"><span class="lineno">  724</span>                }</div>
<div class="line"><span class="lineno">  725</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_a = <a class="code hl_function" href="synchrotron_8cpp.html#a5b1694deb534f1df0ba3515fdf52b65a">compute_syn_gamma_a</a>(Gamma_rel, B, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.I_nu_peak, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c);</div>
<div class="line"><span class="lineno">  726</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.regime = <a class="code hl_function" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263">determine_regime</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_a, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m);</div>
<div class="line"><span class="lineno">  727</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.p = p;</div>
<div class="line"><span class="lineno">  728</span>            }</div>
<div class="line"><span class="lineno">  729</span>        }</div>
<div class="line"><span class="lineno">  730</span>    }</div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordflow">return</span> electrons;</div>
<div class="line"><span class="lineno">  732</span>}</div>
<div class="ttc" id="asynchrotron_8cpp_html_a0095a83d7309c92bcf2d807436b2615c"><div class="ttname"><a href="synchrotron_8cpp.html#a0095a83d7309c92bcf2d807436b2615c">compute_syn_gamma_m</a></div><div class="ttdeci">Real compute_syn_gamma_m(Real Gamma_rel, Real gamma_M, Real eps_e, Real p, Real xi)</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00555">synchrotron.cpp:555</a></div></div>
<div class="ttc" id="asynchrotron_8cpp_html_a1c5ae0a77c927eb60684c180ba559567"><div class="ttname"><a href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567">compute_syn_gamma_M</a></div><div class="ttdeci">Real compute_syn_gamma_M(Real B, InverseComptonY const &amp;Ys, Real p)</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00524">synchrotron.cpp:524</a></div></div>
<div class="ttc" id="asynchrotron_8cpp_html_a52e34d49dd7497d65ea5261e80d615d4"><div class="ttname"><a href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4">compute_gamma_c</a></div><div class="ttdeci">Real compute_gamma_c(Real t_com, Real B, InverseComptonY const &amp;Ys, Real p)</div><div class="ttdoc">Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00572">synchrotron.cpp:572</a></div></div>
<div class="ttc" id="asynchrotron_8cpp_html_a5813eed02877ed5f35a34e929a68d263"><div class="ttname"><a href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263">determine_regime</a></div><div class="ttdeci">size_t determine_regime(Real a, Real c, Real m)</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00166">synchrotron.cpp:166</a></div></div>
<div class="ttc" id="asynchrotron_8cpp_html_a5b1694deb534f1df0ba3515fdf52b65a"><div class="ttname"><a href="synchrotron_8cpp.html#a5b1694deb534f1df0ba3515fdf52b65a">compute_syn_gamma_a</a></div><div class="ttdeci">Real compute_syn_gamma_a(Real Gamma_rel, Real B, Real I_syn_peak, Real gamma_m, Real gamma_c)</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00605">synchrotron.cpp:605</a></div></div>
<div class="ttc" id="asynchrotron_8cpp_html_a7f6b35414b0d45eff0677786294fc97c"><div class="ttname"><a href="synchrotron_8cpp.html#a7f6b35414b0d45eff0677786294fc97c">compute_syn_peak_power</a></div><div class="ttdeci">Real compute_syn_peak_power(Real B, Real p)</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00478">synchrotron.cpp:478</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_a1ed93cca9de717545d10f8619effaf3a"><div class="ttname"><a href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a></div><div class="ttdeci">xt::xtensor&lt; SynElectrons, 3 &gt; SynElectronGrid</div><div class="ttdoc">Type alias for 3D grid of synchrotron electrons.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8h_source.html#l00249">synchrotron.h:249</a></div></div>
<div class="ttc" id="autilities_8h_html_a4520a27a10a2aef33c99ad8c679da404"><div class="ttname"><a href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404">fast_pow</a></div><div class="ttdeci">Real fast_pow(Real a, Real b)</div><div class="ttdoc">Fast approximation of a raised to the power of b.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00491">utilities.h:491</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_a4fdbd47450e56475b4be4656e288854e_cgraph.png" border="0" usemap="#asynchrotron_8h_a4fdbd47450e56475b4be4656e288854e_cgraph" alt=""/></div>
<map name="asynchrotron_8h_a4fdbd47450e56475b4be4656e288854e_cgraph" id="asynchrotron_8h_a4fdbd47450e56475b4be4656e288854e_cgraph">
<area shape="rect" title="Creates and returns a new electron grid based on shock parameters." alt="" coords="5,261,183,286"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="253,31,403,57"/>
<area shape="poly" title=" " alt="" coords="98,259,114,221,141,168,179,113,203,88,229,66,239,60,241,64,232,70,207,92,184,116,145,171,118,223,102,261"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="969,134,1051,159"/>
<area shape="poly" title=" " alt="" coords="123,258,172,238,230,220,333,198,438,181,645,158,826,147,956,144,956,149,826,152,646,163,439,186,334,203,231,225,174,243,125,263"/>
<area shape="rect" href="synchrotron_8cpp.html#a5b1694deb534f1df0ba3515fdf52b65a" title=" " alt="" coords="237,235,419,261"/>
<area shape="poly" title=" " alt="" coords="183,261,223,257,224,262,183,266"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="235,81,421,106"/>
<area shape="poly" title=" " alt="" coords="102,259,151,196,188,159,229,126,264,108,266,113,232,130,191,163,155,200,106,262"/>
<area shape="rect" href="synchrotron_8cpp.html#a0095a83d7309c92bcf2d807436b2615c" title=" " alt="" coords="235,285,421,310"/>
<area shape="poly" title=" " alt="" coords="183,280,221,284,221,289,183,285"/>
<area shape="rect" href="synchrotron_8cpp.html#a7f6b35414b0d45eff0677786294fc97c" title=" " alt="" coords="231,334,425,359"/>
<area shape="poly" title=" " alt="" coords="130,284,231,319,263,328,261,333,230,324,128,289"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="257,383,399,409"/>
<area shape="poly" title=" " alt="" coords="111,284,162,325,196,348,232,368,253,377,251,382,230,373,193,353,159,330,108,288"/>
<area shape="rect" href="classShock.html#a182095c7ca3cfd83d9d22d2627c10466" title="Returns grid dimensions as a tuple." alt="" coords="274,433,382,458"/>
<area shape="poly" title=" " alt="" coords="105,285,154,350,190,387,232,419,262,432,259,437,229,424,186,391,149,353,101,288"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="473,69,673,109"/>
<area shape="poly" title=" " alt="" coords="398,54,460,66,459,71,397,59"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="473,5,673,45"/>
<area shape="poly" title=" " alt="" coords="403,36,459,31,460,37,404,41"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="721,37,921,77"/>
<area shape="poly" title=" " alt="" coords="674,36,708,40,707,45,673,41"/>
<area shape="poly" title=" " alt="" coords="866,75,971,126,968,130,863,80"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="977,45,1043,70"/>
<area shape="poly" title=" " alt="" coords="922,55,963,55,963,60,922,60"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1099,109,1185,134"/>
<area shape="poly" title=" " alt="" coords="1050,136,1085,130,1086,135,1051,142"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1101,158,1183,183"/>
<area shape="poly" title=" " alt="" coords="1051,151,1088,158,1087,163,1050,157"/>
<area shape="poly" title=" " alt="" coords="397,233,473,220,599,203,697,193,795,182,921,163,956,156,957,161,922,168,796,187,698,198,600,208,474,225,398,238"/>
<area shape="rect" href="physics_8h.html#a2a95c6b3f1236d69328af7199a772a23" title="Computes adiabatic index as a function of Lorentz factor." alt="" coords="519,235,628,261"/>
<area shape="poly" title=" " alt="" coords="419,245,505,245,505,251,419,251"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="502,285,645,310"/>
<area shape="poly" title=" " alt="" coords="392,258,496,279,495,284,391,263"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="490,334,657,359"/>
<area shape="poly" title=" " alt="" coords="401,258,427,270,442,282,452,295,460,307,475,319,491,327,488,332,472,324,456,311,447,298,438,286,424,274,399,263"/>
<area shape="poly" title=" " alt="" coords="421,89,459,89,460,94,421,94"/>
<area shape="poly" title=" " alt="" coords="378,78,425,65,491,47,492,52,426,71,379,83"/>
<area shape="rect" href="utilities_8h.html#a29a716285d00743072d357c4a64a7f85" title="Finds the root of a function using the bisection method." alt="" coords="526,383,621,409"/>
<area shape="poly" title=" " alt="" coords="401,308,427,319,442,331,452,344,460,357,475,368,514,384,512,389,472,373,456,360,447,348,438,335,424,324,399,313"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="545,433,601,458"/>
<area shape="poly" title=" " alt="" coords="392,406,532,435,531,440,391,411"/>
</map>
</div>

</div>
</div>
<a id="a901300e562505fb294c074fa1e678308" name="a901300e562505fb294c074fa1e678308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a901300e562505fb294c074fa1e678308">&#9670;&#160;</a></span>generate_syn_electrons() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void generate_syn_electrons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>electrons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> const &amp;&#160;</td>
          <td class="paramname"><em>shock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>xi</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Populates an existing electron grid with values based on shock parameters. </p>
<p>Modifies a grid supplied by the caller rather than creating a new one. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electrons</td><td>The electron grid to populate </td></tr>
    <tr><td class="paramname">shock</td><td>The shock object containing physical properties </td></tr>
    <tr><td class="paramname">p</td><td>Power-law index for the electron energy distribution </td></tr>
    <tr><td class="paramname">xi</td><td>Energy partitioning parameter (default: 1) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="synchrotron_8cpp_source.html#l00734">734</a> of file <a class="el" href="synchrotron_8cpp_source.html">synchrotron.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  734</span>                                                                                             {</div>
<div class="line"><span class="lineno">  735</span>    <span class="keyword">auto</span> [phi_size, theta_size, t_size] = shock.shape();</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>    electrons.resize({phi_size, theta_size, t_size});</div>
<div class="line"><span class="lineno">  738</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_syn_limit = 3;</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; phi_size; ++i) {</div>
<div class="line"><span class="lineno">  741</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; theta_size; ++j) {</div>
<div class="line"><span class="lineno">  742</span>            <span class="keywordtype">size_t</span> k_inj = shock.injection_idx(i, j);</div>
<div class="line"><span class="lineno">  743</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; t_size; ++k) {</div>
<div class="line"><span class="lineno">  744</span>                <span class="keywordflow">if</span> (shock.required(i, j, k) == 0) {</div>
<div class="line"><span class="lineno">  745</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  746</span>                }</div>
<div class="line"><span class="lineno">  747</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma_rel = shock.Gamma_rel(i, j, k);</div>
<div class="line"><span class="lineno">  748</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_com = shock.t_comv(i, j, k);</div>
<div class="line"><span class="lineno">  749</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> B = shock.B(i, j, k);</div>
<div class="line"><span class="lineno">  750</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Sigma = shock.column_num_den(i, j, k);</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>                <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a> = electrons(i, j, k);</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_M = <a class="code hl_function" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567">compute_syn_gamma_M</a>(B, electrons(i, j, k).Ys, p);</div>
<div class="line"><span class="lineno">  755</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m = <a class="code hl_function" href="synchrotron_8cpp.html#a0095a83d7309c92bcf2d807436b2615c">compute_syn_gamma_m</a>(Gamma_rel, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_M, shock.eps_e, p, xi);</div>
<div class="line"><span class="lineno">  756</span>                <span class="comment">// Fraction of synchrotron electrons; the rest are cyclotron</span></div>
<div class="line"><span class="lineno">  757</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> f = 1.;</div>
<div class="line"><span class="lineno">  758</span>                <span class="keywordflow">if</span> (1 &lt; <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m &amp;&amp; <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m &lt; gamma_syn_limit) {</div>
<div class="line"><span class="lineno">  759</span>                    f = std::min(<a class="code hl_function" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404">fast_pow</a>((gamma_syn_limit - 1) / (<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m - 1), 1 - p), 1_r);</div>
<div class="line"><span class="lineno">  760</span>                    <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m = gamma_syn_limit;</div>
<div class="line"><span class="lineno">  761</span>                }</div>
<div class="line"><span class="lineno">  762</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.column_num_den = Sigma * f * xi;</div>
<div class="line"><span class="lineno">  763</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.I_nu_peak = <a class="code hl_function" href="synchrotron_8cpp.html#a7f6b35414b0d45eff0677786294fc97c">compute_syn_peak_power</a>(B, p) * <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.column_num_den / (4 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>);</div>
<div class="line"><span class="lineno">  764</span>                <span class="keywordflow">if</span> (k &lt;= k_inj) {</div>
<div class="line"><span class="lineno">  765</span>                    <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c = <a class="code hl_function" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4">compute_gamma_c</a>(t_com, B, electrons(i, j, k).Ys, p);</div>
<div class="line"><span class="lineno">  766</span>                } <span class="keywordflow">else</span> {  <span class="comment">// no shocked electron injection, just adiabatic cooling</span></div>
<div class="line"><span class="lineno">  767</span>                    <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c = electrons(i, j, k_inj).gamma_c * <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m / electrons(i, j, k_inj).gamma_m;</div>
<div class="line"><span class="lineno">  768</span>                    <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_M = <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c;</div>
<div class="line"><span class="lineno">  769</span>                }</div>
<div class="line"><span class="lineno">  770</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_a = <a class="code hl_function" href="synchrotron_8cpp.html#a5b1694deb534f1df0ba3515fdf52b65a">compute_syn_gamma_a</a>(Gamma_rel, B, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.I_nu_peak, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c);</div>
<div class="line"><span class="lineno">  771</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.regime = <a class="code hl_function" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263">determine_regime</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_a, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m);</div>
<div class="line"><span class="lineno">  772</span>                <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.p = p;</div>
<div class="line"><span class="lineno">  773</span>            }</div>
<div class="line"><span class="lineno">  774</span>        }</div>
<div class="line"><span class="lineno">  775</span>    }</div>
<div class="line"><span class="lineno">  776</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_a901300e562505fb294c074fa1e678308_cgraph.png" border="0" usemap="#asynchrotron_8h_a901300e562505fb294c074fa1e678308_cgraph" alt=""/></div>
<map name="asynchrotron_8h_a901300e562505fb294c074fa1e678308_cgraph" id="asynchrotron_8h_a901300e562505fb294c074fa1e678308_cgraph">
<area shape="rect" title="Populates an existing electron grid with values based on shock parameters." alt="" coords="5,261,183,286"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="253,31,403,57"/>
<area shape="poly" title=" " alt="" coords="98,259,114,221,141,168,179,113,203,88,229,66,239,60,241,64,232,70,207,92,184,116,145,171,118,223,102,261"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="969,134,1051,159"/>
<area shape="poly" title=" " alt="" coords="123,258,172,238,230,220,333,198,438,181,645,158,826,147,956,144,956,149,826,152,646,163,439,186,334,203,231,225,174,243,125,263"/>
<area shape="rect" href="synchrotron_8cpp.html#a5b1694deb534f1df0ba3515fdf52b65a" title=" " alt="" coords="237,235,419,261"/>
<area shape="poly" title=" " alt="" coords="183,261,223,257,224,262,183,266"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="235,81,421,106"/>
<area shape="poly" title=" " alt="" coords="102,259,151,196,188,159,229,126,264,108,266,113,232,130,191,163,155,200,106,262"/>
<area shape="rect" href="synchrotron_8cpp.html#a0095a83d7309c92bcf2d807436b2615c" title=" " alt="" coords="235,285,421,310"/>
<area shape="poly" title=" " alt="" coords="183,280,221,284,221,289,183,285"/>
<area shape="rect" href="synchrotron_8cpp.html#a7f6b35414b0d45eff0677786294fc97c" title=" " alt="" coords="231,334,425,359"/>
<area shape="poly" title=" " alt="" coords="130,284,231,319,263,328,261,333,230,324,128,289"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="257,383,399,409"/>
<area shape="poly" title=" " alt="" coords="111,284,162,325,196,348,232,368,253,377,251,382,230,373,193,353,159,330,108,288"/>
<area shape="rect" href="classShock.html#a182095c7ca3cfd83d9d22d2627c10466" title="Returns grid dimensions as a tuple." alt="" coords="274,433,382,458"/>
<area shape="poly" title=" " alt="" coords="105,285,154,350,190,387,232,419,262,432,259,437,229,424,186,391,149,353,101,288"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="473,69,673,109"/>
<area shape="poly" title=" " alt="" coords="398,54,460,66,459,71,397,59"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="473,5,673,45"/>
<area shape="poly" title=" " alt="" coords="403,36,459,31,460,37,404,41"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="721,37,921,77"/>
<area shape="poly" title=" " alt="" coords="674,36,708,40,707,45,673,41"/>
<area shape="poly" title=" " alt="" coords="866,75,971,126,968,130,863,80"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="977,45,1043,70"/>
<area shape="poly" title=" " alt="" coords="922,55,963,55,963,60,922,60"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1099,109,1185,134"/>
<area shape="poly" title=" " alt="" coords="1050,136,1085,130,1086,135,1051,142"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1101,158,1183,183"/>
<area shape="poly" title=" " alt="" coords="1051,151,1088,158,1087,163,1050,157"/>
<area shape="poly" title=" " alt="" coords="397,233,473,220,599,203,697,193,795,182,921,163,956,156,957,161,922,168,796,187,698,198,600,208,474,225,398,238"/>
<area shape="rect" href="physics_8h.html#a2a95c6b3f1236d69328af7199a772a23" title="Computes adiabatic index as a function of Lorentz factor." alt="" coords="519,235,628,261"/>
<area shape="poly" title=" " alt="" coords="419,245,505,245,505,251,419,251"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="502,285,645,310"/>
<area shape="poly" title=" " alt="" coords="392,258,496,279,495,284,391,263"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="490,334,657,359"/>
<area shape="poly" title=" " alt="" coords="401,258,427,270,442,282,452,295,460,307,475,319,491,327,488,332,472,324,456,311,447,298,438,286,424,274,399,263"/>
<area shape="poly" title=" " alt="" coords="421,89,459,89,460,94,421,94"/>
<area shape="poly" title=" " alt="" coords="378,78,425,65,491,47,492,52,426,71,379,83"/>
<area shape="rect" href="utilities_8h.html#a29a716285d00743072d357c4a64a7f85" title="Finds the root of a function using the bisection method." alt="" coords="526,383,621,409"/>
<area shape="poly" title=" " alt="" coords="401,308,427,319,442,331,452,344,460,357,475,368,514,384,512,389,472,373,456,360,447,348,438,335,424,324,399,313"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="545,433,601,458"/>
<area shape="poly" title=" " alt="" coords="392,406,532,435,531,440,391,411"/>
</map>
</div>

</div>
</div>
<a id="a331f545228d2b18e84e0252510e295f8" name="a331f545228d2b18e84e0252510e295f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a331f545228d2b18e84e0252510e295f8">&#9670;&#160;</a></span>generate_syn_photons() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> generate_syn_photons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> const &amp;&#160;</td>
          <td class="paramname"><em>shock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> const &amp;&#160;</td>
          <td class="paramname"><em>electrons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and returns a new photon grid based on shock and electron grid. </p>
<p>Computes characteristic frequencies and updates calculation constants for each grid cell. Returns the populated photon grid. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shock</td><td>The shock object containing physical properties </td></tr>
    <tr><td class="paramname">electrons</td><td>The electron grid providing energy distribution information </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new grid of synchrotron photons </dd></dl>

<p class="definition">Definition at line <a class="el" href="synchrotron_8cpp_source.html#l00778">778</a> of file <a class="el" href="synchrotron_8cpp_source.html">synchrotron.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  778</span>                                                                                 {</div>
<div class="line"><span class="lineno">  779</span>    <span class="keyword">auto</span> [phi_size, theta_size, t_size] = shock.shape();</div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span>    <a class="code hl_typedef" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> ph({phi_size, theta_size, t_size});</div>
<div class="line"><span class="lineno">  782</span> </div>
<div class="line"><span class="lineno">  783</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; phi_size; ++i) {</div>
<div class="line"><span class="lineno">  784</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; theta_size; ++j) {</div>
<div class="line"><span class="lineno">  785</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; t_size; ++k) {</div>
<div class="line"><span class="lineno">  786</span>                ph(i, j, k).e = &amp;(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k));</div>
<div class="line"><span class="lineno">  787</span>                <span class="keywordflow">if</span> (shock.required(i, j, k) == 0) {</div>
<div class="line"><span class="lineno">  788</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  789</span>                }</div>
<div class="line"><span class="lineno">  790</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> B = shock.B(i, j, k);</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>                ph(i, j, k).nu_M = <a class="code hl_function" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).gamma_M, B);</div>
<div class="line"><span class="lineno">  793</span>                ph(i, j, k).nu_m = <a class="code hl_function" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).gamma_m, B);</div>
<div class="line"><span class="lineno">  794</span>                ph(i, j, k).nu_c = <a class="code hl_function" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).gamma_c, B);</div>
<div class="line"><span class="lineno">  795</span>                ph(i, j, k).nu_a = <a class="code hl_function" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).gamma_a, B);</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>                ph(i, j, k).log2_I_nu_peak = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).I_nu_peak);</div>
<div class="line"><span class="lineno">  798</span>                ph(i, j, k).log2_nu_m = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(ph(i, j, k).nu_m);</div>
<div class="line"><span class="lineno">  799</span>                ph(i, j, k).log2_nu_c = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(ph(i, j, k).nu_c);</div>
<div class="line"><span class="lineno">  800</span>                ph(i, j, k).log2_nu_a = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(ph(i, j, k).nu_a);</div>
<div class="line"><span class="lineno">  801</span>                ph(i, j, k).log2_nu_M = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(ph(i, j, k).nu_M);</div>
<div class="line"><span class="lineno">  802</span>                ph(i, j, k).update_constant();</div>
<div class="line"><span class="lineno">  803</span>            }</div>
<div class="line"><span class="lineno">  804</span>        }</div>
<div class="line"><span class="lineno">  805</span>    }</div>
<div class="line"><span class="lineno">  806</span>    <span class="keywordflow">return</span> ph;</div>
<div class="line"><span class="lineno">  807</span>}</div>
<div class="ttc" id="asynchrotron_8cpp_html_a936bfaa522ec8295a21d253e5453188d"><div class="ttname"><a href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a></div><div class="ttdeci">Real compute_syn_freq(Real gamma, Real B)</div><div class="ttdoc">Calculates synchrotron frequency for a given Lorentz factor and magnetic field.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00493">synchrotron.cpp:493</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_a0ab8637927d98b2552ae0f5b9eb5e5c2"><div class="ttname"><a href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a></div><div class="ttdeci">xt::xtensor&lt; SynPhotons, 3 &gt; SynPhotonGrid</div><div class="ttdoc">Type alias for 3D grid of synchrotron photons.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8h_source.html#l00247">synchrotron.h:247</a></div></div>
<div class="ttc" id="autilities_8h_html_afe0a1b1b7509ac4df83fcc0e510f281b"><div class="ttname"><a href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a></div><div class="ttdeci">double fast_log2(double val)</div><div class="ttdoc">Fast approximation of the base-2 logarithm.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00421">utilities.h:421</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_a331f545228d2b18e84e0252510e295f8_cgraph.png" border="0" usemap="#asynchrotron_8h_a331f545228d2b18e84e0252510e295f8_cgraph" alt=""/></div>
<map name="asynchrotron_8h_a331f545228d2b18e84e0252510e295f8_cgraph" id="asynchrotron_8h_a331f545228d2b18e84e0252510e295f8_cgraph">
<area shape="rect" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="5,55,175,80"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="223,5,365,31"/>
<area shape="poly" title=" " alt="" coords="143,52,227,31,228,37,144,57"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="253,55,335,80"/>
<area shape="poly" title=" " alt="" coords="175,65,239,65,239,70,175,70"/>
<area shape="rect" href="classShock.html#a182095c7ca3cfd83d9d22d2627c10466" title="Returns grid dimensions as a tuple." alt="" coords="240,104,348,129"/>
<area shape="poly" title=" " alt="" coords="144,77,228,98,227,103,143,83"/>
</map>
</div>

</div>
</div>
<a id="a0f78089bdc9e329056d89812794298b9" name="a0f78089bdc9e329056d89812794298b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f78089bdc9e329056d89812794298b9">&#9670;&#160;</a></span>generate_syn_photons() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void generate_syn_photons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>photons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> const &amp;&#160;</td>
          <td class="paramname"><em>shock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> const &amp;&#160;</td>
          <td class="paramname"><em>electrons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Populates an existing photon grid with values based on shock and electron grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">photons</td><td>The photon grid to populate </td></tr>
    <tr><td class="paramname">shock</td><td>The shock object containing physical properties </td></tr>
    <tr><td class="paramname">electrons</td><td>The electron grid providing energy distribution information </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="synchrotron_8cpp_source.html#l00809">809</a> of file <a class="el" href="synchrotron_8cpp_source.html">synchrotron.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  809</span>                                                                                           {</div>
<div class="line"><span class="lineno">  810</span>    <span class="keyword">auto</span> [phi_size, theta_size, t_size] = shock.shape();</div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span>    ph.resize({phi_size, theta_size, t_size});</div>
<div class="line"><span class="lineno">  813</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; phi_size; ++i) {</div>
<div class="line"><span class="lineno">  814</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; theta_size; ++j) {</div>
<div class="line"><span class="lineno">  815</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; t_size; ++k) {</div>
<div class="line"><span class="lineno">  816</span>                ph(i, j, k).e = &amp;(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k));</div>
<div class="line"><span class="lineno">  817</span>                <span class="keywordflow">if</span> (shock.required(i, j, k) == 0) {</div>
<div class="line"><span class="lineno">  818</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  819</span>                }</div>
<div class="line"><span class="lineno">  820</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> B = shock.B(i, j, k);</div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span>                ph(i, j, k).nu_M = <a class="code hl_function" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).gamma_M, B);</div>
<div class="line"><span class="lineno">  823</span>                ph(i, j, k).nu_m = <a class="code hl_function" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).gamma_m, B);</div>
<div class="line"><span class="lineno">  824</span>                ph(i, j, k).nu_c = <a class="code hl_function" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).gamma_c, B);</div>
<div class="line"><span class="lineno">  825</span>                ph(i, j, k).nu_a = <a class="code hl_function" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d">compute_syn_freq</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).gamma_a, B);</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>                ph(i, j, k).log2_I_nu_peak = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).I_nu_peak);</div>
<div class="line"><span class="lineno">  828</span>                ph(i, j, k).log2_nu_m = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(ph(i, j, k).nu_m);</div>
<div class="line"><span class="lineno">  829</span>                ph(i, j, k).log2_nu_c = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(ph(i, j, k).nu_c);</div>
<div class="line"><span class="lineno">  830</span>                ph(i, j, k).log2_nu_a = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(ph(i, j, k).nu_a);</div>
<div class="line"><span class="lineno">  831</span>                ph(i, j, k).log2_nu_M = <a class="code hl_function" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b">fast_log2</a>(ph(i, j, k).nu_M);</div>
<div class="line"><span class="lineno">  832</span>                ph(i, j, k).update_constant();</div>
<div class="line"><span class="lineno">  833</span>            }</div>
<div class="line"><span class="lineno">  834</span>        }</div>
<div class="line"><span class="lineno">  835</span>    }</div>
<div class="line"><span class="lineno">  836</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_a0f78089bdc9e329056d89812794298b9_cgraph.png" border="0" usemap="#asynchrotron_8h_a0f78089bdc9e329056d89812794298b9_cgraph" alt=""/></div>
<map name="asynchrotron_8h_a0f78089bdc9e329056d89812794298b9_cgraph" id="asynchrotron_8h_a0f78089bdc9e329056d89812794298b9_cgraph">
<area shape="rect" title="Populates an existing photon grid with values based on shock and electron grid." alt="" coords="5,55,175,80"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="223,5,365,31"/>
<area shape="poly" title=" " alt="" coords="143,52,227,31,228,37,144,57"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="253,55,335,80"/>
<area shape="poly" title=" " alt="" coords="175,65,239,65,239,70,175,70"/>
<area shape="rect" href="classShock.html#a182095c7ca3cfd83d9d22d2627c10466" title="Returns grid dimensions as a tuple." alt="" coords="240,104,348,129"/>
<area shape="poly" title=" " alt="" coords="144,77,228,98,227,103,143,83"/>
</map>
</div>

</div>
</div>
<a id="aecff2eca5f5a9c7e2a94481eb96e597f" name="aecff2eca5f5a9c7e2a94481eb96e597f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecff2eca5f5a9c7e2a94481eb96e597f">&#9670;&#160;</a></span>update_electrons_4Y()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_electrons_4Y </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> const &amp;&#160;</td>
          <td class="paramname"><em>shock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates electron properties throughout the grid based on shock parameters and IC Y values. </p>
<p>Recalculates gamma_M, gamma_c, gamma_a, regime, and Y_c parameters for each grid cell. Handles both freshly-shocked and adiabatic cooling regions. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>Synchrotron electron grid to update </td></tr>
    <tr><td class="paramname">shock</td><td>The shock object containing evolution data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="synchrotron_8cpp_source.html#l00655">655</a> of file <a class="el" href="synchrotron_8cpp_source.html">synchrotron.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  655</span>                                                                 {</div>
<div class="line"><span class="lineno">  656</span>    <span class="keyword">auto</span> [phi_size, theta_size, t_size] = shock.shape();</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; phi_size; ++i) {</div>
<div class="line"><span class="lineno">  659</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; theta_size; ++j) {</div>
<div class="line"><span class="lineno">  660</span>            <span class="keywordtype">size_t</span> k_inj = shock.injection_idx(i, j);</div>
<div class="line"><span class="lineno">  661</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; t_size; ++k) {</div>
<div class="line"><span class="lineno">  662</span>                <span class="keywordflow">if</span> (shock.required(i, j, k) == 0) {</div>
<div class="line"><span class="lineno">  663</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  664</span>                }</div>
<div class="line"><span class="lineno">  665</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma_rel = shock.Gamma_rel(i, j, k);</div>
<div class="line"><span class="lineno">  666</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_com = shock.t_comv(i, j, k);</div>
<div class="line"><span class="lineno">  667</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> B = shock.B(i, j, k);</div>
<div class="line"><span class="lineno">  668</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> p = <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).p;</div>
<div class="line"><span class="lineno">  669</span>                <span class="keyword">auto</span>&amp; Ys = <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k).Ys;</div>
<div class="line"><span class="lineno">  670</span>                <span class="keyword">auto</span>&amp; electron = <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k);</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>                electron.gamma_M = <a class="code hl_function" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567">compute_syn_gamma_M</a>(B, Ys, p);  <span class="comment">// Update maximum electron Lorentz factor</span></div>
<div class="line"><span class="lineno">  673</span>                <span class="keywordflow">if</span> (k &lt;= k_inj) {</div>
<div class="line"><span class="lineno">  674</span>                    electron.gamma_c = <a class="code hl_function" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4">compute_gamma_c</a>(t_com, B, Ys, p);  <span class="comment">// Update cooling electron Lorentz factor</span></div>
<div class="line"><span class="lineno">  675</span>                } <span class="keywordflow">else</span> {  <span class="comment">// no shocked electron injection, just adiabatic cooling</span></div>
<div class="line"><span class="lineno">  676</span>                    electron.gamma_c = <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k_inj).gamma_c * electron.gamma_m / <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>(i, j, k_inj).gamma_m;</div>
<div class="line"><span class="lineno">  677</span>                    electron.gamma_M = electron.gamma_c;</div>
<div class="line"><span class="lineno">  678</span>                }</div>
<div class="line"><span class="lineno">  679</span>                electron.gamma_a =</div>
<div class="line"><span class="lineno">  680</span>                    <a class="code hl_function" href="synchrotron_8cpp.html#a5b1694deb534f1df0ba3515fdf52b65a">compute_syn_gamma_a</a>(Gamma_rel, B, electron.I_nu_peak, electron.gamma_m, electron.gamma_c);</div>
<div class="line"><span class="lineno">  681</span>                electron.regime = <a class="code hl_function" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263">determine_regime</a>(electron.gamma_a, electron.gamma_c, electron.gamma_m);</div>
<div class="line"><span class="lineno">  682</span>                electron.Y_c = <a class="code hl_function" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb">InverseComptonY::compute_Y_tilt_at_gamma</a>(Ys, electron.gamma_c, p);</div>
<div class="line"><span class="lineno">  683</span>            }</div>
<div class="line"><span class="lineno">  684</span>        }</div>
<div class="line"><span class="lineno">  685</span>    }</div>
<div class="line"><span class="lineno">  686</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_aecff2eca5f5a9c7e2a94481eb96e597f_cgraph.png" border="0" usemap="#asynchrotron_8h_aecff2eca5f5a9c7e2a94481eb96e597f_cgraph" alt=""/></div>
<map name="asynchrotron_8h_aecff2eca5f5a9c7e2a94481eb96e597f_cgraph" id="asynchrotron_8h_aecff2eca5f5a9c7e2a94481eb96e597f_cgraph">
<area shape="rect" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="5,158,163,183"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="228,29,379,54"/>
<area shape="poly" title=" " alt="" coords="95,156,142,111,174,85,209,63,225,56,227,61,212,68,177,89,145,115,99,160"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="444,69,644,109"/>
<area shape="poly" title=" " alt="" coords="156,155,430,107,431,112,157,161"/>
<area shape="rect" href="synchrotron_8cpp.html#a5b1694deb534f1df0ba3515fdf52b65a" title=" " alt="" coords="213,183,394,209"/>
<area shape="poly" title=" " alt="" coords="163,177,199,181,199,187,163,182"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="211,78,396,103"/>
<area shape="poly" title=" " alt="" coords="118,155,210,121,253,106,255,111,212,127,120,160"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="232,233,375,258"/>
<area shape="poly" title=" " alt="" coords="116,181,212,217,240,226,239,231,210,223,114,186"/>
<area shape="rect" href="classShock.html#a182095c7ca3cfd83d9d22d2627c10466" title="Returns grid dimensions as a tuple." alt="" coords="249,282,357,307"/>
<area shape="poly" title=" " alt="" coords="99,181,146,224,178,248,212,268,237,278,235,283,209,273,175,252,143,228,96,185"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="444,5,644,45"/>
<area shape="poly" title=" " alt="" coords="378,34,430,30,431,36,379,39"/>
<area shape="poly" title=" " alt="" coords="368,51,431,64,430,69,367,57"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="692,95,892,135"/>
<area shape="poly" title=" " alt="" coords="644,97,679,100,678,106,644,102"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="940,155,1021,181"/>
<area shape="poly" title=" " alt="" coords="864,132,928,150,926,156,862,137"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="948,102,1013,127"/>
<area shape="poly" title=" " alt="" coords="892,112,934,112,934,117,892,117"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1069,130,1156,155"/>
<area shape="poly" title=" " alt="" coords="1021,158,1055,151,1056,156,1022,163"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1071,179,1154,205"/>
<area shape="poly" title=" " alt="" coords="1022,173,1058,179,1057,185,1021,178"/>
<area shape="poly" title=" " alt="" coords="394,190,926,168,926,173,394,195"/>
<area shape="rect" href="physics_8h.html#a2a95c6b3f1236d69328af7199a772a23" title="Computes adiabatic index as a function of Lorentz factor." alt="" coords="489,235,599,261"/>
<area shape="poly" title=" " alt="" coords="363,206,476,231,475,236,362,211"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="473,285,615,310"/>
<area shape="poly" title=" " alt="" coords="373,206,397,218,413,231,422,245,431,259,445,271,461,279,458,284,443,276,427,262,418,248,409,235,395,222,371,211"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="461,134,627,159"/>
<area shape="poly" title=" " alt="" coords="365,181,467,160,468,165,366,186"/>
<area shape="poly" title=" " alt="" coords="350,75,456,46,457,51,352,80"/>
<area shape="poly" title=" " alt="" coords="396,87,430,87,430,93,396,93"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="516,334,572,359"/>
<area shape="poly" title=" " alt="" coords="370,256,397,268,413,282,422,295,431,308,445,320,474,333,503,340,502,345,472,338,443,325,427,312,418,298,409,285,395,273,367,261"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="synchrotron_8h_aecff2eca5f5a9c7e2a94481eb96e597f_icgraph.png" border="0" usemap="#asynchrotron_8h_aecff2eca5f5a9c7e2a94481eb96e597f_icgraph" alt=""/></div>
<map name="asynchrotron_8h_aecff2eca5f5a9c7e2a94481eb96e597f_icgraph" id="asynchrotron_8h_aecff2eca5f5a9c7e2a94481eb96e597f_icgraph">
<area shape="rect" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="189,31,347,56"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad7c1306e2402033ff31ce1f00cf1e3f2" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="26,5,121,31"/>
<area shape="poly" title=" " alt="" coords="175,34,121,27,121,21,176,29"/>
<area shape="rect" href="inverse-compton_8cpp.html#ae4c1495aa74372b72c2d5d61d1d53b62" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,55,141,80"/>
<area shape="poly" title=" " alt="" coords="176,57,142,62,141,56,175,52"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="synchrotron_8h.html">synchrotron.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
