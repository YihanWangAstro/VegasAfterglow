<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: mesh.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mesh_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mesh.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;span&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">../util/macros.h</a>&quot;</code><br />
<code>#include &quot;boost/numeric/odeint.hpp&quot;</code><br />
<code>#include &quot;<a class="el" href="physics_8h_source.html">physics.h</a>&quot;</code><br />
<code>#include &quot;xtensor/containers/xadapt.hpp&quot;</code><br />
<code>#include &quot;xtensor/containers/xtensor.hpp&quot;</code><br />
<code>#include &quot;xtensor/core/xmath.hpp&quot;</code><br />
<code>#include &quot;xtensor/io/xnpy.hpp&quot;</code><br />
<code>#include &quot;xtensor/views/xview.hpp&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for mesh.h:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h__incl.png" border="0" usemap="#amesh_8h" alt=""/></div>
<map name="amesh_8h" id="amesh_8h">
<area shape="rect" title=" " alt="" coords="563,5,634,31"/>
<area shape="rect" title=" " alt="" coords="5,86,91,111"/>
<area shape="poly" title=" " alt="" coords="563,24,366,40,235,57,103,81,91,84,90,79,102,76,234,51,365,34,563,18"/>
<area shape="rect" title=" " alt="" coords="115,86,184,111"/>
<area shape="poly" title=" " alt="" coords="563,24,403,41,300,58,197,81,188,84,186,79,195,76,299,53,402,36,563,19"/>
<area shape="rect" title=" " alt="" coords="208,86,261,111"/>
<area shape="poly" title=" " alt="" coords="564,25,434,43,354,59,274,81,269,83,267,78,273,76,353,54,433,38,563,20"/>
<area shape="rect" title=" " alt="" coords="286,86,349,111"/>
<area shape="poly" title=" " alt="" coords="564,30,475,51,369,81,360,84,359,79,367,76,473,46,563,25"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="417,167,535,192"/>
<area shape="poly" title=" " alt="" coords="563,22,526,25,485,34,445,52,428,65,414,80,408,98,414,118,429,139,448,157,444,161,425,143,410,120,403,98,410,77,425,61,443,47,483,29,525,20,563,16"/>
<area shape="rect" title=" " alt="" coords="425,86,613,111"/>
<area shape="poly" title=" " alt="" coords="589,33,542,78,539,74,585,29"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="637,86,720,111"/>
<area shape="poly" title=" " alt="" coords="612,29,659,74,655,78,609,33"/>
<area shape="rect" title=" " alt="" coords="745,79,887,119"/>
<area shape="poly" title=" " alt="" coords="631,28,752,72,750,77,629,33"/>
<area shape="rect" title=" " alt="" coords="911,79,1054,119"/>
<area shape="poly" title=" " alt="" coords="635,23,898,76,897,81,634,29"/>
<area shape="rect" title=" " alt="" coords="1078,86,1255,111"/>
<area shape="poly" title=" " alt="" coords="635,21,820,42,1067,76,1096,81,1095,86,1066,81,820,47,634,26"/>
<area shape="rect" title=" " alt="" coords="1280,86,1429,111"/>
<area shape="poly" title=" " alt="" coords="634,18,898,35,1082,52,1268,76,1294,81,1293,86,1268,81,1081,58,898,41,634,24"/>
<area shape="rect" title=" " alt="" coords="1454,86,1637,111"/>
<area shape="poly" title=" " alt="" coords="634,18,965,34,1200,51,1442,76,1475,81,1474,86,1441,81,1200,56,964,39,634,23"/>
<area shape="rect" title=" " alt="" coords="384,247,443,273"/>
<area shape="poly" title=" " alt="" coords="469,194,433,238,429,235,465,191"/>
<area shape="rect" href="simulation-defaults_8h.html" title="Centralized simulation configuration defaults." alt="" coords="467,240,613,280"/>
<area shape="poly" title=" " alt="" coords="488,190,518,228,514,231,483,194"/>
<area shape="rect" title=" " alt="" coords="505,328,575,353"/>
<area shape="poly" title=" " alt="" coords="543,280,543,314,537,314,537,280"/>
<area shape="poly" title=" " alt="" coords="650,114,519,164,517,159,648,109"/>
<area shape="rect" title=" " alt="" coords="647,167,710,192"/>
<area shape="poly" title=" " alt="" coords="681,112,681,153,676,153,676,112"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h__dep__incl.png" border="0" usemap="#amesh_8hdep" alt=""/></div>
<map name="amesh_8hdep" id="amesh_8hdep">
<area shape="rect" title=" " alt="" coords="681,5,751,31"/>
<area shape="rect" href="IO_8h.html" title=" " alt="" coords="176,519,224,544"/>
<area shape="poly" title=" " alt="" coords="667,24,526,33,439,43,352,57,271,75,204,99,178,113,159,128,147,145,143,164,143,386,148,425,162,462,194,517,189,520,157,464,143,426,137,386,137,163,142,143,155,125,175,108,202,94,269,70,351,51,439,38,526,28,667,18"/>
<area shape="rect" href="afterglow_8h.html" title=" " alt="" coords="1170,592,1265,617"/>
<area shape="poly" title=" " alt="" coords="765,17,1044,24,1236,32,1436,45,1626,63,1786,88,1848,103,1896,120,1927,140,1936,151,1939,163,1939,460,1933,485,1916,507,1889,526,1855,542,1767,568,1661,586,1548,597,1438,604,1265,607,1265,601,1437,598,1548,592,1660,581,1765,563,1853,537,1886,521,1912,503,1928,482,1933,459,1933,164,1931,154,1924,144,1894,125,1847,108,1785,93,1625,69,1436,50,1236,38,1044,29,765,23"/>
<area shape="rect" href="inverse-compton_8h.html" title=" " alt="" coords="605,299,749,324"/>
<area shape="poly" title=" " alt="" coords="727,43,733,72,733,104,723,163,709,219,684,299,679,298,704,217,718,162,728,104,727,73,721,44"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="527,445,638,471"/>
<area shape="poly" title=" " alt="" coords="667,26,550,41,409,68,345,86,292,108,257,134,247,148,244,164,244,312,246,323,252,333,274,354,308,374,349,391,443,422,528,443,527,448,441,427,347,396,305,378,271,358,248,337,241,325,239,313,239,163,242,146,253,131,289,104,343,81,408,62,549,36,666,21"/>
<area shape="rect" href="mesh_8cpp.html" title=" " alt="" coords="633,79,719,104"/>
<area shape="poly" title=" " alt="" coords="705,44,685,80,680,77,700,42"/>
<area shape="rect" href="observer_8h.html" title=" " alt="" coords="1792,299,1883,324"/>
<area shape="poly" title=" " alt="" coords="766,16,984,20,1133,26,1292,37,1451,53,1597,77,1661,91,1718,108,1767,128,1804,150,1820,165,1831,184,1843,226,1844,268,1842,299,1837,298,1839,268,1837,227,1826,186,1816,169,1801,154,1764,133,1717,113,1660,97,1596,82,1450,59,1292,42,1133,31,984,25,766,22"/>
<area shape="rect" href="prompt_8h.html" title=" " alt="" coords="21,445,102,471"/>
<area shape="poly" title=" " alt="" coords="667,21,541,22,380,28,300,36,227,47,166,62,123,81,101,98,88,115,81,136,79,163,79,313,74,389,66,445,61,445,69,388,73,313,73,163,75,135,83,113,97,94,120,76,164,56,226,41,299,31,380,23,541,16,667,16"/>
<area shape="rect" href="quadrature_8h.html" title=" " alt="" coords="578,225,683,251"/>
<area shape="poly" title=" " alt="" coords="671,39,644,56,624,80,616,99,612,118,612,159,620,197,629,224,623,226,615,198,607,160,607,118,611,97,619,77,641,52,668,34"/>
<area shape="rect" href="shock_8h.html" title=" " alt="" coords="1248,225,1320,251"/>
<area shape="poly" title=" " alt="" coords="765,19,903,29,1080,52,1167,69,1244,91,1306,118,1329,133,1346,150,1351,161,1352,173,1342,194,1323,213,1304,227,1301,223,1320,209,1337,191,1346,172,1346,163,1342,154,1326,137,1303,122,1242,96,1165,74,1079,57,903,35,765,24"/>
<area shape="rect" href="utilities_8h.html" title=" " alt="" coords="1004,79,1087,104"/>
<area shape="poly" title=" " alt="" coords="765,27,1004,78,1003,84,764,32"/>
<area shape="rect" href="IO_8cpp.html" title=" " alt="" coords="169,592,231,617"/>
<area shape="poly" title=" " alt="" coords="203,558,203,592,197,592,197,558"/>
<area shape="poly" title=" " alt="" coords="238,533,1170,597,1170,603,237,538"/>
<area shape="rect" href="pymodel_8cpp.html" title=" " alt="" coords="1269,812,1376,837"/>
<area shape="poly" title=" " alt="" coords="1255,622,1279,640,1300,664,1317,704,1325,746,1326,812,1321,812,1319,746,1311,705,1295,667,1276,644,1252,626"/>
<area shape="rect" href="pymodel_8h.html" title=" " alt="" coords="1163,739,1253,764"/>
<area shape="poly" title=" " alt="" coords="1182,626,1159,644,1141,667,1138,677,1139,686,1150,706,1168,723,1188,736,1185,741,1165,727,1146,709,1134,688,1133,676,1136,664,1155,640,1178,622"/>
<area shape="rect" href="shock__dispatch_8h.html" title=" " alt="" coords="1150,665,1285,691"/>
<area shape="poly" title=" " alt="" coords="1220,631,1220,665,1215,665,1215,631"/>
<area shape="rect" href="synchrotron_8cpp.html" title=" " alt="" coords="734,665,861,691"/>
<area shape="poly" title=" " alt="" coords="1157,619,861,669,860,663,1156,614"/>
<area shape="poly" title=" " alt="" coords="1239,769,1305,810,1303,814,1236,773"/>
<area shape="rect" href="pybind_8cpp.html" title=" " alt="" coords="1152,812,1245,837"/>
<area shape="poly" title=" " alt="" coords="1207,778,1203,812,1198,812,1202,777"/>
<area shape="poly" title=" " alt="" coords="1217,705,1212,739,1207,738,1211,704"/>
<area shape="poly" title=" " alt="" coords="716,327,803,370,931,443,1011,493,1093,542,1192,589,1190,594,1091,546,1009,498,928,448,800,374,714,332"/>
<area shape="poly" title=" " alt="" coords="592,324,458,344,398,358,357,374,331,391,311,408,299,428,295,457,295,532,298,548,307,563,323,576,343,589,397,611,463,629,608,655,734,669,734,675,607,661,461,635,395,616,341,593,320,580,303,566,293,550,289,533,289,456,294,426,307,404,327,387,355,370,397,353,457,339,591,319"/>
<area shape="rect" href="inverse-compton_8cpp.html" title=" " alt="" coords="671,519,830,544"/>
<area shape="poly" title=" " alt="" coords="731,327,760,345,784,371,788,385,784,399,775,410,766,417,745,424,725,430,716,437,709,446,706,465,712,484,725,502,739,517,735,520,721,505,708,487,700,466,704,444,713,433,722,426,743,419,763,412,772,406,779,396,783,385,779,373,757,349,728,332"/>
<area shape="rect" href="power-law-syn_8cpp.html" title=" " alt="" coords="349,445,494,471"/>
<area shape="poly" title=" " alt="" coords="591,320,526,326,460,337,404,353,384,362,370,374,366,382,365,391,373,410,389,428,406,443,403,447,385,432,368,413,360,392,360,381,366,370,381,358,402,348,459,332,526,321,591,315"/>
<area shape="rect" href="power-law-syn_8h.html" title=" " alt="" coords="380,372,511,397"/>
<area shape="poly" title=" " alt="" coords="628,330,484,374,482,369,626,325"/>
<area shape="poly" title=" " alt="" coords="627,332,598,349,576,373,570,391,570,410,580,444,575,446,565,411,565,390,571,371,594,345,624,327"/>
<area shape="rect" href="smooth-power-law-syn_8h.html" title=" " alt="" coords="585,372,769,397"/>
<area shape="poly" title=" " alt="" coords="680,338,680,372,675,372,675,338"/>
<area shape="poly" title=" " alt="" coords="440,411,428,446,423,444,435,409"/>
<area shape="poly" title=" " alt="" coords="481,401,561,443,559,447,478,406"/>
<area shape="poly" title=" " alt="" coords="514,475,225,528,224,523,513,469"/>
<area shape="poly" title=" " alt="" coords="599,481,625,514,642,529,661,542,703,557,761,569,904,587,1053,596,1170,600,1170,605,1053,601,904,592,760,574,702,562,659,546,639,533,621,517,595,484"/>
<area shape="poly" title=" " alt="" coords="593,482,605,512,623,542,661,582,703,616,777,663,774,667,700,620,657,586,619,546,600,515,588,485"/>
<area shape="poly" title=" " alt="" coords="623,474,724,516,722,521,621,478"/>
<area shape="poly" title=" " alt="" coords="653,408,600,447,597,443,650,403"/>
<area shape="rect" href="smooth-power-law-syn_8cpp.html" title=" " alt="" coords="718,445,917,471"/>
<area shape="poly" title=" " alt="" coords="713,401,796,443,793,447,711,406"/>
<area shape="poly" title=" " alt="" coords="1854,335,1865,365,1866,382,1863,398,1838,451,1811,489,1775,518,1724,546,1685,560,1633,572,1505,589,1372,599,1265,605,1265,599,1371,594,1505,584,1632,567,1684,555,1722,542,1772,514,1807,485,1834,448,1857,396,1861,382,1859,366,1849,337"/>
<area shape="rect" href="observer_8cpp.html" title=" " alt="" coords="1742,372,1847,397"/>
<area shape="poly" title=" " alt="" coords="1826,337,1804,373,1799,371,1821,334"/>
<area shape="poly" title=" " alt="" coords="97,474,179,516,176,521,94,479"/>
<area shape="poly" title=" " alt="" coords="82,479,118,513,140,529,165,541,227,554,334,565,630,583,944,594,1170,600,1170,605,944,599,630,588,334,571,226,560,163,547,138,534,114,517,78,483"/>
<area shape="rect" href="prompt_8cpp.html" title=" " alt="" coords="5,519,101,544"/>
<area shape="poly" title=" " alt="" coords="61,485,57,519,52,518,56,484"/>
<area shape="poly" title=" " alt="" coords="648,261,672,297,668,300,644,264"/>
<area shape="poly" title=" " alt="" coords="1234,242,1028,246,889,252,742,263,595,279,462,303,403,317,351,334,308,353,275,374,245,409,224,450,211,489,204,519,199,518,206,488,219,448,240,406,272,370,306,348,349,329,401,312,460,297,595,274,741,258,889,247,1028,240,1234,237"/>
<area shape="poly" title=" " alt="" coords="1235,248,750,304,749,299,1234,242"/>
<area shape="poly" title=" " alt="" coords="1236,257,782,400,622,448,621,443,781,395,1234,252"/>
<area shape="poly" title=" " alt="" coords="1334,243,1792,302,1791,307,1333,248"/>
<area shape="rect" href="forward-shock_8hpp.html" title=" " alt="" coords="1310,372,1453,397"/>
<area shape="poly" title=" " alt="" coords="1291,264,1299,293,1313,323,1337,350,1364,370,1361,374,1334,354,1308,325,1294,295,1285,265"/>
<area shape="rect" href="shock-physics_8h.html" title=" " alt="" coords="1322,299,1449,324"/>
<area shape="poly" title=" " alt="" coords="1313,256,1370,296,1367,301,1310,261"/>
<area shape="rect" href="shock_8cpp.html" title=" " alt="" coords="1529,372,1615,397"/>
<area shape="poly" title=" " alt="" coords="1334,249,1397,268,1463,296,1520,334,1562,370,1558,374,1517,339,1460,301,1395,273,1333,254"/>
<area shape="rect" href="simple-shock_8hpp.html" title=" " alt="" coords="1149,372,1286,397"/>
<area shape="poly" title=" " alt="" coords="1275,265,1225,373,1220,371,1270,262"/>
<area shape="poly" title=" " alt="" coords="1366,410,1228,593,1224,590,1362,407"/>
<area shape="poly" title=" " alt="" coords="1387,338,1385,372,1379,372,1381,338"/>
<area shape="rect" href="reverse-shock_8hpp.html" title=" " alt="" coords="1419,519,1562,544"/>
<area shape="poly" title=" " alt="" coords="1423,329,1447,347,1468,371,1485,410,1493,452,1494,518,1489,518,1487,453,1479,412,1463,373,1444,351,1420,333"/>
<area shape="poly" title=" " alt="" coords="1429,326,1542,369,1541,374,1427,331"/>
<area shape="poly" title=" " alt="" coords="1347,332,1246,374,1244,369,1345,327"/>
<area shape="poly" title=" " alt="" coords="1434,550,1262,594,1261,589,1433,545"/>
<area shape="poly" title=" " alt="" coords="1220,412,1220,592,1215,592,1215,412"/>
<area shape="poly" title=" " alt="" coords="1075,111,1094,129,1109,151,1124,186,1131,216,1133,272,1131,328,1133,360,1140,397,1158,455,1179,511,1214,591,1209,593,1174,513,1152,457,1135,398,1128,361,1125,328,1128,272,1126,217,1118,187,1104,153,1090,132,1071,115"/>
<area shape="poly" title=" " alt="" coords="1013,113,989,131,970,153,949,196,940,235,938,271,941,306,947,381,944,424,932,472,904,533,869,589,810,667,805,664,865,586,899,530,927,470,939,423,942,381,936,307,933,271,935,234,944,194,966,151,986,127,1010,109"/>
<area shape="poly" title=" " alt="" coords="991,100,915,118,876,133,840,154,818,177,807,200,797,226,777,253,740,281,704,301,701,296,737,276,773,249,792,223,803,198,814,174,837,150,874,128,914,112,990,95"/>
<area shape="poly" title=" " alt="" coords="1020,115,1001,132,986,153,969,198,963,240,965,280,969,318,973,355,971,393,958,432,931,472,910,492,885,507,831,525,830,519,883,502,907,488,927,469,953,430,965,392,967,356,964,318,959,280,958,240,964,197,982,151,997,129,1016,111"/>
<area shape="poly" title=" " alt="" coords="1002,112,970,130,942,154,914,191,890,233,854,319,832,395,822,446,817,445,827,394,849,317,885,230,909,188,938,150,967,125,999,107"/>
<area shape="poly" title=" " alt="" coords="1101,91,1266,96,1477,107,1668,124,1736,136,1775,150,1792,166,1806,185,1825,227,1835,267,1839,298,1834,299,1830,268,1820,228,1801,187,1788,169,1772,154,1735,141,1668,129,1477,112,1266,102,1101,97"/>
<area shape="poly" title=" " alt="" coords="1101,94,1245,109,1429,134,1521,152,1605,172,1675,196,1724,223,1745,250,1764,292,1793,371,1788,373,1760,295,1740,253,1721,227,1673,201,1604,177,1520,157,1428,140,1244,114,1100,100"/>
<area shape="rect" href="jet_8h.html" title=" " alt="" coords="1169,152,1220,177"/>
<area shape="poly" title=" " alt="" coords="1083,107,1171,149,1169,154,1080,112"/>
<area shape="rect" href="medium_8h.html" title=" " alt="" coords="1244,152,1332,177"/>
<area shape="poly" title=" " alt="" coords="1098,105,1249,149,1248,154,1096,110"/>
<area shape="rect" href="utilities_8cpp.html" title=" " alt="" coords="996,152,1095,177"/>
<area shape="poly" title=" " alt="" coords="1048,118,1048,152,1043,152,1043,118"/>
<area shape="poly" title=" " alt="" coords="1234,175,1655,308,1656,460,1650,492,1633,514,1607,530,1576,546,1517,566,1432,582,1265,602,1265,597,1431,577,1515,561,1574,542,1605,525,1629,510,1645,490,1651,459,1651,312,1233,180"/>
<area shape="poly" title=" " alt="" coords="1221,184,1271,223,1268,227,1218,188"/>
<area shape="poly" title=" " alt="" coords="1346,171,1450,189,1568,217,1622,236,1665,257,1695,282,1704,295,1707,310,1707,459,1705,478,1699,494,1679,515,1651,531,1616,546,1587,557,1548,567,1452,583,1265,602,1265,597,1451,578,1547,562,1585,552,1614,542,1648,526,1676,511,1695,491,1700,477,1701,459,1701,310,1699,297,1691,285,1663,262,1620,241,1567,223,1449,194,1345,176"/>
<area shape="poly" title=" " alt="" coords="1289,191,1287,225,1282,225,1284,191"/>
</map>
</div>
</div>
<p><a href="mesh_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoord.html">Coord</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a coordinate system with arrays for phi, theta, and t.  <a href="classCoord.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afd05120c4d579ec7fa4906f677781a83" id="r_afd05120c4d579ec7fa4906f677781a83"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 1 &gt;</td></tr>
<tr class="memdesc:afd05120c4d579ec7fa4906f677781a83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 1D arrays (e.g., time points)  <br /></td></tr>
<tr class="separator:afd05120c4d579ec7fa4906f677781a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ec6be5d638ad03ae6697ff2b71ef91" id="r_ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 2 &gt;</td></tr>
<tr class="memdesc:ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 2D grids (e.g., spatial coordinates)  <br /></td></tr>
<tr class="separator:ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b76cc05bedc7fd9499c0bd3eec3bcb5" id="r_a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 3 &gt;</td></tr>
<tr class="memdesc:a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D grids (e.g., full spatial-temporal data)  <br /></td></tr>
<tr class="separator:a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb738e18bf395ef0903c8c5d6f37c47f" id="r_afb738e18bf395ef0903c8c5d6f37c47f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">int</a>, 3 &gt;</td></tr>
<tr class="memdesc:afb738e18bf395ef0903c8c5d6f37c47f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D boolean grids for masking operations.  <br /></td></tr>
<tr class="separator:afb738e18bf395ef0903c8c5d6f37c47f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27e3f4efb19b3f2b0694e0bee5fb25ae" id="r_a27e3f4efb19b3f2b0694e0bee5fb25ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a27e3f4efb19b3f2b0694e0bee5fb25ae">IndexGrid</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>, 2 &gt;</td></tr>
<tr class="separator:a27e3f4efb19b3f2b0694e0bee5fb25ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa5d127d3ecb19584c7f27ee212d49605" id="r_aa5d127d3ecb19584c7f27ee212d49605"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aa5d127d3ecb19584c7f27ee212d49605">is_linear_scale</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>=<a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a>)</td></tr>
<tr class="memdesc:aa5d127d3ecb19584c7f27ee212d49605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if an array is linearly scaled within a given tolerance.  <br /></td></tr>
<tr class="separator:aa5d127d3ecb19584c7f27ee212d49605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e56adbbf18a0c9a5c04a8d4de268d9" id="r_ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ac0e56adbbf18a0c9a5c04a8d4de268d9">is_log_scale</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>=<a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a>)</td></tr>
<tr class="memdesc:ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if an array is logarithmically scaled within a given tolerance.  <br /></td></tr>
<tr class="separator:ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a885b165e8d9c9d20f27ec99329a0c3cb" id="r_a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </td></tr>
<tr class="memitem:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a885b165e8d9c9d20f27ec99329a0c3cb">boundary_to_center</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>)</td></tr>
<tr class="memdesc:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using linear interpolation.  <br /></td></tr>
<tr class="separator:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba66986baad5475a202c20a92bda036e" id="r_aba66986baad5475a202c20a92bda036e"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </td></tr>
<tr class="memitem:aba66986baad5475a202c20a92bda036e"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aba66986baad5475a202c20a92bda036e">boundary_to_center_log</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>)</td></tr>
<tr class="memdesc:aba66986baad5475a202c20a92bda036e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using geometric mean (logarithmic interpolation)  <br /></td></tr>
<tr class="separator:aba66986baad5475a202c20a92bda036e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1622b29b5488dbee3ef9068b9f8c7d4" id="r_ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae1622b29b5488dbee3ef9068b9f8c7d4">boundary_to_center</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>)</td></tr>
<tr class="memdesc:ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using linear interpolation.  <br /></td></tr>
<tr class="separator:ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac536f77c32691232cb5e7546595fb3d2" id="r_ac536f77c32691232cb5e7546595fb3d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ac536f77c32691232cb5e7546595fb3d2">boundary_to_center_log</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>)</td></tr>
<tr class="memdesc:ac536f77c32691232cb5e7546595fb3d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using geometric mean.  <br /></td></tr>
<tr class="separator:ac536f77c32691232cb5e7546595fb3d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96aa0a78a0de13a52955de3c2ce29ddd" id="r_a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classCoord.html">Coord</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd">auto_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;t_obs, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_cut</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_view, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> z, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi_resol=<a class="el" href="namespacedefaults_1_1grid.html#a81845ddcce8fb560efb401cdde437a16">defaults::grid::phi_resolution</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_resol=<a class="el" href="namespacedefaults_1_1grid.html#a372994c537be68d80989655f9b43c672">defaults::grid::theta_resolution</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_resol=<a class="el" href="namespacedefaults_1_1grid.html#aa203749fa338e32e6c7a711c82846582">defaults::grid::time_resolution</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>=<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">true</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi_view=0, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_theta_num</a>=<a class="el" href="namespacedefaults_1_1grid.html#a17f64e94f8f9cb660a1e9d80a2b1558c">defaults::grid::min_theta_points</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fwd_ratio</a>=<a class="el" href="namespacedefaults_1_1grid.html#ae654c737813ff06431141238b26e0a67">defaults::grid::forward_ratio</a>)</td></tr>
<tr class="memdesc:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a coordinate grid (<a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a>) for shock evolution.  <br /></td></tr>
<tr class="separator:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ba8f4400237a97c0d2fac934fb44cf" id="r_a28ba8f4400237a97c0d2fac934fb44cf"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a28ba8f4400237a97c0d2fac934fb44cf"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf">find_jet_edges</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_cut, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>)</td></tr>
<tr class="memdesc:a28ba8f4400237a97c0d2fac934fb44cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary.  <br /></td></tr>
<tr class="separator:a28ba8f4400237a97c0d2fac934fb44cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb4a7162e9b5a1e2ed39f7d9e94b53f" id="r_a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a7cb4a7162e9b5a1e2ed39f7d9e94b53f">jet_spreading_edge</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t0)</td></tr>
<tr class="memdesc:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the edge of the jet where the spreading is strongest.  <br /></td></tr>
<tr class="separator:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afadc5019976c36be16277dc4dc178a7f" id="r_afadc5019976c36be16277dc4dc178a7f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </td></tr>
<tr class="memitem:afadc5019976c36be16277dc4dc178a7f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afadc5019976c36be16277dc4dc178a7f">logspace_center</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>)</td></tr>
<tr class="separator:afadc5019976c36be16277dc4dc178a7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76f104cdad403ea346ff1a6603c78ad6" id="r_a76f104cdad403ea346ff1a6603c78ad6"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </td></tr>
<tr class="memitem:a76f104cdad403ea346ff1a6603c78ad6"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a76f104cdad403ea346ff1a6603c78ad6">log2space</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">grid_per_order</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">array</a>)</td></tr>
<tr class="separator:a76f104cdad403ea346ff1a6603c78ad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7703ab8b66bb86ed857746606fac9a2" id="r_ad7703ab8b66bb86ed857746606fac9a2"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </td></tr>
<tr class="memitem:ad7703ab8b66bb86ed857746606fac9a2"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ad7703ab8b66bb86ed857746606fac9a2">logspace_boundary_center</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bin_width</a>)</td></tr>
<tr class="separator:ad7703ab8b66bb86ed857746606fac9a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e78f3cf4aabf7985519d581ce43182" id="r_ae2e78f3cf4aabf7985519d581ce43182"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae2e78f3cf4aabf7985519d581ce43182">adaptive_grid_with_breaks</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">break_weights</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts_per_decade</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;grid, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_refined_breaks</a>=3, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius_decades</a>=0.5, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_factor</a>=3.0)</td></tr>
<tr class="memdesc:ae2e78f3cf4aabf7985519d581ce43182"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds an adaptive log-spaced grid with explicit break points.  <br /></td></tr>
<tr class="separator:ae2e78f3cf4aabf7985519d581ce43182"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49c59d8da915e118c4e550cc9bd4d3d9" id="r_a49c59d8da915e118c4e550cc9bd4d3d9"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &gt; </td></tr>
<tr class="memitem:a49c59d8da915e118c4e550cc9bd4d3d9"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &amp;&amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>)</td></tr>
<tr class="separator:a49c59d8da915e118c4e550cc9bd4d3d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc6828dd13a70c0c203dba03e765cea" id="r_a3dc6828dd13a70c0c203dba03e765cea"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a3dc6828dd13a70c0c203dba03e765cea"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>)</td></tr>
<tr class="separator:a3dc6828dd13a70c0c203dba03e765cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cba2da30fd9821858dc89b5caea3443" id="r_a9cba2da30fd9821858dc89b5caea3443"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443">edge_refinement_grid</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_resol)</td></tr>
<tr class="separator:a9cba2da30fd9821858dc89b5caea3443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83ae490737edde6ad03ede25e371a071" id="r_a83ae490737edde6ad03ede25e371a071"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a83ae490737edde6ad03ede25e371a071"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071">adaptive_phi_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>)</td></tr>
<tr class="separator:a83ae490737edde6ad03ede25e371a071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c066f2c8e6d102d7a56de8cb42cf5a8" id="r_a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </td></tr>
<tr class="memitem:a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>)</td></tr>
<tr class="separator:a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7505ad2e84c2a29610c1a13cd3b25e3" id="r_aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta)</td></tr>
<tr class="memdesc:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates deceleration time for a given angle from ejecta and medium properties.  <br /></td></tr>
<tr class="separator:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2b9eccaf75f7a9fe6bafd8696049bd2" id="r_ab2b9eccaf75f7a9fe6bafd8696049bd2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2">refined_time_grid</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_resol, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a>=0.3, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a>=10.0)</td></tr>
<tr class="memdesc:ab2b9eccaf75f7a9fe6bafd8696049bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a refined logarithmic time grid with higher density around a specified time.  <br /></td></tr>
<tr class="separator:ab2b9eccaf75f7a9fe6bafd8696049bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="afd05120c4d579ec7fa4906f677781a83" name="afd05120c4d579ec7fa4906f677781a83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd05120c4d579ec7fa4906f677781a83">&#9670;&#160;</a></span>Array</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 1&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 1D arrays (e.g., time points) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00039">39</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="a27e3f4efb19b3f2b0694e0bee5fb25ae" name="a27e3f4efb19b3f2b0694e0bee5fb25ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27e3f4efb19b3f2b0694e0bee5fb25ae">&#9670;&#160;</a></span>IndexGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#a27e3f4efb19b3f2b0694e0bee5fb25ae">IndexGrid</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>, 2&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00047">47</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="afb738e18bf395ef0903c8c5d6f37c47f" name="afb738e18bf395ef0903c8c5d6f37c47f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb738e18bf395ef0903c8c5d6f37c47f">&#9670;&#160;</a></span>MaskGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">int</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D boolean grids for masking operations. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00045">45</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="ae7ec6be5d638ad03ae6697ff2b71ef91" name="ae7ec6be5d638ad03ae6697ff2b71ef91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ec6be5d638ad03ae6697ff2b71ef91">&#9670;&#160;</a></span>MeshGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 2&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 2D grids (e.g., spatial coordinates) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00041">41</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="a6b76cc05bedc7fd9499c0bd3eec3bcb5" name="a6b76cc05bedc7fd9499c0bd3eec3bcb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b76cc05bedc7fd9499c0bd3eec3bcb5">&#9670;&#160;</a></span>MeshGrid3d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D grids (e.g., full spatial-temporal data) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00043">43</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae2e78f3cf4aabf7985519d581ce43182" name="ae2e78f3cf4aabf7985519d581ce43182"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e78f3cf4aabf7985519d581ce43182">&#9670;&#160;</a></span>adaptive_grid_with_breaks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> adaptive_grid_with_breaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td>
          <td class="paramname"><em>breaks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td>
          <td class="paramname"><em>break_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>pts_per_decade</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>max_refined_breaks</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_radius_decades</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_factor</em> = <code>3.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Builds an adaptive log-spaced grid with explicit break points. </p>
<p>Places grid points at endpoints and break frequencies, then fills segments between with approximately <code>pts_per_decade</code> log-spaced points. Nearby points are merged automatically based on the local step size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lg2_min</td><td>Log2 of minimum grid value </td></tr>
    <tr><td class="paramname">lg2_max</td><td>Log2 of maximum grid value </td></tr>
    <tr><td class="paramname">breaks</td><td>Break frequencies (linear scale) to include </td></tr>
    <tr><td class="paramname">break_weights</td><td>Importance weights for each break (top values get refined regions) </td></tr>
    <tr><td class="paramname">pts_per_decade</td><td>Base density of fill points per decade </td></tr>
    <tr><td class="paramname">grid</td><td>Output array of grid point values (resized internally) </td></tr>
    <tr><td class="paramname">max_refined_breaks</td><td>Maximum number of breaks to refine (sorted by weight) </td></tr>
    <tr><td class="paramname">refine_radius_decades</td><td>Half-width of the refined region around each break (in decades) </td></tr>
    <tr><td class="paramname">refine_factor</td><td>Grid density multiplier inside refined regions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of grid points </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00292">292</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  295</span>                                                                  {</div>
<div class="line"><span class="lineno">  296</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a> = 256;</div>
<div class="line"><span class="lineno">  297</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_per_decade</a> = 3.321928094887362; <span class="comment">// log2(10)</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius_decades</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_per_decade</a>;</div>
<div class="line"><span class="lineno">  299</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_per_decade</a> / std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts_per_decade</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>(1e-6));</div>
<div class="line"><span class="lineno">  300</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fine_step</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_factor</a>;</div>
<div class="line"><span class="lineno">  301</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merge_eps</a> = 0.5 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fine_step</a>;</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    <span class="comment">// Collect valid breaks within range with weights</span></div>
<div class="line"><span class="lineno">  304</span>    <span class="keyword">struct </span><a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Break</a> {</div>
<div class="line"><span class="lineno">  305</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a>;</div>
<div class="line"><span class="lineno">  306</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weight</a>;</div>
<div class="line"><span class="lineno">  307</span>    };</div>
<div class="line"><span class="lineno">  308</span>    std::vector&lt;Break&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>;</div>
<div class="line"><span class="lineno">  309</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>.size());</div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  311</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>];</div>
<div class="line"><span class="lineno">  312</span>        <span class="keywordflow">if</span> (!(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> &gt; 0) || !std::isfinite(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>)) {</div>
<div class="line"><span class="lineno">  313</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  314</span>        }</div>
<div class="line"><span class="lineno">  315</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a> = std::log2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>);</div>
<div class="line"><span class="lineno">  316</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a> &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a> &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>) {</div>
<div class="line"><span class="lineno">  317</span>            <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a> = 1;</div>
<div class="line"><span class="lineno">  318</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">break_weights</a>.size()) {</div>
<div class="line"><span class="lineno">  319</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">break_weights</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>];</div>
<div class="line"><span class="lineno">  320</span>                <span class="keywordflow">if</span> (std::isfinite(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a>) &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a> &gt;= 0) {</div>
<div class="line"><span class="lineno">  321</span>                    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a>;</div>
<div class="line"><span class="lineno">  322</span>                }</div>
<div class="line"><span class="lineno">  323</span>            }</div>
<div class="line"><span class="lineno">  324</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a>});</div>
<div class="line"><span class="lineno">  325</span>        }</div>
<div class="line"><span class="lineno">  326</span>    }</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    <span class="comment">// Sort by weight descending; top N get refinement</span></div>
<div class="line"><span class="lineno">  329</span>    std::ranges::sort(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>, [](<span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>, <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) { <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>.weight &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>.weight; });</div>
<div class="line"><span class="lineno">  330</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_refine</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_refined_breaks</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>.size());</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>    <span class="comment">// Build grid points with break tracking for merge protection</span></div>
<div class="line"><span class="lineno">  333</span>    <span class="keyword">struct </span><a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Pt</a> {</div>
<div class="line"><span class="lineno">  334</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a>;</div>
<div class="line"><span class="lineno">  335</span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_break</a>;</div>
<div class="line"><span class="lineno">  336</span>    };</div>
<div class="line"><span class="lineno">  337</span>    std::vector&lt;Pt&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>;</div>
<div class="line"><span class="lineno">  338</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a> * 2);</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>    <span class="comment">// Coarse uniform grid</span></div>
<div class="line"><span class="lineno">  341</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>(0));</div>
<div class="line"><span class="lineno">  342</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_coarse</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> &gt; 0 &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a> &gt; 0)</div>
<div class="line"><span class="lineno">  343</span>                                ? std::max&lt;size_t&gt;(1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::ceil(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a>)))</div>
<div class="line"><span class="lineno">  344</span>                                : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>(1);</div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_coarse</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  346</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_coarse</a>), <span class="keyword">false</span>});</div>
<div class="line"><span class="lineno">  347</span>    }</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>    <span class="comment">// Break anchors</span></div>
<div class="line"><span class="lineno">  350</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">br</a> : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>) {</div>
<div class="line"><span class="lineno">  351</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">br</a>.lg2, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  352</span>    }</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="comment">// Refinement around top-weighted breaks</span></div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_refine</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  356</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>].<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius</a>);</div>
<div class="line"><span class="lineno">  357</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>].<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius</a>);</div>
<div class="line"><span class="lineno">  358</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fine_step</a>));</div>
<div class="line"><span class="lineno">  359</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt;= n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) {</div>
<div class="line"><span class="lineno">  360</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(n), <span class="keyword">false</span>});</div>
<div class="line"><span class="lineno">  361</span>        }</div>
<div class="line"><span class="lineno">  362</span>    }</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>    <span class="comment">// Sort and merge close points, protecting break positions</span></div>
<div class="line"><span class="lineno">  365</span>    std::ranges::sort(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>, [](<span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>, <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) { <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>.lg2 &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>.lg2; });</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    std::vector&lt;Pt&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>;</div>
<div class="line"><span class="lineno">  368</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.size());</div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; p : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>) {</div>
<div class="line"><span class="lineno">  370</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.empty() &amp;&amp; p.lg2 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().lg2 &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merge_eps</a>) {</div>
<div class="line"><span class="lineno">  371</span>            <span class="keywordflow">if</span> (p.is_break &amp;&amp; !<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().is_break) {</div>
<div class="line"><span class="lineno">  372</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back() = p;</div>
<div class="line"><span class="lineno">  373</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  374</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().is_break = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().is_break || p.is_break;</div>
<div class="line"><span class="lineno">  375</span>            }</div>
<div class="line"><span class="lineno">  376</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  377</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back(p);</div>
<div class="line"><span class="lineno">  378</span>        }</div>
<div class="line"><span class="lineno">  379</span>    }</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    <span class="comment">// Ensure endpoints</span></div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.empty()) {</div>
<div class="line"><span class="lineno">  383</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  384</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  385</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  386</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.front().lg2 = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>;</div>
<div class="line"><span class="lineno">  387</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size() == 1) {</div>
<div class="line"><span class="lineno">  388</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  389</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  390</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().lg2 = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>;</div>
<div class="line"><span class="lineno">  391</span>        }</div>
<div class="line"><span class="lineno">  392</span>    }</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>    <span class="comment">// Hard cap with uniform subsampling</span></div>
<div class="line"><span class="lineno">  395</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size() &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a>) {</div>
<div class="line"><span class="lineno">  396</span>        std::vector&lt;Pt&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>;</div>
<div class="line"><span class="lineno">  397</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a>);</div>
<div class="line"><span class="lineno">  398</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  399</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size() - 1) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a> - 1)]);</div>
<div class="line"><span class="lineno">  400</span>        }</div>
<div class="line"><span class="lineno">  401</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.swap(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>);</div>
<div class="line"><span class="lineno">  402</span>    }</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    grid = Array::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size()});</div>
<div class="line"><span class="lineno">  405</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  406</span>        grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>].<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a>);</div>
<div class="line"><span class="lineno">  407</span>    }</div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size();</div>
<div class="line"><span class="lineno">  409</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00023">macros.h:23</a></div></div>
<div class="ttc" id="apybind_8cpp_html_ad93eae6422741850877b46bd61f08c89"><div class="ttname"><a href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">make_native_binary</a></div><div class="ttdeci">BinaryFunc make_native_binary(uintptr_t addr, std::vector&lt; Real &gt; const &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="pybind_8cpp_source.html#l00027">pybind.cpp:27</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph.png" border="0" usemap="#amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph" alt=""/></div>
<map name="amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph" id="amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph">
<area shape="rect" title="Builds an adaptive log&#45;spaced grid with explicit break points." alt="" coords="5,5,152,45"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="200,13,355,38"/>
<area shape="poly" title=" " alt="" coords="152,23,186,23,186,28,152,28"/>
</map>
</div>

</div>
</div>
<a id="a83ae490737edde6ad03ede25e371a071" name="a83ae490737edde6ad03ede25e371a071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83ae490737edde6ad03ede25e371a071">&#9670;&#160;</a></span>adaptive_phi_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> adaptive_phi_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>phi_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00579">579</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  579</span>                                                                                                               {</div>
<div class="line"><span class="lineno">  580</span>    <span class="keywordflow">if</span> ((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a> == 0 &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>) || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a> &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>) {</div>
<div class="line"><span class="lineno">  581</span>        <span class="keywordflow">return</span> xt::linspace(0., 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>);</div>
<div class="line"><span class="lineno">  582</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  583</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_tv</a> = std::cos(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>);</div>
<div class="line"><span class="lineno">  584</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sin_tv</a> = std::sin(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>);</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>        <span class="comment">// Sample a few theta values to find the peak Doppler weight at each phi</span></div>
<div class="line"><span class="lineno">  587</span>        <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta_sample</a> = 8;</div>
<div class="line"><span class="lineno">  588</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a> = [=, &amp;<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi) {</div>
<div class="line"><span class="lineno">  591</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_phi</a> = std::cos(phi);</div>
<div class="line"><span class="lineno">  592</span>            <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a> = 0;</div>
<div class="line"><span class="lineno">  593</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta_sample</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>) {</div>
<div class="line"><span class="lineno">  594</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta_sample</a> - 1);</div>
<div class="line"><span class="lineno">  595</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, theta);</div>
<div class="line"><span class="lineno">  596</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> = std::sqrt(std::fabs(Gamma * Gamma - 1)) / Gamma;</div>
<div class="line"><span class="lineno">  597</span>                <span class="comment">// cos(angle to LOS) = cos(theta)cos(theta_v) + sin(theta)sin(theta_v)cos(phi)</span></div>
<div class="line"><span class="lineno">  598</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_alpha</a> = std::cos(theta) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_tv</a> + std::sin(theta) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sin_tv</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_phi</a>;</div>
<div class="line"><span class="lineno">  599</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> = (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_alpha</a>);</div>
<div class="line"><span class="lineno">  600</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weight</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> * Gamma * std::sqrt((Gamma - 1) * Gamma) * std::sin(theta);</div>
<div class="line"><span class="lineno">  601</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weight</a>);</div>
<div class="line"><span class="lineno">  602</span>            }</div>
<div class="line"><span class="lineno">  603</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a>;</div>
<div class="line"><span class="lineno">  604</span>        };</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a>, 0, 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>);</div>
<div class="line"><span class="lineno">  607</span>    }</div>
<div class="line"><span class="lineno">  608</span>}</div>
<div class="ttc" id="amesh_8h_html_a49c59d8da915e118c4e550cc9bd4d3d9"><div class="ttname"><a href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a></div><div class="ttdeci">Array inverse_CFD_sampling(Func &amp;&amp;pdf, Real min, Real max, size_t num)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00499">mesh.h:499</a></div></div>
<div class="ttc" id="anamespacecon_html_aa0ccd904b754d0f907898a942516d121"><div class="ttname"><a href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a></div><div class="ttdeci">constexpr Real pi</div><div class="ttdoc">Pi.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00096">macros.h:96</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1grid_html_af2b7c5de15cb9c537f0de0e0e56148b1"><div class="ttname"><a href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a></div><div class="ttdeci">constexpr double theta_min</div><div class="ttdoc">Minimum polar angle (avoids singularity at theta=0)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00080">simulation-defaults.h:80</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph.png" border="0" usemap="#amesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph" alt=""/></div>
<map name="amesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph" id="amesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph">
<area shape="rect" title=" " alt="" coords="5,96,144,121"/>
<area shape="rect" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9" title=" " alt="" coords="192,46,363,72"/>
<area shape="poly" title=" " alt="" coords="127,93,211,73,212,78,128,98"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="509,46,664,72"/>
<area shape="poly" title=" " alt="" coords="144,114,211,118,291,120,376,117,461,106,506,93,548,76,550,81,508,98,462,111,377,122,291,125,211,124,144,119"/>
<area shape="poly" title=" " alt="" coords="299,44,330,28,371,14,416,4,462,6,509,20,551,38,548,43,507,25,461,11,416,10,372,19,333,33,302,49"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="411,21,461,46"/>
<area shape="poly" title=" " alt="" coords="357,44,397,37,398,43,358,49"/>
<area shape="rect" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1" title="Returns the value of a single parameter." alt="" coords="413,70,459,96"/>
<area shape="poly" title=" " alt="" coords="362,69,400,75,399,80,361,74"/>
<area shape="poly" title=" " alt="" coords="462,35,498,42,497,47,461,41"/>
<area shape="poly" title=" " alt="" coords="459,77,495,71,496,76,460,82"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph.png" border="0" usemap="#amesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph" alt=""/></div>
<map name="amesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph" id="amesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,913,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a3dc6828dd13a70c0c203dba03e765cea" name="a3dc6828dd13a70c0c203dba03e765cea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dc6828dd13a70c0c203dba03e765cea">&#9670;&#160;</a></span>adaptive_theta_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> adaptive_theta_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>theta_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00537">537</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  537</span>                                                                                                             {</div>
<div class="line"><span class="lineno">  538</span>    <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a> = [=, &amp;<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta) {</div>
<div class="line"><span class="lineno">  539</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, theta);</div>
<div class="line"><span class="lineno">  540</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> = std::sqrt(std::fabs(Gamma * Gamma - 1)) / Gamma;</div>
<div class="line"><span class="lineno">  541</span>        <span class="comment">// Real D = 1 / (Gamma * (1 - beta * std::cos(theta - theta_v)));</span></div>
<div class="line"><span class="lineno">  542</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> = (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * std::cos(theta - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>));</div>
<div class="line"><span class="lineno">  543</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> * Gamma * std::sqrt((Gamma - 1) * Gamma) * std::sin(theta);</div>
<div class="line"><span class="lineno">  544</span>        <span class="comment">// pdf = D * std::sin(theta);</span></div>
<div class="line"><span class="lineno">  545</span>    };</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a>, theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>);</div>
<div class="line"><span class="lineno">  548</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph.png" border="0" usemap="#amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph" alt=""/></div>
<map name="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph" id="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph">
<area shape="rect" title=" " alt="" coords="5,96,157,121"/>
<area shape="rect" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9" title=" " alt="" coords="205,46,376,72"/>
<area shape="poly" title=" " alt="" coords="135,93,222,72,224,78,137,98"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="523,46,677,72"/>
<area shape="poly" title=" " alt="" coords="158,114,225,119,305,120,390,117,474,106,520,93,561,76,563,81,522,98,475,111,391,122,305,126,225,124,157,119"/>
<area shape="poly" title=" " alt="" coords="312,44,344,28,384,14,429,4,475,6,522,20,564,38,562,43,520,25,474,11,430,10,385,19,346,33,315,49"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="424,21,475,46"/>
<area shape="poly" title=" " alt="" coords="370,44,410,37,411,43,371,49"/>
<area shape="rect" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1" title="Returns the value of a single parameter." alt="" coords="426,70,473,96"/>
<area shape="poly" title=" " alt="" coords="375,69,413,75,412,80,374,74"/>
<area shape="poly" title=" " alt="" coords="476,35,511,42,511,47,475,41"/>
<area shape="poly" title=" " alt="" coords="473,77,509,71,510,76,474,82"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph.png" border="0" usemap="#amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph" alt=""/></div>
<map name="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph" id="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,927,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a96aa0a78a0de13a52955de3c2ce29ddd" name="a96aa0a78a0de13a52955de3c2ce29ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96aa0a78a0de13a52955de3c2ce29ddd">&#9670;&#160;</a></span>auto_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCoord.html">Coord</a> auto_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_view</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a81845ddcce8fb560efb401cdde437a16">defaults::grid::phi_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a372994c537be68d80989655f9b43c672">defaults::grid::theta_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#aa203749fa338e32e6c7a711c82846582">defaults::grid::time_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em> = <code><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">true</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi_view</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>min_theta_num</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a17f64e94f8f9cb660a1e9d80a2b1558c">defaults::grid::min_theta_points</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>fwd_ratio</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#ae654c737813ff06431141238b26e0a67">defaults::grid::forward_ratio</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a coordinate grid (<a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a>) for shock evolution. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">theta_cut</td><td>Maximum theta value to include </td></tr>
    <tr><td class="paramname">theta_view</td><td>Viewing angle </td></tr>
    <tr><td class="paramname">z</td><td>Redshift </td></tr>
    <tr><td class="paramname">phi_resol</td><td></td></tr>
    <tr><td class="paramname">theta_resol</td><td></td></tr>
    <tr><td class="paramname">t_resol</td><td></td></tr>
    <tr><td class="paramname">is_axisymmetric</td><td>Whether the jet is axisymmetric (default: true) </td></tr>
    <tr><td class="paramname">phi_view</td><td>Viewing angle (default: 0) </td></tr>
    <tr><td class="paramname">min_theta_num</td><td>Minimum number of theta grid points (default: 56) </td></tr>
    <tr><td class="paramname">fwd_ratio</td><td>Forward ratio for grid resolution (default: 0.3) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a> object with the constructed grid</dd></dl>
<p>The grid is based on the observation times (t_obs), maximum theta value (theta_cut), and specified numbers of grid points in phi, theta, and t. The radial grid is logarithmically spaced between t_min and t_max, and the theta grid is generated linearly. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00756">756</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  758</span>                                                      {</div>
<div class="line"><span class="lineno">  759</span>    <a class="code hl_class" href="classCoord.html">Coord</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>;</div>
<div class="line"><span class="lineno">  760</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.<a class="code hl_variable" href="classCoord.html#aeb5bef37e495fdeefad735154e99bf73">theta_view</a> = theta_view;</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a> = <a class="code hl_function" href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf">find_jet_edges</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="code hl_variable" href="namespacecon.html#a9c6b1c9b349c790392fa370c8d9e13a8">con::Gamma_cut</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>);</div>
<div class="line"><span class="lineno">  763</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edge</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>.empty() ? <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_cut</a> : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>.back(); <span class="comment">// outermost edge (fallback if no edges)</span></div>
<div class="line"><span class="lineno">  764</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  765</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edge</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_cut</a>);</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_theta_num</a> + <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) * 180 / <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> * theta_resol);</div>
<div class="line"><span class="lineno">  768</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta_num</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fwd_ratio</a>);</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta_num</a>;</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta</a> = xt::linspace(theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta_num</a>);</div>
<div class="line"><span class="lineno">  772</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta</a> = <a class="code hl_function" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta_num</a>, theta_view);</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>;</div>
<div class="line"><span class="lineno">  775</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge_theta</a> = <a class="code hl_function" href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443">edge_refinement_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>, theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a>, theta_resol);</div>
<div class="line"><span class="lineno">  776</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta = <a class="code hl_function" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a>(<a class="code hl_function" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge_theta</a>);</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>    <span class="comment">// coord.theta = uniform_theta;</span></div>
<div class="line"><span class="lineno">  779</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a> = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(360 * phi_resol), 1);</div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi = <a class="code hl_function" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071">adaptive_phi_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>, theta_view, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>);</div>
<div class="line"><span class="lineno">  782</span> </div>
<div class="line"><span class="lineno">  783</span>    <span class="keywordflow">if</span> (t_obs.size() == 0) {</div>
<div class="line"><span class="lineno">  784</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">assert</a>(<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;auto_grid: t_obs is empty&quot;</span>);</div>
<div class="line"><span class="lineno">  785</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>;</div>
<div class="line"><span class="lineno">  786</span>    }</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a> = *std::ranges::max_element(t_obs);</div>
<div class="line"><span class="lineno">  789</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a> = *std::ranges::min_element(t_obs);</div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>    <span class="comment">// Compute base time grid size + extra points for refinement around t_dec</span></div>
<div class="line"><span class="lineno">  792</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">base_t_num</a> = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a>) * t_resol), 24);</div>
<div class="line"><span class="lineno">  793</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_ratio</a> = 2.0;</div>
<div class="line"><span class="lineno">  794</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a> = 0.3;</div>
<div class="line"><span class="lineno">  795</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> = 10.0;</div>
<div class="line"><span class="lineno">  796</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_extra</a> =</div>
<div class="line"><span class="lineno">  797</span>        <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_ratio</a> - 1.0) * t_resol * std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a>));</div>
<div class="line"><span class="lineno">  798</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">base_t_num</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_extra</a>;</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta.size();</div>
<div class="line"><span class="lineno">  801</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a> ? 1 : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi.size();</div>
<div class="line"><span class="lineno">  802</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v_max</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta.back() + theta_view;</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.t = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a>, theta_size, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>});</div>
<div class="line"><span class="lineno">  805</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  806</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; theta_size; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  807</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> = <a class="code hl_function" href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa">physics::relativistic::gamma_to_beta</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>)));</div>
<div class="line"><span class="lineno">  808</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a> =</div>
<div class="line"><span class="lineno">  809</span>                std::max&lt;Real&gt;(0.99 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a> * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) / (1 - std::cos(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v_max</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) / (1 + z), 1e-2 * <a class="code hl_variable" href="namespaceunit.html#a4e7c438655d3f34c7c30a155ec38f250">unit::sec</a>);</div>
<div class="line"><span class="lineno">  810</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a> = 1.01 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a> / (1 + z);</div>
<div class="line"><span class="lineno">  811</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_dec</a> = <a class="code hl_function" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, medium, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>));</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>            xt::view(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.t, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>, xt::all()) =</div>
<div class="line"><span class="lineno">  814</span>                <a class="code hl_function" href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2">refined_time_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_dec</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>, t_resol, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a>);</div>
<div class="line"><span class="lineno">  815</span>        }</div>
<div class="line"><span class="lineno">  816</span>    }</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>;</div>
<div class="line"><span class="lineno">  819</span>}</div>
<div class="ttc" id="aclassCoord_html"><div class="ttname"><a href="classCoord.html">Coord</a></div><div class="ttdoc">Represents a coordinate system with arrays for phi, theta, and t.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00058">mesh.h:58</a></div></div>
<div class="ttc" id="aclassCoord_html_aeb5bef37e495fdeefad735154e99bf73"><div class="ttname"><a href="classCoord.html#aeb5bef37e495fdeefad735154e99bf73">Coord::theta_view</a></div><div class="ttdeci">Real theta_view</div><div class="ttdoc">Viewing angle.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00066">mesh.h:66</a></div></div>
<div class="ttc" id="amesh_8h_html_a28ba8f4400237a97c0d2fac934fb44cf"><div class="ttname"><a href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf">find_jet_edges</a></div><div class="ttdeci">std::vector&lt; Real &gt; find_jet_edges(Ejecta const &amp;jet, Real gamma_cut, bool is_axisymmetric)</div><div class="ttdoc">Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00412">mesh.h:412</a></div></div>
<div class="ttc" id="amesh_8h_html_a3c066f2c8e6d102d7a56de8cb42cf5a8"><div class="ttname"><a href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a></div><div class="ttdeci">Array merge_grids(Arr const &amp;arr1, Arr const &amp;arr2)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00611">mesh.h:611</a></div></div>
<div class="ttc" id="amesh_8h_html_a3dc6828dd13a70c0c203dba03e765cea"><div class="ttname"><a href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a></div><div class="ttdeci">Array adaptive_theta_grid(Ejecta const &amp;jet, Real theta_min, Real theta_max, size_t theta_num, Real theta_v)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00537">mesh.h:537</a></div></div>
<div class="ttc" id="amesh_8h_html_a83ae490737edde6ad03ede25e371a071"><div class="ttname"><a href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071">adaptive_phi_grid</a></div><div class="ttdeci">Array adaptive_phi_grid(Ejecta const &amp;jet, size_t phi_num, Real theta_v, Real theta_max, bool is_axisymmetric)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00579">mesh.h:579</a></div></div>
<div class="ttc" id="amesh_8h_html_a9cba2da30fd9821858dc89b5caea3443"><div class="ttname"><a href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443">edge_refinement_grid</a></div><div class="ttdeci">Array edge_refinement_grid(std::vector&lt; Real &gt; const &amp;jet_edges, Real theta_min, Real theta_max, Real avg_spacing, Real theta_resol)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00550">mesh.h:550</a></div></div>
<div class="ttc" id="amesh_8h_html_aa7505ad2e84c2a29610c1a13cd3b25e3"><div class="ttname"><a href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a></div><div class="ttdeci">Real estimate_t_dec(Ejecta const &amp;jet, Medium const &amp;medium, Real phi, Real theta)</div><div class="ttdoc">Estimates deceleration time for a given angle from ejecta and medium properties.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00645">mesh.h:645</a></div></div>
<div class="ttc" id="amesh_8h_html_ab2b9eccaf75f7a9fe6bafd8696049bd2"><div class="ttname"><a href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2">refined_time_grid</a></div><div class="ttdeci">Array refined_time_grid(Real t_start, Real t_end, Real t_refine, size_t t_num, Real t_resol, Real refine_lo_factor=0.3, Real refine_hi_factor=10.0)</div><div class="ttdoc">Create a refined logarithmic time grid with higher density around a specified time.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00700">mesh.h:700</a></div></div>
<div class="ttc" id="amesh_8h_html_afd05120c4d579ec7fa4906f677781a83"><div class="ttname"><a href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a></div><div class="ttdeci">xt::xtensor&lt; Real, 1 &gt; Array</div><div class="ttdoc">Type alias for 1D arrays (e.g., time points)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00039">mesh.h:39</a></div></div>
<div class="ttc" id="anamespacecon_html_a9c6b1c9b349c790392fa370c8d9e13a8"><div class="ttname"><a href="namespacecon.html#a9c6b1c9b349c790392fa370c8d9e13a8">con::Gamma_cut</a></div><div class="ttdeci">constexpr Real Gamma_cut</div><div class="ttdoc">Cutoff Lorentz factor value.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00101">macros.h:101</a></div></div>
<div class="ttc" id="anamespacephysics_1_1relativistic_html_ab1c1444afa3c4afd0c57145f932962fa"><div class="ttname"><a href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa">physics::relativistic::gamma_to_beta</a></div><div class="ttdeci">Real gamma_to_beta(Real gamma)</div><div class="ttdoc">Converts Lorentz factor (gamma) to a velocity fraction (beta)</div><div class="ttdef"><b>Definition</b> <a href="physics_8h_source.html#l00036">physics.h:36</a></div></div>
<div class="ttc" id="anamespaceunit_html_a4e7c438655d3f34c7c30a155ec38f250"><div class="ttname"><a href="namespaceunit.html#a4e7c438655d3f34c7c30a155ec38f250">unit::sec</a></div><div class="ttdeci">constexpr Real sec</div><div class="ttdoc">Second in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00045">macros.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph.png" border="0" usemap="#amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph" alt=""/></div>
<map name="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph" id="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph">
<area shape="rect" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="5,348,88,374"/>
<area shape="rect" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071" title=" " alt="" coords="143,168,281,194"/>
<area shape="poly" title=" " alt="" coords="52,347,84,293,107,260,134,230,174,199,177,203,138,234,112,264,89,296,57,350"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="739,270,893,295"/>
<area shape="poly" title=" " alt="" coords="48,348,56,311,72,259,97,204,114,178,134,154,181,113,225,90,274,76,335,61,436,30,519,7,559,3,600,6,644,20,692,44,719,65,742,90,762,118,778,149,800,208,813,256,807,257,795,209,773,151,757,121,738,93,716,69,689,49,642,25,599,12,559,8,520,12,438,35,337,66,275,81,227,95,184,117,138,158,119,181,102,207,77,261,61,312,53,349"/>
<area shape="rect" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea" title=" " alt="" coords="136,244,288,270"/>
<area shape="poly" title=" " alt="" coords="60,346,93,318,135,288,164,273,166,277,137,293,96,322,63,350"/>
<area shape="rect" href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443" title=" " alt="" coords="339,295,503,320"/>
<area shape="poly" title=" " alt="" coords="86,346,135,333,233,319,326,310,326,315,234,324,137,338,87,351"/>
<area shape="rect" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="151,348,273,374"/>
<area shape="poly" title=" " alt="" coords="88,358,137,358,137,364,88,364"/>
<area shape="rect" href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa" title="Converts Lorentz factor (gamma) to a velocity fraction (beta)" alt="" coords="347,396,495,436"/>
<area shape="poly" title=" " alt="" coords="89,371,137,382,239,398,334,407,333,413,238,403,135,388,88,376"/>
<area shape="rect" href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="565,452,681,478"/>
<area shape="poly" title=" " alt="" coords="67,372,99,391,137,409,191,426,247,440,360,457,465,464,551,465,551,470,465,469,360,462,246,445,190,432,135,414,96,396,65,376"/>
<area shape="rect" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8" title=" " alt="" coords="370,511,473,536"/>
<area shape="poly" title=" " alt="" coords="55,373,66,399,83,431,107,463,137,489,191,513,249,525,306,530,356,528,356,534,305,535,248,531,189,518,135,494,103,467,78,434,61,401,50,375"/>
<area shape="rect" href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="555,558,691,583"/>
<area shape="poly" title=" " alt="" coords="53,373,61,407,76,452,101,497,118,517,137,534,187,560,240,579,296,590,353,596,408,597,461,594,550,583,551,588,461,600,408,602,353,601,296,596,239,584,185,565,135,538,114,521,97,500,71,454,55,409,47,375"/>
<area shape="rect" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9" title=" " alt="" coords="336,168,507,194"/>
<area shape="poly" title=" " alt="" coords="282,178,322,178,322,184,282,184"/>
<area shape="poly" title=" " alt="" coords="231,166,309,121,364,95,426,71,493,54,561,47,595,48,628,53,661,63,692,77,716,94,738,115,772,164,796,214,810,255,805,257,791,216,767,167,734,119,713,98,689,82,659,68,627,59,594,54,561,52,494,59,428,76,366,100,311,126,234,170"/>
<area shape="poly" title=" " alt="" coords="493,166,539,162,589,161,641,166,692,179,724,194,753,215,797,257,794,261,749,219,721,199,690,184,640,171,589,166,539,167,494,171"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="597,194,648,219"/>
<area shape="poly" title=" " alt="" coords="507,189,584,199,584,204,507,194"/>
<area shape="rect" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1" title="Returns the value of a single parameter." alt="" coords="599,92,646,118"/>
<area shape="poly" title=" " alt="" coords="455,166,586,116,588,121,457,171"/>
<area shape="poly" title=" " alt="" coords="649,214,771,262,769,267,647,218"/>
<area shape="poly" title=" " alt="" coords="647,111,670,121,692,135,726,165,756,198,801,257,797,260,752,201,722,168,689,139,667,126,645,115"/>
<area shape="poly" title=" " alt="" coords="247,242,372,196,373,201,249,247"/>
<area shape="poly" title=" " alt="" coords="288,258,691,274,725,276,725,281,691,280,288,263"/>
<area shape="poly" title=" " alt="" coords="503,300,724,286,725,291,504,305"/>
<area shape="poly" title=" " alt="" coords="273,353,506,329,690,302,734,295,735,300,691,308,507,334,274,358"/>
<area shape="poly" title=" " alt="" coords="262,371,335,390,333,396,261,376"/>
<area shape="poly" title=" " alt="" coords="496,412,590,402,641,391,690,375,719,360,746,341,790,303,794,307,749,345,721,364,692,380,642,396,591,407,496,418"/>
<area shape="poly" title=" " alt="" coords="655,450,689,430,722,399,752,366,797,305,802,308,757,369,726,403,692,434,657,455"/>
<area shape="poly" title=" " alt="" coords="473,527,522,528,578,524,636,512,664,501,689,487,712,469,733,447,766,398,790,348,805,307,810,309,795,350,771,401,737,450,716,473,692,491,666,506,638,517,579,530,522,534,473,532"/>
<area shape="poly" title=" " alt="" coords="657,555,689,534,712,507,733,477,766,414,790,355,805,308,810,309,795,356,771,417,737,480,716,510,692,538,660,560"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph.png" border="0" usemap="#amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph" alt=""/></div>
<map name="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph" id="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph">
<area shape="rect" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a885b165e8d9c9d20f27ec99329a0c3cb" name="a885b165e8d9c9d20f27ec99329a0c3cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a885b165e8d9c9d20f27ec99329a0c3cb">&#9670;&#160;</a></span>boundary_to_center() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> boundary_to_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using linear interpolation. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Arr1</td><td>Type of the input array </td></tr>
    <tr><td class="paramname">Arr2</td><td>Type of the output array </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
    <tr><td class="paramname">center</td><td>Output array of center values</td></tr>
  </table>
  </dd>
</dl>
<p>This is used to compute cell-centered values from cell-boundary values. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00206">206</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  206</span>                                                            {</div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2 || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size() + 1 != <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size()) {</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  209</span>    }</div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  211</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph.png" border="0" usemap="#amesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph" alt=""/></div>
<map name="amesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph" id="amesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph">
<area shape="rect" title="Converts boundary values to center values using linear interpolation." alt="" coords="5,5,156,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="204,5,359,31"/>
<area shape="poly" title=" " alt="" coords="156,15,191,15,191,21,156,21"/>
</map>
</div>

</div>
</div>
<a id="ae1622b29b5488dbee3ef9068b9f8c7d4" name="ae1622b29b5488dbee3ef9068b9f8c7d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1622b29b5488dbee3ef9068b9f8c7d4">&#9670;&#160;</a></span>boundary_to_center() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> boundary_to_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using linear interpolation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of center values </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00038">38</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>                                                {</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2) {</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">return</span> Array::from_shape({0});</div>
<div class="line"><span class="lineno">   41</span>    }</div>
<div class="line"><span class="lineno">   42</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() - 1}, 0);</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   44</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">   45</span>    }</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>;</div>
<div class="line"><span class="lineno">   47</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph.png" border="0" usemap="#amesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph" alt=""/></div>
<map name="amesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph" id="amesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph">
<area shape="rect" title="Converts boundary values to center values using linear interpolation." alt="" coords="5,5,156,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="204,5,359,31"/>
<area shape="poly" title=" " alt="" coords="156,15,191,15,191,21,156,21"/>
</map>
</div>

</div>
</div>
<a id="aba66986baad5475a202c20a92bda036e" name="aba66986baad5475a202c20a92bda036e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba66986baad5475a202c20a92bda036e">&#9670;&#160;</a></span>boundary_to_center_log() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> boundary_to_center_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using geometric mean (logarithmic interpolation) </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Arr1</td><td>Type of the input array </td></tr>
    <tr><td class="paramname">Arr2</td><td>Type of the output array </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
    <tr><td class="paramname">center</td><td>Output array of center values</td></tr>
  </table>
  </dd>
</dl>
<p>This is used when working with logarithmically scaled quantities. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00216">216</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  216</span>                                                                {</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2 || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size() + 1 != <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size()) {</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  219</span>    }</div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  221</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = std::sqrt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">  222</span>    }</div>
<div class="line"><span class="lineno">  223</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aba66986baad5475a202c20a92bda036e_cgraph.png" border="0" usemap="#amesh_8h_aba66986baad5475a202c20a92bda036e_cgraph" alt=""/></div>
<map name="amesh_8h_aba66986baad5475a202c20a92bda036e_cgraph" id="amesh_8h_aba66986baad5475a202c20a92bda036e_cgraph">
<area shape="rect" title="Converts boundary values to center values using geometric mean (logarithmic interpolation)" alt="" coords="5,5,184,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="232,5,387,31"/>
<area shape="poly" title=" " alt="" coords="184,15,218,15,218,21,184,21"/>
</map>
</div>

</div>
</div>
<a id="ac536f77c32691232cb5e7546595fb3d2" name="ac536f77c32691232cb5e7546595fb3d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac536f77c32691232cb5e7546595fb3d2">&#9670;&#160;</a></span>boundary_to_center_log() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> boundary_to_center_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using geometric mean. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of center values </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00049">49</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>                                                    {</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2) {</div>
<div class="line"><span class="lineno">   51</span>        <span class="keywordflow">return</span> Array::from_shape({0});</div>
<div class="line"><span class="lineno">   52</span>    }</div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() - 1}, 0);</div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   55</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = std::sqrt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">   56</span>    }</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>;</div>
<div class="line"><span class="lineno">   58</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph.png" border="0" usemap="#amesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph" alt=""/></div>
<map name="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph" id="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph">
<area shape="rect" title="Converts boundary values to center values using geometric mean." alt="" coords="5,5,184,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="232,5,387,31"/>
<area shape="poly" title=" " alt="" coords="184,15,218,15,218,21,184,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph.png" border="0" usemap="#amesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph" alt=""/></div>
<map name="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph" id="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph">
<area shape="rect" title="Converts boundary values to center values using geometric mean." alt="" coords="167,29,345,55"/>
<area shape="rect" href="classObserver.html#a2588a9ebaec5465d6b5bd08fadadcb99" title="Computes the integrated flux over a frequency band." alt="" coords="5,29,119,55"/>
<area shape="poly" title=" " alt="" coords="153,45,119,45,119,39,153,39"/>
<area shape="poly" title=" " alt="" coords="96,19,86,11,62,8,42,10,31,15,29,20,35,28,30,31,24,21,27,11,40,5,62,3,88,6,99,15"/>
</map>
</div>

</div>
</div>
<a id="a9cba2da30fd9821858dc89b5caea3443" name="a9cba2da30fd9821858dc89b5caea3443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cba2da30fd9821858dc89b5caea3443">&#9670;&#160;</a></span>edge_refinement_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> edge_refinement_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>avg_spacing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_resol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00550">550</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  551</span>                                                    {</div>
<div class="line"><span class="lineno">  552</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>;</div>
<div class="line"><span class="lineno">  553</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.reserve(150);</div>
<div class="line"><span class="lineno">  554</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>) {</div>
<div class="line"><span class="lineno">  555</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> &gt;= <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> / 2 - 0.01)</div>
<div class="line"><span class="lineno">  556</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  557</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">half</a> = 3 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a>;</div>
<div class="line"><span class="lineno">  558</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(10 * theta_resol), 2);</div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt;= n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  560</span>            <span class="comment">// Log-spaced offsets: denser near the edge</span></div>
<div class="line"><span class="lineno">  561</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">frac</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno">  562</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">offset</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">half</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">frac</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">frac</a>;</div>
<div class="line"><span class="lineno">  563</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">below</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">offset</a>;</div>
<div class="line"><span class="lineno">  564</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">above</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">offset</a>;</div>
<div class="line"><span class="lineno">  565</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">below</a> &gt;= theta_min)</div>
<div class="line"><span class="lineno">  566</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">below</a>);</div>
<div class="line"><span class="lineno">  567</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">above</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>)</div>
<div class="line"><span class="lineno">  568</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">above</a>);</div>
<div class="line"><span class="lineno">  569</span>        }</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> &gt;= theta_min &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>)</div>
<div class="line"><span class="lineno">  571</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a>);</div>
<div class="line"><span class="lineno">  572</span>    }</div>
<div class="line"><span class="lineno">  573</span>    std::ranges::sort(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>);</div>
<div class="line"><span class="lineno">  574</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.erase(std::ranges::unique(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>).<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">begin</a>(), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.end());</div>
<div class="line"><span class="lineno">  575</span>    <span class="keywordflow">return</span> xt::adapt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>, {<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.size()});</div>
<div class="line"><span class="lineno">  576</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph.png" border="0" usemap="#amesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph" alt=""/></div>
<map name="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph" id="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,169,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="217,5,372,31"/>
<area shape="poly" title=" " alt="" coords="170,15,203,15,203,21,170,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph.png" border="0" usemap="#amesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph" alt=""/></div>
<map name="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph" id="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,939,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="aa7505ad2e84c2a29610c1a13cd3b25e3" name="aa7505ad2e84c2a29610c1a13cd3b25e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7505ad2e84c2a29610c1a13cd3b25e3">&#9670;&#160;</a></span>estimate_t_dec()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> estimate_t_dec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimates deceleration time for a given angle from ejecta and medium properties. </p>
<p>Integrates swept mass outward until m_swept = m_jet/Gamma0(phi,theta). Returns lab-frame time. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00645">645</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  645</span>                                                                                   {</div>
<div class="line"><span class="lineno">  646</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, theta);</div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a> &lt;= 1) {</div>
<div class="line"><span class="lineno">  648</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecon.html#ad61313f4a5b7876e54ae46d02d4a04bd">con::inf</a>;</div>
<div class="line"><span class="lineno">  649</span>    }</div>
<div class="line"><span class="lineno">  650</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> = <a class="code hl_function" href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa">physics::relativistic::gamma_to_beta</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a>);</div>
<div class="line"><span class="lineno">  651</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> m_jet = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.eps_k(phi, theta) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a> * <a class="code hl_variable" href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a>);</div>
<div class="line"><span class="lineno">  652</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">target</a> = m_jet / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a>;</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">N</a> = 256;</div>
<div class="line"><span class="lineno">  655</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a> = std::log(1e-3);</div>
<div class="line"><span class="lineno">  656</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_max</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a> + 40 * std::log(10.0);</div>
<div class="line"><span class="lineno">  657</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">du</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">N</a>;</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> mass = 0;</div>
<div class="line"><span class="lineno">  660</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> = std::exp(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a>);</div>
<div class="line"><span class="lineno">  661</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> = medium.rho(phi, theta, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a>;</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">N</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  664</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a> = std::exp(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">du</a>);</div>
<div class="line"><span class="lineno">  665</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a> = medium.rho(phi, theta, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a>;</div>
<div class="line"><span class="lineno">  666</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dr</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a>;</div>
<div class="line"><span class="lineno">  667</span>        mass += 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dr</a>;</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">if</span> (mass &gt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">target</a>) {</div>
<div class="line"><span class="lineno">  670</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_dec</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">target</a> - (mass - 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dr</a>)) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>;</div>
<div class="line"><span class="lineno">  671</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_dec</a> * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a>);</div>
<div class="line"><span class="lineno">  672</span>        }</div>
<div class="line"><span class="lineno">  673</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>;</div>
<div class="line"><span class="lineno">  674</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a>;</div>
<div class="line"><span class="lineno">  675</span>    }</div>
<div class="line"><span class="lineno">  676</span>    <span class="keywordflow">return</span> std::exp(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_max</a>) * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a>);</div>
<div class="line"><span class="lineno">  677</span>}</div>
<div class="ttc" id="anamespacecon_html_a26ef2b83dd09c356e324bd243b498764"><div class="ttname"><a href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a></div><div class="ttdeci">constexpr Real c2</div><div class="ttdoc">Speed of light squared.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00087">macros.h:87</a></div></div>
<div class="ttc" id="anamespacecon_html_a2ff3edf57629ccb9a49d5bde7278a7c4"><div class="ttname"><a href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a></div><div class="ttdeci">constexpr Real c</div><div class="ttdoc">Speed of light (normalized to 1 in code units)</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00086">macros.h:86</a></div></div>
<div class="ttc" id="anamespacecon_html_ad61313f4a5b7876e54ae46d02d4a04bd"><div class="ttname"><a href="namespacecon.html#ad61313f4a5b7876e54ae46d02d4a04bd">con::inf</a></div><div class="ttdeci">constexpr Real inf</div><div class="ttdoc">Infinity value.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00103">macros.h:103</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph.png" border="0" usemap="#amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph" alt=""/></div>
<map name="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph" id="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph">
<area shape="rect" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="5,42,128,67"/>
<area shape="rect" href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa" title="Converts Lorentz factor (gamma) to a velocity fraction (beta)" alt="" coords="176,5,324,45"/>
<area shape="poly" title=" " alt="" coords="128,42,162,37,163,42,129,48"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="372,42,527,67"/>
<area shape="poly" title=" " alt="" coords="129,54,176,55,324,55,358,54,358,59,324,60,176,60,128,59"/>
<area shape="poly" title=" " alt="" coords="324,34,359,39,358,44,324,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph.png" border="0" usemap="#amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph" alt=""/></div>
<map name="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph" id="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph">
<area shape="rect" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="775,31,897,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a28ba8f4400237a97c0d2fac934fb44cf" name="a28ba8f4400237a97c0d2fac934fb44cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ba8f4400237a97c0d2fac934fb44cf">&#9670;&#160;</a></span>find_jet_edges()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; find_jet_edges </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">gamma_cut</td><td>Lorentz factor cutoff value </td></tr>
    <tr><td class="paramname">is_axisymmetric</td><td>Flag for axisymmetric jets </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Sorted vector of edge theta positions; last element is the outermost jet edge </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00412">412</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  412</span>                                                                                                         {</div>
<div class="line"><span class="lineno">  413</span>    <span class="comment">// Find all edges in the active jet region (Gamma0 &gt;= gamma_cut).</span></div>
<div class="line"><span class="lineno">  414</span>    <span class="comment">// Sharp edges: large fractional jumps (&gt; 50%) between adjacent scan points.</span></div>
<div class="line"><span class="lineno">  415</span>    <span class="comment">// Smooth jets: the outermost theta where Gamma0 crosses gamma_cut.</span></div>
<div class="line"><span class="lineno">  416</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a> = 512;</div>
<div class="line"><span class="lineno">  417</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eps</a> = <a class="code hl_variable" href="namespacedefaults_1_1solver.html#a29443c4987378f49066f9b406c391afc">defaults::solver::binary_search_eps</a>;</div>
<div class="line"><span class="lineno">  418</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  419</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> = <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> / 2;</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a>) &gt;= gamma_cut) {</div>
<div class="line"><span class="lineno">  422</span>        <span class="keywordflow">return</span> {<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a>};</div>
<div class="line"><span class="lineno">  423</span>    }</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>;</div>
<div class="line"><span class="lineno">  426</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.reserve(100);</div>
<div class="line"><span class="lineno">  427</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>;</div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>);</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  431</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a> - 1);</div>
<div class="line"><span class="lineno">  432</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a>);</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> &gt;= gamma_cut || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> &gt;= gamma_cut) {</div>
<div class="line"><span class="lineno">  435</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a> = std::abs(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a>);</div>
<div class="line"><span class="lineno">  436</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">scale</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> - 1, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> - 1);</div>
<div class="line"><span class="lineno">  437</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">scale</a> &gt; 0 &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a> &gt; 0.5 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">scale</a>) {</div>
<div class="line"><span class="lineno">  438</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_th</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a>;</div>
<div class="line"><span class="lineno">  439</span>                <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eps</a>) {</div>
<div class="line"><span class="lineno">  440</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a> = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a>);</div>
<div class="line"><span class="lineno">  441</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">G_mid</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a>);</div>
<div class="line"><span class="lineno">  442</span>                    <span class="keywordflow">if</span> (std::abs(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">G_mid</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a>) &lt; std::abs(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">G_mid</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a>)) {</div>
<div class="line"><span class="lineno">  443</span>                        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a>;</div>
<div class="line"><span class="lineno">  444</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  445</span>                        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a>;</div>
<div class="line"><span class="lineno">  446</span>                    }</div>
<div class="line"><span class="lineno">  447</span>                }</div>
<div class="line"><span class="lineno">  448</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a>);</div>
<div class="line"><span class="lineno">  449</span>            }</div>
<div class="line"><span class="lineno">  450</span>        }</div>
<div class="line"><span class="lineno">  451</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a>;</div>
<div class="line"><span class="lineno">  452</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a>;</div>
<div class="line"><span class="lineno">  453</span>    }</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <span class="comment">// Smooth jet: no sharp edges found  scan downward from pi/2 to find outermost Gamma0 &gt;= gamma_cut</span></div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.empty()) {</div>
<div class="line"><span class="lineno">  457</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a>;</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a>; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a> &gt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a> -= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>) {</div>
<div class="line"><span class="lineno">  459</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a>) &gt;= <a class="code hl_variable" href="namespacedefaults_1_1cutoffs.html#a6cda2def28c77f63dbee9eb169d9d87a">gamma_cut</a>) {</div>
<div class="line"><span class="lineno">  460</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a>);</div>
<div class="line"><span class="lineno">  461</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  462</span>            }</div>
<div class="line"><span class="lineno">  463</span>        }</div>
<div class="line"><span class="lineno">  464</span>    }</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>;</div>
<div class="line"><span class="lineno">  467</span>}</div>
<div class="ttc" id="anamespacedefaults_1_1cutoffs_html_a6cda2def28c77f63dbee9eb169d9d87a"><div class="ttname"><a href="namespacedefaults_1_1cutoffs.html#a6cda2def28c77f63dbee9eb169d9d87a">defaults::cutoffs::gamma_cut</a></div><div class="ttdeci">constexpr double gamma_cut</div><div class="ttdoc">Lorentz factor below which the flow is considered non-relativistic Used to terminate shock evolution ...</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00041">simulation-defaults.h:41</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1solver_html_a29443c4987378f49066f9b406c391afc"><div class="ttname"><a href="namespacedefaults_1_1solver.html#a29443c4987378f49066f9b406c391afc">defaults::solver::binary_search_eps</a></div><div class="ttdeci">constexpr double binary_search_eps</div><div class="ttdoc">Tolerance for binary search (jet edge finding)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00098">simulation-defaults.h:98</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph.png" border="0" usemap="#amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph" alt=""/></div>
<map name="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph" id="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph">
<area shape="rect" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="5,5,121,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="169,5,324,31"/>
<area shape="poly" title=" " alt="" coords="121,15,155,15,155,21,121,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph.png" border="0" usemap="#amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph" alt=""/></div>
<map name="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph" id="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph">
<area shape="rect" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="775,31,891,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a49c59d8da915e118c4e550cc9bd4d3d9" name="a49c59d8da915e118c4e550cc9bd4d3d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49c59d8da915e118c4e550cc9bd4d3d9">&#9670;&#160;</a></span>inverse_CFD_sampling()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> inverse_CFD_sampling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00499">499</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  499</span>                                                                       {</div>
<div class="line"><span class="lineno">  500</span>    <span class="keyword">using namespace </span>boost::numeric::odeint;</div>
<div class="line"><span class="lineno">  501</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> rtol = <a class="code hl_variable" href="namespacedefaults_1_1solver.html#a3469dc43cf2d60069d164931e7656d12">defaults::solver::ode_rtol</a>;</div>
<div class="line"><span class="lineno">  502</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a> = <a class="code hl_variable" href="namespacedefaults_1_1sampling.html#afb3d6cb58a2dc84e4f0a2ed64d7e1609">defaults::sampling::theta_samples</a>;</div>
<div class="line"><span class="lineno">  503</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a> = xt::linspace(<a class="code hl_function" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>);</div>
<div class="line"><span class="lineno">  504</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>});</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>    <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">make_dense_output</a>(rtol, rtol, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">runge_kutta_dopri5&lt;Real&gt;</a>());</div>
<div class="line"><span class="lineno">  507</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.initialize(0, <a class="code hl_function" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a>, (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a> - <a class="code hl_function" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a>) / 1e3);</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.current_time() &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a>;) {</div>
<div class="line"><span class="lineno">  510</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.do_step(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>);</div>
<div class="line"><span class="lineno">  511</span>        <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>.size() &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.current_time() &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)) {</div>
<div class="line"><span class="lineno">  512</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.calc_state(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>));</div>
<div class="line"><span class="lineno">  513</span>            ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>;</div>
<div class="line"><span class="lineno">  514</span>        }</div>
<div class="line"><span class="lineno">  515</span>    }</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_out</a> = xt::linspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>.front(), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>.back(), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>);</div>
<div class="line"><span class="lineno">  518</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>});</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) {</div>
<div class="line"><span class="lineno">  521</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  522</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>)) {</div>
<div class="line"><span class="lineno">  523</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> == 0) {</div>
<div class="line"><span class="lineno">  524</span>                    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>);</div>
<div class="line"><span class="lineno">  525</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  526</span>                    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> slope = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1)) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1));</div>
<div class="line"><span class="lineno">  527</span>                    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1) + slope * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1));</div>
<div class="line"><span class="lineno">  528</span>                }</div>
<div class="line"><span class="lineno">  529</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  530</span>            }</div>
<div class="line"><span class="lineno">  531</span>        }</div>
<div class="line"><span class="lineno">  532</span>    }</div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a>;</div>
<div class="line"><span class="lineno">  534</span>}</div>
<div class="ttc" id="anamespacedefaults_1_1sampling_html_afb3d6cb58a2dc84e4f0a2ed64d7e1609"><div class="ttname"><a href="namespacedefaults_1_1sampling.html#afb3d6cb58a2dc84e4f0a2ed64d7e1609">defaults::sampling::theta_samples</a></div><div class="ttdeci">constexpr std::size_t theta_samples</div><div class="ttdoc">Number of sample points for theta integration.</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00122">simulation-defaults.h:122</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1solver_html_a3469dc43cf2d60069d164931e7656d12"><div class="ttname"><a href="namespacedefaults_1_1solver.html#a3469dc43cf2d60069d164931e7656d12">defaults::solver::ode_rtol</a></div><div class="ttdeci">constexpr double ode_rtol</div><div class="ttdoc">Relative tolerance for ODE integration (Runge-Kutta)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00092">simulation-defaults.h:92</a></div></div>
<div class="ttc" id="autilities_8h_html_ab8e81118f023df135835db8cce4f5f42"><div class="ttname"><a href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a></div><div class="ttdeci">T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00260">utilities.h:260</a></div></div>
<div class="ttc" id="autilities_8h_html_ac47d1412f3f1791737d0f963267096f1"><div class="ttname"><a href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a></div><div class="ttdeci">T min(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00232">utilities.h:232</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph.png" border="0" usemap="#amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph" alt=""/></div>
<map name="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph" id="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph">
<area shape="rect" title=" " alt="" coords="5,19,176,45"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="323,19,477,45"/>
<area shape="poly" title=" " alt="" coords="138,17,203,6,239,3,275,4,335,14,334,19,274,9,239,8,203,11,139,22"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="224,19,275,45"/>
<area shape="poly" title=" " alt="" coords="176,29,210,29,210,35,176,35"/>
<area shape="rect" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1" title="Returns the value of a single parameter." alt="" coords="226,69,273,94"/>
<area shape="poly" title=" " alt="" coords="133,42,214,68,212,73,131,47"/>
<area shape="poly" title=" " alt="" coords="275,29,309,29,309,35,275,35"/>
<area shape="poly" title=" " alt="" coords="272,71,347,47,348,52,274,77"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph.png" border="0" usemap="#amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph" alt=""/></div>
<map name="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph" id="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph">
<area shape="rect" title=" " alt="" coords="975,31,1145,56"/>
<area shape="rect" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071" title=" " alt="" coords="781,5,920,31"/>
<area shape="poly" title=" " alt="" coords="961,34,920,29,920,24,962,29"/>
<area shape="rect" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea" title=" " alt="" coords="775,55,927,80"/>
<area shape="poly" title=" " alt="" coords="961,57,927,61,926,56,961,52"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="768,33,727,40,727,34,767,28"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
<area shape="poly" title=" " alt="" coords="761,57,726,52,727,47,762,52"/>
</map>
</div>

</div>
</div>
<a id="aa5d127d3ecb19584c7f27ee212d49605" name="aa5d127d3ecb19584c7f27ee212d49605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d127d3ecb19584c7f27ee212d49605">&#9670;&#160;</a></span>is_linear_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> is_linear_scale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code><a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if an array is linearly scaled within a given tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arr</td><td>The array to check </td></tr>
    <tr><td class="paramname">tolerance</td><td>Maximum allowed deviation from linearity (default: 1e-6) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the array is linearly scaled, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00012">12</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   12</span>                                                       {</div>
<div class="line"><span class="lineno">   13</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size() &lt; 2)</div>
<div class="line"><span class="lineno">   14</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// At least two elements are needed.</span></div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">diff</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[1] - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[0];</div>
<div class="line"><span class="lineno">   17</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 2; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   18</span>        <span class="keywordflow">if</span> (std::fabs((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> - 1] - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">diff</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">diff</a>) &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>) {</div>
<div class="line"><span class="lineno">   19</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   20</span>        }</div>
<div class="line"><span class="lineno">   21</span>    }</div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   23</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph.png" border="0" usemap="#amesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph" alt=""/></div>
<map name="amesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph" id="amesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph">
<area shape="rect" title="Checks if an array is linearly scaled within a given tolerance." alt="" coords="5,5,124,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="172,5,327,31"/>
<area shape="poly" title=" " alt="" coords="124,15,158,15,158,21,124,21"/>
</map>
</div>

</div>
</div>
<a id="ac0e56adbbf18a0c9a5c04a8d4de268d9" name="ac0e56adbbf18a0c9a5c04a8d4de268d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e56adbbf18a0c9a5c04a8d4de268d9">&#9670;&#160;</a></span>is_log_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> is_log_scale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code><a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if an array is logarithmically scaled within a given tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arr</td><td>The array to check </td></tr>
    <tr><td class="paramname">tolerance</td><td>Maximum allowed deviation from logarithmic scaling (default: 1e-6) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the array is logarithmically scaled, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00025">25</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   25</span>                                                    {</div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size() &lt; 2)</div>
<div class="line"><span class="lineno">   27</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// At least two elements are needed.</span></div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> ratio = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[1] / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[0];</div>
<div class="line"><span class="lineno">   30</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 2; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   31</span>        <span class="keywordflow">if</span> (std::fabs((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> - 1] - ratio) / ratio) &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>) {</div>
<div class="line"><span class="lineno">   32</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   33</span>        }</div>
<div class="line"><span class="lineno">   34</span>    }</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   36</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph.png" border="0" usemap="#amesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph" alt=""/></div>
<map name="amesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph" id="amesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph">
<area shape="rect" title="Checks if an array is logarithmically scaled within a given tolerance." alt="" coords="5,5,107,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="155,5,309,31"/>
<area shape="poly" title=" " alt="" coords="107,15,141,15,141,21,107,21"/>
</map>
</div>

</div>
</div>
<a id="a7cb4a7162e9b5a1e2ed39f7d9e94b53f" name="a7cb4a7162e9b5a1e2ed39f7d9e94b53f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb4a7162e9b5a1e2ed39f7d9e94b53f">&#9670;&#160;</a></span>jet_spreading_edge()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> jet_spreading_edge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the edge of the jet where the spreading is strongest. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
    <tr><td class="paramname"><a class="el" href="classMedium.html" title="Represents the generic medium or any user-defined surrounding medium that the GRB jet interacts with.">Medium</a></td><td>Type of the ambient medium </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">medium</td><td>The ambient medium object </td></tr>
    <tr><td class="paramname">phi</td><td>Azimuthal angle </td></tr>
    <tr><td class="paramname">theta_min</td><td>Minimum polar angle to consider </td></tr>
    <tr><td class="paramname">theta_max</td><td>Maximum polar angle to consider </td></tr>
    <tr><td class="paramname">t0</td><td>Initial time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Angle (in radians) where the spreading is strongest</dd></dl>
<p>The spreading strength is measured by the derivative of the pressure with respect to theta, which is proportional to d((Gamma-1)Gamma rho)/dtheta </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00470">470</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  470</span>                                                                                                                    {</div>
<div class="line"><span class="lineno">  471</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) / 256;</div>
<div class="line"><span class="lineno">  472</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_s = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>;</div>
<div class="line"><span class="lineno">  473</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a> = 0;</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta = theta_min; theta &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>; theta += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>) {</div>
<div class="line"><span class="lineno">  476</span>        <span class="comment">// Real G = jet.Gamma0(phi, theta);</span></div>
<div class="line"><span class="lineno">  477</span>        <span class="comment">// Real beta0 = physics::relativistic::gamma_to_beta(G);</span></div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">// Real r0 = beta0 * con::c * t0 / (1 - beta0);</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="comment">// Real rho = medium.rho(phi, theta, 0);</span></div>
<div class="line"><span class="lineno">  480</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_lo</a> = std::max(theta - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>, theta_min);</div>
<div class="line"><span class="lineno">  481</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_hi</a> = std::min(theta + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>);</div>
<div class="line"><span class="lineno">  482</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_hi</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_lo</a>)) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_lo</a>);</div>
<div class="line"><span class="lineno">  483</span>        <span class="comment">// Real drho = (medium.rho(phi, th_hi, r0) - medium.rho(phi, th_lo, r0)) / (th_hi - th_lo);</span></div>
<div class="line"><span class="lineno">  484</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a>; <span class="comment">//(2 * G - 1) * rho * dG + (G - 1) * G * drho;</span></div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a>) {</div>
<div class="line"><span class="lineno">  487</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp</a>;</div>
<div class="line"><span class="lineno">  488</span>            theta_s = theta;</div>
<div class="line"><span class="lineno">  489</span>        }</div>
<div class="line"><span class="lineno">  490</span>    }</div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a> == 0) {</div>
<div class="line"><span class="lineno">  492</span>        theta_s = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>;</div>
<div class="line"><span class="lineno">  493</span>    }</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordflow">return</span> theta_s;</div>
<div class="line"><span class="lineno">  496</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph.png" border="0" usemap="#amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph" alt=""/></div>
<map name="amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph" id="amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph">
<area shape="rect" title="Determines the edge of the jet where the spreading is strongest." alt="" coords="5,5,155,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="203,5,357,31"/>
<area shape="poly" title=" " alt="" coords="155,15,189,15,189,21,155,21"/>
</map>
</div>

</div>
</div>
<a id="a76f104cdad403ea346ff1a6603c78ad6" name="a76f104cdad403ea346ff1a6603c78ad6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76f104cdad403ea346ff1a6603c78ad6">&#9670;&#160;</a></span>log2space()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> log2space </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>grid_per_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00243">243</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  243</span>                                                                            {</div>
<div class="line"><span class="lineno">  244</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">decades</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>) / 3.321928094887362;</div>
<div class="line"><span class="lineno">  245</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(2, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::ceil(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">decades</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">grid_per_order</a>)));</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">array</a> = xt::logspace&lt;Real&gt;(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, n + 1, 2.0);</div>
<div class="line"><span class="lineno">  248</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph.png" border="0" usemap="#amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph" alt=""/></div>
<map name="amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph" id="amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,93,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="141,5,296,31"/>
<area shape="poly" title=" " alt="" coords="94,15,128,15,128,21,94,21"/>
</map>
</div>

</div>
</div>
<a id="ad7703ab8b66bb86ed857746606fac9a2" name="ad7703ab8b66bb86ed857746606fac9a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7703ab8b66bb86ed857746606fac9a2">&#9670;&#160;</a></span>logspace_boundary_center()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> logspace_boundary_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>bin_width</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00251">251</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  251</span>                                                                                                      {</div>
<div class="line"><span class="lineno">  252</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a> = Arr::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>});</div>
<div class="line"><span class="lineno">  253</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bin_width</a> = Array::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>});</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a> == 0)</div>
<div class="line"><span class="lineno">  255</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>);</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> r = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a>);</div>
<div class="line"><span class="lineno">  260</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a> = std::sqrt(r);</div>
<div class="line"><span class="lineno">  261</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a> = r - 1.;</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">for</span> (std::size_t <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  266</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a>;</div>
<div class="line"><span class="lineno">  267</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bin_width</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a>;</div>
<div class="line"><span class="lineno">  268</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> *= r;</div>
<div class="line"><span class="lineno">  269</span>    }</div>
<div class="line"><span class="lineno">  270</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph.png" border="0" usemap="#amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph" alt=""/></div>
<map name="amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph" id="amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,201,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="249,5,404,31"/>
<area shape="poly" title=" " alt="" coords="201,15,236,15,236,21,201,21"/>
</map>
</div>

</div>
</div>
<a id="afadc5019976c36be16277dc4dc178a7f" name="afadc5019976c36be16277dc4dc178a7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afadc5019976c36be16277dc4dc178a7f">&#9670;&#160;</a></span>logspace_center()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> logspace_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00226">226</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  226</span>                                                                           {</div>
<div class="line"><span class="lineno">  227</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a> = Arr::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>});</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a> == 0)</div>
<div class="line"><span class="lineno">  229</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>);</div>
<div class="line"><span class="lineno">  232</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> r = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a>);</div>
<div class="line"><span class="lineno">  233</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a> = std::sqrt(r);</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>);</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordflow">for</span> (std::size_t <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  237</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a>;</div>
<div class="line"><span class="lineno">  238</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> *= r;</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="line"><span class="lineno">  240</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph.png" border="0" usemap="#amesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph" alt=""/></div>
<map name="amesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph" id="amesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,133,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="181,5,336,31"/>
<area shape="poly" title=" " alt="" coords="133,15,167,15,167,21,133,21"/>
</map>
</div>

</div>
</div>
<a id="a3c066f2c8e6d102d7a56de8cb42cf5a8" name="a3c066f2c8e6d102d7a56de8cb42cf5a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c066f2c8e6d102d7a56de8cb42cf5a8">&#9670;&#160;</a></span>merge_grids()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> merge_grids </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00611">611</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  611</span>                                                    {</div>
<div class="line"><span class="lineno">  612</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>;</div>
<div class="line"><span class="lineno">  613</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>.size() + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>.size());</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0;</div>
<div class="line"><span class="lineno">  616</span>    <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a> = [&amp;](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">val</a>) {</div>
<div class="line"><span class="lineno">  617</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.empty() || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.back() != <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">val</a>)</div>
<div class="line"><span class="lineno">  618</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">val</a>);</div>
<div class="line"><span class="lineno">  619</span>    };</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>.size() &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>.size()) {</div>
<div class="line"><span class="lineno">  622</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>]) {</div>
<div class="line"><span class="lineno">  623</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>++]);</div>
<div class="line"><span class="lineno">  624</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> - 1] == <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>])</div>
<div class="line"><span class="lineno">  625</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>++;</div>
<div class="line"><span class="lineno">  626</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  627</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>++]);</div>
<div class="line"><span class="lineno">  628</span>        }</div>
<div class="line"><span class="lineno">  629</span>    }</div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>.size())</div>
<div class="line"><span class="lineno">  631</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>++]);</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>.size())</div>
<div class="line"><span class="lineno">  633</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>++]);</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">return</span> xt::adapt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>);</div>
<div class="line"><span class="lineno">  636</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph.png" border="0" usemap="#amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph" alt=""/></div>
<map name="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph" id="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,108,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="156,5,311,31"/>
<area shape="poly" title=" " alt="" coords="108,15,142,15,142,21,108,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph.png" border="0" usemap="#amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph" alt=""/></div>
<map name="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph" id="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,877,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="ab2b9eccaf75f7a9fe6bafd8696049bd2" name="ab2b9eccaf75f7a9fe6bafd8696049bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2b9eccaf75f7a9fe6bafd8696049bd2">&#9670;&#160;</a></span>refined_time_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> refined_time_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_refine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>t_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_resol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_lo_factor</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_hi_factor</em> = <code>10.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a refined logarithmic time grid with higher density around a specified time. </p>
<p>Constructs a three-segment logspace grid:</p><ul>
<li>Segment 1: [t_start, t_lo] with base resolution</li>
<li>Segment 2: [t_lo, t_hi] with higher resolution (around t_refine)</li>
<li>Segment 3: [t_hi, t_end] with base resolution</li>
</ul>
<p>Falls back to simple logspace if refinement is not applicable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_start</td><td>Start time of the grid </td></tr>
    <tr><td class="paramname">t_end</td><td>End time of the grid </td></tr>
    <tr><td class="paramname">t_refine</td><td>Time around which to refine (e.g., deceleration time) </td></tr>
    <tr><td class="paramname">t_num</td><td>Total number of grid points </td></tr>
    <tr><td class="paramname">t_resol</td><td>Resolution parameter (points per decade) </td></tr>
    <tr><td class="paramname">refine_lo_factor</td><td>Lower bound factor for refinement region (t_lo = refine_lo_factor * t_refine) </td></tr>
    <tr><td class="paramname">refine_hi_factor</td><td>Upper bound factor for refinement region (t_hi = refine_hi_factor * t_refine) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of time grid points </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00700">700</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  701</span>                                                                                          {</div>
<div class="line"><span class="lineno">  702</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>});</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>);</div>
<div class="line"><span class="lineno">  705</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>);</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine &lt;= t_start || t_refine &gt;</a>= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>) {</div>
<div class="line"><span class="lineno">  708</span>        <span class="keywordflow">return</span> xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>);</div>
<div class="line"><span class="lineno">  709</span>    }</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_lo</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>);</div>
<div class="line"><span class="lineno">  712</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_hi</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>);</div>
<div class="line"><span class="lineno">  713</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_lo</a>);</div>
<div class="line"><span class="lineno">  714</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_hi</a>);</div>
<div class="line"><span class="lineno">  715</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>;</div>
<div class="line"><span class="lineno">  716</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a>;</div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a> &gt; 0) ? std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(t_resol * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a>), 2) : 0;</div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a> &gt; 0) ? std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(t_resol * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a>), 2) : 0;</div>
<div class="line"><span class="lineno">  720</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shared</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> &gt; 0 ? 1 : 0) + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> &gt; 0 ? 1 : 0);</div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2_raw</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> + 2 &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shared</a>) ? (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shared</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a>) : 0;</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2_raw</a> &lt; 2) {</div>
<div class="line"><span class="lineno">  724</span>        <span class="keywordflow">return</span> xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>);</div>
<div class="line"><span class="lineno">  725</span>    }</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2_raw</a>;</div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a> = 0;</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>    <span class="comment">// Segment 1: [t_start, t_lo]</span></div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  732</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg1</a> = xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a>);</div>
<div class="line"><span class="lineno">  733</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)</div>
<div class="line"><span class="lineno">  734</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a>++) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg1</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>);</div>
<div class="line"><span class="lineno">  735</span>    }</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>    <span class="comment">// Segment 2: [t_lo, t_hi] - skip first point if it overlaps with seg1</span></div>
<div class="line"><span class="lineno">  738</span>    {</div>
<div class="line"><span class="lineno">  739</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg2</a> = xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2</a>);</div>
<div class="line"><span class="lineno">  740</span>        <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k0</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> &gt; 0) ? 1 : 0;</div>
<div class="line"><span class="lineno">  741</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k0</a>; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)</div>
<div class="line"><span class="lineno">  742</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a>++) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg2</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>);</div>
<div class="line"><span class="lineno">  743</span>    }</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    <span class="comment">// Segment 3: [t_hi, t_end] - skip first point (overlaps with seg2)</span></div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  747</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg3</a> = xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a>);</div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)</div>
<div class="line"><span class="lineno">  749</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a>++) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg3</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>);</div>
<div class="line"><span class="lineno">  750</span>    }</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>;</div>
<div class="line"><span class="lineno">  753</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph.png" border="0" usemap="#amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph" alt=""/></div>
<map name="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph" id="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph">
<area shape="rect" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="5,5,141,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="189,5,344,31"/>
<area shape="poly" title=" " alt="" coords="141,15,176,15,176,21,141,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph.png" border="0" usemap="#amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph" alt=""/></div>
<map name="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph" id="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph">
<area shape="rect" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="775,31,911,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="mesh_8h.html">mesh.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
