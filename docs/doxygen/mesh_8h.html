<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: mesh.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mesh_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mesh.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;span&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">../util/macros.h</a>&quot;</code><br />
<code>#include &quot;boost/numeric/odeint.hpp&quot;</code><br />
<code>#include &quot;<a class="el" href="physics_8h_source.html">physics.h</a>&quot;</code><br />
<code>#include &quot;xtensor/containers/xadapt.hpp&quot;</code><br />
<code>#include &quot;xtensor/containers/xtensor.hpp&quot;</code><br />
<code>#include &quot;xtensor/core/xmath.hpp&quot;</code><br />
<code>#include &quot;xtensor/io/xnpy.hpp&quot;</code><br />
<code>#include &quot;xtensor/views/xview.hpp&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for mesh.h:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h__incl.png" border="0" usemap="#amesh_8h" alt=""/></div>
<map name="amesh_8h" id="amesh_8h">
<area shape="rect" title=" " alt="" coords="563,5,634,31"/>
<area shape="rect" title=" " alt="" coords="5,86,91,111"/>
<area shape="poly" title=" " alt="" coords="563,24,366,40,235,57,103,81,91,84,90,79,102,76,234,51,365,34,563,18"/>
<area shape="rect" title=" " alt="" coords="115,86,184,111"/>
<area shape="poly" title=" " alt="" coords="563,24,403,41,300,58,197,81,188,84,186,79,195,76,299,53,402,36,563,19"/>
<area shape="rect" title=" " alt="" coords="208,86,261,111"/>
<area shape="poly" title=" " alt="" coords="564,25,434,43,354,59,274,81,269,83,267,78,273,76,353,54,433,38,563,20"/>
<area shape="rect" title=" " alt="" coords="286,86,349,111"/>
<area shape="poly" title=" " alt="" coords="564,30,475,51,369,81,360,84,359,79,367,76,473,46,563,25"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="417,167,535,192"/>
<area shape="poly" title=" " alt="" coords="563,22,526,25,485,34,445,52,428,65,414,80,408,98,414,118,429,139,448,157,444,161,425,143,410,120,403,98,410,77,425,61,443,47,483,29,525,20,563,16"/>
<area shape="rect" title=" " alt="" coords="425,86,613,111"/>
<area shape="poly" title=" " alt="" coords="589,33,542,78,539,74,585,29"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="637,86,720,111"/>
<area shape="poly" title=" " alt="" coords="612,29,659,74,655,78,609,33"/>
<area shape="rect" title=" " alt="" coords="745,79,887,119"/>
<area shape="poly" title=" " alt="" coords="631,28,752,72,750,77,629,33"/>
<area shape="rect" title=" " alt="" coords="911,79,1054,119"/>
<area shape="poly" title=" " alt="" coords="635,23,898,76,897,81,634,29"/>
<area shape="rect" title=" " alt="" coords="1078,86,1255,111"/>
<area shape="poly" title=" " alt="" coords="635,21,820,42,1067,76,1096,81,1095,86,1066,81,820,47,634,26"/>
<area shape="rect" title=" " alt="" coords="1280,86,1429,111"/>
<area shape="poly" title=" " alt="" coords="634,18,898,35,1082,52,1268,76,1294,81,1293,86,1268,81,1081,58,898,41,634,24"/>
<area shape="rect" title=" " alt="" coords="1454,86,1637,111"/>
<area shape="poly" title=" " alt="" coords="634,18,965,34,1200,51,1442,76,1475,81,1474,86,1441,81,1200,56,964,39,634,23"/>
<area shape="rect" title=" " alt="" coords="384,247,443,273"/>
<area shape="poly" title=" " alt="" coords="469,194,433,238,429,235,465,191"/>
<area shape="rect" href="simulation-defaults_8h.html" title="Centralized simulation configuration defaults." alt="" coords="467,240,613,280"/>
<area shape="poly" title=" " alt="" coords="488,190,518,228,514,231,483,194"/>
<area shape="rect" title=" " alt="" coords="505,328,575,353"/>
<area shape="poly" title=" " alt="" coords="543,280,543,314,537,314,537,280"/>
<area shape="poly" title=" " alt="" coords="650,114,519,164,517,159,648,109"/>
<area shape="rect" title=" " alt="" coords="647,167,710,192"/>
<area shape="poly" title=" " alt="" coords="681,112,681,153,676,153,676,112"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h__dep__incl.png" border="0" usemap="#amesh_8hdep" alt=""/></div>
<map name="amesh_8hdep" id="amesh_8hdep">
<area shape="rect" title=" " alt="" coords="1289,5,1359,31"/>
<area shape="rect" href="IO_8h.html" title=" " alt="" coords="264,519,312,544"/>
<area shape="poly" title=" " alt="" coords="1275,23,1018,33,844,42,663,56,493,75,349,99,294,113,251,129,225,146,218,155,216,164,216,386,223,426,240,463,260,494,279,517,275,520,256,497,235,465,218,427,211,386,211,163,213,152,221,142,249,124,292,108,348,93,492,69,663,51,844,37,1018,27,1274,18"/>
<area shape="rect" href="afterglow_8h.html" title=" " alt="" coords="1359,592,1454,617"/>
<area shape="poly" title=" " alt="" coords="1373,17,1527,24,1624,33,1722,45,1813,64,1889,88,1919,104,1942,121,1956,141,1961,163,1961,460,1957,479,1944,497,1925,513,1900,527,1835,550,1757,569,1673,583,1590,593,1454,604,1454,598,1589,588,1672,578,1756,564,1834,545,1898,522,1922,508,1941,493,1952,477,1956,459,1956,164,1951,143,1938,125,1916,108,1887,93,1812,69,1721,51,1623,38,1527,30,1373,23"/>
<area shape="rect" href="mcmc_8h.html" title=" " alt="" coords="1605,739,1680,764"/>
<area shape="poly" title=" " alt="" coords="1373,17,1539,21,1644,28,1750,40,1850,58,1933,84,1965,100,1990,118,2006,139,2012,163,2012,606,2009,628,2001,644,1989,656,1974,665,1936,678,1893,693,1837,715,1779,730,1681,748,1680,743,1778,725,1835,710,1891,688,1934,673,1972,660,1986,652,1997,641,2004,626,2007,606,2007,164,2001,141,1987,122,1963,104,1931,89,1849,63,1750,45,1643,34,1539,26,1373,22"/>
<area shape="rect" href="inverse-compton_8h.html" title=" " alt="" coords="628,299,772,324"/>
<area shape="poly" title=" " alt="" coords="1275,23,1201,28,1107,38,1003,55,901,81,820,105,755,127,728,142,703,162,679,190,657,226,654,245,661,264,674,282,688,297,684,300,670,286,656,267,649,246,652,224,675,187,699,159,725,138,753,122,818,100,899,76,1002,49,1106,32,1201,22,1275,18"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="471,445,582,471"/>
<area shape="poly" title=" " alt="" coords="1275,24,1050,37,747,64,602,83,480,106,433,119,398,133,375,148,368,164,368,313,371,358,378,376,393,396,411,412,431,425,475,443,473,448,429,430,407,416,389,399,373,379,366,359,363,313,363,163,371,145,395,129,432,114,479,101,601,77,746,58,1049,32,1274,19"/>
<area shape="rect" href="mesh_8cpp.html" title=" " alt="" coords="2047,79,2132,104"/>
<area shape="poly" title=" " alt="" coords="1373,19,1652,38,1839,54,2028,76,2047,79,2046,84,2028,81,1838,59,1652,43,1373,24"/>
<area shape="rect" href="observer_8h.html" title=" " alt="" coords="1761,299,1852,324"/>
<area shape="poly" title=" " alt="" coords="1373,21,1452,33,1552,55,1605,72,1658,93,1709,119,1756,150,1776,166,1788,182,1805,225,1812,265,1811,298,1805,298,1806,265,1800,226,1784,185,1772,170,1753,154,1707,124,1656,98,1604,77,1551,61,1451,38,1372,26"/>
<area shape="rect" href="prompt_8h.html" title=" " alt="" coords="94,445,175,471"/>
<area shape="poly" title=" " alt="" coords="1275,22,1033,23,693,30,523,37,374,48,260,62,221,71,196,81,174,97,160,115,153,136,151,163,151,313,146,389,139,445,134,445,141,388,145,313,145,163,148,135,155,112,170,94,193,76,219,66,259,57,373,42,523,32,692,24,1032,17,1275,16"/>
<area shape="rect" href="quadrature_8h.html" title=" " alt="" coords="666,225,771,251"/>
<area shape="poly" title=" " alt="" coords="1276,26,1183,37,1062,59,996,76,929,97,864,123,803,154,779,171,759,190,729,227,725,223,755,187,776,167,800,150,862,118,927,92,994,71,1061,54,1182,31,1275,20"/>
<area shape="rect" href="shock_8h.html" title=" " alt="" coords="1243,225,1315,251"/>
<area shape="poly" title=" " alt="" coords="1361,35,1405,61,1446,96,1462,116,1471,136,1472,158,1462,179,1448,195,1431,208,1392,226,1351,235,1315,239,1314,234,1350,230,1390,221,1428,203,1444,191,1458,176,1466,157,1466,137,1457,118,1442,100,1402,66,1359,40"/>
<area shape="rect" href="utilities_8h.html" title=" " alt="" coords="1283,79,1365,104"/>
<area shape="poly" title=" " alt="" coords="1327,44,1327,79,1321,79,1321,44"/>
<area shape="rect" href="IO_8cpp.html" title=" " alt="" coords="257,592,319,617"/>
<area shape="poly" title=" " alt="" coords="291,558,291,592,285,592,285,558"/>
<area shape="poly" title=" " alt="" coords="326,532,1359,598,1359,603,326,538"/>
<area shape="poly" title=" " alt="" coords="1468,605,1506,611,1546,621,1585,638,1619,663,1632,681,1640,702,1645,738,1640,739,1635,703,1627,684,1615,667,1582,643,1544,626,1505,616,1467,610"/>
<area shape="rect" href="pymodel_8cpp.html" title=" " alt="" coords="1333,812,1440,837"/>
<area shape="poly" title=" " alt="" coords="1407,632,1390,812,1385,811,1402,631"/>
<area shape="rect" href="pymodel_8h.html" title=" " alt="" coords="1448,739,1539,764"/>
<area shape="poly" title=" " alt="" coords="1423,628,1489,737,1484,740,1418,631"/>
<area shape="rect" href="shock__dispatch_8h.html" title=" " alt="" coords="1470,665,1605,691"/>
<area shape="poly" title=" " alt="" coords="1441,622,1517,663,1515,667,1439,626"/>
<area shape="rect" href="synchrotron_8cpp.html" title=" " alt="" coords="229,665,355,691"/>
<area shape="poly" title=" " alt="" coords="1346,613,356,675,355,670,1345,607"/>
<area shape="rect" href="mcmc_8cpp.html" title=" " alt="" coords="1598,812,1687,837"/>
<area shape="poly" title=" " alt="" coords="1645,778,1645,812,1640,812,1640,778"/>
<area shape="rect" href="pybind_8cpp.html" title=" " alt="" coords="1475,812,1568,837"/>
<area shape="poly" title=" " alt="" coords="1612,773,1543,814,1540,809,1610,769"/>
<area shape="poly" title=" " alt="" coords="1505,776,1519,811,1514,813,1501,778"/>
<area shape="poly" title=" " alt="" coords="1466,774,1406,814,1403,810,1464,769"/>
<area shape="poly" title=" " alt="" coords="1567,696,1627,736,1624,741,1564,701"/>
<area shape="poly" title=" " alt="" coords="1525,704,1503,740,1498,737,1521,701"/>
<area shape="poly" title=" " alt="" coords="743,327,829,370,867,394,897,417,945,462,994,503,1025,522,1065,542,1143,568,1224,585,1299,595,1360,599,1359,605,1298,600,1223,590,1142,573,1063,546,1023,527,991,507,941,466,894,422,864,398,827,374,740,332"/>
<area shape="poly" title=" " alt="" coords="614,317,453,325,361,334,270,348,187,366,120,390,94,404,75,420,63,438,59,457,59,532,63,560,75,584,94,604,117,622,173,647,229,663,227,669,171,652,114,626,90,608,71,587,58,562,53,533,53,456,58,435,71,416,91,400,117,385,186,361,269,342,360,329,453,320,614,311"/>
<area shape="rect" href="inverse-compton_8cpp.html" title=" " alt="" coords="734,519,893,544"/>
<area shape="poly" title=" " alt="" coords="749,327,780,345,806,370,817,389,823,410,828,452,825,490,819,519,814,518,819,490,822,452,818,411,812,391,802,374,777,349,747,332"/>
<area shape="rect" href="power-law-syn_8cpp.html" title=" " alt="" coords="302,445,447,471"/>
<area shape="poly" title=" " alt="" coords="614,321,550,328,484,339,428,354,407,363,393,374,382,390,377,409,376,445,370,445,371,409,377,388,389,370,404,359,426,349,483,334,549,323,614,316"/>
<area shape="rect" href="power-law-syn_8h.html" title=" " alt="" coords="403,372,533,397"/>
<area shape="poly" title=" " alt="" coords="651,330,506,374,505,369,649,325"/>
<area shape="poly" title=" " alt="" coords="663,333,630,351,598,374,562,412,536,447,532,444,557,409,594,370,627,346,660,328"/>
<area shape="rect" href="smooth-power-law-syn_8h.html" title=" " alt="" coords="608,372,792,397"/>
<area shape="poly" title=" " alt="" coords="703,338,703,372,697,372,697,338"/>
<area shape="poly" title=" " alt="" coords="444,408,392,447,388,443,441,403"/>
<area shape="poly" title=" " alt="" coords="488,406,519,444,515,447,484,410"/>
<area shape="poly" title=" " alt="" coords="476,477,313,525,312,520,475,472"/>
<area shape="poly" title=" " alt="" coords="560,475,634,510,678,527,723,541,813,561,905,576,1086,594,1245,601,1359,602,1359,607,1245,606,1086,599,904,581,812,566,722,547,676,533,632,515,558,480"/>
<area shape="poly" title=" " alt="" coords="506,482,306,667,303,663,502,478"/>
<area shape="poly" title=" " alt="" coords="586,471,768,516,766,521,585,477"/>
<area shape="poly" title=" " alt="" coords="661,405,556,448,554,443,659,400"/>
<area shape="rect" href="smooth-power-law-syn_8cpp.html" title=" " alt="" coords="606,445,805,471"/>
<area shape="poly" title=" " alt="" coords="705,411,707,445,702,445,699,411"/>
<area shape="poly" title=" " alt="" coords="1825,335,1836,365,1838,382,1835,398,1810,451,1782,487,1746,517,1696,546,1634,573,1569,591,1506,600,1454,605,1454,600,1506,595,1567,585,1632,568,1693,542,1743,512,1778,484,1805,448,1829,396,1832,382,1831,366,1820,337"/>
<area shape="rect" href="observer_8cpp.html" title=" " alt="" coords="1714,372,1819,397"/>
<area shape="poly" title=" " alt="" coords="1796,338,1775,373,1771,371,1791,335"/>
<area shape="poly" title=" " alt="" coords="173,474,265,516,263,521,171,479"/>
<area shape="poly" title=" " alt="" coords="157,478,199,513,225,529,253,541,322,554,441,566,769,583,1115,594,1359,600,1359,605,1115,600,769,588,441,571,321,560,251,547,223,534,196,517,154,483"/>
<area shape="rect" href="prompt_8cpp.html" title=" " alt="" coords="93,519,189,544"/>
<area shape="poly" title=" " alt="" coords="140,484,143,518,138,519,134,485"/>
<area shape="poly" title=" " alt="" coords="715,265,706,299,700,298,710,263"/>
<area shape="poly" title=" " alt="" coords="1229,243,1118,247,966,257,792,274,616,301,489,325,436,342,372,374,324,403,308,420,293,446,287,465,286,485,288,518,283,519,280,485,282,464,288,444,304,417,321,399,369,370,434,337,488,320,616,296,791,269,965,252,1118,242,1229,238"/>
<area shape="poly" title=" " alt="" coords="1229,248,773,304,772,299,1229,243"/>
<area shape="poly" title=" " alt="" coords="1237,258,1050,324,929,363,805,400,686,428,583,449,582,444,685,423,803,395,927,358,1049,319,1235,253"/>
<area shape="poly" title=" " alt="" coords="1329,243,1762,301,1761,307,1328,249"/>
<area shape="rect" href="forward-shock_8hpp.html" title=" " alt="" coords="1445,372,1587,397"/>
<area shape="poly" title=" " alt="" coords="1329,245,1393,263,1427,277,1458,297,1477,314,1492,334,1513,370,1508,373,1488,337,1473,318,1454,301,1424,282,1391,268,1327,250"/>
<area shape="rect" href="shock-physics_8h.html" title=" " alt="" coords="1317,299,1443,324"/>
<area shape="poly" title=" " alt="" coords="1308,256,1365,296,1362,301,1305,261"/>
<area shape="rect" href="shock_8cpp.html" title=" " alt="" coords="1121,372,1207,397"/>
<area shape="poly" title=" " alt="" coords="1263,263,1175,373,1171,370,1259,260"/>
<area shape="rect" href="simple-shock_8hpp.html" title=" " alt="" coords="1231,372,1369,397"/>
<area shape="poly" title=" " alt="" coords="1285,264,1301,371,1296,372,1280,265"/>
<area shape="poly" title=" " alt="" coords="1520,411,1517,475,1508,511,1493,545,1465,575,1434,594,1431,590,1462,570,1488,543,1503,510,1512,474,1515,411"/>
<area shape="poly" title=" " alt="" coords="1415,328,1495,369,1493,374,1412,333"/>
<area shape="rect" href="reverse-shock_8hpp.html" title=" " alt="" coords="1335,519,1478,544"/>
<area shape="poly" title=" " alt="" coords="1386,338,1408,518,1403,519,1380,338"/>
<area shape="poly" title=" " alt="" coords="1333,331,1200,374,1198,369,1331,326"/>
<area shape="poly" title=" " alt="" coords="1359,335,1315,374,1311,370,1355,331"/>
<area shape="poly" title=" " alt="" coords="1409,558,1409,592,1404,592,1404,558"/>
<area shape="poly" title=" " alt="" coords="1301,411,1304,474,1312,510,1326,543,1352,570,1382,590,1380,594,1349,574,1322,545,1307,511,1298,475,1295,411"/>
<area shape="poly" title=" " alt="" coords="1372,107,1416,125,1461,150,1528,194,1554,216,1576,239,1593,265,1607,295,1617,330,1623,372,1624,427,1613,471,1588,508,1547,546,1499,575,1450,594,1448,589,1496,571,1544,542,1583,505,1608,468,1618,426,1617,372,1611,331,1602,297,1589,268,1572,243,1551,220,1525,199,1459,154,1414,130,1369,111"/>
<area shape="poly" title=" " alt="" coords="1379,92,1524,102,1611,111,1699,125,1780,143,1847,167,1873,182,1893,198,1906,216,1911,236,1911,606,1904,642,1885,672,1857,696,1823,714,1785,728,1747,738,1681,749,1680,744,1746,733,1784,723,1820,709,1854,691,1881,668,1899,640,1905,606,1905,237,1901,218,1889,202,1870,186,1845,172,1778,148,1698,130,1610,116,1523,107,1379,97"/>
<area shape="poly" title=" " alt="" coords="1269,98,1143,107,967,124,760,149,544,185,439,207,340,232,249,260,169,292,102,328,51,367,33,388,19,410,11,433,8,457,8,532,14,566,30,593,55,616,86,634,122,648,158,658,229,670,228,675,157,663,120,653,84,638,52,620,26,597,9,568,3,533,3,457,6,432,14,408,28,385,48,363,99,323,167,288,247,255,339,227,438,202,543,179,759,144,966,118,1143,102,1269,93"/>
<area shape="poly" title=" " alt="" coords="1269,97,1170,103,1051,113,939,130,895,141,863,154,836,175,822,199,809,224,786,253,753,280,721,301,718,296,749,275,782,249,804,221,817,196,832,172,860,150,893,136,938,125,1050,108,1170,97,1269,92"/>
<area shape="poly" title=" " alt="" coords="1269,98,1197,109,1157,119,1120,132,1086,150,1059,173,1041,202,1035,237,1035,386,1030,414,1018,439,1000,460,977,477,923,504,870,521,869,516,921,499,974,473,996,456,1014,436,1025,413,1029,386,1029,236,1036,200,1055,170,1083,146,1118,128,1156,114,1195,104,1268,93"/>
<area shape="poly" title=" " alt="" coords="1270,101,1159,118,1031,145,973,164,926,185,894,210,886,223,883,237,883,313,879,339,868,362,851,383,831,401,786,429,742,448,740,443,783,424,828,397,848,379,863,359,874,337,877,312,877,236,881,221,890,206,923,181,971,159,1029,140,1158,112,1269,96"/>
<area shape="poly" title=" " alt="" coords="1379,92,1466,98,1568,108,1661,125,1699,136,1725,150,1744,166,1760,185,1784,227,1799,267,1807,298,1802,299,1794,269,1779,229,1755,188,1740,170,1723,154,1697,141,1660,130,1567,113,1466,103,1379,97"/>
<area shape="poly" title=" " alt="" coords="1379,93,1456,99,1543,110,1622,126,1653,137,1675,150,1695,185,1722,250,1765,371,1760,373,1717,252,1691,188,1671,154,1650,142,1620,131,1542,115,1455,104,1379,98"/>
<area shape="rect" href="jet_8h.html" title=" " alt="" coords="1397,152,1448,177"/>
<area shape="poly" title=" " alt="" coords="1352,110,1408,150,1405,154,1349,114"/>
<area shape="rect" href="medium_8h.html" title=" " alt="" coords="1163,152,1251,177"/>
<area shape="poly" title=" " alt="" coords="1295,113,1227,154,1224,149,1292,109"/>
<area shape="rect" href="utilities_8cpp.html" title=" " alt="" coords="1275,152,1373,177"/>
<area shape="poly" title=" " alt="" coords="1327,118,1327,152,1321,152,1321,118"/>
<area shape="poly" title=" " alt="" coords="1457,182,1507,218,1561,267,1583,297,1599,329,1606,363,1603,398,1588,445,1573,480,1550,511,1516,546,1478,575,1438,594,1436,590,1475,570,1513,542,1546,507,1568,477,1583,443,1597,397,1601,363,1594,330,1578,300,1557,271,1504,222,1454,187"/>
<area shape="poly" title=" " alt="" coords="1389,186,1303,228,1301,223,1386,181"/>
<area shape="poly" title=" " alt="" coords="1176,187,1146,209,1117,237,1094,271,1088,290,1085,310,1085,459,1087,480,1093,499,1115,530,1148,554,1188,572,1233,585,1278,593,1359,600,1359,606,1278,599,1232,590,1186,577,1145,559,1111,534,1088,501,1082,481,1080,459,1080,310,1082,289,1089,269,1112,234,1142,205,1172,183"/>
<area shape="poly" title=" " alt="" coords="1230,185,1269,223,1265,227,1227,189"/>
</map>
</div>
</div>
<p><a href="mesh_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoord.html">Coord</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a coordinate system with arrays for phi, theta, and t.  <a href="classCoord.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afd05120c4d579ec7fa4906f677781a83" id="r_afd05120c4d579ec7fa4906f677781a83"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 1 &gt;</td></tr>
<tr class="memdesc:afd05120c4d579ec7fa4906f677781a83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 1D arrays (e.g., time points)  <br /></td></tr>
<tr class="separator:afd05120c4d579ec7fa4906f677781a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ec6be5d638ad03ae6697ff2b71ef91" id="r_ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 2 &gt;</td></tr>
<tr class="memdesc:ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 2D grids (e.g., spatial coordinates)  <br /></td></tr>
<tr class="separator:ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b76cc05bedc7fd9499c0bd3eec3bcb5" id="r_a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a> = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 3 &gt;</td></tr>
<tr class="memdesc:a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D grids (e.g., full spatial-temporal data)  <br /></td></tr>
<tr class="separator:a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb738e18bf395ef0903c8c5d6f37c47f" id="r_afb738e18bf395ef0903c8c5d6f37c47f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">int</a>, 3 &gt;</td></tr>
<tr class="memdesc:afb738e18bf395ef0903c8c5d6f37c47f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D boolean grids for masking operations.  <br /></td></tr>
<tr class="separator:afb738e18bf395ef0903c8c5d6f37c47f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27e3f4efb19b3f2b0694e0bee5fb25ae" id="r_a27e3f4efb19b3f2b0694e0bee5fb25ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a27e3f4efb19b3f2b0694e0bee5fb25ae">IndexGrid</a> = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>, 2 &gt;</td></tr>
<tr class="separator:a27e3f4efb19b3f2b0694e0bee5fb25ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa5d127d3ecb19584c7f27ee212d49605" id="r_aa5d127d3ecb19584c7f27ee212d49605"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aa5d127d3ecb19584c7f27ee212d49605">is_linear_scale</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">tolerance</a>=<a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a>)</td></tr>
<tr class="memdesc:aa5d127d3ecb19584c7f27ee212d49605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if an array is linearly scaled within a given tolerance.  <br /></td></tr>
<tr class="separator:aa5d127d3ecb19584c7f27ee212d49605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e56adbbf18a0c9a5c04a8d4de268d9" id="r_ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ac0e56adbbf18a0c9a5c04a8d4de268d9">is_log_scale</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">tolerance</a>=<a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a>)</td></tr>
<tr class="memdesc:ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if an array is logarithmically scaled within a given tolerance.  <br /></td></tr>
<tr class="separator:ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a885b165e8d9c9d20f27ec99329a0c3cb" id="r_a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr1</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr2</a> &gt; </td></tr>
<tr class="memitem:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a885b165e8d9c9d20f27ec99329a0c3cb">boundary_to_center</a> (<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr1</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr2</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>)</td></tr>
<tr class="memdesc:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using linear interpolation.  <br /></td></tr>
<tr class="separator:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba66986baad5475a202c20a92bda036e" id="r_aba66986baad5475a202c20a92bda036e"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr1</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr2</a> &gt; </td></tr>
<tr class="memitem:aba66986baad5475a202c20a92bda036e"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aba66986baad5475a202c20a92bda036e">boundary_to_center_log</a> (<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr1</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr2</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>)</td></tr>
<tr class="memdesc:aba66986baad5475a202c20a92bda036e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using geometric mean (logarithmic interpolation)  <br /></td></tr>
<tr class="separator:aba66986baad5475a202c20a92bda036e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1622b29b5488dbee3ef9068b9f8c7d4" id="r_ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae1622b29b5488dbee3ef9068b9f8c7d4">boundary_to_center</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>)</td></tr>
<tr class="memdesc:ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using linear interpolation.  <br /></td></tr>
<tr class="separator:ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac536f77c32691232cb5e7546595fb3d2" id="r_ac536f77c32691232cb5e7546595fb3d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ac536f77c32691232cb5e7546595fb3d2">boundary_to_center_log</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>)</td></tr>
<tr class="memdesc:ac536f77c32691232cb5e7546595fb3d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using geometric mean.  <br /></td></tr>
<tr class="separator:ac536f77c32691232cb5e7546595fb3d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96aa0a78a0de13a52955de3c2ce29ddd" id="r_a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classCoord.html">Coord</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd">auto_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;jet, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;medium, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;t_obs, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_cut</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_view, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> z, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi_resol=<a class="el" href="namespacedefaults_1_1grid.html#a81845ddcce8fb560efb401cdde437a16">defaults::grid::phi_resolution</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_resol=<a class="el" href="namespacedefaults_1_1grid.html#a372994c537be68d80989655f9b43c672">defaults::grid::theta_resolution</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_resol=<a class="el" href="namespacedefaults_1_1grid.html#aa203749fa338e32e6c7a711c82846582">defaults::grid::time_resolution</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">is_axisymmetric</a>=<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">true</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi_view=0, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">min_theta_num</a>=<a class="el" href="namespacedefaults_1_1grid.html#a17f64e94f8f9cb660a1e9d80a2b1558c">defaults::grid::min_theta_points</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">fwd_ratio</a>=<a class="el" href="namespacedefaults_1_1grid.html#ae654c737813ff06431141238b26e0a67">defaults::grid::forward_ratio</a>)</td></tr>
<tr class="memdesc:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a coordinate grid (<a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a>) for shock evolution.  <br /></td></tr>
<tr class="separator:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ba8f4400237a97c0d2fac934fb44cf" id="r_a28ba8f4400237a97c0d2fac934fb44cf"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a28ba8f4400237a97c0d2fac934fb44cf"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf">find_jet_edges</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;jet, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_cut, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">is_axisymmetric</a>)</td></tr>
<tr class="memdesc:a28ba8f4400237a97c0d2fac934fb44cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary.  <br /></td></tr>
<tr class="separator:a28ba8f4400237a97c0d2fac934fb44cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb4a7162e9b5a1e2ed39f7d9e94b53f" id="r_a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a7cb4a7162e9b5a1e2ed39f7d9e94b53f">jet_spreading_edge</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;jet, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;medium, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t0)</td></tr>
<tr class="memdesc:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the edge of the jet where the spreading is strongest.  <br /></td></tr>
<tr class="separator:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afadc5019976c36be16277dc4dc178a7f" id="r_afadc5019976c36be16277dc4dc178a7f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a>  = Array&gt; </td></tr>
<tr class="memitem:afadc5019976c36be16277dc4dc178a7f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afadc5019976c36be16277dc4dc178a7f">logspace_center</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>)</td></tr>
<tr class="separator:afadc5019976c36be16277dc4dc178a7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76f104cdad403ea346ff1a6603c78ad6" id="r_a76f104cdad403ea346ff1a6603c78ad6"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a>  = Array&gt; </td></tr>
<tr class="memitem:a76f104cdad403ea346ff1a6603c78ad6"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a76f104cdad403ea346ff1a6603c78ad6">log2space</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">grid_per_order</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">array</a>)</td></tr>
<tr class="separator:a76f104cdad403ea346ff1a6603c78ad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7703ab8b66bb86ed857746606fac9a2" id="r_ad7703ab8b66bb86ed857746606fac9a2"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &gt; </td></tr>
<tr class="memitem:ad7703ab8b66bb86ed857746606fac9a2"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ad7703ab8b66bb86ed857746606fac9a2">logspace_boundary_center</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bin_width</a>)</td></tr>
<tr class="separator:ad7703ab8b66bb86ed857746606fac9a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e78f3cf4aabf7985519d581ce43182" id="r_ae2e78f3cf4aabf7985519d581ce43182"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae2e78f3cf4aabf7985519d581ce43182">adaptive_grid_with_breaks</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::span</a>&lt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">breaks</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::span</a>&lt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">break_weights</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts_per_decade</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;grid, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max_refined_breaks</a>=3, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_radius_decades</a>=0.5, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_factor</a>=3.0)</td></tr>
<tr class="memdesc:ae2e78f3cf4aabf7985519d581ce43182"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds an adaptive log-spaced grid with explicit break points.  <br /></td></tr>
<tr class="separator:ae2e78f3cf4aabf7985519d581ce43182"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49c59d8da915e118c4e550cc9bd4d3d9" id="r_a49c59d8da915e118c4e550cc9bd4d3d9"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Func</a> &gt; </td></tr>
<tr class="memitem:a49c59d8da915e118c4e550cc9bd4d3d9"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a> (<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Func</a> &amp;&amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pdf</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">num</a>)</td></tr>
<tr class="separator:a49c59d8da915e118c4e550cc9bd4d3d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc6828dd13a70c0c203dba03e765cea" id="r_a3dc6828dd13a70c0c203dba03e765cea"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a3dc6828dd13a70c0c203dba03e765cea"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;jet, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_v)</td></tr>
<tr class="separator:a3dc6828dd13a70c0c203dba03e765cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cba2da30fd9821858dc89b5caea3443" id="r_a9cba2da30fd9821858dc89b5caea3443"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443">edge_refinement_grid</a> (<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">jet_edges</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">avg_spacing</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_resol)</td></tr>
<tr class="separator:a9cba2da30fd9821858dc89b5caea3443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83ae490737edde6ad03ede25e371a071" id="r_a83ae490737edde6ad03ede25e371a071"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a83ae490737edde6ad03ede25e371a071"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071">adaptive_phi_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;jet, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">phi_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_v, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">is_axisymmetric</a>)</td></tr>
<tr class="separator:a83ae490737edde6ad03ede25e371a071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c066f2c8e6d102d7a56de8cb42cf5a8" id="r_a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &gt; </td></tr>
<tr class="memitem:a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a> (<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr1</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr2</a>)</td></tr>
<tr class="separator:a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7505ad2e84c2a29610c1a13cd3b25e3" id="r_aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;jet, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;medium, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta)</td></tr>
<tr class="memdesc:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates deceleration time for a given angle from ejecta and medium properties.  <br /></td></tr>
<tr class="separator:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2b9eccaf75f7a9fe6bafd8696049bd2" id="r_ab2b9eccaf75f7a9fe6bafd8696049bd2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2">refined_time_grid</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_start</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_end</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_refine</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_resol, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_lo_factor</a>=0.3, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_hi_factor</a>=10.0)</td></tr>
<tr class="memdesc:ab2b9eccaf75f7a9fe6bafd8696049bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a refined logarithmic time grid with higher density around a specified time.  <br /></td></tr>
<tr class="separator:ab2b9eccaf75f7a9fe6bafd8696049bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="afd05120c4d579ec7fa4906f677781a83" name="afd05120c4d579ec7fa4906f677781a83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd05120c4d579ec7fa4906f677781a83">&#9670;&#160;</a></span>Array</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a> <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> =  <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 1&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 1D arrays (e.g., time points) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00039">39</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="a27e3f4efb19b3f2b0694e0bee5fb25ae" name="a27e3f4efb19b3f2b0694e0bee5fb25ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27e3f4efb19b3f2b0694e0bee5fb25ae">&#9670;&#160;</a></span>IndexGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a> <a class="el" href="mesh_8h.html#a27e3f4efb19b3f2b0694e0bee5fb25ae">IndexGrid</a> =  <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>, 2&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00047">47</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="afb738e18bf395ef0903c8c5d6f37c47f" name="afb738e18bf395ef0903c8c5d6f37c47f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb738e18bf395ef0903c8c5d6f37c47f">&#9670;&#160;</a></span>MaskGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a> <a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> =  <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">int</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D boolean grids for masking operations. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00045">45</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="ae7ec6be5d638ad03ae6697ff2b71ef91" name="ae7ec6be5d638ad03ae6697ff2b71ef91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ec6be5d638ad03ae6697ff2b71ef91">&#9670;&#160;</a></span>MeshGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a> <a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> =  <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 2&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 2D grids (e.g., spatial coordinates) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00041">41</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="a6b76cc05bedc7fd9499c0bd3eec3bcb5" name="a6b76cc05bedc7fd9499c0bd3eec3bcb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b76cc05bedc7fd9499c0bd3eec3bcb5">&#9670;&#160;</a></span>MeshGrid3d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a> <a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a> =  <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D grids (e.g., full spatial-temporal data) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00043">43</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae2e78f3cf4aabf7985519d581ce43182" name="ae2e78f3cf4aabf7985519d581ce43182"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e78f3cf4aabf7985519d581ce43182">&#9670;&#160;</a></span>adaptive_grid_with_breaks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a> adaptive_grid_with_breaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::span</a>&lt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td>
          <td class="paramname"><em>breaks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::span</a>&lt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td>
          <td class="paramname"><em>break_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>pts_per_decade</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>&#160;</td>
          <td class="paramname"><em>max_refined_breaks</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_radius_decades</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_factor</em> = <code>3.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Builds an adaptive log-spaced grid with explicit break points. </p>
<p>Places grid points at endpoints and break frequencies, then fills segments between with approximately <code>pts_per_decade</code> log-spaced points. Points closer than <code>min_sep</code> decades (log10) are merged.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lg2_min</td><td>Log2 of minimum grid value </td></tr>
    <tr><td class="paramname">lg2_max</td><td>Log2 of maximum grid value </td></tr>
    <tr><td class="paramname">breaks</td><td>Break frequencies (linear scale) to include </td></tr>
    <tr><td class="paramname">pts_per_decade</td><td>Base density of fill points per decade </td></tr>
    <tr><td class="paramname">grid</td><td>Output array of grid point values (resized internally) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of grid points </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00288">288</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  291</span>                                                                  {</div>
<div class="line"><span class="lineno">  292</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">MAX_PTS</a> = 256;</div>
<div class="line"><span class="lineno">  293</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_per_decade</a> = 3.321928094887362; <span class="comment">// log2(10)</span></div>
<div class="line"><span class="lineno">  294</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_radius</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_radius_decades</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_per_decade</a>;</div>
<div class="line"><span class="lineno">  295</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coarse_step</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_per_decade</a> / std::max(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts_per_decade</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>(1e-6));</div>
<div class="line"><span class="lineno">  296</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">fine_step</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coarse_step</a> / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_factor</a>;</div>
<div class="line"><span class="lineno">  297</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merge_eps</a> = 0.5 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">fine_step</a>;</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <span class="comment">// Collect valid breaks within range with weights</span></div>
<div class="line"><span class="lineno">  300</span>    <span class="keyword">struct </span><a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Break</a> {</div>
<div class="line"><span class="lineno">  301</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2</a>;</div>
<div class="line"><span class="lineno">  302</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">weight</a>;</div>
<div class="line"><span class="lineno">  303</span>    };</div>
<div class="line"><span class="lineno">  304</span>    std::vector&lt;Break&gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">valid_breaks</a>;</div>
<div class="line"><span class="lineno">  305</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">valid_breaks</a>.reserve(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">breaks</a>.size());</div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">breaks</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  307</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">breaks</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>];</div>
<div class="line"><span class="lineno">  308</span>        <span class="keywordflow">if</span> (!(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a> &gt; 0) || !std::isfinite(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>)) {</div>
<div class="line"><span class="lineno">  309</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  310</span>        }</div>
<div class="line"><span class="lineno">  311</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_b</a> = std::log2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>);</div>
<div class="line"><span class="lineno">  312</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_b</a> &gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a> &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_b</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>) {</div>
<div class="line"><span class="lineno">  313</span>            <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">w</a> = 1;</div>
<div class="line"><span class="lineno">  314</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">break_weights</a>.size()) {</div>
<div class="line"><span class="lineno">  315</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">wi</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">break_weights</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>];</div>
<div class="line"><span class="lineno">  316</span>                <span class="keywordflow">if</span> (std::isfinite(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">wi</a>) &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">wi</a> &gt;= 0) {</div>
<div class="line"><span class="lineno">  317</span>                    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">w</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">wi</a>;</div>
<div class="line"><span class="lineno">  318</span>                }</div>
<div class="line"><span class="lineno">  319</span>            }</div>
<div class="line"><span class="lineno">  320</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">valid_breaks</a>.push_back({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_b</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">w</a>});</div>
<div class="line"><span class="lineno">  321</span>        }</div>
<div class="line"><span class="lineno">  322</span>    }</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    <span class="comment">// Sort by weight descending; top N get refinement</span></div>
<div class="line"><span class="lineno">  325</span>    std::ranges::sort(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">valid_breaks</a>, [](<span class="keyword">auto</span>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">a</a>, <span class="keyword">auto</span>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>) { <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">a</a>.weight &gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>.weight; });</div>
<div class="line"><span class="lineno">  326</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_refine</a> = std::min(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max_refined_breaks</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">valid_breaks</a>.size());</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    <span class="comment">// Build grid points with break tracking for merge protection</span></div>
<div class="line"><span class="lineno">  329</span>    <span class="keyword">struct </span><a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Pt</a> {</div>
<div class="line"><span class="lineno">  330</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2</a>;</div>
<div class="line"><span class="lineno">  331</span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">is_break</a>;</div>
<div class="line"><span class="lineno">  332</span>    };</div>
<div class="line"><span class="lineno">  333</span>    std::vector&lt;Pt&gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts</a>;</div>
<div class="line"><span class="lineno">  334</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts</a>.reserve(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">MAX_PTS</a> * 2);</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    <span class="comment">// Coarse uniform grid</span></div>
<div class="line"><span class="lineno">  337</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">span</a> = std::max(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>(0));</div>
<div class="line"><span class="lineno">  338</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_coarse</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">span</a> &gt; 0 &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coarse_step</a> &gt; 0)</div>
<div class="line"><span class="lineno">  339</span>                                ? std::max&lt;size_t&gt;(1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::ceil(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">span</a> / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coarse_step</a>)))</div>
<div class="line"><span class="lineno">  340</span>                                : <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>(1);</div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_coarse</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  342</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts</a>.push_back({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">span</a> * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_coarse</a>), <span class="keyword">false</span>});</div>
<div class="line"><span class="lineno">  343</span>    }</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="comment">// Break anchors</span></div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">br</a> : <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">valid_breaks</a>) {</div>
<div class="line"><span class="lineno">  347</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts</a>.push_back({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">br</a>.lg2, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  348</span>    }</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>    <span class="comment">// Refinement around top-weighted breaks</span></div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_refine</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  352</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lo</a> = std::max(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">valid_breaks</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>].<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_radius</a>);</div>
<div class="line"><span class="lineno">  353</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">hi</a> = std::min(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">valid_breaks</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>].<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_radius</a>);</div>
<div class="line"><span class="lineno">  354</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">hi</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lo</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">fine_step</a>));</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt;= n; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  356</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts</a>.push_back({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lo</a> + (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">hi</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lo</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(n), <span class="keyword">false</span>});</div>
<div class="line"><span class="lineno">  357</span>        }</div>
<div class="line"><span class="lineno">  358</span>    }</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>    <span class="comment">// Sort and merge close points, protecting break positions</span></div>
<div class="line"><span class="lineno">  361</span>    std::ranges::sort(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts</a>, [](<span class="keyword">auto</span>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">a</a>, <span class="keyword">auto</span>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>) { <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">a</a>.lg2 &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>.lg2; });</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    std::vector&lt;Pt&gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>;</div>
<div class="line"><span class="lineno">  364</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.reserve(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts</a>.size());</div>
<div class="line"><span class="lineno">  365</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; p : <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pts</a>) {</div>
<div class="line"><span class="lineno">  366</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.empty() &amp;&amp; p.lg2 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.back().lg2 &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merge_eps</a>) {</div>
<div class="line"><span class="lineno">  367</span>            <span class="keywordflow">if</span> (p.is_break &amp;&amp; !<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.back().is_break) {</div>
<div class="line"><span class="lineno">  368</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.back() = p;</div>
<div class="line"><span class="lineno">  369</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  370</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.back().is_break = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.back().is_break || p.is_break;</div>
<div class="line"><span class="lineno">  371</span>            }</div>
<div class="line"><span class="lineno">  372</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  373</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.push_back(p);</div>
<div class="line"><span class="lineno">  374</span>        }</div>
<div class="line"><span class="lineno">  375</span>    }</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>    <span class="comment">// Ensure endpoints</span></div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.empty()) {</div>
<div class="line"><span class="lineno">  379</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.push_back({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  380</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.push_back({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  381</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  382</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.front().lg2 = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>;</div>
<div class="line"><span class="lineno">  383</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.size() == 1) {</div>
<div class="line"><span class="lineno">  384</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.push_back({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  385</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  386</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.back().lg2 = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>;</div>
<div class="line"><span class="lineno">  387</span>        }</div>
<div class="line"><span class="lineno">  388</span>    }</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="comment">// Hard cap with uniform subsampling</span></div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.size() &gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">MAX_PTS</a>) {</div>
<div class="line"><span class="lineno">  392</span>        std::vector&lt;Pt&gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">capped</a>;</div>
<div class="line"><span class="lineno">  393</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">capped</a>.reserve(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">MAX_PTS</a>);</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">MAX_PTS</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  395</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">capped</a>.push_back(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.size() - 1) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">MAX_PTS</a> - 1)]);</div>
<div class="line"><span class="lineno">  396</span>        }</div>
<div class="line"><span class="lineno">  397</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.swap(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">capped</a>);</div>
<div class="line"><span class="lineno">  398</span>    }</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    grid = Array::from_shape({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.size()});</div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  402</span>        grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) = std::exp2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>].<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2</a>);</div>
<div class="line"><span class="lineno">  403</span>    }</div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">merged</a>.size();</div>
<div class="line"><span class="lineno">  405</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00023">macros.h:23</a></div></div>
<div class="ttc" id="autilities_8h_html_ab8e81118f023df135835db8cce4f5f42"><div class="ttname"><a href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a></div><div class="ttdeci">T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00206">utilities.h:206</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph.png" border="0" usemap="#amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph" alt=""/></div>
<map name="amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph" id="amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph">
<area shape="rect" title="Builds an adaptive log&#45;spaced grid with explicit break points." alt="" coords="5,22,152,62"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="200,29,251,55"/>
<area shape="poly" title=" " alt="" coords="152,39,186,39,186,45,152,45"/>
<area shape="poly" title=" " alt="" coords="200,31,195,21,198,11,208,5,225,3,246,6,254,15,251,18,243,11,225,8,210,10,202,15,201,20,205,28"/>
</map>
</div>

</div>
</div>
<a id="a83ae490737edde6ad03ede25e371a071" name="a83ae490737edde6ad03ede25e371a071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83ae490737edde6ad03ede25e371a071">&#9670;&#160;</a></span>adaptive_phi_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> adaptive_phi_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>&#160;</td>
          <td class="paramname"><em>phi_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00575">575</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  575</span>                                                                                                               {</div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">if</span> ((theta_v == 0 &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">is_axisymmetric</a>) || theta_v &gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>) {</div>
<div class="line"><span class="lineno">  577</span>        <span class="keywordflow">return</span> xt::linspace(0., 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">phi_num</a>);</div>
<div class="line"><span class="lineno">  578</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  579</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cos_tv</a> = std::cos(theta_v);</div>
<div class="line"><span class="lineno">  580</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">sin_tv</a> = std::sin(theta_v);</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>        <span class="comment">// Sample a few theta values to find the peak Doppler weight at each phi</span></div>
<div class="line"><span class="lineno">  583</span>        <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_theta_sample</a> = 8;</div>
<div class="line"><span class="lineno">  584</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>        <span class="keyword">auto</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eqn</a> = [=, &amp;jet](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi) {</div>
<div class="line"><span class="lineno">  587</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cos_phi</a> = std::cos(phi);</div>
<div class="line"><span class="lineno">  588</span>            <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max_weight</a> = 0;</div>
<div class="line"><span class="lineno">  589</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">it</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">it</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_theta_sample</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">it</a>) {</div>
<div class="line"><span class="lineno">  590</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> + (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">it</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_theta_sample</a> - 1);</div>
<div class="line"><span class="lineno">  591</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma = jet.Gamma0(phi, theta);</div>
<div class="line"><span class="lineno">  592</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a> = std::sqrt(std::fabs(Gamma * Gamma - 1)) / Gamma;</div>
<div class="line"><span class="lineno">  593</span>                <span class="comment">// cos(angle to LOS) = cos(theta)cos(theta_v) + sin(theta)sin(theta_v)cos(phi)</span></div>
<div class="line"><span class="lineno">  594</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cos_alpha</a> = std::cos(theta) * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cos_tv</a> + std::sin(theta) * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">sin_tv</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cos_phi</a>;</div>
<div class="line"><span class="lineno">  595</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">a</a> = (1 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a>) / (1 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cos_alpha</a>);</div>
<div class="line"><span class="lineno">  596</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">weight</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">a</a> * Gamma * std::sqrt((Gamma - 1) * Gamma) * std::sin(theta);</div>
<div class="line"><span class="lineno">  597</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max_weight</a> = std::max(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max_weight</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">weight</a>);</div>
<div class="line"><span class="lineno">  598</span>            }</div>
<div class="line"><span class="lineno">  599</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pdf</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max_weight</a>;</div>
<div class="line"><span class="lineno">  600</span>        };</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eqn</a>, 0, 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">phi_num</a>);</div>
<div class="line"><span class="lineno">  603</span>    }</div>
<div class="line"><span class="lineno">  604</span>}</div>
<div class="ttc" id="amesh_8h_html_a49c59d8da915e118c4e550cc9bd4d3d9"><div class="ttname"><a href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a></div><div class="ttdeci">Array inverse_CFD_sampling(Func &amp;&amp;pdf, Real min, Real max, size_t num)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00495">mesh.h:495</a></div></div>
<div class="ttc" id="anamespacecon_html_aa0ccd904b754d0f907898a942516d121"><div class="ttname"><a href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a></div><div class="ttdeci">constexpr Real pi</div><div class="ttdoc">Pi.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00096">macros.h:96</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1grid_html_af2b7c5de15cb9c537f0de0e0e56148b1"><div class="ttname"><a href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a></div><div class="ttdeci">constexpr double theta_min</div><div class="ttdoc">Minimum polar angle (avoids singularity at theta=0)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00078">simulation-defaults.h:78</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph.png" border="0" usemap="#amesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph" alt=""/></div>
<map name="amesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph" id="amesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,144,80"/>
<area shape="rect" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9" title=" " alt="" coords="192,29,363,55"/>
<area shape="poly" title=" " alt="" coords="144,56,178,52,179,57,145,61"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="505,29,556,55"/>
<area shape="poly" title=" " alt="" coords="144,72,289,77,373,74,457,65,492,55,493,60,458,70,374,80,289,83,144,77"/>
<area shape="poly" title=" " alt="" coords="321,27,385,15,422,13,458,15,493,25,492,30,457,21,421,18,386,20,321,32"/>
<area shape="rect" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1" title="Returns the value of a single parameter." alt="" coords="411,29,457,55"/>
<area shape="poly" title=" " alt="" coords="363,39,397,39,397,45,363,45"/>
<area shape="poly" title=" " alt="" coords="513,30,510,21,512,12,519,5,531,3,544,6,551,15,546,18,541,11,531,8,521,10,517,14,515,20,518,28"/>
<area shape="poly" title=" " alt="" coords="458,39,492,39,492,45,458,45"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph.png" border="0" usemap="#amesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph" alt=""/></div>
<map name="amesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph" id="amesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,913,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a3dc6828dd13a70c0c203dba03e765cea" name="a3dc6828dd13a70c0c203dba03e765cea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dc6828dd13a70c0c203dba03e765cea">&#9670;&#160;</a></span>adaptive_theta_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> adaptive_theta_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>&#160;</td>
          <td class="paramname"><em>theta_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00533">533</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  533</span>                                                                                                             {</div>
<div class="line"><span class="lineno">  534</span>    <span class="keyword">auto</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eqn</a> = [=, &amp;jet](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta) {</div>
<div class="line"><span class="lineno">  535</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma = jet.Gamma0(0, theta);</div>
<div class="line"><span class="lineno">  536</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a> = std::sqrt(std::fabs(Gamma * Gamma - 1)) / Gamma;</div>
<div class="line"><span class="lineno">  537</span>        <span class="comment">// Real D = 1 / (Gamma * (1 - beta * std::cos(theta - theta_v)));</span></div>
<div class="line"><span class="lineno">  538</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">a</a> = (1 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a>) / (1 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a> * std::cos(theta - theta_v));</div>
<div class="line"><span class="lineno">  539</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pdf</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">a</a> * Gamma * std::sqrt((Gamma - 1) * Gamma) * std::sin(theta);</div>
<div class="line"><span class="lineno">  540</span>        <span class="comment">// pdf = D * std::sin(theta);</span></div>
<div class="line"><span class="lineno">  541</span>    };</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eqn</a>, theta_min, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_num</a>);</div>
<div class="line"><span class="lineno">  544</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph.png" border="0" usemap="#amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph" alt=""/></div>
<map name="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph" id="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,157,80"/>
<area shape="rect" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9" title=" " alt="" coords="205,29,376,55"/>
<area shape="poly" title=" " alt="" coords="158,55,191,51,192,57,158,61"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="519,29,569,55"/>
<area shape="poly" title=" " alt="" coords="158,72,303,78,387,74,470,65,505,55,506,60,471,70,388,80,303,83,158,77"/>
<area shape="poly" title=" " alt="" coords="334,27,398,15,435,13,471,15,506,25,505,30,470,21,435,18,399,20,335,32"/>
<area shape="rect" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1" title="Returns the value of a single parameter." alt="" coords="424,29,471,55"/>
<area shape="poly" title=" " alt="" coords="376,39,410,39,410,45,376,45"/>
<area shape="poly" title=" " alt="" coords="527,30,523,21,525,12,532,5,544,3,558,6,564,15,560,18,555,11,544,8,535,10,530,14,529,20,532,28"/>
<area shape="poly" title=" " alt="" coords="471,39,505,39,505,45,471,45"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph.png" border="0" usemap="#amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph" alt=""/></div>
<map name="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph" id="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,927,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a96aa0a78a0de13a52955de3c2ce29ddd" name="a96aa0a78a0de13a52955de3c2ce29ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96aa0a78a0de13a52955de3c2ce29ddd">&#9670;&#160;</a></span>auto_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCoord.html">Coord</a> auto_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_view</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a81845ddcce8fb560efb401cdde437a16">defaults::grid::phi_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a372994c537be68d80989655f9b43c672">defaults::grid::theta_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#aa203749fa338e32e6c7a711c82846582">defaults::grid::time_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em> = <code><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">true</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi_view</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>&#160;</td>
          <td class="paramname"><em>min_theta_num</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a17f64e94f8f9cb660a1e9d80a2b1558c">defaults::grid::min_theta_points</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>fwd_ratio</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#ae654c737813ff06431141238b26e0a67">defaults::grid::forward_ratio</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a coordinate grid (<a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a>) for shock evolution. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">theta_cut</td><td>Maximum theta value to include </td></tr>
    <tr><td class="paramname">theta_view</td><td>Viewing angle </td></tr>
    <tr><td class="paramname">z</td><td>Redshift </td></tr>
    <tr><td class="paramname">phi_resol</td><td></td></tr>
    <tr><td class="paramname">theta_resol</td><td></td></tr>
    <tr><td class="paramname">t_resol</td><td></td></tr>
    <tr><td class="paramname">is_axisymmetric</td><td>Whether the jet is axisymmetric (default: true) </td></tr>
    <tr><td class="paramname">phi_view</td><td>Viewing angle (default: 0) </td></tr>
    <tr><td class="paramname">min_theta_num</td><td>Minimum number of theta grid points (default: 56) </td></tr>
    <tr><td class="paramname">fwd_ratio</td><td>Forward ratio for grid resolution (default: 0.3) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a> object with the constructed grid</dd></dl>
<p>The grid is based on the observation times (t_obs), maximum theta value (theta_cut), and specified numbers of grid points in phi, theta, and t. The radial grid is logarithmically spaced between t_min and t_max, and the theta grid is generated linearly. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00752">752</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  754</span>                                                      {</div>
<div class="line"><span class="lineno">  755</span>    <a class="code hl_class" href="classCoord.html">Coord</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>;</div>
<div class="line"><span class="lineno">  756</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.<a class="code hl_variable" href="classCoord.html#aeb5bef37e495fdeefad735154e99bf73">theta_view</a> = theta_view;</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">jet_edges</a> = <a class="code hl_function" href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf">find_jet_edges</a>(jet, <a class="code hl_variable" href="namespacecon.html#a9c6b1c9b349c790392fa370c8d9e13a8">con::Gamma_cut</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">is_axisymmetric</a>);</div>
<div class="line"><span class="lineno">  759</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">jet_edge</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">jet_edges</a>.empty() ? <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_cut</a> : <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">jet_edges</a>.back(); <span class="comment">// outermost edge (fallback if no edges)</span></div>
<div class="line"><span class="lineno">  760</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  761</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a> = std::min(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">jet_edge</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_cut</a>);</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_num</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">min_theta_num</a> + <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) * 180 / <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> * theta_resol);</div>
<div class="line"><span class="lineno">  764</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">uniform_theta_num</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_num</a>) * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">fwd_ratio</a>);</div>
<div class="line"><span class="lineno">  765</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">adaptive_theta_num</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_num</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">uniform_theta_num</a>;</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">uniform_theta</a> = xt::linspace(theta_min, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">uniform_theta_num</a>);</div>
<div class="line"><span class="lineno">  768</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">adaptive_theta</a> = <a class="code hl_function" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a>(jet, theta_min, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">adaptive_theta_num</a>, theta_view);</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">avg_spacing</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_num</a>;</div>
<div class="line"><span class="lineno">  771</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edge_theta</a> = <a class="code hl_function" href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443">edge_refinement_grid</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">jet_edges</a>, theta_min, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">avg_spacing</a>, theta_resol);</div>
<div class="line"><span class="lineno">  772</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.theta = <a class="code hl_function" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a>(<a class="code hl_function" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">uniform_theta</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">adaptive_theta</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edge_theta</a>);</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>    <span class="comment">// coord.theta = uniform_theta;</span></div>
<div class="line"><span class="lineno">  775</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">phi_num</a> = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(360 * phi_resol), 1);</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.phi = <a class="code hl_function" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071">adaptive_phi_grid</a>(jet, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">phi_num</a>, theta_view, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">is_axisymmetric</a>);</div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span>    <span class="keywordflow">if</span> (t_obs.size() == 0) {</div>
<div class="line"><span class="lineno">  780</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">assert</a>(<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;auto_grid: t_obs is empty&quot;</span>);</div>
<div class="line"><span class="lineno">  781</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>;</div>
<div class="line"><span class="lineno">  782</span>    }</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_max = *std::ranges::max_element(t_obs);</div>
<div class="line"><span class="lineno">  785</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_min = *std::ranges::min_element(t_obs);</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    <span class="comment">// Compute base time grid size + extra points for refinement around t_dec</span></div>
<div class="line"><span class="lineno">  788</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">base_t_num</a> = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::log10(t_max / t_min) * t_resol), 24);</div>
<div class="line"><span class="lineno">  789</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_ratio</a> = 2.0;</div>
<div class="line"><span class="lineno">  790</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_lo_factor</a> = 0.3;</div>
<div class="line"><span class="lineno">  791</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_hi_factor</a> = 10.0;</div>
<div class="line"><span class="lineno">  792</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_extra</a> =</div>
<div class="line"><span class="lineno">  793</span>        <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_ratio</a> - 1.0) * t_resol * std::log10(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_hi_factor</a> / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_lo_factor</a>));</div>
<div class="line"><span class="lineno">  794</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_num</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">base_t_num</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_extra</a>;</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.theta.size();</div>
<div class="line"><span class="lineno">  797</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">phi_size_needed</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">is_axisymmetric</a> ? 1 : <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.phi.size();</div>
<div class="line"><span class="lineno">  798</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_v_max</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.theta.back() + theta_view;</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.t = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">phi_size_needed</a>, theta_size, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_num</a>});</div>
<div class="line"><span class="lineno">  801</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">phi_size_needed</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  802</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  803</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a> = <a class="code hl_function" href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa">physics::relativistic::gamma_to_beta</a>(jet.Gamma0(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.phi(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.theta(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>)));</div>
<div class="line"><span class="lineno">  804</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_start</a> =</div>
<div class="line"><span class="lineno">  805</span>                std::max&lt;Real&gt;(0.99 * t_min * (1 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>) / (1 - std::cos(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_v_max</a>) * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>) / (1 + z), 1e-2 * <a class="code hl_variable" href="namespaceunit.html#a4e7c438655d3f34c7c30a155ec38f250">unit::sec</a>);</div>
<div class="line"><span class="lineno">  806</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_end</a> = 1.01 * t_max / (1 + z);</div>
<div class="line"><span class="lineno">  807</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_dec</a> = <a class="code hl_function" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a>(jet, medium, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.phi(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.theta(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>));</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>            xt::view(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>.t, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, xt::all()) =</div>
<div class="line"><span class="lineno">  810</span>                <a class="code hl_function" href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2">refined_time_grid</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_start</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_end</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_dec</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_num</a>, t_resol, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_lo_factor</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_hi_factor</a>);</div>
<div class="line"><span class="lineno">  811</span>        }</div>
<div class="line"><span class="lineno">  812</span>    }</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>;</div>
<div class="line"><span class="lineno">  815</span>}</div>
<div class="ttc" id="aclassCoord_html"><div class="ttname"><a href="classCoord.html">Coord</a></div><div class="ttdoc">Represents a coordinate system with arrays for phi, theta, and t.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00058">mesh.h:58</a></div></div>
<div class="ttc" id="aclassCoord_html_aeb5bef37e495fdeefad735154e99bf73"><div class="ttname"><a href="classCoord.html#aeb5bef37e495fdeefad735154e99bf73">Coord::theta_view</a></div><div class="ttdeci">Real theta_view</div><div class="ttdoc">Viewing angle.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00066">mesh.h:66</a></div></div>
<div class="ttc" id="amesh_8h_html_a28ba8f4400237a97c0d2fac934fb44cf"><div class="ttname"><a href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf">find_jet_edges</a></div><div class="ttdeci">std::vector&lt; Real &gt; find_jet_edges(Ejecta const &amp;jet, Real gamma_cut, bool is_axisymmetric)</div><div class="ttdoc">Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00408">mesh.h:408</a></div></div>
<div class="ttc" id="amesh_8h_html_a3c066f2c8e6d102d7a56de8cb42cf5a8"><div class="ttname"><a href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a></div><div class="ttdeci">Array merge_grids(Arr const &amp;arr1, Arr const &amp;arr2)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00607">mesh.h:607</a></div></div>
<div class="ttc" id="amesh_8h_html_a3dc6828dd13a70c0c203dba03e765cea"><div class="ttname"><a href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a></div><div class="ttdeci">Array adaptive_theta_grid(Ejecta const &amp;jet, Real theta_min, Real theta_max, size_t theta_num, Real theta_v)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00533">mesh.h:533</a></div></div>
<div class="ttc" id="amesh_8h_html_a83ae490737edde6ad03ede25e371a071"><div class="ttname"><a href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071">adaptive_phi_grid</a></div><div class="ttdeci">Array adaptive_phi_grid(Ejecta const &amp;jet, size_t phi_num, Real theta_v, Real theta_max, bool is_axisymmetric)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00575">mesh.h:575</a></div></div>
<div class="ttc" id="amesh_8h_html_a9cba2da30fd9821858dc89b5caea3443"><div class="ttname"><a href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443">edge_refinement_grid</a></div><div class="ttdeci">Array edge_refinement_grid(std::vector&lt; Real &gt; const &amp;jet_edges, Real theta_min, Real theta_max, Real avg_spacing, Real theta_resol)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00546">mesh.h:546</a></div></div>
<div class="ttc" id="amesh_8h_html_aa7505ad2e84c2a29610c1a13cd3b25e3"><div class="ttname"><a href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a></div><div class="ttdeci">Real estimate_t_dec(Ejecta const &amp;jet, Medium const &amp;medium, Real phi, Real theta)</div><div class="ttdoc">Estimates deceleration time for a given angle from ejecta and medium properties.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00641">mesh.h:641</a></div></div>
<div class="ttc" id="amesh_8h_html_ab2b9eccaf75f7a9fe6bafd8696049bd2"><div class="ttname"><a href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2">refined_time_grid</a></div><div class="ttdeci">Array refined_time_grid(Real t_start, Real t_end, Real t_refine, size_t t_num, Real t_resol, Real refine_lo_factor=0.3, Real refine_hi_factor=10.0)</div><div class="ttdoc">Create a refined logarithmic time grid with higher density around a specified time.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00696">mesh.h:696</a></div></div>
<div class="ttc" id="amesh_8h_html_afd05120c4d579ec7fa4906f677781a83"><div class="ttname"><a href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a></div><div class="ttdeci">xt::xtensor&lt; Real, 1 &gt; Array</div><div class="ttdoc">Type alias for 1D arrays (e.g., time points)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00039">mesh.h:39</a></div></div>
<div class="ttc" id="anamespacecon_html_a9c6b1c9b349c790392fa370c8d9e13a8"><div class="ttname"><a href="namespacecon.html#a9c6b1c9b349c790392fa370c8d9e13a8">con::Gamma_cut</a></div><div class="ttdeci">constexpr Real Gamma_cut</div><div class="ttdoc">Cutoff Lorentz factor value.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00101">macros.h:101</a></div></div>
<div class="ttc" id="anamespacephysics_1_1relativistic_html_ab1c1444afa3c4afd0c57145f932962fa"><div class="ttname"><a href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa">physics::relativistic::gamma_to_beta</a></div><div class="ttdeci">Real gamma_to_beta(Real gamma)</div><div class="ttdoc">Converts Lorentz factor (gamma) to a velocity fraction (beta)</div><div class="ttdef"><b>Definition</b> <a href="physics_8h_source.html#l00036">physics.h:36</a></div></div>
<div class="ttc" id="anamespaceunit_html_a4e7c438655d3f34c7c30a155ec38f250"><div class="ttname"><a href="namespaceunit.html#a4e7c438655d3f34c7c30a155ec38f250">unit::sec</a></div><div class="ttdeci">constexpr Real sec</div><div class="ttdoc">Second in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00045">macros.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph.png" border="0" usemap="#amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph" alt=""/></div>
<map name="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph" id="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph">
<area shape="rect" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="5,312,88,338"/>
<area shape="rect" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071" title=" " alt="" coords="143,158,281,183"/>
<area shape="poly" title=" " alt="" coords="51,311,81,255,105,222,134,193,145,187,148,191,138,198,109,226,85,258,56,313"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="767,259,817,284"/>
<area shape="poly" title=" " alt="" coords="48,311,58,278,74,233,100,185,134,143,182,105,226,85,275,74,335,62,446,32,537,7,581,3,625,7,671,24,720,53,741,73,758,96,780,148,790,201,794,245,788,245,785,202,775,150,753,98,737,76,717,58,668,28,623,13,581,8,538,12,447,37,337,67,276,79,228,91,185,110,138,147,104,188,79,236,63,280,53,313"/>
<area shape="rect" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea" title=" " alt="" coords="136,208,288,234"/>
<area shape="poly" title=" " alt="" coords="60,310,92,281,135,251,162,237,164,241,137,255,96,285,63,314"/>
<area shape="rect" href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443" title=" " alt="" coords="555,259,719,284"/>
<area shape="poly" title=" " alt="" coords="85,310,136,297,244,282,352,274,540,268,541,273,353,279,244,288,136,302,86,315"/>
<area shape="rect" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="151,312,273,338"/>
<area shape="poly" title=" " alt="" coords="88,322,137,322,137,328,88,328"/>
<area shape="rect" href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa" title="Converts Lorentz factor (gamma) to a velocity fraction (beta)" alt="" coords="347,360,495,400"/>
<area shape="poly" title=" " alt="" coords="89,335,137,346,239,362,334,371,333,376,238,367,135,352,88,340"/>
<area shape="rect" href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="363,424,479,450"/>
<area shape="poly" title=" " alt="" coords="68,335,99,355,137,373,191,391,248,406,350,425,349,430,246,411,190,396,135,378,97,360,65,340"/>
<area shape="rect" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8" title=" " alt="" coords="585,468,688,494"/>
<area shape="poly" title=" " alt="" coords="58,336,89,378,111,401,137,420,192,446,250,464,309,477,369,485,481,490,572,486,572,491,481,495,369,491,308,483,248,470,190,451,135,425,108,405,85,382,53,339"/>
<area shape="rect" href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="353,526,489,551"/>
<area shape="poly" title=" " alt="" coords="53,337,60,372,75,418,101,466,117,487,137,504,185,528,237,542,290,547,339,546,339,551,290,552,236,547,183,533,135,508,114,490,96,468,71,420,55,373,47,338"/>
<area shape="rect" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9" title=" " alt="" coords="336,158,507,183"/>
<area shape="poly" title=" " alt="" coords="282,168,322,168,322,173,282,173"/>
<area shape="poly" title=" " alt="" coords="234,155,318,112,378,88,444,67,515,53,587,50,622,54,656,62,689,74,720,92,738,107,753,125,774,166,786,209,791,245,786,246,780,210,769,168,748,128,734,111,717,96,687,79,655,67,621,59,586,56,516,59,446,72,380,93,321,117,236,160"/>
<area shape="poly" title=" " alt="" coords="507,162,557,164,611,169,667,181,720,200,751,221,775,246,771,250,748,225,717,205,665,186,610,175,556,169,507,168"/>
<area shape="rect" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1" title="Returns the value of a single parameter." alt="" coords="613,107,660,132"/>
<area shape="poly" title=" " alt="" coords="476,155,599,125,601,131,477,160"/>
<area shape="poly" title=" " alt="" coords="766,260,760,251,763,241,774,234,792,232,813,236,822,244,819,248,811,241,792,238,776,240,768,244,766,250,770,257"/>
<area shape="poly" title=" " alt="" coords="661,122,691,132,720,149,742,172,759,197,784,245,779,248,755,200,738,175,717,154,689,137,659,127"/>
<area shape="poly" title=" " alt="" coords="265,206,354,184,356,189,266,211"/>
<area shape="poly" title=" " alt="" coords="288,215,376,215,484,217,602,226,719,244,754,254,753,259,718,249,602,232,484,223,376,220,288,221"/>
<area shape="poly" title=" " alt="" coords="719,269,753,269,753,274,719,274"/>
<area shape="poly" title=" " alt="" coords="273,324,361,324,472,320,595,311,718,293,753,283,754,289,719,298,596,316,473,326,361,329,273,329"/>
<area shape="poly" title=" " alt="" coords="262,335,335,354,333,359,261,340"/>
<area shape="poly" title=" " alt="" coords="496,380,547,378,604,372,662,359,717,339,747,318,771,293,775,297,751,322,720,343,664,364,604,377,547,383,496,385"/>
<area shape="poly" title=" " alt="" coords="479,438,533,436,595,429,659,413,689,400,717,384,739,365,756,342,779,296,784,298,760,345,742,369,720,388,691,405,661,418,596,434,534,442,480,443"/>
<area shape="poly" title=" " alt="" coords="685,466,702,457,717,446,744,410,763,370,776,330,784,297,789,298,781,332,768,372,748,413,721,449,705,462,687,471"/>
<area shape="poly" title=" " alt="" coords="490,548,544,552,604,548,664,534,692,521,717,504,738,483,754,457,767,429,776,400,786,343,789,298,794,298,791,344,781,401,772,431,759,460,742,486,720,508,695,526,666,539,605,554,544,557,489,553"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph.png" border="0" usemap="#amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph" alt=""/></div>
<map name="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph" id="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph">
<area shape="rect" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a885b165e8d9c9d20f27ec99329a0c3cb" name="a885b165e8d9c9d20f27ec99329a0c3cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a885b165e8d9c9d20f27ec99329a0c3cb">&#9670;&#160;</a></span>boundary_to_center() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr1</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr2</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> boundary_to_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr1</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr2</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using linear interpolation. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Arr1</td><td>Type of the input array </td></tr>
    <tr><td class="paramname">Arr2</td><td>Type of the output array </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
    <tr><td class="paramname">center</td><td>Output array of center values</td></tr>
  </table>
  </dd>
</dl>
<p>This is used to compute cell-centered values from cell-boundary values. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00206">206</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  206</span>                                                            {</div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>.size() &lt; 2 || <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>.size() + 1 != <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>.size()) {</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  209</span>    }</div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  211</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] = 0.5 * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> + 1]);</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1622b29b5488dbee3ef9068b9f8c7d4" name="ae1622b29b5488dbee3ef9068b9f8c7d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1622b29b5488dbee3ef9068b9f8c7d4">&#9670;&#160;</a></span>boundary_to_center() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> boundary_to_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using linear interpolation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of center values </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00038">38</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>                                                {</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>.size() &lt; 2) {</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">return</span> Array::from_shape({0});</div>
<div class="line"><span class="lineno">   41</span>    }</div>
<div class="line"><span class="lineno">   42</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>.size() - 1}, 0);</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">   44</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] = 0.5 * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> + 1]);</div>
<div class="line"><span class="lineno">   45</span>    }</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>;</div>
<div class="line"><span class="lineno">   47</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba66986baad5475a202c20a92bda036e" name="aba66986baad5475a202c20a92bda036e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba66986baad5475a202c20a92bda036e">&#9670;&#160;</a></span>boundary_to_center_log() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr1</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr2</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> boundary_to_center_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr1</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr2</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using geometric mean (logarithmic interpolation) </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Arr1</td><td>Type of the input array </td></tr>
    <tr><td class="paramname">Arr2</td><td>Type of the output array </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
    <tr><td class="paramname">center</td><td>Output array of center values</td></tr>
  </table>
  </dd>
</dl>
<p>This is used when working with logarithmically scaled quantities. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00216">216</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  216</span>                                                                {</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>.size() &lt; 2 || <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>.size() + 1 != <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>.size()) {</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  219</span>    }</div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  221</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] = std::sqrt(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> + 1]);</div>
<div class="line"><span class="lineno">  222</span>    }</div>
<div class="line"><span class="lineno">  223</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac536f77c32691232cb5e7546595fb3d2" name="ac536f77c32691232cb5e7546595fb3d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac536f77c32691232cb5e7546595fb3d2">&#9670;&#160;</a></span>boundary_to_center_log() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> boundary_to_center_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using geometric mean. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of center values </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00049">49</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>                                                    {</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>.size() &lt; 2) {</div>
<div class="line"><span class="lineno">   51</span>        <span class="keywordflow">return</span> Array::from_shape({0});</div>
<div class="line"><span class="lineno">   52</span>    }</div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>.size() - 1}, 0);</div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">   55</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] = std::sqrt(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundary</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> + 1]);</div>
<div class="line"><span class="lineno">   56</span>    }</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>;</div>
<div class="line"><span class="lineno">   58</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph.png" border="0" usemap="#amesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph" alt=""/></div>
<map name="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph" id="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph">
<area shape="rect" title="Converts boundary values to center values using geometric mean." alt="" coords="524,29,703,55"/>
<area shape="rect" href="classObserver.html#a2588a9ebaec5465d6b5bd08fadadcb99" title="Computes the integrated flux over a frequency band." alt="" coords="363,29,476,55"/>
<area shape="poly" title=" " alt="" coords="510,45,476,45,476,39,510,39"/>
<area shape="poly" title=" " alt="" coords="447,19,439,11,419,8,403,10,394,15,392,20,397,28,392,31,387,21,390,11,401,5,419,3,441,6,451,15"/>
<area shape="rect" href="classPyModel.html#a51390496a41c22c7c2dbb8838ac7a2d2" title="Calculate bolometric flux integrated over a frequency range." alt="" coords="204,29,315,55"/>
<area shape="poly" title=" " alt="" coords="349,45,315,45,315,39,349,39"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,29,156,55"/>
<area shape="poly" title=" " alt="" coords="190,45,156,45,156,39,190,39"/>
</map>
</div>

</div>
</div>
<a id="a9cba2da30fd9821858dc89b5caea3443" name="a9cba2da30fd9821858dc89b5caea3443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cba2da30fd9821858dc89b5caea3443">&#9670;&#160;</a></span>edge_refinement_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> edge_refinement_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>avg_spacing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_resol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00546">546</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  547</span>                                                    {</div>
<div class="line"><span class="lineno">  548</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>;</div>
<div class="line"><span class="lineno">  549</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>.reserve(150);</div>
<div class="line"><span class="lineno">  550</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edge</a> : <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">jet_edges</a>) {</div>
<div class="line"><span class="lineno">  551</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edge</a> &gt;= <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> / 2 - 0.01)</div>
<div class="line"><span class="lineno">  552</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  553</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">half</a> = 3 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">avg_spacing</a>;</div>
<div class="line"><span class="lineno">  554</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(10 * theta_resol), 2);</div>
<div class="line"><span class="lineno">  555</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 1; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt;= n; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  556</span>            <span class="comment">// Log-spaced offsets: denser near the edge</span></div>
<div class="line"><span class="lineno">  557</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">frac</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno">  558</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">offset</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">half</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">frac</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">frac</a>;</div>
<div class="line"><span class="lineno">  559</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">below</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edge</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">offset</a>;</div>
<div class="line"><span class="lineno">  560</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">above</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edge</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">offset</a>;</div>
<div class="line"><span class="lineno">  561</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">below</a> &gt;= theta_min)</div>
<div class="line"><span class="lineno">  562</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>.push_back(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">below</a>);</div>
<div class="line"><span class="lineno">  563</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">above</a> &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>)</div>
<div class="line"><span class="lineno">  564</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>.push_back(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">above</a>);</div>
<div class="line"><span class="lineno">  565</span>        }</div>
<div class="line"><span class="lineno">  566</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edge</a> &gt;= theta_min &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edge</a> &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>)</div>
<div class="line"><span class="lineno">  567</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>.push_back(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edge</a>);</div>
<div class="line"><span class="lineno">  568</span>    }</div>
<div class="line"><span class="lineno">  569</span>    std::ranges::sort(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>);</div>
<div class="line"><span class="lineno">  570</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>.erase(std::ranges::unique(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>).<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">begin</a>(), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>.end());</div>
<div class="line"><span class="lineno">  571</span>    <span class="keywordflow">return</span> xt::adapt(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>, {<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">points</a>.size()});</div>
<div class="line"><span class="lineno">  572</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph.png" border="0" usemap="#amesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph" alt=""/></div>
<map name="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph" id="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,169,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="217,29,268,55"/>
<area shape="poly" title=" " alt="" coords="169,39,204,39,204,45,169,45"/>
<area shape="poly" title=" " alt="" coords="217,31,211,21,214,11,225,5,243,3,264,6,273,15,269,19,262,11,243,8,227,10,218,15,216,20,221,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph.png" border="0" usemap="#amesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph" alt=""/></div>
<map name="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph" id="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,939,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="aa7505ad2e84c2a29610c1a13cd3b25e3" name="aa7505ad2e84c2a29610c1a13cd3b25e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7505ad2e84c2a29610c1a13cd3b25e3">&#9670;&#160;</a></span>estimate_t_dec()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> estimate_t_dec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimates deceleration time for a given angle from ejecta and medium properties. </p>
<p>Integrates swept mass outward until m_swept = m_jet/Gamma0. Returns lab-frame time. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00641">641</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  641</span>                                                                                   {</div>
<div class="line"><span class="lineno">  642</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">gamma</a> = jet.Gamma0(phi, theta);</div>
<div class="line"><span class="lineno">  643</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">gamma</a> &lt;= 1) {</div>
<div class="line"><span class="lineno">  644</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecon.html#ad61313f4a5b7876e54ae46d02d4a04bd">con::inf</a>;</div>
<div class="line"><span class="lineno">  645</span>    }</div>
<div class="line"><span class="lineno">  646</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a> = <a class="code hl_function" href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa">physics::relativistic::gamma_to_beta</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">gamma</a>);</div>
<div class="line"><span class="lineno">  647</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> m_jet = jet.eps_k(phi, theta) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">gamma</a> * <a class="code hl_variable" href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a>);</div>
<div class="line"><span class="lineno">  648</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">target</a> = m_jet / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">gamma</a>;</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">N</a> = 256;</div>
<div class="line"><span class="lineno">  651</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">u_min</a> = std::log(1e-3);</div>
<div class="line"><span class="lineno">  652</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">u_max</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">u_min</a> + 40 * std::log(10.0);</div>
<div class="line"><span class="lineno">  653</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">du</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">u_max</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">u_min</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">N</a>;</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> mass = 0;</div>
<div class="line"><span class="lineno">  656</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_prev</a> = std::exp(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">u_min</a>);</div>
<div class="line"><span class="lineno">  657</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">f_prev</a> = medium.rho(phi, theta, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_prev</a>) * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_prev</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_prev</a>;</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 1; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">N</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  660</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_i</a> = std::exp(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">u_min</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">du</a>);</div>
<div class="line"><span class="lineno">  661</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">f_i</a> = medium.rho(phi, theta, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_i</a>) * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_i</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_i</a>;</div>
<div class="line"><span class="lineno">  662</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dr</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_i</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_prev</a>;</div>
<div class="line"><span class="lineno">  663</span>        mass += 0.5 * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">f_prev</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">f_i</a>) * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dr</a>;</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>        <span class="keywordflow">if</span> (mass &gt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">target</a>) {</div>
<div class="line"><span class="lineno">  666</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_dec</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_prev</a> + (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">target</a> - (mass - 0.5 * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">f_prev</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">f_i</a>) * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dr</a>)) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">f_i</a>;</div>
<div class="line"><span class="lineno">  667</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_dec</a> * (1 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a>);</div>
<div class="line"><span class="lineno">  668</span>        }</div>
<div class="line"><span class="lineno">  669</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">f_prev</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">f_i</a>;</div>
<div class="line"><span class="lineno">  670</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_prev</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_i</a>;</div>
<div class="line"><span class="lineno">  671</span>    }</div>
<div class="line"><span class="lineno">  672</span>    <span class="keywordflow">return</span> std::exp(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">u_max</a>) * (1 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">beta</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a>);</div>
<div class="line"><span class="lineno">  673</span>}</div>
<div class="ttc" id="anamespacecon_html_a26ef2b83dd09c356e324bd243b498764"><div class="ttname"><a href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a></div><div class="ttdeci">constexpr Real c2</div><div class="ttdoc">Speed of light squared.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00087">macros.h:87</a></div></div>
<div class="ttc" id="anamespacecon_html_a2ff3edf57629ccb9a49d5bde7278a7c4"><div class="ttname"><a href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a></div><div class="ttdeci">constexpr Real c</div><div class="ttdoc">Speed of light (normalized to 1 in code units)</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00086">macros.h:86</a></div></div>
<div class="ttc" id="anamespacecon_html_ad61313f4a5b7876e54ae46d02d4a04bd"><div class="ttname"><a href="namespacecon.html#ad61313f4a5b7876e54ae46d02d4a04bd">con::inf</a></div><div class="ttdeci">constexpr Real inf</div><div class="ttdoc">Infinity value.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00102">macros.h:102</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph.png" border="0" usemap="#amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph" alt=""/></div>
<map name="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph" id="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph">
<area shape="rect" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="5,42,128,67"/>
<area shape="rect" href="namespacephysics_1_1relativistic.html#ab1c1444afa3c4afd0c57145f932962fa" title="Converts Lorentz factor (gamma) to a velocity fraction (beta)" alt="" coords="176,5,324,45"/>
<area shape="poly" title=" " alt="" coords="128,42,162,37,163,42,129,48"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="372,42,423,67"/>
<area shape="poly" title=" " alt="" coords="129,54,176,55,324,55,358,54,358,59,324,60,176,60,128,59"/>
<area shape="poly" title=" " alt="" coords="325,37,359,44,358,50,324,43"/>
<area shape="poly" title=" " alt="" coords="372,43,367,34,370,24,380,18,397,15,418,19,426,27,423,31,415,24,397,21,382,23,374,27,373,33,377,41"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph.png" border="0" usemap="#amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph" alt=""/></div>
<map name="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph" id="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph">
<area shape="rect" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="775,31,897,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a28ba8f4400237a97c0d2fac934fb44cf" name="a28ba8f4400237a97c0d2fac934fb44cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ba8f4400237a97c0d2fac934fb44cf">&#9670;&#160;</a></span>find_jet_edges()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; find_jet_edges </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">gamma_cut</td><td>Lorentz factor cutoff value </td></tr>
    <tr><td class="paramname">is_axisymmetric</td><td>Flag for axisymmetric jets </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Sorted vector of edge theta positions; last element is the outermost jet edge </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00408">408</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  408</span>                                                                                                         {</div>
<div class="line"><span class="lineno">  409</span>    <span class="comment">// Find all edges in the active jet region (Gamma0 &gt;= gamma_cut).</span></div>
<div class="line"><span class="lineno">  410</span>    <span class="comment">// Sharp edges: large fractional jumps (&gt; 50%) between adjacent scan points.</span></div>
<div class="line"><span class="lineno">  411</span>    <span class="comment">// Smooth jets: the outermost theta where Gamma0 crosses gamma_cut.</span></div>
<div class="line"><span class="lineno">  412</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_scan</a> = 512;</div>
<div class="line"><span class="lineno">  413</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eps</a> = <a class="code hl_variable" href="namespacedefaults_1_1solver.html#a29443c4987378f49066f9b406c391afc">defaults::solver::binary_search_eps</a>;</div>
<div class="line"><span class="lineno">  414</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_lo</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  415</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_hi</a> = <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> / 2;</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="keywordflow">if</span> (jet.Gamma0(0, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_hi</a>) &gt;= gamma_cut) {</div>
<div class="line"><span class="lineno">  418</span>        <span class="keywordflow">return</span> {<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_hi</a>};</div>
<div class="line"><span class="lineno">  419</span>    }</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edges</a>;</div>
<div class="line"><span class="lineno">  422</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edges</a>.reserve(100);</div>
<div class="line"><span class="lineno">  423</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">prev_th</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_lo</a>;</div>
<div class="line"><span class="lineno">  424</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">prev_G</a> = jet.Gamma0(0, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_lo</a>);</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 1; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_scan</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  427</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_th</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_lo</a> + (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_hi</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_lo</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_scan</a> - 1);</div>
<div class="line"><span class="lineno">  428</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_G</a> = jet.Gamma0(0, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_th</a>);</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">prev_G</a> &gt;= gamma_cut || <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_G</a> &gt;= gamma_cut) {</div>
<div class="line"><span class="lineno">  431</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dG</a> = std::abs(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_G</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">prev_G</a>);</div>
<div class="line"><span class="lineno">  432</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> scale = std::max(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">prev_G</a> - 1, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_G</a> - 1);</div>
<div class="line"><span class="lineno">  433</span>            <span class="keywordflow">if</span> (scale &gt; 0 &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dG</a> &gt; 0.5 * scale) {</div>
<div class="line"><span class="lineno">  434</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lo</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">prev_th</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">hi</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_th</a>;</div>
<div class="line"><span class="lineno">  435</span>                <span class="keywordflow">while</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">hi</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lo</a> &gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eps</a>) {</div>
<div class="line"><span class="lineno">  436</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">mid</a> = 0.5 * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lo</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">hi</a>);</div>
<div class="line"><span class="lineno">  437</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">G_mid</a> = jet.Gamma0(0, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">mid</a>);</div>
<div class="line"><span class="lineno">  438</span>                    <span class="keywordflow">if</span> (std::abs(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">G_mid</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">prev_G</a>) &lt; std::abs(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">G_mid</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_G</a>)) {</div>
<div class="line"><span class="lineno">  439</span>                        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lo</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">mid</a>;</div>
<div class="line"><span class="lineno">  440</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  441</span>                        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">hi</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">mid</a>;</div>
<div class="line"><span class="lineno">  442</span>                    }</div>
<div class="line"><span class="lineno">  443</span>                }</div>
<div class="line"><span class="lineno">  444</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edges</a>.push_back(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lo</a>);</div>
<div class="line"><span class="lineno">  445</span>            }</div>
<div class="line"><span class="lineno">  446</span>        }</div>
<div class="line"><span class="lineno">  447</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">prev_th</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_th</a>;</div>
<div class="line"><span class="lineno">  448</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">prev_G</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cur_G</a>;</div>
<div class="line"><span class="lineno">  449</span>    }</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <span class="comment">// Smooth jet: no sharp edges found  scan downward from pi/2 to find outermost Gamma0 &gt;= gamma_cut</span></div>
<div class="line"><span class="lineno">  452</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edges</a>.empty()) {</div>
<div class="line"><span class="lineno">  453</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">step</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_hi</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_lo</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n_scan</a>;</div>
<div class="line"><span class="lineno">  454</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_hi</a>; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th</a> &gt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_lo</a>; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th</a> -= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">step</a>) {</div>
<div class="line"><span class="lineno">  455</span>            <span class="keywordflow">if</span> (jet.Gamma0(0, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th</a>) &gt;= <a class="code hl_variable" href="namespacedefaults_1_1cutoffs.html#a6cda2def28c77f63dbee9eb169d9d87a">gamma_cut</a>) {</div>
<div class="line"><span class="lineno">  456</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edges</a>.push_back(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th</a>);</div>
<div class="line"><span class="lineno">  457</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  458</span>            }</div>
<div class="line"><span class="lineno">  459</span>        }</div>
<div class="line"><span class="lineno">  460</span>    }</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">edges</a>;</div>
<div class="line"><span class="lineno">  463</span>}</div>
<div class="ttc" id="anamespacedefaults_1_1cutoffs_html_a6cda2def28c77f63dbee9eb169d9d87a"><div class="ttname"><a href="namespacedefaults_1_1cutoffs.html#a6cda2def28c77f63dbee9eb169d9d87a">defaults::cutoffs::gamma_cut</a></div><div class="ttdeci">constexpr double gamma_cut</div><div class="ttdoc">Lorentz factor below which the flow is considered non-relativistic Used to terminate shock evolution ...</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00041">simulation-defaults.h:41</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1solver_html_a29443c4987378f49066f9b406c391afc"><div class="ttname"><a href="namespacedefaults_1_1solver.html#a29443c4987378f49066f9b406c391afc">defaults::solver::binary_search_eps</a></div><div class="ttdeci">constexpr double binary_search_eps</div><div class="ttdoc">Tolerance for binary search (jet edge finding)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00096">simulation-defaults.h:96</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph.png" border="0" usemap="#amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph" alt=""/></div>
<map name="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph" id="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph">
<area shape="rect" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="5,29,121,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="169,29,220,55"/>
<area shape="poly" title=" " alt="" coords="121,39,155,39,155,45,121,45"/>
<area shape="poly" title=" " alt="" coords="172,30,168,21,170,11,179,5,195,3,213,6,221,14,217,18,210,11,195,8,181,10,174,14,173,20,177,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph.png" border="0" usemap="#amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph" alt=""/></div>
<map name="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph" id="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph">
<area shape="rect" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="775,31,891,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a49c59d8da915e118c4e550cc9bd4d3d9" name="a49c59d8da915e118c4e550cc9bd4d3d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49c59d8da915e118c4e550cc9bd4d3d9">&#9670;&#160;</a></span>inverse_CFD_sampling()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Func</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> inverse_CFD_sampling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Func</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00495">495</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  495</span>                                                                       {</div>
<div class="line"><span class="lineno">  496</span>    <span class="keyword">using namespace </span>boost::numeric::odeint;</div>
<div class="line"><span class="lineno">  497</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> rtol = <a class="code hl_variable" href="namespacedefaults_1_1solver.html#a3469dc43cf2d60069d164931e7656d12">defaults::solver::ode_rtol</a>;</div>
<div class="line"><span class="lineno">  498</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">sample_num</a> = <a class="code hl_variable" href="namespacedefaults_1_1sampling.html#afb3d6cb58a2dc84e4f0a2ed64d7e1609">defaults::sampling::theta_samples</a>;</div>
<div class="line"><span class="lineno">  499</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_i</a> = xt::linspace(<a class="code hl_function" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">sample_num</a>);</div>
<div class="line"><span class="lineno">  500</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_i</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">sample_num</a>});</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>    <span class="keyword">auto</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">stepper</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">make_dense_output</a>(rtol, rtol, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">runge_kutta_dopri5&lt;Real&gt;</a>());</div>
<div class="line"><span class="lineno">  503</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">stepper</a>.initialize(0, <a class="code hl_function" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a>, (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a> - <a class="code hl_function" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a>) / 1e3);</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 1; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">stepper</a>.current_time() &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a>;) {</div>
<div class="line"><span class="lineno">  506</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">stepper</a>.do_step(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">pdf</a>);</div>
<div class="line"><span class="lineno">  507</span>        <span class="keywordflow">while</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_i</a>.size() &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">stepper</a>.current_time() &gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>)) {</div>
<div class="line"><span class="lineno">  508</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">stepper</a>.calc_state(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>));</div>
<div class="line"><span class="lineno">  509</span>            ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>;</div>
<div class="line"><span class="lineno">  510</span>        }</div>
<div class="line"><span class="lineno">  511</span>    }</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_out</a> = xt::linspace(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_i</a>.front(), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_i</a>.back(), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">num</a>);</div>
<div class="line"><span class="lineno">  514</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_out</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">num</a>});</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">num</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  517</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">sample_num</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  518</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_out</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>)) {</div>
<div class="line"><span class="lineno">  519</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> == 0) {</div>
<div class="line"><span class="lineno">  520</span>                    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_out</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>);</div>
<div class="line"><span class="lineno">  521</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  522</span>                    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> slope = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> - 1)) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> - 1));</div>
<div class="line"><span class="lineno">  523</span>                    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_out</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> - 1) + slope * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_out</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">CDF_i</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> - 1));</div>
<div class="line"><span class="lineno">  524</span>                }</div>
<div class="line"><span class="lineno">  525</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  526</span>            }</div>
<div class="line"><span class="lineno">  527</span>        }</div>
<div class="line"><span class="lineno">  528</span>    }</div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x_out</a>;</div>
<div class="line"><span class="lineno">  530</span>}</div>
<div class="ttc" id="anamespacedefaults_1_1sampling_html_afb3d6cb58a2dc84e4f0a2ed64d7e1609"><div class="ttname"><a href="namespacedefaults_1_1sampling.html#afb3d6cb58a2dc84e4f0a2ed64d7e1609">defaults::sampling::theta_samples</a></div><div class="ttdeci">constexpr std::size_t theta_samples</div><div class="ttdoc">Number of sample points for theta integration.</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00120">simulation-defaults.h:120</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1solver_html_a3469dc43cf2d60069d164931e7656d12"><div class="ttname"><a href="namespacedefaults_1_1solver.html#a3469dc43cf2d60069d164931e7656d12">defaults::solver::ode_rtol</a></div><div class="ttdeci">constexpr double ode_rtol</div><div class="ttdoc">Relative tolerance for ODE integration (Runge-Kutta)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00090">simulation-defaults.h:90</a></div></div>
<div class="ttc" id="autilities_8h_html_ac47d1412f3f1791737d0f963267096f1"><div class="ttname"><a href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1">min</a></div><div class="ttdeci">T min(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00178">utilities.h:178</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph.png" border="0" usemap="#amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph" alt=""/></div>
<map name="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph" id="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,176,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="319,29,369,55"/>
<area shape="poly" title=" " alt="" coords="176,39,305,39,305,45,176,45"/>
<area shape="rect" href="utilities_8h.html#ac47d1412f3f1791737d0f963267096f1" title="Returns the value of a single parameter." alt="" coords="224,55,271,80"/>
<area shape="poly" title=" " alt="" coords="170,52,211,59,210,64,169,57"/>
<area shape="poly" title=" " alt="" coords="327,30,323,21,325,12,332,5,344,3,358,6,364,15,360,18,355,11,344,8,335,10,330,14,329,20,332,28"/>
<area shape="poly" title=" " alt="" coords="270,59,305,49,306,55,272,64"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph.png" border="0" usemap="#amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph" alt=""/></div>
<map name="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph" id="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph">
<area shape="rect" title=" " alt="" coords="975,31,1145,56"/>
<area shape="rect" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071" title=" " alt="" coords="781,5,920,31"/>
<area shape="poly" title=" " alt="" coords="961,34,920,29,920,24,962,29"/>
<area shape="rect" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea" title=" " alt="" coords="775,55,927,80"/>
<area shape="poly" title=" " alt="" coords="961,57,927,61,926,56,961,52"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="768,33,727,40,727,34,767,28"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
<area shape="poly" title=" " alt="" coords="761,57,726,52,727,47,762,52"/>
</map>
</div>

</div>
</div>
<a id="aa5d127d3ecb19584c7f27ee212d49605" name="aa5d127d3ecb19584c7f27ee212d49605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d127d3ecb19584c7f27ee212d49605">&#9670;&#160;</a></span>is_linear_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a> is_linear_scale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code><a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if an array is linearly scaled within a given tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arr</td><td>The array to check </td></tr>
    <tr><td class="paramname">tolerance</td><td>Maximum allowed deviation from linearity (default: 1e-6) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the array is linearly scaled, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00012">12</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   12</span>                                                       {</div>
<div class="line"><span class="lineno">   13</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>.size() &lt; 2)</div>
<div class="line"><span class="lineno">   14</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// At least two elements are needed.</span></div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">diff</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>[1] - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>[0];</div>
<div class="line"><span class="lineno">   17</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 2; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">   18</span>        <span class="keywordflow">if</span> (std::fabs((<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> - 1] - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">diff</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">diff</a>) &gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">tolerance</a>) {</div>
<div class="line"><span class="lineno">   19</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   20</span>        }</div>
<div class="line"><span class="lineno">   21</span>    }</div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   23</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0e56adbbf18a0c9a5c04a8d4de268d9" name="ac0e56adbbf18a0c9a5c04a8d4de268d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e56adbbf18a0c9a5c04a8d4de268d9">&#9670;&#160;</a></span>is_log_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a> is_log_scale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code><a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if an array is logarithmically scaled within a given tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arr</td><td>The array to check </td></tr>
    <tr><td class="paramname">tolerance</td><td>Maximum allowed deviation from logarithmic scaling (default: 1e-6) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the array is logarithmically scaled, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00025">25</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   25</span>                                                    {</div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>.size() &lt; 2)</div>
<div class="line"><span class="lineno">   27</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// At least two elements are needed.</span></div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> ratio = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>[1] / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>[0];</div>
<div class="line"><span class="lineno">   30</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 2; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">   31</span>        <span class="keywordflow">if</span> (std::fabs((<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> - 1] - ratio) / ratio) &gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">tolerance</a>) {</div>
<div class="line"><span class="lineno">   32</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   33</span>        }</div>
<div class="line"><span class="lineno">   34</span>    }</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   36</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cb4a7162e9b5a1e2ed39f7d9e94b53f" name="a7cb4a7162e9b5a1e2ed39f7d9e94b53f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb4a7162e9b5a1e2ed39f7d9e94b53f">&#9670;&#160;</a></span>jet_spreading_edge()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> jet_spreading_edge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the edge of the jet where the spreading is strongest. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
    <tr><td class="paramname"><a class="el" href="classMedium.html" title="Represents the generic medium or any user-defined surrounding medium that the GRB jet interacts with.">Medium</a></td><td>Type of the ambient medium </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">medium</td><td>The ambient medium object </td></tr>
    <tr><td class="paramname">phi</td><td>Azimuthal angle </td></tr>
    <tr><td class="paramname">theta_min</td><td>Minimum polar angle to consider </td></tr>
    <tr><td class="paramname">theta_max</td><td>Maximum polar angle to consider </td></tr>
    <tr><td class="paramname">t0</td><td>Initial time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Angle (in radians) where the spreading is strongest</dd></dl>
<p>The spreading strength is measured by the derivative of the pressure with respect to theta, which is proportional to d((Gamma-1)Gamma rho)/dtheta </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00466">466</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  466</span>                                                                                                                    {</div>
<div class="line"><span class="lineno">  467</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">step</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) / 256;</div>
<div class="line"><span class="lineno">  468</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_s = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>;</div>
<div class="line"><span class="lineno">  469</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dp_min</a> = 0;</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta = theta_min; theta &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>; theta += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">step</a>) {</div>
<div class="line"><span class="lineno">  472</span>        <span class="comment">// Real G = jet.Gamma0(phi, theta);</span></div>
<div class="line"><span class="lineno">  473</span>        <span class="comment">// Real beta0 = physics::relativistic::gamma_to_beta(G);</span></div>
<div class="line"><span class="lineno">  474</span>        <span class="comment">// Real r0 = beta0 * con::c * t0 / (1 - beta0);</span></div>
<div class="line"><span class="lineno">  475</span>        <span class="comment">// Real rho = medium.rho(phi, theta, 0);</span></div>
<div class="line"><span class="lineno">  476</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th_lo</a> = std::max(theta - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">step</a>, theta_min);</div>
<div class="line"><span class="lineno">  477</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th_hi</a> = std::min(theta + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">step</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>);</div>
<div class="line"><span class="lineno">  478</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dG</a> = (jet.Gamma0(phi, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th_hi</a>) - jet.Gamma0(phi, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th_lo</a>)) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th_hi</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">th_lo</a>);</div>
<div class="line"><span class="lineno">  479</span>        <span class="comment">// Real drho = (medium.rho(phi, th_hi, r0) - medium.rho(phi, th_lo, r0)) / (th_hi - th_lo);</span></div>
<div class="line"><span class="lineno">  480</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dp</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dG</a>; <span class="comment">//(2 * G - 1) * rho * dG + (G - 1) * G * drho;</span></div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dp</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dp_min</a>) {</div>
<div class="line"><span class="lineno">  483</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dp_min</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dp</a>;</div>
<div class="line"><span class="lineno">  484</span>            theta_s = theta;</div>
<div class="line"><span class="lineno">  485</span>        }</div>
<div class="line"><span class="lineno">  486</span>    }</div>
<div class="line"><span class="lineno">  487</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dp_min</a> == 0) {</div>
<div class="line"><span class="lineno">  488</span>        theta_s = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">theta_max</a>;</div>
<div class="line"><span class="lineno">  489</span>    }</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">return</span> theta_s;</div>
<div class="line"><span class="lineno">  492</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph.png" border="0" usemap="#amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph" alt=""/></div>
<map name="amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph" id="amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph">
<area shape="rect" title="Determines the edge of the jet where the spreading is strongest." alt="" coords="5,29,155,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="203,29,253,55"/>
<area shape="poly" title=" " alt="" coords="155,39,189,39,189,45,155,45"/>
<area shape="poly" title=" " alt="" coords="203,31,198,21,201,11,211,5,228,3,248,6,257,15,253,18,246,11,228,8,213,10,205,15,203,20,208,28"/>
</map>
</div>

</div>
</div>
<a id="a76f104cdad403ea346ff1a6603c78ad6" name="a76f104cdad403ea346ff1a6603c78ad6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76f104cdad403ea346ff1a6603c78ad6">&#9670;&#160;</a></span>log2space()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a>  = Array&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> log2space </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>grid_per_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00243">243</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  243</span>                                                                            {</div>
<div class="line"><span class="lineno">  244</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">decades</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>) / 3.321928094887362;</div>
<div class="line"><span class="lineno">  245</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(2, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::ceil(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">decades</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">grid_per_order</a>)));</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">array</a> = xt::logspace&lt;Real&gt;(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a>, n + 1, 2.0);</div>
<div class="line"><span class="lineno">  248</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph.png" border="0" usemap="#amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph" alt=""/></div>
<map name="amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph" id="amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,93,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="141,29,192,55"/>
<area shape="poly" title=" " alt="" coords="93,39,127,39,127,45,93,45"/>
<area shape="poly" title=" " alt="" coords="146,30,142,21,144,12,153,5,167,3,183,6,190,14,186,18,180,11,167,8,155,10,149,14,147,20,151,28"/>
</map>
</div>

</div>
</div>
<a id="ad7703ab8b66bb86ed857746606fac9a2" name="ad7703ab8b66bb86ed857746606fac9a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7703ab8b66bb86ed857746606fac9a2">&#9670;&#160;</a></span>logspace_boundary_center()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> logspace_boundary_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>bin_width</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00251">251</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  251</span>                                                                                                      {</div>
<div class="line"><span class="lineno">  252</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a> = Arr::from_shape({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a>});</div>
<div class="line"><span class="lineno">  253</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bin_width</a> = Array::from_shape({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a>});</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a> == 0)</div>
<div class="line"><span class="lineno">  255</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dlg2</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a>);</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> r = std::exp2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dlg2</a>);</div>
<div class="line"><span class="lineno">  260</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">s</a> = std::sqrt(r);</div>
<div class="line"><span class="lineno">  261</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">w</a> = r - 1.;</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">left</a> = std::exp2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">for</span> (std::size_t <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  266</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">left</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">s</a>;</div>
<div class="line"><span class="lineno">  267</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bin_width</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">left</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">w</a>;</div>
<div class="line"><span class="lineno">  268</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">left</a> *= r;</div>
<div class="line"><span class="lineno">  269</span>    }</div>
<div class="line"><span class="lineno">  270</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph.png" border="0" usemap="#amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph" alt=""/></div>
<map name="amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph" id="amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,201,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="249,29,300,55"/>
<area shape="poly" title=" " alt="" coords="202,39,236,39,236,45,202,45"/>
<area shape="poly" title=" " alt="" coords="247,32,240,22,243,12,255,5,275,3,299,7,309,16,305,20,297,11,275,8,256,10,247,15,246,21,251,28"/>
</map>
</div>

</div>
</div>
<a id="afadc5019976c36be16277dc4dc178a7f" name="afadc5019976c36be16277dc4dc178a7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afadc5019976c36be16277dc4dc178a7f">&#9670;&#160;</a></span>logspace_center()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a>  = Array&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> logspace_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00226">226</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  226</span>                                                                           {</div>
<div class="line"><span class="lineno">  227</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a> = Arr::from_shape({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a>});</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a> == 0)</div>
<div class="line"><span class="lineno">  229</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dlg2</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_max</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a>);</div>
<div class="line"><span class="lineno">  232</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> r = std::exp2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dlg2</a>);</div>
<div class="line"><span class="lineno">  233</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">s</a> = std::sqrt(r);</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">left</a> = std::exp2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_min</a>);</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordflow">for</span> (std::size_t <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  237</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">center</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">left</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">s</a>;</div>
<div class="line"><span class="lineno">  238</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">left</a> *= r;</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="line"><span class="lineno">  240</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c066f2c8e6d102d7a56de8cb42cf5a8" name="a3c066f2c8e6d102d7a56de8cb42cf5a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c066f2c8e6d102d7a56de8cb42cf5a8">&#9670;&#160;</a></span>merge_grids()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">typename</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> merge_grids </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Arr</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00607">607</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  607</span>                                                    {</div>
<div class="line"><span class="lineno">  608</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>;</div>
<div class="line"><span class="lineno">  609</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>.reserve(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr1</a>.size() + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr2</a>.size());</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0;</div>
<div class="line"><span class="lineno">  612</span>    <span class="keyword">auto</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">add_unique</a> = [&amp;](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">val</a>) {</div>
<div class="line"><span class="lineno">  613</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>.empty() || <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>.back() != <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">val</a>)</div>
<div class="line"><span class="lineno">  614</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>.push_back(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">val</a>);</div>
<div class="line"><span class="lineno">  615</span>    };</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr1</a>.size() &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr2</a>.size()) {</div>
<div class="line"><span class="lineno">  618</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr1</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>] &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr2</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>]) {</div>
<div class="line"><span class="lineno">  619</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">add_unique</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr1</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>++]);</div>
<div class="line"><span class="lineno">  620</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr1</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> - 1] == <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr2</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>])</div>
<div class="line"><span class="lineno">  621</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>++;</div>
<div class="line"><span class="lineno">  622</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  623</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">add_unique</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr2</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>++]);</div>
<div class="line"><span class="lineno">  624</span>        }</div>
<div class="line"><span class="lineno">  625</span>    }</div>
<div class="line"><span class="lineno">  626</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr1</a>.size())</div>
<div class="line"><span class="lineno">  627</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">add_unique</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr1</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>++]);</div>
<div class="line"><span class="lineno">  628</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr2</a>.size())</div>
<div class="line"><span class="lineno">  629</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">add_unique</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">arr2</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>++]);</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordflow">return</span> xt::adapt(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>);</div>
<div class="line"><span class="lineno">  632</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph.png" border="0" usemap="#amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph" alt=""/></div>
<map name="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph" id="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,108,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="156,29,207,55"/>
<area shape="poly" title=" " alt="" coords="108,39,142,39,142,45,108,45"/>
<area shape="poly" title=" " alt="" coords="160,30,156,21,158,11,167,5,181,3,198,6,206,14,202,18,196,11,181,8,169,10,162,14,161,20,165,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph.png" border="0" usemap="#amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph" alt=""/></div>
<map name="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph" id="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,877,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="ab2b9eccaf75f7a9fe6bafd8696049bd2" name="ab2b9eccaf75f7a9fe6bafd8696049bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2b9eccaf75f7a9fe6bafd8696049bd2">&#9670;&#160;</a></span>refined_time_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> refined_time_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_refine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">size_t</a>&#160;</td>
          <td class="paramname"><em>t_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_resol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_lo_factor</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_hi_factor</em> = <code>10.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a refined logarithmic time grid with higher density around a specified time. </p>
<p>Constructs a three-segment logspace grid:</p><ul>
<li>Segment 1: [t_start, t_lo] with base resolution</li>
<li>Segment 2: [t_lo, t_hi] with higher resolution (around t_refine)</li>
<li>Segment 3: [t_hi, t_end] with base resolution</li>
</ul>
<p>Falls back to simple logspace if refinement is not applicable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_start</td><td>Start time of the grid </td></tr>
    <tr><td class="paramname">t_end</td><td>End time of the grid </td></tr>
    <tr><td class="paramname">t_refine</td><td>Time around which to refine (e.g., deceleration time) </td></tr>
    <tr><td class="paramname">t_num</td><td>Total number of grid points </td></tr>
    <tr><td class="paramname">t_resol</td><td>Resolution parameter (points per decade) </td></tr>
    <tr><td class="paramname">refine_lo_factor</td><td>Lower bound factor for refinement region (t_lo = refine_lo_factor * t_refine) </td></tr>
    <tr><td class="paramname">refine_hi_factor</td><td>Upper bound factor for refinement region (t_hi = refine_hi_factor * t_refine) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of time grid points </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00696">696</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  697</span>                                                                                          {</div>
<div class="line"><span class="lineno">  698</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_num</a>});</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_s</a> = std::log10(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_start</a>);</div>
<div class="line"><span class="lineno">  701</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_e</a> = std::log10(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_end</a>);</div>
<div class="line"><span class="lineno">  702</span> </div>
<div class="line"><span class="lineno">  703</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_refine &lt;= t_start || t_refine &gt;</a>= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_end</a>) {</div>
<div class="line"><span class="lineno">  704</span>        <span class="keywordflow">return</span> xt::logspace(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_s</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_e</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_num</a>);</div>
<div class="line"><span class="lineno">  705</span>    }</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_lo</a> = std::max(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_lo_factor</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_refine</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_start</a>);</div>
<div class="line"><span class="lineno">  708</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_hi</a> = std::min(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">refine_hi_factor</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_refine</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_end</a>);</div>
<div class="line"><span class="lineno">  709</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_lo</a> = std::log10(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_lo</a>);</div>
<div class="line"><span class="lineno">  710</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_hi</a> = std::log10(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_hi</a>);</div>
<div class="line"><span class="lineno">  711</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_before</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_lo</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_s</a>;</div>
<div class="line"><span class="lineno">  712</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_after</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_e</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_hi</a>;</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n1</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_before</a> &gt; 0) ? std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(t_resol * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_before</a>), 2) : 0;</div>
<div class="line"><span class="lineno">  715</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n3</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_after</a> &gt; 0) ? std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(t_resol * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_after</a>), 2) : 0;</div>
<div class="line"><span class="lineno">  716</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shared</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n1</a> &gt; 0 ? 1 : 0) + (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n3</a> &gt; 0 ? 1 : 0);</div>
<div class="line"><span class="lineno">  717</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n2_raw</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n1</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n3</a> + 2 &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_num</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shared</a>) ? (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_num</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shared</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n1</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n3</a>) : 0;</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n2_raw</a> &lt; 2) {</div>
<div class="line"><span class="lineno">  720</span>        <span class="keywordflow">return</span> xt::logspace(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_s</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_e</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_num</a>);</div>
<div class="line"><span class="lineno">  721</span>    }</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n2</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n2_raw</a>;</div>
<div class="line"><span class="lineno">  724</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">idx</a> = 0;</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>    <span class="comment">// Segment 1: [t_start, t_lo]</span></div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n1</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  728</span>        <span class="keyword">auto</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">seg1</a> = xt::logspace(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_s</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_lo</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n1</a>);</div>
<div class="line"><span class="lineno">  729</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n1</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>)</div>
<div class="line"><span class="lineno">  730</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">idx</a>++) = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">seg1</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>);</div>
<div class="line"><span class="lineno">  731</span>    }</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>    <span class="comment">// Segment 2: [t_lo, t_hi] - skip first point if it overlaps with seg1</span></div>
<div class="line"><span class="lineno">  734</span>    {</div>
<div class="line"><span class="lineno">  735</span>        <span class="keyword">auto</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">seg2</a> = xt::logspace(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_lo</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_hi</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n2</a>);</div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k0</a> = (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n1</a> &gt; 0) ? 1 : 0;</div>
<div class="line"><span class="lineno">  737</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k0</a>; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n2</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>)</div>
<div class="line"><span class="lineno">  738</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">idx</a>++) = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">seg2</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>);</div>
<div class="line"><span class="lineno">  739</span>    }</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>    <span class="comment">// Segment 3: [t_hi, t_end] - skip first point (overlaps with seg2)</span></div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n3</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  743</span>        <span class="keyword">auto</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">seg3</a> = xt::logspace(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_hi</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_e</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n3</a>);</div>
<div class="line"><span class="lineno">  744</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 1; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">n3</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>)</div>
<div class="line"><span class="lineno">  745</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">idx</a>++) = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">seg3</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>);</div>
<div class="line"><span class="lineno">  746</span>    }</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">result</a>;</div>
<div class="line"><span class="lineno">  749</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph.png" border="0" usemap="#amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph" alt=""/></div>
<map name="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph" id="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph">
<area shape="rect" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="5,29,141,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="189,29,240,55"/>
<area shape="poly" title=" " alt="" coords="142,39,175,39,175,45,142,45"/>
<area shape="poly" title=" " alt="" coords="191,30,186,21,188,11,198,5,215,3,234,6,243,15,239,18,232,11,215,8,200,10,193,15,191,20,195,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph.png" border="0" usemap="#amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph" alt=""/></div>
<map name="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph" id="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph">
<area shape="rect" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="775,31,911,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="mesh_8h.html">mesh.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
