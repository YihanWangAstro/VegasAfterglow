<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: mesh.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mesh_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mesh.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
<code>#include &lt;numeric&gt;</code><br />
<code>#include &lt;span&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">../util/macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="traits_8h_source.html">../util/traits.h</a>&quot;</code><br />
<code>#include &quot;boost/numeric/odeint.hpp&quot;</code><br />
<code>#include &quot;<a class="el" href="physics_8h_source.html">physics.h</a>&quot;</code><br />
<code>#include &quot;xtensor/containers/xadapt.hpp&quot;</code><br />
<code>#include &quot;xtensor/views/xview.hpp&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for mesh.h:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h__incl.png" border="0" usemap="#amesh_8h" alt=""/></div>
<map name="amesh_8h" id="amesh_8h">
<area shape="rect" title=" " alt="" coords="525,5,595,31"/>
<area shape="rect" title=" " alt="" coords="5,86,91,111"/>
<area shape="poly" title=" " alt="" coords="525,24,343,41,223,58,103,81,91,84,90,79,102,76,223,53,342,36,524,19"/>
<area shape="rect" title=" " alt="" coords="115,86,184,111"/>
<area shape="poly" title=" " alt="" coords="525,25,380,43,288,60,197,81,189,84,187,79,195,76,287,54,379,38,524,20"/>
<area shape="rect" title=" " alt="" coords="208,86,275,111"/>
<area shape="poly" title=" " alt="" coords="525,28,418,48,287,81,281,83,279,78,286,76,417,43,524,22"/>
<area shape="rect" title=" " alt="" coords="299,86,373,111"/>
<area shape="poly" title=" " alt="" coords="526,33,386,81,380,84,378,79,384,76,524,28"/>
<area shape="rect" title=" " alt="" coords="397,86,451,111"/>
<area shape="poly" title=" " alt="" coords="541,33,457,81,455,77,539,29"/>
<area shape="rect" title=" " alt="" coords="475,86,538,111"/>
<area shape="poly" title=" " alt="" coords="554,32,525,76,520,73,550,29"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="657,167,775,192"/>
<area shape="poly" title=" " alt="" coords="597,27,640,46,662,60,681,77,693,95,703,114,714,152,709,154,698,116,689,97,677,80,658,64,637,50,594,32"/>
<area shape="rect" href="traits_8h.html" title=" " alt="" coords="562,86,667,111"/>
<area shape="poly" title=" " alt="" coords="570,29,601,73,597,76,566,32"/>
<area shape="rect" title=" " alt="" coords="743,86,931,111"/>
<area shape="poly" title=" " alt="" coords="596,27,784,80,783,85,595,32"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="956,86,1039,111"/>
<area shape="poly" title=" " alt="" coords="596,20,748,39,846,55,945,76,956,79,954,84,943,81,845,60,748,44,595,25"/>
<area shape="rect" title=" " alt="" coords="1063,79,1206,119"/>
<area shape="poly" title=" " alt="" coords="596,20,786,39,1050,76,1050,81,785,45,596,25"/>
<area shape="rect" title=" " alt="" coords="1230,86,1413,111"/>
<area shape="poly" title=" " alt="" coords="596,19,856,38,1036,54,1219,76,1251,81,1250,86,1218,81,1035,60,855,43,595,24"/>
<area shape="rect" title=" " alt="" coords="593,247,652,273"/>
<area shape="poly" title=" " alt="" coords="704,194,649,240,645,236,701,190"/>
<area shape="rect" title=" " alt="" coords="677,247,755,273"/>
<area shape="poly" title=" " alt="" coords="719,192,719,233,713,233,713,192"/>
<area shape="rect" href="simulation-defaults_8h.html" title="Centralized simulation configuration defaults." alt="" coords="780,240,927,280"/>
<area shape="poly" title=" " alt="" coords="738,190,809,231,807,235,735,194"/>
<area shape="rect" title=" " alt="" coords="818,328,889,353"/>
<area shape="poly" title=" " alt="" coords="856,280,856,314,851,314,851,280"/>
<area shape="poly" title=" " alt="" coords="631,109,692,156,688,160,628,114"/>
<area shape="rect" title=" " alt="" coords="576,167,632,192"/>
<area shape="poly" title=" " alt="" coords="616,112,610,153,605,152,610,111"/>
<area shape="poly" title=" " alt="" coords="967,114,945,121,778,166,777,161,943,116,965,109"/>
<area shape="rect" title=" " alt="" coords="966,167,1029,192"/>
<area shape="poly" title=" " alt="" coords="1000,112,1000,153,995,153,995,112"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h__dep__incl.png" border="0" usemap="#amesh_8hdep" alt=""/></div>
<map name="amesh_8hdep" id="amesh_8hdep">
<area shape="rect" title=" " alt="" coords="599,5,670,31"/>
<area shape="rect" href="IO_8h.html" title=" " alt="" coords="112,519,160,544"/>
<area shape="poly" title=" " alt="" coords="586,23,433,30,337,38,240,51,151,69,76,94,48,109,26,125,13,143,8,164,8,386,11,408,19,429,47,466,82,496,115,516,112,521,79,500,43,470,15,432,6,410,3,386,3,163,8,141,22,121,45,104,74,89,149,64,240,46,337,33,432,25,585,17"/>
<area shape="rect" href="afterglow_8h.html" title=" " alt="" coords="1241,592,1335,617"/>
<area shape="poly" title=" " alt="" coords="684,18,888,23,1165,35,1424,52,1517,63,1572,76,1605,91,1632,107,1650,130,1656,163,1656,459,1653,489,1643,510,1626,528,1601,546,1581,557,1552,566,1481,582,1336,602,1335,596,1480,577,1551,561,1579,552,1599,542,1622,524,1638,507,1648,487,1651,459,1651,164,1645,132,1628,112,1603,96,1570,81,1516,68,1423,57,1165,40,888,29,684,23"/>
<area shape="rect" href="inverse-compton_8h.html" title=" " alt="" coords="403,299,547,324"/>
<area shape="poly" title=" " alt="" coords="587,31,541,48,520,62,502,80,486,108,476,138,467,201,469,258,475,298,470,299,464,259,462,201,471,137,481,105,498,77,516,58,538,44,585,26"/>
<area shape="rect" href="mesh_8cpp.html" title=" " alt="" coords="512,79,597,104"/>
<area shape="poly" title=" " alt="" coords="614,42,570,80,566,76,610,38"/>
<area shape="rect" href="observer_8h.html" title=" " alt="" coords="879,299,969,324"/>
<area shape="poly" title=" " alt="" coords="656,39,715,102,914,297,910,300,711,106,652,43"/>
<area shape="rect" href="prompt_8h.html" title=" " alt="" coords="1477,79,1558,104"/>
<area shape="poly" title=" " alt="" coords="684,21,1476,84,1476,89,683,26"/>
<area shape="rect" href="quadrature_8h.html" title=" " alt="" coords="331,225,437,251"/>
<area shape="poly" title=" " alt="" coords="587,27,521,44,487,60,458,81,429,116,408,158,395,197,389,226,383,225,390,195,403,156,424,113,454,77,485,55,519,39,585,22"/>
<area shape="rect" href="shock_8h.html" title=" " alt="" coords="883,225,955,251"/>
<area shape="poly" title=" " alt="" coords="662,37,905,223,902,227,659,41"/>
<area shape="rect" href="utilities_8h.html" title=" " alt="" coords="831,79,913,104"/>
<area shape="poly" title=" " alt="" coords="684,31,835,76,833,81,683,36"/>
<area shape="rect" href="IO_8cpp.html" title=" " alt="" coords="105,592,167,617"/>
<area shape="poly" title=" " alt="" coords="139,558,139,592,133,592,133,558"/>
<area shape="poly" title=" " alt="" coords="174,534,259,541,836,578,1240,599,1240,604,836,583,258,547,173,539"/>
<area shape="rect" href="shock__dispatch_8h.html" title=" " alt="" coords="1221,665,1355,691"/>
<area shape="poly" title=" " alt="" coords="1291,631,1291,665,1285,665,1285,631"/>
<area shape="rect" href="pymodel_8h.html" title=" " alt="" coords="1243,739,1333,764"/>
<area shape="poly" title=" " alt="" coords="1291,704,1291,739,1285,739,1285,704"/>
<area shape="rect" href="pybind_8cpp.html" title=" " alt="" coords="1180,812,1273,837"/>
<area shape="poly" title=" " alt="" coords="1271,776,1239,814,1235,810,1267,773"/>
<area shape="rect" href="pymodel_8cpp.html" title=" " alt="" coords="1297,812,1404,837"/>
<area shape="poly" title=" " alt="" coords="1309,773,1343,810,1339,814,1305,776"/>
<area shape="poly" title=" " alt="" coords="432,331,378,356,326,390,307,408,296,428,294,448,304,469,333,500,363,520,393,531,425,535,498,535,540,536,586,541,775,567,962,585,1241,599,1240,605,961,590,774,573,585,547,539,541,498,540,425,540,392,536,360,525,329,505,299,472,288,449,290,426,303,405,323,385,375,352,429,327"/>
<area shape="rect" href="inverse-compton_8cpp.html" title=" " alt="" coords="766,519,925,544"/>
<area shape="poly" title=" " alt="" coords="524,326,573,345,624,370,688,408,748,450,833,516,830,521,744,454,685,413,621,374,571,350,522,331"/>
<area shape="rect" href="power-law-syn_8cpp.html" title=" " alt="" coords="94,445,239,471"/>
<area shape="poly" title=" " alt="" coords="416,330,356,349,295,374,231,412,183,447,180,443,228,408,292,370,354,344,414,325"/>
<area shape="rect" href="power-law-syn_8h.html" title=" " alt="" coords="93,372,224,397"/>
<area shape="poly" title=" " alt="" coords="411,330,210,374,209,369,410,324"/>
<area shape="rect" href="smooth-power-law-syn_8h.html" title=" " alt="" coords="363,372,547,397"/>
<area shape="poly" title=" " alt="" coords="470,338,460,373,455,371,465,337"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="537,445,647,471"/>
<area shape="poly" title=" " alt="" coords="511,329,537,347,561,370,582,410,592,444,587,446,577,412,557,374,534,351,508,333"/>
<area shape="rect" href="synchrotron_8cpp.html" title=" " alt="" coords="615,519,742,544"/>
<area shape="poly" title=" " alt="" coords="517,327,554,346,594,372,631,404,661,444,675,484,681,518,675,519,670,485,656,447,627,408,590,376,551,351,515,332"/>
<area shape="poly" title=" " alt="" coords="164,411,168,445,163,446,159,411"/>
<area shape="rect" href="smooth-power-law-syn_8cpp.html" title=" " alt="" coords="314,445,513,471"/>
<area shape="poly" title=" " alt="" coords="443,411,422,447,418,444,439,408"/>
<area shape="poly" title=" " alt="" coords="490,401,571,443,568,447,487,406"/>
<area shape="poly" title=" " alt="" coords="524,473,160,529,160,524,523,468"/>
<area shape="poly" title=" " alt="" coords="590,485,591,515,596,530,604,542,617,549,638,556,701,569,883,586,1085,596,1240,600,1240,605,1085,601,883,591,700,574,636,562,615,554,601,546,591,532,586,516,585,485"/>
<area shape="poly" title=" " alt="" coords="647,472,805,516,804,521,645,477"/>
<area shape="poly" title=" " alt="" coords="618,477,666,516,663,521,615,481"/>
<area shape="poly" title=" " alt="" coords="951,331,994,370,1034,419,1061,461,1090,501,1136,542,1189,571,1242,589,1240,594,1187,576,1133,546,1086,504,1057,464,1030,422,990,374,948,335"/>
<area shape="rect" href="observer_8cpp.html" title=" " alt="" coords="875,372,981,397"/>
<area shape="poly" title=" " alt="" coords="928,338,930,372,925,372,923,338"/>
<area shape="poly" title=" " alt="" coords="1545,111,1563,129,1580,151,1600,191,1605,237,1605,459,1605,486,1601,508,1591,527,1572,546,1555,557,1530,567,1467,582,1336,602,1335,596,1466,577,1528,562,1552,552,1569,542,1586,524,1596,506,1599,486,1600,459,1600,237,1595,193,1575,153,1559,133,1541,115"/>
<area shape="rect" href="prompt_8cpp.html" title=" " alt="" coords="1469,152,1565,177"/>
<area shape="poly" title=" " alt="" coords="1520,118,1520,152,1515,152,1515,118"/>
<area shape="poly" title=" " alt="" coords="411,257,461,296,458,301,408,261"/>
<area shape="poly" title=" " alt="" coords="869,242,691,245,574,251,451,261,331,278,223,301,177,316,138,333,106,352,83,374,70,397,68,419,73,442,84,469,101,496,122,516,118,520,97,500,79,472,68,444,62,419,65,395,79,370,103,348,135,328,175,311,222,296,330,273,450,256,573,245,690,239,869,236"/>
<area shape="poly" title=" " alt="" coords="869,250,547,301,546,296,869,245"/>
<area shape="poly" title=" " alt="" coords="892,260,611,447,608,443,889,256"/>
<area shape="poly" title=" " alt="" coords="923,264,926,298,920,299,918,265"/>
<area shape="rect" href="forward-shock_8hpp.html" title=" " alt="" coords="1057,372,1199,397"/>
<area shape="poly" title=" " alt="" coords="948,256,1113,370,1110,374,945,261"/>
<area shape="rect" href="shock-physics_8h.html" title=" " alt="" coords="1174,299,1301,324"/>
<area shape="poly" title=" " alt="" coords="969,248,1187,296,1185,301,968,253"/>
<area shape="rect" href="shock_8cpp.html" title=" " alt="" coords="1326,372,1413,397"/>
<area shape="poly" title=" " alt="" coords="969,239,1054,246,1154,256,1248,273,1286,284,1313,296,1333,313,1348,333,1367,371,1363,373,1344,336,1329,317,1311,301,1284,289,1247,278,1154,262,1053,251,969,245"/>
<area shape="poly" title=" " alt="" coords="1128,411,1127,440,1130,475,1138,511,1155,542,1173,560,1195,574,1241,592,1239,597,1192,579,1170,564,1151,546,1133,512,1124,476,1122,440,1122,411"/>
<area shape="poly" title=" " alt="" coords="1210,334,1147,374,1144,370,1207,329"/>
<area shape="rect" href="reverse-shock_8hpp.html" title=" " alt="" coords="1270,445,1413,471"/>
<area shape="poly" title=" " alt="" coords="1256,334,1335,444,1331,447,1252,337"/>
<area shape="poly" title=" " alt="" coords="1272,328,1349,369,1346,374,1269,333"/>
<area shape="rect" href="simple-shock_8hpp.html" title=" " alt="" coords="1166,519,1303,544"/>
<area shape="poly" title=" " alt="" coords="1240,338,1237,518,1232,518,1234,338"/>
<area shape="poly" title=" " alt="" coords="1337,485,1317,545,1296,593,1291,591,1312,543,1332,483"/>
<area shape="poly" title=" " alt="" coords="1254,553,1281,590,1277,593,1249,557"/>
<area shape="poly" title=" " alt="" coords="927,99,1250,157,1411,193,1469,209,1501,223,1525,241,1542,259,1552,281,1555,310,1555,460,1548,494,1531,522,1505,546,1474,564,1439,578,1402,589,1336,601,1335,596,1401,584,1437,573,1471,559,1502,541,1527,519,1543,492,1549,459,1549,310,1546,282,1537,262,1522,245,1499,228,1467,214,1410,198,1249,163,926,104"/>
<area shape="poly" title=" " alt="" coords="840,113,497,301,494,296,838,108"/>
<area shape="poly" title=" " alt="" coords="865,118,849,172,842,204,840,237,840,386,847,518,842,519,835,386,835,237,837,203,843,171,860,116"/>
<area shape="poly" title=" " alt="" coords="851,116,831,139,811,168,795,201,789,237,789,386,787,409,779,430,755,468,725,499,698,520,694,516,721,495,751,465,774,428,781,407,784,386,784,236,790,200,806,165,827,136,847,112"/>
<area shape="rect" href="jet_8h.html" title=" " alt="" coords="880,152,931,177"/>
<area shape="poly" title=" " alt="" coords="886,115,902,151,898,153,881,118"/>
<area shape="rect" href="medium_8h.html" title=" " alt="" coords="955,152,1043,177"/>
<area shape="poly" title=" " alt="" coords="906,108,979,149,977,154,903,113"/>
<area shape="rect" href="utilities_8cpp.html" title=" " alt="" coords="1347,152,1445,177"/>
<area shape="poly" title=" " alt="" coords="927,97,1328,149,1347,152,1346,158,1328,155,927,102"/>
<area shape="poly" title=" " alt="" coords="945,175,989,183,1033,188,1122,187,1285,177,1352,180,1381,187,1406,198,1426,216,1441,240,1450,271,1453,310,1453,460,1450,485,1439,508,1424,528,1405,546,1361,575,1321,594,1319,589,1359,570,1401,542,1420,525,1435,505,1444,483,1448,459,1448,310,1445,272,1436,242,1422,219,1403,203,1379,192,1352,185,1285,182,1122,193,1033,193,988,188,944,180"/>
<area shape="poly" title=" " alt="" coords="913,191,919,225,914,226,907,192"/>
<area shape="poly" title=" " alt="" coords="1056,163,1159,166,1281,175,1395,193,1439,206,1471,223,1490,242,1500,261,1503,283,1504,310,1504,459,1503,486,1499,507,1489,526,1471,546,1440,569,1405,585,1369,595,1336,602,1335,597,1368,590,1403,580,1437,564,1468,542,1484,523,1494,505,1498,485,1499,459,1499,310,1498,284,1495,263,1486,245,1468,227,1437,211,1393,198,1281,180,1159,172,1056,169"/>
<area shape="poly" title=" " alt="" coords="978,188,934,227,930,223,974,184"/>
</map>
</div>
</div>
<p><a href="mesh_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoord.html">Coord</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a coordinate system with arrays for phi, theta, and t.  <a href="classCoord.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afd05120c4d579ec7fa4906f677781a83" id="r_afd05120c4d579ec7fa4906f677781a83"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 1 &gt;</td></tr>
<tr class="memdesc:afd05120c4d579ec7fa4906f677781a83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 1D arrays (e.g., time points)  <br /></td></tr>
<tr class="separator:afd05120c4d579ec7fa4906f677781a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ec6be5d638ad03ae6697ff2b71ef91" id="r_ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 2 &gt;</td></tr>
<tr class="memdesc:ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 2D grids (e.g., spatial coordinates)  <br /></td></tr>
<tr class="separator:ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b76cc05bedc7fd9499c0bd3eec3bcb5" id="r_a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 3 &gt;</td></tr>
<tr class="memdesc:a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D grids (e.g., full spatial-temporal data)  <br /></td></tr>
<tr class="separator:a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb738e18bf395ef0903c8c5d6f37c47f" id="r_afb738e18bf395ef0903c8c5d6f37c47f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">int</a>, 3 &gt;</td></tr>
<tr class="memdesc:afb738e18bf395ef0903c8c5d6f37c47f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D boolean grids for masking operations.  <br /></td></tr>
<tr class="separator:afb738e18bf395ef0903c8c5d6f37c47f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27e3f4efb19b3f2b0694e0bee5fb25ae" id="r_a27e3f4efb19b3f2b0694e0bee5fb25ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a27e3f4efb19b3f2b0694e0bee5fb25ae">IndexGrid</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>, 2 &gt;</td></tr>
<tr class="separator:a27e3f4efb19b3f2b0694e0bee5fb25ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a4c9eca1a51662c0a447221f4d3940caa" id="r_a4c9eca1a51662c0a447221f4d3940caa"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caa">Symmetry</a> : uint8_t { <a class="el" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa32234519c88d862c5df3934bd134aa9c">structured</a>
, <a class="el" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa2fbec3f317107be74b3eb9a4a224a059">phi_symmetric</a>
, <a class="el" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa3e58619a3450b6f761468f6283dc8573">piecewise</a>
, <a class="el" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa92fd05a96e739c61bbbd8b81d35ec741">isotropic</a>
 }</td></tr>
<tr class="memdesc:a4c9eca1a51662c0a447221f4d3940caa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Symmetry level of the computational grid, auto-detected from jet initial conditions.  <a href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caa">More...</a><br /></td></tr>
<tr class="separator:a4c9eca1a51662c0a447221f4d3940caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa5d127d3ecb19584c7f27ee212d49605" id="r_aa5d127d3ecb19584c7f27ee212d49605"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aa5d127d3ecb19584c7f27ee212d49605">is_linear_scale</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>=<a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a>)</td></tr>
<tr class="memdesc:aa5d127d3ecb19584c7f27ee212d49605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if an array is linearly scaled within a given tolerance.  <br /></td></tr>
<tr class="separator:aa5d127d3ecb19584c7f27ee212d49605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e56adbbf18a0c9a5c04a8d4de268d9" id="r_ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ac0e56adbbf18a0c9a5c04a8d4de268d9">is_log_scale</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>=<a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a>)</td></tr>
<tr class="memdesc:ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if an array is logarithmically scaled within a given tolerance.  <br /></td></tr>
<tr class="separator:ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a885b165e8d9c9d20f27ec99329a0c3cb" id="r_a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </td></tr>
<tr class="memitem:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a885b165e8d9c9d20f27ec99329a0c3cb">boundary_to_center</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>)</td></tr>
<tr class="memdesc:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using linear interpolation.  <br /></td></tr>
<tr class="separator:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba66986baad5475a202c20a92bda036e" id="r_aba66986baad5475a202c20a92bda036e"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </td></tr>
<tr class="memitem:aba66986baad5475a202c20a92bda036e"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aba66986baad5475a202c20a92bda036e">boundary_to_center_log</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>)</td></tr>
<tr class="memdesc:aba66986baad5475a202c20a92bda036e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using geometric mean (logarithmic interpolation)  <br /></td></tr>
<tr class="separator:aba66986baad5475a202c20a92bda036e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1622b29b5488dbee3ef9068b9f8c7d4" id="r_ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae1622b29b5488dbee3ef9068b9f8c7d4">boundary_to_center</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>)</td></tr>
<tr class="memdesc:ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using linear interpolation.  <br /></td></tr>
<tr class="separator:ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac536f77c32691232cb5e7546595fb3d2" id="r_ac536f77c32691232cb5e7546595fb3d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ac536f77c32691232cb5e7546595fb3d2">boundary_to_center_log</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>)</td></tr>
<tr class="memdesc:ac536f77c32691232cb5e7546595fb3d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using geometric mean.  <br /></td></tr>
<tr class="separator:ac536f77c32691232cb5e7546595fb3d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6130a6c9bb4bbe255dd8852fd154791d" id="r_a6130a6c9bb4bbe255dd8852fd154791d"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:a6130a6c9bb4bbe255dd8852fd154791d"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a6130a6c9bb4bbe255dd8852fd154791d">build_time_grid</a> (<a class="el" href="classCoord.html">Coord</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>, <a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> z, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_resol, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>)</td></tr>
<tr class="memdesc:a6130a6c9bb4bbe255dd8852fd154791d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds the engine-time grid for each (phi, theta) cell in the coordinate system.  <br /></td></tr>
<tr class="separator:a6130a6c9bb4bbe255dd8852fd154791d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96aa0a78a0de13a52955de3c2ce29ddd" id="r_a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classCoord.html">Coord</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd">auto_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;t_obs, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_cut</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_view, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> z, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi_resol=<a class="el" href="namespacedefaults_1_1grid.html#a81845ddcce8fb560efb401cdde437a16">defaults::grid::phi_resolution</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_resol=<a class="el" href="namespacedefaults_1_1grid.html#a372994c537be68d80989655f9b43c672">defaults::grid::theta_resolution</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_resol=<a class="el" href="namespacedefaults_1_1grid.html#aa203749fa338e32e6c7a711c82846582">defaults::grid::time_resolution</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>=<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">true</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi_view=0, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_theta_num</a>=<a class="el" href="namespacedefaults_1_1grid.html#a17f64e94f8f9cb660a1e9d80a2b1558c">defaults::grid::min_theta_points</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fwd_ratio</a>=<a class="el" href="namespacedefaults_1_1grid.html#ae654c737813ff06431141238b26e0a67">defaults::grid::forward_ratio</a>)</td></tr>
<tr class="memdesc:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a coordinate grid (<a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a>) for shock evolution.  <br /></td></tr>
<tr class="separator:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cb4f8dcb245bdf3dba21d11f42d07e0" id="r_a0cb4f8dcb245bdf3dba21d11f42d07e0"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a0cb4f8dcb245bdf3dba21d11f42d07e0"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a0cb4f8dcb245bdf3dba21d11f42d07e0">find_jet_jumps</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_cut, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>)</td></tr>
<tr class="memdesc:a0cb4f8dcb245bdf3dba21d11f42d07e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary.  <br /></td></tr>
<tr class="separator:a0cb4f8dcb245bdf3dba21d11f42d07e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb4a7162e9b5a1e2ed39f7d9e94b53f" id="r_a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a7cb4a7162e9b5a1e2ed39f7d9e94b53f">jet_spreading_edge</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t0)</td></tr>
<tr class="memdesc:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the edge of the jet where the spreading is strongest.  <br /></td></tr>
<tr class="separator:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afadc5019976c36be16277dc4dc178a7f" id="r_afadc5019976c36be16277dc4dc178a7f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </td></tr>
<tr class="memitem:afadc5019976c36be16277dc4dc178a7f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afadc5019976c36be16277dc4dc178a7f">logspace_center</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>)</td></tr>
<tr class="separator:afadc5019976c36be16277dc4dc178a7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76f104cdad403ea346ff1a6603c78ad6" id="r_a76f104cdad403ea346ff1a6603c78ad6"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </td></tr>
<tr class="memitem:a76f104cdad403ea346ff1a6603c78ad6"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a76f104cdad403ea346ff1a6603c78ad6">log2space</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">grid_per_order</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">array</a>)</td></tr>
<tr class="separator:a76f104cdad403ea346ff1a6603c78ad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7703ab8b66bb86ed857746606fac9a2" id="r_ad7703ab8b66bb86ed857746606fac9a2"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </td></tr>
<tr class="memitem:ad7703ab8b66bb86ed857746606fac9a2"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ad7703ab8b66bb86ed857746606fac9a2">logspace_boundary_center</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bin_width</a>)</td></tr>
<tr class="separator:ad7703ab8b66bb86ed857746606fac9a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e78f3cf4aabf7985519d581ce43182" id="r_ae2e78f3cf4aabf7985519d581ce43182"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae2e78f3cf4aabf7985519d581ce43182">adaptive_grid_with_breaks</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">break_weights</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts_per_decade</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;grid, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_refined_breaks</a>=3, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius_decades</a>=0.5, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_factor</a>=3.0)</td></tr>
<tr class="memdesc:ae2e78f3cf4aabf7985519d581ce43182"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds an adaptive log-spaced grid with explicit break points.  <br /></td></tr>
<tr class="separator:ae2e78f3cf4aabf7985519d581ce43182"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4bf3bc5ca82cf7ac350fab9eff68452" id="r_aa4bf3bc5ca82cf7ac350fab9eff68452"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:aa4bf3bc5ca82cf7ac350fab9eff68452"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aa4bf3bc5ca82cf7ac350fab9eff68452">find_theta_max</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_cut)</td></tr>
<tr class="separator:aa4bf3bc5ca82cf7ac350fab9eff68452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f8fa2784bc01569368e72d4020bb9b0" id="r_a6f8fa2784bc01569368e72d4020bb9b0"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &gt; </td></tr>
<tr class="memitem:a6f8fa2784bc01569368e72d4020bb9b0"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a6f8fa2784bc01569368e72d4020bb9b0">inverse_CFD_sampling</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &amp;&amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>=<a class="el" href="namespacedefaults_1_1sampling.html#afb3d6cb58a2dc84e4f0a2ed64d7e1609">defaults::sampling::theta_samples</a>)</td></tr>
<tr class="separator:a6f8fa2784bc01569368e72d4020bb9b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc6828dd13a70c0c203dba03e765cea" id="r_a3dc6828dd13a70c0c203dba03e765cea"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a3dc6828dd13a70c0c203dba03e765cea"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>)</td></tr>
<tr class="separator:a3dc6828dd13a70c0c203dba03e765cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae31d546d7f15fece5525fd480b771b68" id="r_ae31d546d7f15fece5525fd480b771b68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae31d546d7f15fece5525fd480b771b68">jump_refinement_grid</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_jumps</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_resol)</td></tr>
<tr class="separator:ae31d546d7f15fece5525fd480b771b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a360e0d18f141d6cd50b062a901338575" id="r_a360e0d18f141d6cd50b062a901338575"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a360e0d18f141d6cd50b062a901338575"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a360e0d18f141d6cd50b062a901338575">adaptive_phi_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;theta_grid, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>)</td></tr>
<tr class="separator:a360e0d18f141d6cd50b062a901338575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c066f2c8e6d102d7a56de8cb42cf5a8" id="r_a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </td></tr>
<tr class="memitem:a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>)</td></tr>
<tr class="separator:a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7505ad2e84c2a29610c1a13cd3b25e3" id="r_aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta)</td></tr>
<tr class="memdesc:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates deceleration time for a given angle from ejecta and medium properties.  <br /></td></tr>
<tr class="separator:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aaa6d60a9852531ccfc1d290284c611" id="r_a0aaa6d60a9852531ccfc1d290284c611"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a0aaa6d60a9852531ccfc1d290284c611">refined_time_grid</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a>=0.3, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a>=10.0)</td></tr>
<tr class="memdesc:a0aaa6d60a9852531ccfc1d290284c611"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a refined logarithmic time grid with higher density around a specified time.  <br /></td></tr>
<tr class="separator:a0aaa6d60a9852531ccfc1d290284c611"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aba685e866cceb5c13d7e357fcaa69529" id="r_aba685e866cceb5c13d7e357fcaa69529"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">constexpr</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aba685e866cceb5c13d7e357fcaa69529">log2_10</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::numbers::ln10</a> / <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::numbers::ln2</a></td></tr>
<tr class="separator:aba685e866cceb5c13d7e357fcaa69529"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="afd05120c4d579ec7fa4906f677781a83" name="afd05120c4d579ec7fa4906f677781a83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd05120c4d579ec7fa4906f677781a83">&#9670;&#160;</a></span>Array</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 1&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 1D arrays (e.g., time points) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00041">41</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="a27e3f4efb19b3f2b0694e0bee5fb25ae" name="a27e3f4efb19b3f2b0694e0bee5fb25ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27e3f4efb19b3f2b0694e0bee5fb25ae">&#9670;&#160;</a></span>IndexGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#a27e3f4efb19b3f2b0694e0bee5fb25ae">IndexGrid</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>, 2&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00049">49</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="afb738e18bf395ef0903c8c5d6f37c47f" name="afb738e18bf395ef0903c8c5d6f37c47f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb738e18bf395ef0903c8c5d6f37c47f">&#9670;&#160;</a></span>MaskGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">int</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D boolean grids for masking operations. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00047">47</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="ae7ec6be5d638ad03ae6697ff2b71ef91" name="ae7ec6be5d638ad03ae6697ff2b71ef91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ec6be5d638ad03ae6697ff2b71ef91">&#9670;&#160;</a></span>MeshGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 2&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 2D grids (e.g., spatial coordinates) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00043">43</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="a6b76cc05bedc7fd9499c0bd3eec3bcb5" name="a6b76cc05bedc7fd9499c0bd3eec3bcb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b76cc05bedc7fd9499c0bd3eec3bcb5">&#9670;&#160;</a></span>MeshGrid3d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D grids (e.g., full spatial-temporal data) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00045">45</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a4c9eca1a51662c0a447221f4d3940caa" name="a4c9eca1a51662c0a447221f4d3940caa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c9eca1a51662c0a447221f4d3940caa">&#9670;&#160;</a></span>Symmetry</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">enum</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">class</a> <a class="el" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caa">Symmetry</a> : <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uint8_t</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Symmetry level of the computational grid, auto-detected from jet initial conditions. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4c9eca1a51662c0a447221f4d3940caaa32234519c88d862c5df3934bd134aa9c" name="a4c9eca1a51662c0a447221f4d3940caaa32234519c88d862c5df3934bd134aa9c"></a>structured&#160;</td><td class="fielddoc"><p>Full (phi, theta) computation needed. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c9eca1a51662c0a447221f4d3940caaa2fbec3f317107be74b3eb9a4a224a059" name="a4c9eca1a51662c0a447221f4d3940caaa2fbec3f317107be74b3eb9a4a224a059"></a>phi_symmetric&#160;</td><td class="fielddoc"><p>Uniform in phi; compute one phi slice, broadcast across phi. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c9eca1a51662c0a447221f4d3940caaa3e58619a3450b6f761468f6283dc8573" name="a4c9eca1a51662c0a447221f4d3940caaa3e58619a3450b6f761468f6283dc8573"></a>piecewise&#160;</td><td class="fielddoc"><p>phi-symmetric + piecewise-constant in theta; compute K representative thetas </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c9eca1a51662c0a447221f4d3940caaa92fd05a96e739c61bbbd8b81d35ec741" name="a4c9eca1a51662c0a447221f4d3940caaa92fd05a96e739c61bbbd8b81d35ec741"></a>isotropic&#160;</td><td class="fielddoc"><p>Uniform in both phi and theta; compute one point, broadcast everywhere. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00056">56</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   56</span>                    : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uint8_t</a> {</div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_enumvalue" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa32234519c88d862c5df3934bd134aa9c">structured</a>,    <span class="comment">///&lt; Full (phi, theta) computation needed</span></div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_enumvalue" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa2fbec3f317107be74b3eb9a4a224a059">phi_symmetric</a>, <span class="comment">///&lt; Uniform in phi; compute one phi slice, broadcast across phi</span></div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_enumvalue" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa3e58619a3450b6f761468f6283dc8573">piecewise</a>,     <span class="comment">///&lt; phi-symmetric + piecewise-constant in theta; compute K representative thetas</span></div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_enumvalue" href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa92fd05a96e739c61bbbd8b81d35ec741">isotropic</a>      <span class="comment">///&lt; Uniform in both phi and theta; compute one point, broadcast everywhere</span></div>
<div class="line"><span class="lineno">   61</span>};</div>
<div class="ttc" id="amesh_8h_html_a4c9eca1a51662c0a447221f4d3940caaa2fbec3f317107be74b3eb9a4a224a059"><div class="ttname"><a href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa2fbec3f317107be74b3eb9a4a224a059">Symmetry::phi_symmetric</a></div><div class="ttdeci">@ phi_symmetric</div><div class="ttdoc">Uniform in phi; compute one phi slice, broadcast across phi.</div></div>
<div class="ttc" id="amesh_8h_html_a4c9eca1a51662c0a447221f4d3940caaa32234519c88d862c5df3934bd134aa9c"><div class="ttname"><a href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa32234519c88d862c5df3934bd134aa9c">Symmetry::structured</a></div><div class="ttdeci">@ structured</div><div class="ttdoc">Full (phi, theta) computation needed.</div></div>
<div class="ttc" id="amesh_8h_html_a4c9eca1a51662c0a447221f4d3940caaa3e58619a3450b6f761468f6283dc8573"><div class="ttname"><a href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa3e58619a3450b6f761468f6283dc8573">Symmetry::piecewise</a></div><div class="ttdeci">@ piecewise</div><div class="ttdoc">phi-symmetric + piecewise-constant in theta; compute K representative thetas</div></div>
<div class="ttc" id="amesh_8h_html_a4c9eca1a51662c0a447221f4d3940caaa92fd05a96e739c61bbbd8b81d35ec741"><div class="ttname"><a href="mesh_8h.html#a4c9eca1a51662c0a447221f4d3940caaa92fd05a96e739c61bbbd8b81d35ec741">Symmetry::isotropic</a></div><div class="ttdeci">@ isotropic</div><div class="ttdoc">Uniform in both phi and theta; compute one point, broadcast everywhere.</div></div>
<div class="ttc" id="apybind_8cpp_html_ad93eae6422741850877b46bd61f08c89"><div class="ttname"><a href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">make_native_binary</a></div><div class="ttdeci">BinaryFunc make_native_binary(uintptr_t addr, std::vector&lt; Real &gt; const &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="pybind_8cpp_source.html#l00027">pybind.cpp:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae2e78f3cf4aabf7985519d581ce43182" name="ae2e78f3cf4aabf7985519d581ce43182"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e78f3cf4aabf7985519d581ce43182">&#9670;&#160;</a></span>adaptive_grid_with_breaks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> adaptive_grid_with_breaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td>
          <td class="paramname"><em>breaks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td>
          <td class="paramname"><em>break_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>pts_per_decade</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>max_refined_breaks</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_radius_decades</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_factor</em> = <code>3.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Builds an adaptive log-spaced grid with explicit break points. </p>
<p>Places grid points at endpoints and break frequencies, then fills segments between with approximately <code>pts_per_decade</code> log-spaced points. Nearby points are merged automatically based on the local step size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lg2_min</td><td>Log2 of minimum grid value </td></tr>
    <tr><td class="paramname">lg2_max</td><td>Log2 of maximum grid value </td></tr>
    <tr><td class="paramname">breaks</td><td>Break frequencies (linear scale) to include </td></tr>
    <tr><td class="paramname">break_weights</td><td>Importance weights for each break (top values get refined regions) </td></tr>
    <tr><td class="paramname">pts_per_decade</td><td>Base density of fill points per decade </td></tr>
    <tr><td class="paramname">grid</td><td>Output array of grid point values (resized internally) </td></tr>
    <tr><td class="paramname">max_refined_breaks</td><td>Maximum number of breaks to refine (sorted by weight) </td></tr>
    <tr><td class="paramname">refine_radius_decades</td><td>Half-width of the refined region around each break (in decades) </td></tr>
    <tr><td class="paramname">refine_factor</td><td>Grid density multiplier inside refined regions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of grid points </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00344">344</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  347</span>                                                                  {</div>
<div class="line"><span class="lineno">  348</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a> = 256;</div>
<div class="line"><span class="lineno">  349</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_per_decade</a> = <a class="code hl_variable" href="mesh_8h.html#aba685e866cceb5c13d7e357fcaa69529">log2_10</a>;</div>
<div class="line"><span class="lineno">  350</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius_decades</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_per_decade</a>;</div>
<div class="line"><span class="lineno">  351</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_per_decade</a> / std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts_per_decade</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>(1e-6));</div>
<div class="line"><span class="lineno">  352</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fine_step</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_factor</a>;</div>
<div class="line"><span class="lineno">  353</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merge_eps</a> = 0.5 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fine_step</a>;</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>    <span class="comment">// Collect valid breaks within range with weights</span></div>
<div class="line"><span class="lineno">  356</span>    <span class="keyword">struct </span><a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Break</a> {</div>
<div class="line"><span class="lineno">  357</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a>;</div>
<div class="line"><span class="lineno">  358</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weight</a>;</div>
<div class="line"><span class="lineno">  359</span>    };</div>
<div class="line"><span class="lineno">  360</span>    std::vector&lt;Break&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>;</div>
<div class="line"><span class="lineno">  361</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>.size());</div>
<div class="line"><span class="lineno">  362</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  363</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>];</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordflow">if</span> (!(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> &gt; 0) || !std::isfinite(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>)) {</div>
<div class="line"><span class="lineno">  365</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  366</span>        }</div>
<div class="line"><span class="lineno">  367</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a> = std::log2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>);</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a> &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a> &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>) {</div>
<div class="line"><span class="lineno">  369</span>            <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a> = 1;</div>
<div class="line"><span class="lineno">  370</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">break_weights</a>.size()) {</div>
<div class="line"><span class="lineno">  371</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">break_weights</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>];</div>
<div class="line"><span class="lineno">  372</span>                <span class="keywordflow">if</span> (std::isfinite(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a>) &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a> &gt;= 0) {</div>
<div class="line"><span class="lineno">  373</span>                    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a>;</div>
<div class="line"><span class="lineno">  374</span>                }</div>
<div class="line"><span class="lineno">  375</span>            }</div>
<div class="line"><span class="lineno">  376</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a>});</div>
<div class="line"><span class="lineno">  377</span>        }</div>
<div class="line"><span class="lineno">  378</span>    }</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <span class="comment">// Sort by weight descending; top N get refinement</span></div>
<div class="line"><span class="lineno">  381</span>    std::ranges::sort(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>, [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) { <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>.weight &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>.weight; });</div>
<div class="line"><span class="lineno">  382</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_refine</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_refined_breaks</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>.size());</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>    <span class="comment">// Build grid points with break tracking for merge protection</span></div>
<div class="line"><span class="lineno">  385</span>    <span class="keyword">struct </span><a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Pt</a> {</div>
<div class="line"><span class="lineno">  386</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a>;</div>
<div class="line"><span class="lineno">  387</span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_break</a>;</div>
<div class="line"><span class="lineno">  388</span>    };</div>
<div class="line"><span class="lineno">  389</span>    std::vector&lt;Pt&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>;</div>
<div class="line"><span class="lineno">  390</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a> * 2);</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>    <span class="comment">// Coarse uniform grid</span></div>
<div class="line"><span class="lineno">  393</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>(0));</div>
<div class="line"><span class="lineno">  394</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_coarse</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> &gt; 0 &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a> &gt; 0)</div>
<div class="line"><span class="lineno">  395</span>                                ? std::max&lt;size_t&gt;(1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::ceil(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a>)))</div>
<div class="line"><span class="lineno">  396</span>                                : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>(1);</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_coarse</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  398</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_coarse</a>), <span class="keyword">false</span>});</div>
<div class="line"><span class="lineno">  399</span>    }</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    <span class="comment">// Break anchors</span></div>
<div class="line"><span class="lineno">  402</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">br</a> : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>) {</div>
<div class="line"><span class="lineno">  403</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">br</a>.lg2, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  404</span>    }</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    <span class="comment">// Refinement around top-weighted breaks</span></div>
<div class="line"><span class="lineno">  407</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_refine</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  408</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>].<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius</a>);</div>
<div class="line"><span class="lineno">  409</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>].<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius</a>);</div>
<div class="line"><span class="lineno">  410</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fine_step</a>));</div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt;= n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) {</div>
<div class="line"><span class="lineno">  412</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(n), <span class="keyword">false</span>});</div>
<div class="line"><span class="lineno">  413</span>        }</div>
<div class="line"><span class="lineno">  414</span>    }</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>    <span class="comment">// Sort and merge close points, protecting break positions</span></div>
<div class="line"><span class="lineno">  417</span>    std::ranges::sort(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>, [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) { <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>.lg2 &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>.lg2; });</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>    std::vector&lt;Pt&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>;</div>
<div class="line"><span class="lineno">  420</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.size());</div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>) {</div>
<div class="line"><span class="lineno">  422</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.empty() &amp;&amp; p.lg2 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().lg2 &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merge_eps</a>) {</div>
<div class="line"><span class="lineno">  423</span>            <span class="keywordflow">if</span> (p.is_break &amp;&amp; !<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().is_break) {</div>
<div class="line"><span class="lineno">  424</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back() = p;</div>
<div class="line"><span class="lineno">  425</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  426</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().is_break = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().is_break || p.is_break;</div>
<div class="line"><span class="lineno">  427</span>            }</div>
<div class="line"><span class="lineno">  428</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  429</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back(p);</div>
<div class="line"><span class="lineno">  430</span>        }</div>
<div class="line"><span class="lineno">  431</span>    }</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">// Ensure endpoints</span></div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.empty()) {</div>
<div class="line"><span class="lineno">  435</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  436</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  437</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  438</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.front().lg2 = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>;</div>
<div class="line"><span class="lineno">  439</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size() == 1) {</div>
<div class="line"><span class="lineno">  440</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  441</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  442</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().lg2 = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>;</div>
<div class="line"><span class="lineno">  443</span>        }</div>
<div class="line"><span class="lineno">  444</span>    }</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>    <span class="comment">// Hard cap with uniform subsampling</span></div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size() &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a>) {</div>
<div class="line"><span class="lineno">  448</span>        std::vector&lt;Pt&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>;</div>
<div class="line"><span class="lineno">  449</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a>);</div>
<div class="line"><span class="lineno">  450</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  451</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size() - 1) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a> - 1)]);</div>
<div class="line"><span class="lineno">  452</span>        }</div>
<div class="line"><span class="lineno">  453</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.swap(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>);</div>
<div class="line"><span class="lineno">  454</span>    }</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span>    grid = Array::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size()});</div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  458</span>        grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>].<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a>);</div>
<div class="line"><span class="lineno">  459</span>    }</div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size();</div>
<div class="line"><span class="lineno">  461</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00024">macros.h:24</a></div></div>
<div class="ttc" id="amesh_8h_html_aba685e866cceb5c13d7e357fcaa69529"><div class="ttname"><a href="mesh_8h.html#aba685e866cceb5c13d7e357fcaa69529">log2_10</a></div><div class="ttdeci">constexpr Real log2_10</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00021">mesh.h:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph.png" border="0" usemap="#amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph" alt=""/></div>
<map name="amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph" id="amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph">
<area shape="rect" title="Builds an adaptive log&#45;spaced grid with explicit break points." alt="" coords="5,5,152,45"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="200,13,355,38"/>
<area shape="poly" title=" " alt="" coords="152,23,186,23,186,28,152,28"/>
</map>
</div>

</div>
</div>
<a id="a360e0d18f141d6cd50b062a901338575" name="a360e0d18f141d6cd50b062a901338575"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a360e0d18f141d6cd50b062a901338575">&#9670;&#160;</a></span>adaptive_phi_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> adaptive_phi_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>phi_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>theta_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00635">635</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  636</span>                                              {</div>
<div class="line"><span class="lineno">  637</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a> == 0 &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>) {</div>
<div class="line"><span class="lineno">  638</span>        <span class="keywordflow">return</span> xt::linspace(0., 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>);</div>
<div class="line"><span class="lineno">  639</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  640</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_tv</a> = std::cos(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>);</div>
<div class="line"><span class="lineno">  641</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sin_tv</a> = std::sin(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>);</div>
<div class="line"><span class="lineno">  642</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta</a> = theta_grid.size();</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>        <span class="comment">// Precompute dcos_theta bin widths from theta grid</span></div>
<div class="line"><span class="lineno">  645</span>        std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dcos</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta</a>);</div>
<div class="line"><span class="lineno">  646</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>) {</div>
<div class="line"><span class="lineno">  647</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> == 0) ? 0.0 : 0.5 * (theta_grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> - 1) + theta_grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>));</div>
<div class="line"><span class="lineno">  648</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">right</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> == <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta</a> - 1) ? theta_grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>) : 0.5 * (theta_grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>) + theta_grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> + 1));</div>
<div class="line"><span class="lineno">  649</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dcos</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>] = std::fabs(std::cos(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a>) - std::cos(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">right</a>));</div>
<div class="line"><span class="lineno">  650</span>        }</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a> = [=, &amp;<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span>&amp; <span class="comment">/*cdf*/</span>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi) {</div>
<div class="line"><span class="lineno">  653</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_phi</a> = std::cos(phi);</div>
<div class="line"><span class="lineno">  654</span>            <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a> = 0;</div>
<div class="line"><span class="lineno">  655</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>) {</div>
<div class="line"><span class="lineno">  656</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta = theta_grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>);</div>
<div class="line"><span class="lineno">  657</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, theta);</div>
<div class="line"><span class="lineno">  658</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> = std::sqrt(std::fabs(Gamma * Gamma - 1)) / Gamma;</div>
<div class="line"><span class="lineno">  659</span>                <span class="comment">// cos(angle to LOS) = cos(theta)cos(theta_v) + sin(theta)sin(theta_v)cos(phi)</span></div>
<div class="line"><span class="lineno">  660</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_alpha</a> = std::cos(theta) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_tv</a> + std::sin(theta) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sin_tv</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_phi</a>;</div>
<div class="line"><span class="lineno">  661</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> = (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_alpha</a>);</div>
<div class="line"><span class="lineno">  662</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weight</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> * Gamma * std::sqrt((Gamma - 1) * Gamma) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dcos</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>]; <span class="comment">//std::sin(theta);</span></div>
<div class="line"><span class="lineno">  663</span>                <span class="comment">//max_weight = std::max(max_weight, weight);</span></div>
<div class="line"><span class="lineno">  664</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a> += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weight</a>;</div>
<div class="line"><span class="lineno">  665</span>            }</div>
<div class="line"><span class="lineno">  666</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a>;</div>
<div class="line"><span class="lineno">  667</span>        };</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="mesh_8h.html#a6f8fa2784bc01569368e72d4020bb9b0">inverse_CFD_sampling</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a>, 0, 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>);</div>
<div class="line"><span class="lineno">  670</span>    }</div>
<div class="line"><span class="lineno">  671</span>}</div>
<div class="ttc" id="amesh_8h_html_a6f8fa2784bc01569368e72d4020bb9b0"><div class="ttname"><a href="mesh_8h.html#a6f8fa2784bc01569368e72d4020bb9b0">inverse_CFD_sampling</a></div><div class="ttdeci">Array inverse_CFD_sampling(Func &amp;&amp;pdf, Real min, Real max, size_t num, size_t sample_num=defaults::sampling::theta_samples)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00555">mesh.h:555</a></div></div>
<div class="ttc" id="anamespacecon_html_aa0ccd904b754d0f907898a942516d121"><div class="ttname"><a href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a></div><div class="ttdeci">constexpr Real pi</div><div class="ttdoc">Pi.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00097">macros.h:97</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a360e0d18f141d6cd50b062a901338575_cgraph.png" border="0" usemap="#amesh_8h_a360e0d18f141d6cd50b062a901338575_cgraph" alt=""/></div>
<map name="amesh_8h_a360e0d18f141d6cd50b062a901338575_cgraph" id="amesh_8h_a360e0d18f141d6cd50b062a901338575_cgraph">
<area shape="rect" title=" " alt="" coords="5,96,144,121"/>
<area shape="rect" href="mesh_8h.html#a6f8fa2784bc01569368e72d4020bb9b0" title=" " alt="" coords="192,46,363,72"/>
<area shape="poly" title=" " alt="" coords="127,93,211,73,212,78,128,98"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="509,46,664,72"/>
<area shape="poly" title=" " alt="" coords="144,114,211,118,291,120,376,117,461,106,506,93,548,76,550,81,508,98,462,111,377,122,291,125,211,124,144,119"/>
<area shape="poly" title=" " alt="" coords="299,44,330,28,371,14,416,4,462,6,509,20,551,38,548,43,507,25,461,11,416,10,372,19,333,33,302,49"/>
<area shape="rect" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491" title="Returns the value of a single parameter." alt="" coords="411,21,461,46"/>
<area shape="poly" title=" " alt="" coords="357,44,397,37,398,43,358,49"/>
<area shape="rect" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1" title="Returns the value of a single parameter." alt="" coords="413,70,459,96"/>
<area shape="poly" title=" " alt="" coords="362,69,400,75,399,80,361,74"/>
<area shape="poly" title=" " alt="" coords="462,35,498,42,497,47,461,41"/>
<area shape="poly" title=" " alt="" coords="459,77,495,71,496,76,460,82"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a360e0d18f141d6cd50b062a901338575_icgraph.png" border="0" usemap="#amesh_8h_a360e0d18f141d6cd50b062a901338575_icgraph" alt=""/></div>
<map name="amesh_8h_a360e0d18f141d6cd50b062a901338575_icgraph" id="amesh_8h_a360e0d18f141d6cd50b062a901338575_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,913,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a3dc6828dd13a70c0c203dba03e765cea" name="a3dc6828dd13a70c0c203dba03e765cea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dc6828dd13a70c0c203dba03e765cea">&#9670;&#160;</a></span>adaptive_theta_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> adaptive_theta_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>theta_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00593">593</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  593</span>                                                                                                             {</div>
<div class="line"><span class="lineno">  594</span>    <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a> = [=, &amp;<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span>&amp; <span class="comment">/*cdf*/</span>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta) {</div>
<div class="line"><span class="lineno">  595</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, theta);</div>
<div class="line"><span class="lineno">  596</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> = std::sqrt(std::fabs(Gamma * Gamma - 1)) / Gamma;</div>
<div class="line"><span class="lineno">  597</span>        <span class="comment">// Real D = 1 / (Gamma * (1 - beta * std::cos(theta - theta_v)));</span></div>
<div class="line"><span class="lineno">  598</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> = (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * std::cos(theta - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>));</div>
<div class="line"><span class="lineno">  599</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> * Gamma * std::sqrt((Gamma - 1) * Gamma) * std::sin(theta);</div>
<div class="line"><span class="lineno">  600</span>        <span class="comment">// pdf = D * std::sin(theta);</span></div>
<div class="line"><span class="lineno">  601</span>    };</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="mesh_8h.html#a6f8fa2784bc01569368e72d4020bb9b0">inverse_CFD_sampling</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a>, theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>);</div>
<div class="line"><span class="lineno">  604</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph.png" border="0" usemap="#amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph" alt=""/></div>
<map name="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph" id="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph">
<area shape="rect" title=" " alt="" coords="5,96,157,121"/>
<area shape="rect" href="mesh_8h.html#a6f8fa2784bc01569368e72d4020bb9b0" title=" " alt="" coords="205,46,376,72"/>
<area shape="poly" title=" " alt="" coords="135,93,222,72,224,78,137,98"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="523,46,677,72"/>
<area shape="poly" title=" " alt="" coords="158,114,225,119,305,120,390,117,474,106,520,93,561,76,563,81,522,98,475,111,391,122,305,126,225,124,157,119"/>
<area shape="poly" title=" " alt="" coords="312,44,344,28,384,14,429,4,475,6,522,20,564,38,562,43,520,25,474,11,430,10,385,19,346,33,315,49"/>
<area shape="rect" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491" title="Returns the value of a single parameter." alt="" coords="424,21,475,46"/>
<area shape="poly" title=" " alt="" coords="370,44,410,37,411,43,371,49"/>
<area shape="rect" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1" title="Returns the value of a single parameter." alt="" coords="426,70,473,96"/>
<area shape="poly" title=" " alt="" coords="375,69,413,75,412,80,374,74"/>
<area shape="poly" title=" " alt="" coords="476,35,511,42,511,47,475,41"/>
<area shape="poly" title=" " alt="" coords="473,77,509,71,510,76,474,82"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph.png" border="0" usemap="#amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph" alt=""/></div>
<map name="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph" id="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,927,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a96aa0a78a0de13a52955de3c2ce29ddd" name="a96aa0a78a0de13a52955de3c2ce29ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96aa0a78a0de13a52955de3c2ce29ddd">&#9670;&#160;</a></span>auto_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCoord.html">Coord</a> auto_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_view</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a81845ddcce8fb560efb401cdde437a16">defaults::grid::phi_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a372994c537be68d80989655f9b43c672">defaults::grid::theta_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#aa203749fa338e32e6c7a711c82846582">defaults::grid::time_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em> = <code><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">true</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi_view</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>min_theta_num</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a17f64e94f8f9cb660a1e9d80a2b1558c">defaults::grid::min_theta_points</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>fwd_ratio</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#ae654c737813ff06431141238b26e0a67">defaults::grid::forward_ratio</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a coordinate grid (<a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a>) for shock evolution. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">theta_cut</td><td>Maximum theta value to include </td></tr>
    <tr><td class="paramname">theta_view</td><td>Viewing angle </td></tr>
    <tr><td class="paramname">z</td><td>Redshift </td></tr>
    <tr><td class="paramname">phi_resol</td><td></td></tr>
    <tr><td class="paramname">theta_resol</td><td></td></tr>
    <tr><td class="paramname">t_resol</td><td></td></tr>
    <tr><td class="paramname">is_axisymmetric</td><td>Whether the jet is axisymmetric (default: true) </td></tr>
    <tr><td class="paramname">phi_view</td><td>Viewing angle (default: 0) </td></tr>
    <tr><td class="paramname">min_theta_num</td><td>Minimum number of theta grid points (default: 56) </td></tr>
    <tr><td class="paramname">fwd_ratio</td><td>Forward ratio for grid resolution (default: 0.3) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a> object with the constructed grid</dd></dl>
<p>The grid is based on the observation times (t_obs), maximum theta value (theta_cut), and specified numbers of grid points in phi, theta, and t. The radial grid is logarithmically spaced between t_min and t_max, and the theta grid is generated linearly. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00926">926</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  928</span>                                                      {</div>
<div class="line"><span class="lineno">  929</span>    <a class="code hl_class" href="classCoord.html">Coord</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>;</div>
<div class="line"><span class="lineno">  930</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.<a class="code hl_variable" href="classCoord.html#aeb5bef37e495fdeefad735154e99bf73">theta_view</a> = theta_view;</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_jumps</a> = <a class="code hl_function" href="mesh_8h.html#a0cb4f8dcb245bdf3dba21d11f42d07e0">find_jet_jumps</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="code hl_variable" href="namespacecon.html#a9c6b1c9b349c790392fa370c8d9e13a8">con::Gamma_cut</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>);</div>
<div class="line"><span class="lineno">  933</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edge</a> = <a class="code hl_function" href="mesh_8h.html#aa4bf3bc5ca82cf7ac350fab9eff68452">find_theta_max</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="code hl_variable" href="namespacecon.html#a9c6b1c9b349c790392fa370c8d9e13a8">con::Gamma_cut</a>);</div>
<div class="line"><span class="lineno">  934</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_jumps</a>.empty()) {</div>
<div class="line"><span class="lineno">  935</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edge</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edge</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_jumps</a>.back());</div>
<div class="line"><span class="lineno">  936</span>    }</div>
<div class="line"><span class="lineno">  937</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  938</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edge</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_cut</a>);</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_theta_num</a> + <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) * 180 / <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> * theta_resol);</div>
<div class="line"><span class="lineno">  941</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta_num</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fwd_ratio</a>);</div>
<div class="line"><span class="lineno">  942</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta_num</a>;</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta</a> = xt::linspace(theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta_num</a>);</div>
<div class="line"><span class="lineno">  945</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta</a> = <a class="code hl_function" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta_num</a>, theta_view);</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>;</div>
<div class="line"><span class="lineno">  948</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jump_theta</a> = <a class="code hl_function" href="mesh_8h.html#ae31d546d7f15fece5525fd480b771b68">jump_refinement_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_jumps</a>, theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a>, theta_resol);</div>
<div class="line"><span class="lineno">  949</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta = <a class="code hl_function" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a>(<a class="code hl_function" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jump_theta</a>);</div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a> = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(360 * phi_resol), 1);</div>
<div class="line"><span class="lineno">  952</span> </div>
<div class="line"><span class="lineno">  953</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a> &lt;= 2) {</div>
<div class="line"><span class="lineno">  954</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi = xt::linspace(0., 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>);</div>
<div class="line"><span class="lineno">  955</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  956</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_phi_num</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a> * 0.3);</div>
<div class="line"><span class="lineno">  957</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_phi_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_phi_num</a>;</div>
<div class="line"><span class="lineno">  958</span> </div>
<div class="line"><span class="lineno">  959</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_phi</a> = xt::linspace(0., 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_phi_num</a>);</div>
<div class="line"><span class="lineno">  960</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_phi</a> = <a class="code hl_function" href="mesh_8h.html#a360e0d18f141d6cd50b062a901338575">adaptive_phi_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_phi_num</a>, theta_view, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>);</div>
<div class="line"><span class="lineno">  961</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi = <a class="code hl_function" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_phi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_phi</a>);</div>
<div class="line"><span class="lineno">  962</span>    }</div>
<div class="line"><span class="lineno">  963</span>    <span class="comment">// Shift phi grid by half the first spacing so no point lands on the</span></div>
<div class="line"><span class="lineno">  964</span>    <span class="comment">// Doppler peak at phi=0; the grid becomes [delta, 2pi+delta] which</span></div>
<div class="line"><span class="lineno">  965</span>    <span class="comment">// preserves the same topology (first/last at same physical angle).</span></div>
<div class="line"><span class="lineno">  966</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shift</a> = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi(1) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi(0));</div>
<div class="line"><span class="lineno">  967</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shift</a>;</div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span>    <span class="keywordflow">if</span> (t_obs.size() == 0) {</div>
<div class="line"><span class="lineno">  970</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">assert</a>(<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;auto_grid: t_obs is empty&quot;</span>);</div>
<div class="line"><span class="lineno">  971</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>;</div>
<div class="line"><span class="lineno">  972</span>    }</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a> = *std::ranges::max_element(t_obs);</div>
<div class="line"><span class="lineno">  975</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a> = *std::ranges::min_element(t_obs);</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.detect_symmetry(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, medium, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a>, z, t_resol);</div>
<div class="line"><span class="lineno">  978</span>    <a class="code hl_function" href="mesh_8h.html#a6130a6c9bb4bbe255dd8852fd154791d">build_time_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, medium, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a>, z, t_resol, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>);</div>
<div class="line"><span class="lineno">  979</span> </div>
<div class="line"><span class="lineno">  980</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>;</div>
<div class="line"><span class="lineno">  981</span>}</div>
<div class="ttc" id="aclassCoord_html"><div class="ttname"><a href="classCoord.html">Coord</a></div><div class="ttdoc">Represents a coordinate system with arrays for phi, theta, and t.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00072">mesh.h:72</a></div></div>
<div class="ttc" id="aclassCoord_html_aeb5bef37e495fdeefad735154e99bf73"><div class="ttname"><a href="classCoord.html#aeb5bef37e495fdeefad735154e99bf73">Coord::theta_view</a></div><div class="ttdeci">Real theta_view</div><div class="ttdoc">Viewing angle.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00080">mesh.h:80</a></div></div>
<div class="ttc" id="amesh_8h_html_a0cb4f8dcb245bdf3dba21d11f42d07e0"><div class="ttname"><a href="mesh_8h.html#a0cb4f8dcb245bdf3dba21d11f42d07e0">find_jet_jumps</a></div><div class="ttdeci">std::vector&lt; Real &gt; find_jet_jumps(Ejecta const &amp;jet, Real gamma_cut, bool is_axisymmetric)</div><div class="ttdoc">Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00464">mesh.h:464</a></div></div>
<div class="ttc" id="amesh_8h_html_a360e0d18f141d6cd50b062a901338575"><div class="ttname"><a href="mesh_8h.html#a360e0d18f141d6cd50b062a901338575">adaptive_phi_grid</a></div><div class="ttdeci">Array adaptive_phi_grid(Ejecta const &amp;jet, size_t phi_num, Real theta_v, Array const &amp;theta_grid, bool is_axisymmetric)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00635">mesh.h:635</a></div></div>
<div class="ttc" id="amesh_8h_html_a3c066f2c8e6d102d7a56de8cb42cf5a8"><div class="ttname"><a href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a></div><div class="ttdeci">Array merge_grids(Arr const &amp;arr1, Arr const &amp;arr2)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00674">mesh.h:674</a></div></div>
<div class="ttc" id="amesh_8h_html_a3dc6828dd13a70c0c203dba03e765cea"><div class="ttname"><a href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a></div><div class="ttdeci">Array adaptive_theta_grid(Ejecta const &amp;jet, Real theta_min, Real theta_max, size_t theta_num, Real theta_v)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00593">mesh.h:593</a></div></div>
<div class="ttc" id="amesh_8h_html_a6130a6c9bb4bbe255dd8852fd154791d"><div class="ttname"><a href="mesh_8h.html#a6130a6c9bb4bbe255dd8852fd154791d">build_time_grid</a></div><div class="ttdeci">void build_time_grid(Coord &amp;coord, Ejecta const &amp;jet, Medium const &amp;medium, Real t_min, Real t_max, Real z, Real t_resol, bool is_axisymmetric)</div><div class="ttdoc">Builds the engine-time grid for each (phi, theta) cell in the coordinate system.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00882">mesh.h:882</a></div></div>
<div class="ttc" id="amesh_8h_html_aa4bf3bc5ca82cf7ac350fab9eff68452"><div class="ttname"><a href="mesh_8h.html#aa4bf3bc5ca82cf7ac350fab9eff68452">find_theta_max</a></div><div class="ttdeci">Real find_theta_max(Ejecta const &amp;jet, Real gamma_cut)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00510">mesh.h:510</a></div></div>
<div class="ttc" id="amesh_8h_html_ae31d546d7f15fece5525fd480b771b68"><div class="ttname"><a href="mesh_8h.html#ae31d546d7f15fece5525fd480b771b68">jump_refinement_grid</a></div><div class="ttdeci">Array jump_refinement_grid(std::vector&lt; Real &gt; const &amp;jet_jumps, Real theta_min, Real theta_max, Real avg_spacing, Real theta_resol)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00606">mesh.h:606</a></div></div>
<div class="ttc" id="amesh_8h_html_afd05120c4d579ec7fa4906f677781a83"><div class="ttname"><a href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a></div><div class="ttdeci">xt::xtensor&lt; Real, 1 &gt; Array</div><div class="ttdoc">Type alias for 1D arrays (e.g., time points)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00041">mesh.h:41</a></div></div>
<div class="ttc" id="anamespacecon_html_a9c6b1c9b349c790392fa370c8d9e13a8"><div class="ttname"><a href="namespacecon.html#a9c6b1c9b349c790392fa370c8d9e13a8">con::Gamma_cut</a></div><div class="ttdeci">constexpr Real Gamma_cut</div><div class="ttdoc">Cutoff Lorentz factor value.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00105">macros.h:105</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1grid_html_af2b7c5de15cb9c537f0de0e0e56148b1"><div class="ttname"><a href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a></div><div class="ttdeci">constexpr double theta_min</div><div class="ttdoc">Minimum polar angle (avoids singularity at theta=0)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00080">simulation-defaults.h:80</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph.png" border="0" usemap="#amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph" alt=""/></div>
<map name="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph" id="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph">
<area shape="rect" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="5,434,88,460"/>
<area shape="rect" href="mesh_8h.html#a360e0d18f141d6cd50b062a901338575" title=" " alt="" coords="143,149,281,174"/>
<area shape="poly" title=" " alt="" coords="47,433,56,393,72,335,97,271,114,239,134,211,151,193,171,179,174,183,155,197,138,214,119,242,102,273,77,337,61,394,53,434"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="751,301,905,326"/>
<area shape="poly" title=" " alt="" coords="45,434,47,380,59,301,70,257,85,213,106,172,134,135,157,111,180,95,224,76,274,67,335,56,441,29,527,6,568,3,610,7,655,21,704,47,734,71,758,100,778,132,794,167,816,234,826,287,821,288,810,235,789,169,774,135,754,103,730,75,701,52,653,26,609,12,568,8,528,12,442,34,337,62,275,72,226,81,183,100,161,116,138,138,111,174,90,215,75,258,64,302,53,380,50,434"/>
<area shape="rect" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea" title=" " alt="" coords="136,225,288,250"/>
<area shape="poly" title=" " alt="" coords="56,432,190,260,194,263,60,435"/>
<area shape="rect" href="mesh_8h.html#a6130a6c9bb4bbe255dd8852fd154791d" title="Builds the engine&#45;time grid for each (phi, theta) cell in the coordinate system." alt="" coords="151,385,273,410"/>
<area shape="poly" title=" " alt="" coords="87,432,155,412,156,417,89,437"/>
<area shape="rect" href="mesh_8h.html#a0cb4f8dcb245bdf3dba21d11f42d07e0" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="363,489,480,514"/>
<area shape="poly" title=" " alt="" coords="89,450,349,489,349,494,88,455"/>
<area shape="rect" href="mesh_8h.html#aa4bf3bc5ca82cf7ac350fab9eff68452" title=" " alt="" coords="567,542,690,568"/>
<area shape="poly" title=" " alt="" coords="73,457,137,484,248,513,362,532,467,544,554,550,553,555,467,549,361,538,247,518,135,489,71,462"/>
<area shape="rect" href="mesh_8h.html#ae31d546d7f15fece5525fd480b771b68" title=" " alt="" coords="339,592,504,617"/>
<area shape="poly" title=" " alt="" coords="55,459,84,515,108,545,137,570,182,590,230,603,279,609,325,610,325,615,279,614,229,608,180,595,135,575,104,549,79,517,50,461"/>
<area shape="rect" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8" title=" " alt="" coords="161,642,263,668"/>
<area shape="poly" title=" " alt="" coords="54,459,63,491,80,534,105,580,138,621,156,634,153,638,134,625,100,583,75,537,58,493,49,461"/>
<area shape="rect" href="mesh_8h.html#a6f8fa2784bc01569368e72d4020bb9b0" title=" " alt="" coords="336,149,507,174"/>
<area shape="poly" title=" " alt="" coords="282,159,322,159,322,164,282,164"/>
<area shape="poly" title=" " alt="" coords="234,146,315,106,372,84,436,64,504,51,573,47,641,57,673,68,704,83,731,103,753,127,788,183,811,240,824,286,819,288,806,242,783,185,749,130,727,107,701,88,671,73,639,62,573,53,505,56,437,69,374,89,318,111,236,151"/>
<area shape="poly" title=" " alt="" coords="443,146,492,122,559,100,596,93,633,91,669,96,704,110,728,127,750,148,784,196,808,245,822,287,817,288,803,247,779,199,746,151,725,131,701,115,668,101,633,96,596,98,560,105,494,127,445,151"/>
<area shape="rect" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491" title="Returns the value of a single parameter." alt="" coords="603,125,654,150"/>
<area shape="poly" title=" " alt="" coords="507,149,590,139,590,145,507,154"/>
<area shape="rect" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1" title="Returns the value of a single parameter." alt="" coords="605,174,652,200"/>
<area shape="poly" title=" " alt="" coords="507,169,592,180,591,185,507,175"/>
<area shape="poly" title=" " alt="" coords="655,139,680,147,704,159,740,189,771,224,815,287,810,290,767,227,736,193,701,164,678,152,653,145"/>
<area shape="poly" title=" " alt="" coords="653,193,704,217,758,253,803,289,800,294,755,258,701,221,651,198"/>
<area shape="poly" title=" " alt="" coords="247,222,372,177,373,182,249,227"/>
<area shape="poly" title=" " alt="" coords="288,233,478,239,591,249,703,267,747,279,786,293,784,298,745,284,702,272,590,254,477,244,288,239"/>
<area shape="poly" title=" " alt="" coords="227,383,273,349,303,332,335,319,387,306,441,297,549,288,651,290,737,298,737,303,651,296,550,294,442,302,388,311,337,324,305,337,276,354,230,387"/>
<area shape="rect" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="360,334,483,360"/>
<area shape="poly" title=" " alt="" coords="265,382,354,360,356,365,266,387"/>
<area shape="rect" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090" title="Converts Lorentz factor (gamma) to a velocity fraction (beta)" alt="" coords="555,376,703,416"/>
<area shape="poly" title=" " alt="" coords="274,395,541,394,541,399,274,400"/>
<area shape="rect" href="mesh_8h.html#a0aaa6d60a9852531ccfc1d290284c611" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="561,441,697,466"/>
<area shape="poly" title=" " alt="" coords="274,403,547,440,547,445,273,408"/>
<area shape="poly" title=" " alt="" coords="482,339,737,318,737,324,483,345"/>
<area shape="poly" title=" " alt="" coords="476,357,542,373,541,378,475,362"/>
<area shape="poly" title=" " alt="" coords="677,374,782,329,784,334,679,379"/>
<area shape="poly" title=" " alt="" coords="675,438,701,426,732,405,760,381,805,335,809,339,764,385,735,409,704,431,677,443"/>
<area shape="poly" title=" " alt="" coords="480,507,530,510,588,507,646,497,701,475,740,446,772,409,797,370,814,337,818,340,801,373,776,412,744,450,704,480,648,502,588,513,530,515,480,512"/>
<area shape="poly" title=" " alt="" coords="669,540,701,521,741,477,774,427,798,378,815,339,820,341,803,380,778,429,745,480,704,525,672,545"/>
<area shape="poly" title=" " alt="" coords="502,614,550,616,603,613,654,600,701,577,729,553,753,523,772,491,788,457,809,392,820,339,826,340,815,393,793,459,777,494,757,527,733,556,704,581,656,605,603,618,550,622,502,620"/>
<area shape="poly" title=" " alt="" coords="264,665,354,680,410,685,469,687,530,682,591,671,648,651,701,621,733,592,759,557,779,518,795,478,814,400,822,340,828,340,820,401,800,480,784,521,763,560,737,595,704,625,651,656,592,676,531,688,469,692,409,691,353,686,263,670"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph.png" border="0" usemap="#amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph" alt=""/></div>
<map name="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph" id="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph">
<area shape="rect" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a885b165e8d9c9d20f27ec99329a0c3cb" name="a885b165e8d9c9d20f27ec99329a0c3cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a885b165e8d9c9d20f27ec99329a0c3cb">&#9670;&#160;</a></span>boundary_to_center() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> boundary_to_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using linear interpolation. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Arr1</td><td>Type of the input array </td></tr>
    <tr><td class="paramname">Arr2</td><td>Type of the output array </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
    <tr><td class="paramname">center</td><td>Output array of center values</td></tr>
  </table>
  </dd>
</dl>
<p>This is used to compute cell-centered values from cell-boundary values. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00258">258</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  258</span>                                                            {</div>
<div class="line"><span class="lineno">  259</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2 || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size() + 1 != <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size()) {</div>
<div class="line"><span class="lineno">  260</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  261</span>    }</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  263</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">  264</span>    }</div>
<div class="line"><span class="lineno">  265</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph.png" border="0" usemap="#amesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph" alt=""/></div>
<map name="amesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph" id="amesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph">
<area shape="rect" title="Converts boundary values to center values using linear interpolation." alt="" coords="5,5,156,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="204,5,359,31"/>
<area shape="poly" title=" " alt="" coords="156,15,191,15,191,21,156,21"/>
</map>
</div>

</div>
</div>
<a id="ae1622b29b5488dbee3ef9068b9f8c7d4" name="ae1622b29b5488dbee3ef9068b9f8c7d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1622b29b5488dbee3ef9068b9f8c7d4">&#9670;&#160;</a></span>boundary_to_center() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> boundary_to_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using linear interpolation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of center values </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00038">38</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>                                                {</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2) {</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">return</span> Array::from_shape({0});</div>
<div class="line"><span class="lineno">   41</span>    }</div>
<div class="line"><span class="lineno">   42</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() - 1}, 0);</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   44</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">   45</span>    }</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>;</div>
<div class="line"><span class="lineno">   47</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph.png" border="0" usemap="#amesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph" alt=""/></div>
<map name="amesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph" id="amesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph">
<area shape="rect" title="Converts boundary values to center values using linear interpolation." alt="" coords="5,5,156,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="204,5,359,31"/>
<area shape="poly" title=" " alt="" coords="156,15,191,15,191,21,156,21"/>
</map>
</div>

</div>
</div>
<a id="aba66986baad5475a202c20a92bda036e" name="aba66986baad5475a202c20a92bda036e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba66986baad5475a202c20a92bda036e">&#9670;&#160;</a></span>boundary_to_center_log() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> boundary_to_center_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using geometric mean (logarithmic interpolation) </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Arr1</td><td>Type of the input array </td></tr>
    <tr><td class="paramname">Arr2</td><td>Type of the output array </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
    <tr><td class="paramname">center</td><td>Output array of center values</td></tr>
  </table>
  </dd>
</dl>
<p>This is used when working with logarithmically scaled quantities. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00268">268</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  268</span>                                                                {</div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2 || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size() + 1 != <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size()) {</div>
<div class="line"><span class="lineno">  270</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  271</span>    }</div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  273</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = std::sqrt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">  274</span>    }</div>
<div class="line"><span class="lineno">  275</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aba66986baad5475a202c20a92bda036e_cgraph.png" border="0" usemap="#amesh_8h_aba66986baad5475a202c20a92bda036e_cgraph" alt=""/></div>
<map name="amesh_8h_aba66986baad5475a202c20a92bda036e_cgraph" id="amesh_8h_aba66986baad5475a202c20a92bda036e_cgraph">
<area shape="rect" title="Converts boundary values to center values using geometric mean (logarithmic interpolation)" alt="" coords="5,5,184,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="232,5,387,31"/>
<area shape="poly" title=" " alt="" coords="184,15,218,15,218,21,184,21"/>
</map>
</div>

</div>
</div>
<a id="ac536f77c32691232cb5e7546595fb3d2" name="ac536f77c32691232cb5e7546595fb3d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac536f77c32691232cb5e7546595fb3d2">&#9670;&#160;</a></span>boundary_to_center_log() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> boundary_to_center_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using geometric mean. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of center values </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00049">49</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>                                                    {</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2) {</div>
<div class="line"><span class="lineno">   51</span>        <span class="keywordflow">return</span> Array::from_shape({0});</div>
<div class="line"><span class="lineno">   52</span>    }</div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() - 1}, 0);</div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   55</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = std::sqrt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">   56</span>    }</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>;</div>
<div class="line"><span class="lineno">   58</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph.png" border="0" usemap="#amesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph" alt=""/></div>
<map name="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph" id="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph">
<area shape="rect" title="Converts boundary values to center values using geometric mean." alt="" coords="5,5,184,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="232,5,387,31"/>
<area shape="poly" title=" " alt="" coords="184,15,218,15,218,21,184,21"/>
</map>
</div>

</div>
</div>
<a id="a6130a6c9bb4bbe255dd8852fd154791d" name="a6130a6c9bb4bbe255dd8852fd154791d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6130a6c9bb4bbe255dd8852fd154791d">&#9670;&#160;</a></span>build_time_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> build_time_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCoord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_resol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Builds the engine-time grid for each (phi, theta) cell in the coordinate system. </p>
<p>Uses the detected symmetry to determine whether to build per-group (broadcast) or per-cell grids. For broadcast cases, uses worst-case cos_v within each group. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coord</td><td>The coordinate object (must have phi, theta, symmetry, theta_reps set) </td></tr>
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">medium</td><td>The medium object </td></tr>
    <tr><td class="paramname">t_min</td><td>Minimum observer time </td></tr>
    <tr><td class="paramname">t_max</td><td>Maximum observer time </td></tr>
    <tr><td class="paramname">z</td><td>Redshift </td></tr>
    <tr><td class="paramname">t_resol</td><td>Time resolution </td></tr>
    <tr><td class="paramname">is_axisymmetric</td><td>Whether the jet is axisymmetric </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00882">882</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  883</span>                                                         {</div>
<div class="line"><span class="lineno">  884</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta.size();</div>
<div class="line"><span class="lineno">  885</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a> ? 1 : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi.size();</div>
<div class="line"><span class="lineno">  886</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v_max</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta.back() + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta_view;</div>
<div class="line"><span class="lineno">  887</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a> = 1.01 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a> / (1 + z);</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>    <span class="comment">// First pass: find the widest per-cell engine-frame time range to size the budget.</span></div>
<div class="line"><span class="lineno">  890</span>    <span class="comment">// High-Gamma cells have much earlier t_start due to relativistic time-of-flight compression.</span></div>
<div class="line"><span class="lineno">  891</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_t_start</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>;</div>
<div class="line"><span class="lineno">  892</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  893</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; theta_size; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  894</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> = <a class="code hl_function" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090">physics::relativistic::gamma_to_beta</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>)));</div>
<div class="line"><span class="lineno">  895</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a> =</div>
<div class="line"><span class="lineno">  896</span>                std::max&lt;Real&gt;(0.99 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a> * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) / (1 - std::cos(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v_max</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) / (1 + z), 1e-2 * <a class="code hl_variable" href="namespaceunit.html#a4e7c438655d3f34c7c30a155ec38f250">unit::sec</a>);</div>
<div class="line"><span class="lineno">  897</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_t_start</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_t_start</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>);</div>
<div class="line"><span class="lineno">  898</span>        }</div>
<div class="line"><span class="lineno">  899</span>    }</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">base_t_num</a> = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_t_start</a>) * t_resol), 24);</div>
<div class="line"><span class="lineno">  902</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_ratio</a> = 2.0;</div>
<div class="line"><span class="lineno">  903</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a> = 0.3;</div>
<div class="line"><span class="lineno">  904</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> = 10.0;</div>
<div class="line"><span class="lineno">  905</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_extra</a> =</div>
<div class="line"><span class="lineno">  906</span>        <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_ratio</a> - 1.0) * t_resol * std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a>));</div>
<div class="line"><span class="lineno">  907</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">base_t_num</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_extra</a>;</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.t = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a>, theta_size, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>});</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>    <span class="comment">// Second pass: build per-cell grids with per-cell t_start and t_dec.</span></div>
<div class="line"><span class="lineno">  912</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  913</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; theta_size; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  914</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> = <a class="code hl_function" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090">physics::relativistic::gamma_to_beta</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>)));</div>
<div class="line"><span class="lineno">  915</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a> =</div>
<div class="line"><span class="lineno">  916</span>                std::max&lt;Real&gt;(0.99 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a> * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) / (1 - std::cos(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v_max</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) / (1 + z), 1e-2 * <a class="code hl_variable" href="namespaceunit.html#a4e7c438655d3f34c7c30a155ec38f250">unit::sec</a>);</div>
<div class="line"><span class="lineno">  917</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_dec</a> = <a class="code hl_function" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, medium, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>));</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>            xt::view(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.t, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>, xt::all()) =</div>
<div class="line"><span class="lineno">  920</span>                <a class="code hl_function" href="mesh_8h.html#a0aaa6d60a9852531ccfc1d290284c611">refined_time_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_dec</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a>);</div>
<div class="line"><span class="lineno">  921</span>        }</div>
<div class="line"><span class="lineno">  922</span>    }</div>
<div class="line"><span class="lineno">  923</span>}</div>
<div class="ttc" id="amesh_8h_html_a0aaa6d60a9852531ccfc1d290284c611"><div class="ttname"><a href="mesh_8h.html#a0aaa6d60a9852531ccfc1d290284c611">refined_time_grid</a></div><div class="ttdeci">Array refined_time_grid(Real t_start, Real t_end, Real t_refine, size_t t_num, Real refine_lo_factor=0.3, Real refine_hi_factor=10.0)</div><div class="ttdoc">Create a refined logarithmic time grid with higher density around a specified time.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00762">mesh.h:762</a></div></div>
<div class="ttc" id="amesh_8h_html_aa7505ad2e84c2a29610c1a13cd3b25e3"><div class="ttname"><a href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a></div><div class="ttdeci">Real estimate_t_dec(Ejecta const &amp;jet, Medium const &amp;medium, Real phi, Real theta)</div><div class="ttdoc">Estimates deceleration time for a given angle from ejecta and medium properties.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00708">mesh.h:708</a></div></div>
<div class="ttc" id="anamespacephysics_1_1relativistic_html_aed1c46f33c9d25ffa27131014b190090"><div class="ttname"><a href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090">physics::relativistic::gamma_to_beta</a></div><div class="ttdeci">Real gamma_to_beta(Real gamma) noexcept</div><div class="ttdoc">Converts Lorentz factor (gamma) to a velocity fraction (beta)</div><div class="ttdef"><b>Definition</b> <a href="physics_8h_source.html#l00036">physics.h:36</a></div></div>
<div class="ttc" id="anamespaceunit_html_a4e7c438655d3f34c7c30a155ec38f250"><div class="ttname"><a href="namespaceunit.html#a4e7c438655d3f34c7c30a155ec38f250">unit::sec</a></div><div class="ttdeci">constexpr Real sec</div><div class="ttdoc">Second in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00046">macros.h:46</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a6130a6c9bb4bbe255dd8852fd154791d_cgraph.png" border="0" usemap="#amesh_8h_a6130a6c9bb4bbe255dd8852fd154791d_cgraph" alt=""/></div>
<map name="amesh_8h_a6130a6c9bb4bbe255dd8852fd154791d_cgraph" id="amesh_8h_a6130a6c9bb4bbe255dd8852fd154791d_cgraph">
<area shape="rect" title="Builds the engine&#45;time grid for each (phi, theta) cell in the coordinate system." alt="" coords="5,95,128,121"/>
<area shape="rect" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="176,70,299,95"/>
<area shape="poly" title=" " alt="" coords="128,96,162,91,163,96,129,102"/>
<area shape="rect" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090" title="Converts Lorentz factor (gamma) to a velocity fraction (beta)" alt="" coords="347,5,495,45"/>
<area shape="poly" title=" " alt="" coords="89,93,128,73,175,55,255,37,332,28,333,33,256,42,177,60,130,78,91,98"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="543,95,697,121"/>
<area shape="poly" title=" " alt="" coords="129,105,529,105,529,111,129,111"/>
<area shape="rect" href="mesh_8h.html#a0aaa6d60a9852531ccfc1d290284c611" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="353,171,489,197"/>
<area shape="poly" title=" " alt="" coords="95,118,133,135,177,149,260,166,339,176,338,181,259,172,175,155,131,140,93,123"/>
<area shape="poly" title=" " alt="" coords="278,67,343,47,344,52,280,72"/>
<area shape="poly" title=" " alt="" coords="299,84,529,99,529,105,299,89"/>
<area shape="poly" title=" " alt="" coords="471,43,576,87,574,92,469,48"/>
<area shape="poly" title=" " alt="" coords="454,169,572,123,574,128,456,174"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a6130a6c9bb4bbe255dd8852fd154791d_icgraph.png" border="0" usemap="#amesh_8h_a6130a6c9bb4bbe255dd8852fd154791d_icgraph" alt=""/></div>
<map name="amesh_8h_a6130a6c9bb4bbe255dd8852fd154791d_icgraph" id="amesh_8h_a6130a6c9bb4bbe255dd8852fd154791d_icgraph">
<area shape="rect" title="Builds the engine&#45;time grid for each (phi, theta) cell in the coordinate system." alt="" coords="775,31,897,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="aa7505ad2e84c2a29610c1a13cd3b25e3" name="aa7505ad2e84c2a29610c1a13cd3b25e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7505ad2e84c2a29610c1a13cd3b25e3">&#9670;&#160;</a></span>estimate_t_dec()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> estimate_t_dec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimates deceleration time for a given angle from ejecta and medium properties. </p>
<p>Integrates swept mass outward until m_swept = m_jet/Gamma0(phi,theta). Returns lab-frame time. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00708">708</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  708</span>                                                                                   {</div>
<div class="line"><span class="lineno">  709</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, theta);</div>
<div class="line"><span class="lineno">  710</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a> &lt;= 1) {</div>
<div class="line"><span class="lineno">  711</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecon.html#ad61313f4a5b7876e54ae46d02d4a04bd">con::inf</a>;</div>
<div class="line"><span class="lineno">  712</span>    }</div>
<div class="line"><span class="lineno">  713</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> = <a class="code hl_function" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090">physics::relativistic::gamma_to_beta</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a>);</div>
<div class="line"><span class="lineno">  714</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> m_jet = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.eps_k(phi, theta) / ((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a> - 1) * <a class="code hl_variable" href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a>);</div>
<div class="line"><span class="lineno">  715</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">target</a> = m_jet / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a>;</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">N</a> = 256;</div>
<div class="line"><span class="lineno">  718</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a> = std::log(1e-3);</div>
<div class="line"><span class="lineno">  719</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_max</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a> + 40 * std::log(10.0);</div>
<div class="line"><span class="lineno">  720</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">du</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">N</a>;</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> mass = 0;</div>
<div class="line"><span class="lineno">  723</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> = std::exp(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a>);</div>
<div class="line"><span class="lineno">  724</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> = medium.rho(phi, theta, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a>;</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">N</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  727</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a> = std::exp(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">du</a>);</div>
<div class="line"><span class="lineno">  728</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a> = medium.rho(phi, theta, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a>;</div>
<div class="line"><span class="lineno">  729</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dr</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a>;</div>
<div class="line"><span class="lineno">  730</span>        mass += 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dr</a>;</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>        <span class="keywordflow">if</span> (mass &gt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">target</a>) {</div>
<div class="line"><span class="lineno">  733</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_dec</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">target</a> - (mass - 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dr</a>)) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>;</div>
<div class="line"><span class="lineno">  734</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_dec</a> * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a>);</div>
<div class="line"><span class="lineno">  735</span>        }</div>
<div class="line"><span class="lineno">  736</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>;</div>
<div class="line"><span class="lineno">  737</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a>;</div>
<div class="line"><span class="lineno">  738</span>    }</div>
<div class="line"><span class="lineno">  739</span>    <span class="keywordflow">return</span> std::exp(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_max</a>) * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a>);</div>
<div class="line"><span class="lineno">  740</span>}</div>
<div class="ttc" id="anamespacecon_html_a26ef2b83dd09c356e324bd243b498764"><div class="ttname"><a href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a></div><div class="ttdeci">constexpr Real c2</div><div class="ttdoc">Speed of light squared.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00088">macros.h:88</a></div></div>
<div class="ttc" id="anamespacecon_html_a2ff3edf57629ccb9a49d5bde7278a7c4"><div class="ttname"><a href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a></div><div class="ttdeci">constexpr Real c</div><div class="ttdoc">Speed of light (normalized to 1 in code units)</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00087">macros.h:87</a></div></div>
<div class="ttc" id="anamespacecon_html_ad61313f4a5b7876e54ae46d02d4a04bd"><div class="ttname"><a href="namespacecon.html#ad61313f4a5b7876e54ae46d02d4a04bd">con::inf</a></div><div class="ttdeci">constexpr Real inf</div><div class="ttdoc">Infinity value.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00107">macros.h:107</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph.png" border="0" usemap="#amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph" alt=""/></div>
<map name="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph" id="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph">
<area shape="rect" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="5,42,128,67"/>
<area shape="rect" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090" title="Converts Lorentz factor (gamma) to a velocity fraction (beta)" alt="" coords="176,5,324,45"/>
<area shape="poly" title=" " alt="" coords="128,42,162,37,163,42,129,48"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="372,42,527,67"/>
<area shape="poly" title=" " alt="" coords="129,54,176,55,324,55,358,54,358,59,324,60,176,60,128,59"/>
<area shape="poly" title=" " alt="" coords="324,34,359,39,358,44,324,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph.png" border="0" usemap="#amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph" alt=""/></div>
<map name="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph" id="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph">
<area shape="rect" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="945,31,1068,56"/>
<area shape="rect" href="mesh_8h.html#a6130a6c9bb4bbe255dd8852fd154791d" title="Builds the engine&#45;time grid for each (phi, theta) cell in the coordinate system." alt="" coords="775,31,897,56"/>
<area shape="poly" title=" " alt="" coords="932,46,898,46,898,41,932,41"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a0cb4f8dcb245bdf3dba21d11f42d07e0" name="a0cb4f8dcb245bdf3dba21d11f42d07e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cb4f8dcb245bdf3dba21d11f42d07e0">&#9670;&#160;</a></span>find_jet_jumps()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; find_jet_jumps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">gamma_cut</td><td>Lorentz factor cutoff value </td></tr>
    <tr><td class="paramname">is_axisymmetric</td><td>Flag for axisymmetric jets </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Sorted vector of edge theta positions; last element is the outermost jet edge </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00464">464</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  464</span>                                                                                                         {</div>
<div class="line"><span class="lineno">  465</span>    <span class="comment">// Find all edges in the active jet region (Gamma0 &gt;= gamma_cut).</span></div>
<div class="line"><span class="lineno">  466</span>    <span class="comment">// Sharp edges: large fractional jumps (&gt; 50%) between adjacent scan points.</span></div>
<div class="line"><span class="lineno">  467</span>    <span class="comment">// Smooth jets: the outermost theta where Gamma0 crosses gamma_cut.</span></div>
<div class="line"><span class="lineno">  468</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a> = 512;</div>
<div class="line"><span class="lineno">  469</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eps</a> = <a class="code hl_variable" href="namespacedefaults_1_1solver.html#a29443c4987378f49066f9b406c391afc">defaults::solver::binary_search_eps</a>;</div>
<div class="line"><span class="lineno">  470</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  471</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> = <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> / 2;</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a>) &gt;= gamma_cut) {</div>
<div class="line"><span class="lineno">  474</span>        <span class="keywordflow">return</span> {<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a>};</div>
<div class="line"><span class="lineno">  475</span>    }</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>;</div>
<div class="line"><span class="lineno">  478</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.reserve(100);</div>
<div class="line"><span class="lineno">  479</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>;</div>
<div class="line"><span class="lineno">  480</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>);</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  483</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a> - 1);</div>
<div class="line"><span class="lineno">  484</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a>);</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> &gt;= gamma_cut || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> &gt;= gamma_cut) {</div>
<div class="line"><span class="lineno">  487</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a> = std::abs(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a>);</div>
<div class="line"><span class="lineno">  488</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">scale</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> - 1, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> - 1);</div>
<div class="line"><span class="lineno">  489</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">scale</a> &gt; 0 &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a> &gt; 0.5 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">scale</a>) {</div>
<div class="line"><span class="lineno">  490</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_th</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a>;</div>
<div class="line"><span class="lineno">  491</span>                <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eps</a>) {</div>
<div class="line"><span class="lineno">  492</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a> = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a>);</div>
<div class="line"><span class="lineno">  493</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">G_mid</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a>);</div>
<div class="line"><span class="lineno">  494</span>                    <span class="keywordflow">if</span> (std::abs(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">G_mid</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a>) &lt; std::abs(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">G_mid</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a>)) {</div>
<div class="line"><span class="lineno">  495</span>                        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a>;</div>
<div class="line"><span class="lineno">  496</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  497</span>                        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a>;</div>
<div class="line"><span class="lineno">  498</span>                    }</div>
<div class="line"><span class="lineno">  499</span>                }</div>
<div class="line"><span class="lineno">  500</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a>);</div>
<div class="line"><span class="lineno">  501</span>            }</div>
<div class="line"><span class="lineno">  502</span>        }</div>
<div class="line"><span class="lineno">  503</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a>;</div>
<div class="line"><span class="lineno">  504</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a>;</div>
<div class="line"><span class="lineno">  505</span>    }</div>
<div class="line"><span class="lineno">  506</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>;</div>
<div class="line"><span class="lineno">  507</span>}</div>
<div class="ttc" id="anamespacedefaults_1_1solver_html_a29443c4987378f49066f9b406c391afc"><div class="ttname"><a href="namespacedefaults_1_1solver.html#a29443c4987378f49066f9b406c391afc">defaults::solver::binary_search_eps</a></div><div class="ttdeci">constexpr double binary_search_eps</div><div class="ttdoc">Tolerance for binary search (jet edge finding)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00098">simulation-defaults.h:98</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a0cb4f8dcb245bdf3dba21d11f42d07e0_cgraph.png" border="0" usemap="#amesh_8h_a0cb4f8dcb245bdf3dba21d11f42d07e0_cgraph" alt=""/></div>
<map name="amesh_8h_a0cb4f8dcb245bdf3dba21d11f42d07e0_cgraph" id="amesh_8h_a0cb4f8dcb245bdf3dba21d11f42d07e0_cgraph">
<area shape="rect" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="5,5,123,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="171,5,325,31"/>
<area shape="poly" title=" " alt="" coords="123,15,157,15,157,21,123,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a0cb4f8dcb245bdf3dba21d11f42d07e0_icgraph.png" border="0" usemap="#amesh_8h_a0cb4f8dcb245bdf3dba21d11f42d07e0_icgraph" alt=""/></div>
<map name="amesh_8h_a0cb4f8dcb245bdf3dba21d11f42d07e0_icgraph" id="amesh_8h_a0cb4f8dcb245bdf3dba21d11f42d07e0_icgraph">
<area shape="rect" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="775,31,892,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="aa4bf3bc5ca82cf7ac350fab9eff68452" name="aa4bf3bc5ca82cf7ac350fab9eff68452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4bf3bc5ca82cf7ac350fab9eff68452">&#9670;&#160;</a></span>find_theta_max()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> find_theta_max </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_cut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00510">510</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  510</span>                                                       {</div>
<div class="line"><span class="lineno">  511</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a> = 512;</div>
<div class="line"><span class="lineno">  512</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  513</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> = <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> / 2;</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a>;</div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a>; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a> &gt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a> -= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>) {</div>
<div class="line"><span class="lineno">  517</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a>) &gt;= <a class="code hl_variable" href="namespacedefaults_1_1cutoffs.html#a6cda2def28c77f63dbee9eb169d9d87a">gamma_cut</a>) {</div>
<div class="line"><span class="lineno">  518</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a>;</div>
<div class="line"><span class="lineno">  519</span>        }</div>
<div class="line"><span class="lineno">  520</span>    }</div>
<div class="line"><span class="lineno">  521</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>;</div>
<div class="line"><span class="lineno">  522</span>}</div>
<div class="ttc" id="anamespacedefaults_1_1cutoffs_html_a6cda2def28c77f63dbee9eb169d9d87a"><div class="ttname"><a href="namespacedefaults_1_1cutoffs.html#a6cda2def28c77f63dbee9eb169d9d87a">defaults::cutoffs::gamma_cut</a></div><div class="ttdeci">constexpr double gamma_cut</div><div class="ttdoc">Lorentz factor below which the flow is considered non-relativistic Used to terminate shock evolution ...</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00041">simulation-defaults.h:41</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa4bf3bc5ca82cf7ac350fab9eff68452_cgraph.png" border="0" usemap="#amesh_8h_aa4bf3bc5ca82cf7ac350fab9eff68452_cgraph" alt=""/></div>
<map name="amesh_8h_aa4bf3bc5ca82cf7ac350fab9eff68452_cgraph" id="amesh_8h_aa4bf3bc5ca82cf7ac350fab9eff68452_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,128,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="176,5,331,31"/>
<area shape="poly" title=" " alt="" coords="128,15,162,15,162,21,128,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa4bf3bc5ca82cf7ac350fab9eff68452_icgraph.png" border="0" usemap="#amesh_8h_aa4bf3bc5ca82cf7ac350fab9eff68452_icgraph" alt=""/></div>
<map name="amesh_8h_aa4bf3bc5ca82cf7ac350fab9eff68452_icgraph" id="amesh_8h_aa4bf3bc5ca82cf7ac350fab9eff68452_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,897,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a6f8fa2784bc01569368e72d4020bb9b0" name="a6f8fa2784bc01569368e72d4020bb9b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f8fa2784bc01569368e72d4020bb9b0">&#9670;&#160;</a></span>inverse_CFD_sampling()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> inverse_CFD_sampling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>sample_num</em> = <code><a class="el" href="namespacedefaults_1_1sampling.html#afb3d6cb58a2dc84e4f0a2ed64d7e1609">defaults::sampling::theta_samples</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00555">555</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  556</span>                                                                              {</div>
<div class="line"><span class="lineno">  557</span>    <span class="keyword">using namespace </span>boost::numeric::odeint;</div>
<div class="line"><span class="lineno">  558</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> rtol = <a class="code hl_variable" href="namespacedefaults_1_1solver.html#a3469dc43cf2d60069d164931e7656d12">defaults::solver::ode_rtol</a>;</div>
<div class="line"><span class="lineno">  559</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a> = xt::linspace(<a class="code hl_function" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a>, <a class="code hl_function" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>);</div>
<div class="line"><span class="lineno">  560</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>});</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>    <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">make_dense_output</a>(rtol, rtol, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">runge_kutta_dopri5&lt;Real&gt;</a>());</div>
<div class="line"><span class="lineno">  563</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.initialize(0, <a class="code hl_function" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a>, (<a class="code hl_function" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a> - <a class="code hl_function" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a>) / 1e3);</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.current_time() &lt;= <a class="code hl_function" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a>;) {</div>
<div class="line"><span class="lineno">  566</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.do_step(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>);</div>
<div class="line"><span class="lineno">  567</span>        <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>.size() &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.current_time() &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)) {</div>
<div class="line"><span class="lineno">  568</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.calc_state(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>));</div>
<div class="line"><span class="lineno">  569</span>            ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>;</div>
<div class="line"><span class="lineno">  570</span>        }</div>
<div class="line"><span class="lineno">  571</span>    }</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_out</a> = xt::linspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>.front(), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>.back(), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>);</div>
<div class="line"><span class="lineno">  574</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>});</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) {</div>
<div class="line"><span class="lineno">  577</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  578</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>)) {</div>
<div class="line"><span class="lineno">  579</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> == 0) {</div>
<div class="line"><span class="lineno">  580</span>                    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>);</div>
<div class="line"><span class="lineno">  581</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  582</span>                    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> slope = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1)) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1));</div>
<div class="line"><span class="lineno">  583</span>                    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1) + slope * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1));</div>
<div class="line"><span class="lineno">  584</span>                }</div>
<div class="line"><span class="lineno">  585</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  586</span>            }</div>
<div class="line"><span class="lineno">  587</span>        }</div>
<div class="line"><span class="lineno">  588</span>    }</div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a>;</div>
<div class="line"><span class="lineno">  590</span>}</div>
<div class="ttc" id="anamespacedefaults_1_1solver_html_a3469dc43cf2d60069d164931e7656d12"><div class="ttname"><a href="namespacedefaults_1_1solver.html#a3469dc43cf2d60069d164931e7656d12">defaults::solver::ode_rtol</a></div><div class="ttdeci">constexpr double ode_rtol</div><div class="ttdoc">Relative tolerance for ODE integration (Runge-Kutta)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00092">simulation-defaults.h:92</a></div></div>
<div class="ttc" id="autilities_8h_html_a87dde689be8887c64263f13adace7ae1"><div class="ttname"><a href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a></div><div class="ttdeci">constexpr T min(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00232">utilities.h:232</a></div></div>
<div class="ttc" id="autilities_8h_html_ab0cbe75cc4de84810290ad6f3075e491"><div class="ttname"><a href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a></div><div class="ttdeci">constexpr T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00260">utilities.h:260</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a6f8fa2784bc01569368e72d4020bb9b0_cgraph.png" border="0" usemap="#amesh_8h_a6f8fa2784bc01569368e72d4020bb9b0_cgraph" alt=""/></div>
<map name="amesh_8h_a6f8fa2784bc01569368e72d4020bb9b0_cgraph" id="amesh_8h_a6f8fa2784bc01569368e72d4020bb9b0_cgraph">
<area shape="rect" title=" " alt="" coords="5,19,176,45"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="323,19,477,45"/>
<area shape="poly" title=" " alt="" coords="138,17,203,6,239,3,275,4,335,14,334,19,274,9,239,8,203,11,139,22"/>
<area shape="rect" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491" title="Returns the value of a single parameter." alt="" coords="224,19,275,45"/>
<area shape="poly" title=" " alt="" coords="176,29,210,29,210,35,176,35"/>
<area shape="rect" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1" title="Returns the value of a single parameter." alt="" coords="226,69,273,94"/>
<area shape="poly" title=" " alt="" coords="133,42,214,68,212,73,131,47"/>
<area shape="poly" title=" " alt="" coords="275,29,309,29,309,35,275,35"/>
<area shape="poly" title=" " alt="" coords="272,71,347,47,348,52,274,77"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a6f8fa2784bc01569368e72d4020bb9b0_icgraph.png" border="0" usemap="#amesh_8h_a6f8fa2784bc01569368e72d4020bb9b0_icgraph" alt=""/></div>
<map name="amesh_8h_a6f8fa2784bc01569368e72d4020bb9b0_icgraph" id="amesh_8h_a6f8fa2784bc01569368e72d4020bb9b0_icgraph">
<area shape="rect" title=" " alt="" coords="975,31,1145,56"/>
<area shape="rect" href="mesh_8h.html#a360e0d18f141d6cd50b062a901338575" title=" " alt="" coords="781,5,920,31"/>
<area shape="poly" title=" " alt="" coords="961,34,920,29,920,24,962,29"/>
<area shape="rect" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea" title=" " alt="" coords="775,55,927,80"/>
<area shape="poly" title=" " alt="" coords="961,57,927,61,926,56,961,52"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="768,33,727,40,727,34,767,28"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
<area shape="poly" title=" " alt="" coords="761,57,726,52,727,47,762,52"/>
</map>
</div>

</div>
</div>
<a id="aa5d127d3ecb19584c7f27ee212d49605" name="aa5d127d3ecb19584c7f27ee212d49605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d127d3ecb19584c7f27ee212d49605">&#9670;&#160;</a></span>is_linear_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> is_linear_scale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code><a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if an array is linearly scaled within a given tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arr</td><td>The array to check </td></tr>
    <tr><td class="paramname">tolerance</td><td>Maximum allowed deviation from linearity (default: 1e-6) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the array is linearly scaled, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00012">12</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   12</span>                                                       {</div>
<div class="line"><span class="lineno">   13</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size() &lt; 2)</div>
<div class="line"><span class="lineno">   14</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// At least two elements are needed.</span></div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">diff</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[1] - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[0];</div>
<div class="line"><span class="lineno">   17</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 2; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   18</span>        <span class="keywordflow">if</span> (std::fabs((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> - 1] - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">diff</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">diff</a>) &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>) {</div>
<div class="line"><span class="lineno">   19</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   20</span>        }</div>
<div class="line"><span class="lineno">   21</span>    }</div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   23</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph.png" border="0" usemap="#amesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph" alt=""/></div>
<map name="amesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph" id="amesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph">
<area shape="rect" title="Checks if an array is linearly scaled within a given tolerance." alt="" coords="5,5,124,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="172,5,327,31"/>
<area shape="poly" title=" " alt="" coords="124,15,158,15,158,21,124,21"/>
</map>
</div>

</div>
</div>
<a id="ac0e56adbbf18a0c9a5c04a8d4de268d9" name="ac0e56adbbf18a0c9a5c04a8d4de268d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e56adbbf18a0c9a5c04a8d4de268d9">&#9670;&#160;</a></span>is_log_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> is_log_scale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code><a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if an array is logarithmically scaled within a given tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arr</td><td>The array to check </td></tr>
    <tr><td class="paramname">tolerance</td><td>Maximum allowed deviation from logarithmic scaling (default: 1e-6) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the array is logarithmically scaled, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00025">25</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   25</span>                                                    {</div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size() &lt; 2)</div>
<div class="line"><span class="lineno">   27</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// At least two elements are needed.</span></div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> ratio = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[1] / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[0];</div>
<div class="line"><span class="lineno">   30</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 2; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   31</span>        <span class="keywordflow">if</span> (std::fabs((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> - 1] - ratio) / ratio) &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>) {</div>
<div class="line"><span class="lineno">   32</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   33</span>        }</div>
<div class="line"><span class="lineno">   34</span>    }</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   36</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph.png" border="0" usemap="#amesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph" alt=""/></div>
<map name="amesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph" id="amesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph">
<area shape="rect" title="Checks if an array is logarithmically scaled within a given tolerance." alt="" coords="5,5,107,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="155,5,309,31"/>
<area shape="poly" title=" " alt="" coords="107,15,141,15,141,21,107,21"/>
</map>
</div>

</div>
</div>
<a id="a7cb4a7162e9b5a1e2ed39f7d9e94b53f" name="a7cb4a7162e9b5a1e2ed39f7d9e94b53f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb4a7162e9b5a1e2ed39f7d9e94b53f">&#9670;&#160;</a></span>jet_spreading_edge()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> jet_spreading_edge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the edge of the jet where the spreading is strongest. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
    <tr><td class="paramname"><a class="el" href="classMedium.html" title="Represents the generic medium or any user-defined surrounding medium that the GRB jet interacts with.">Medium</a></td><td>Type of the ambient medium </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">medium</td><td>The ambient medium object </td></tr>
    <tr><td class="paramname">phi</td><td>Azimuthal angle </td></tr>
    <tr><td class="paramname">theta_min</td><td>Minimum polar angle to consider </td></tr>
    <tr><td class="paramname">theta_max</td><td>Maximum polar angle to consider </td></tr>
    <tr><td class="paramname">t0</td><td>Initial time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Angle (in radians) where the spreading is strongest</dd></dl>
<p>The spreading strength is measured by the derivative of the pressure with respect to theta, which is proportional to d((Gamma-1)Gamma rho)/dtheta </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00525">525</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  526</span>                                {</div>
<div class="line"><span class="lineno">  527</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) / 256;</div>
<div class="line"><span class="lineno">  528</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_s = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>;</div>
<div class="line"><span class="lineno">  529</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a> = 0;</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta = theta_min; theta &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>; theta += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>) {</div>
<div class="line"><span class="lineno">  532</span>        <span class="comment">// Real G = jet.Gamma0(phi, theta);</span></div>
<div class="line"><span class="lineno">  533</span>        <span class="comment">// Real beta0 = physics::relativistic::gamma_to_beta(G);</span></div>
<div class="line"><span class="lineno">  534</span>        <span class="comment">// Real r0 = beta0 * con::c * t0 / (1 - beta0);</span></div>
<div class="line"><span class="lineno">  535</span>        <span class="comment">// Real rho = medium.rho(phi, theta, 0);</span></div>
<div class="line"><span class="lineno">  536</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_lo</a> = std::max(theta - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>, theta_min);</div>
<div class="line"><span class="lineno">  537</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_hi</a> = std::min(theta + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>);</div>
<div class="line"><span class="lineno">  538</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_hi</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_lo</a>)) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_lo</a>);</div>
<div class="line"><span class="lineno">  539</span>        <span class="comment">// Real drho = (medium.rho(phi, th_hi, r0) - medium.rho(phi, th_lo, r0)) / (th_hi - th_lo);</span></div>
<div class="line"><span class="lineno">  540</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a>; <span class="comment">//(2 * G - 1) * rho * dG + (G - 1) * G * drho;</span></div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a>) {</div>
<div class="line"><span class="lineno">  543</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp</a>;</div>
<div class="line"><span class="lineno">  544</span>            theta_s = theta;</div>
<div class="line"><span class="lineno">  545</span>        }</div>
<div class="line"><span class="lineno">  546</span>    }</div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a> == 0) {</div>
<div class="line"><span class="lineno">  548</span>        theta_s = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>;</div>
<div class="line"><span class="lineno">  549</span>    }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>    <span class="keywordflow">return</span> theta_s;</div>
<div class="line"><span class="lineno">  552</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph.png" border="0" usemap="#amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph" alt=""/></div>
<map name="amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph" id="amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph">
<area shape="rect" title="Determines the edge of the jet where the spreading is strongest." alt="" coords="5,5,155,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="203,5,357,31"/>
<area shape="poly" title=" " alt="" coords="155,15,189,15,189,21,155,21"/>
</map>
</div>

</div>
</div>
<a id="ae31d546d7f15fece5525fd480b771b68" name="ae31d546d7f15fece5525fd480b771b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae31d546d7f15fece5525fd480b771b68">&#9670;&#160;</a></span>jump_refinement_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> jump_refinement_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet_jumps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>avg_spacing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_resol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00606">606</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  607</span>                                                    {</div>
<div class="line"><span class="lineno">  608</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>;</div>
<div class="line"><span class="lineno">  609</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.reserve(150);</div>
<div class="line"><span class="lineno">  610</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jump</a> : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_jumps</a>) {</div>
<div class="line"><span class="lineno">  611</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jump</a> &gt;= <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> / 2 - 0.01)</div>
<div class="line"><span class="lineno">  612</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  613</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">half</a> = 3 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a>;</div>
<div class="line"><span class="lineno">  614</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(10 * theta_resol), 2);</div>
<div class="line"><span class="lineno">  615</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt;= n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  616</span>            <span class="comment">// Log-spaced offsets: denser near the edge</span></div>
<div class="line"><span class="lineno">  617</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">frac</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno">  618</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">offset</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">half</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">frac</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">frac</a>;</div>
<div class="line"><span class="lineno">  619</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">below</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jump</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">offset</a>;</div>
<div class="line"><span class="lineno">  620</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">above</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jump</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">offset</a>;</div>
<div class="line"><span class="lineno">  621</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">below</a> &gt;= theta_min)</div>
<div class="line"><span class="lineno">  622</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">below</a>);</div>
<div class="line"><span class="lineno">  623</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">above</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>)</div>
<div class="line"><span class="lineno">  624</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">above</a>);</div>
<div class="line"><span class="lineno">  625</span>        }</div>
<div class="line"><span class="lineno">  626</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jump</a> &gt;= theta_min &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jump</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>)</div>
<div class="line"><span class="lineno">  627</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jump</a>);</div>
<div class="line"><span class="lineno">  628</span>    }</div>
<div class="line"><span class="lineno">  629</span>    std::ranges::sort(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>);</div>
<div class="line"><span class="lineno">  630</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.erase(std::ranges::unique(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>).<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">begin</a>(), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.end());</div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordflow">return</span> xt::adapt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>, {<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.size()});</div>
<div class="line"><span class="lineno">  632</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ae31d546d7f15fece5525fd480b771b68_cgraph.png" border="0" usemap="#amesh_8h_ae31d546d7f15fece5525fd480b771b68_cgraph" alt=""/></div>
<map name="amesh_8h_ae31d546d7f15fece5525fd480b771b68_cgraph" id="amesh_8h_ae31d546d7f15fece5525fd480b771b68_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,171,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="219,5,373,31"/>
<area shape="poly" title=" " alt="" coords="171,15,205,15,205,21,171,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ae31d546d7f15fece5525fd480b771b68_icgraph.png" border="0" usemap="#amesh_8h_ae31d546d7f15fece5525fd480b771b68_icgraph" alt=""/></div>
<map name="amesh_8h_ae31d546d7f15fece5525fd480b771b68_icgraph" id="amesh_8h_ae31d546d7f15fece5525fd480b771b68_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,940,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a76f104cdad403ea346ff1a6603c78ad6" name="a76f104cdad403ea346ff1a6603c78ad6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76f104cdad403ea346ff1a6603c78ad6">&#9670;&#160;</a></span>log2space()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> log2space </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>grid_per_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00295">295</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  295</span>                                                                            {</div>
<div class="line"><span class="lineno">  296</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">decades</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>) / <a class="code hl_variable" href="mesh_8h.html#aba685e866cceb5c13d7e357fcaa69529">log2_10</a>;</div>
<div class="line"><span class="lineno">  297</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(2, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::ceil(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">decades</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">grid_per_order</a>)));</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">array</a> = xt::logspace&lt;Real&gt;(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, n + 1, 2.0);</div>
<div class="line"><span class="lineno">  300</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph.png" border="0" usemap="#amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph" alt=""/></div>
<map name="amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph" id="amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,93,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="141,5,296,31"/>
<area shape="poly" title=" " alt="" coords="94,15,128,15,128,21,94,21"/>
</map>
</div>

</div>
</div>
<a id="ad7703ab8b66bb86ed857746606fac9a2" name="ad7703ab8b66bb86ed857746606fac9a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7703ab8b66bb86ed857746606fac9a2">&#9670;&#160;</a></span>logspace_boundary_center()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> logspace_boundary_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>bin_width</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00303">303</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  303</span>                                                                                                      {</div>
<div class="line"><span class="lineno">  304</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a> = Arr::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>});</div>
<div class="line"><span class="lineno">  305</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bin_width</a> = Array::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>});</div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a> == 0)</div>
<div class="line"><span class="lineno">  307</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>);</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> r = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a>);</div>
<div class="line"><span class="lineno">  312</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a> = std::sqrt(r);</div>
<div class="line"><span class="lineno">  313</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a> = r - 1.;</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>);</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">for</span> (std::size_t <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  318</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a>;</div>
<div class="line"><span class="lineno">  319</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bin_width</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a>;</div>
<div class="line"><span class="lineno">  320</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> *= r;</div>
<div class="line"><span class="lineno">  321</span>    }</div>
<div class="line"><span class="lineno">  322</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph.png" border="0" usemap="#amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph" alt=""/></div>
<map name="amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph" id="amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,201,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="249,5,404,31"/>
<area shape="poly" title=" " alt="" coords="201,15,236,15,236,21,201,21"/>
</map>
</div>

</div>
</div>
<a id="afadc5019976c36be16277dc4dc178a7f" name="afadc5019976c36be16277dc4dc178a7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afadc5019976c36be16277dc4dc178a7f">&#9670;&#160;</a></span>logspace_center()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> logspace_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00278">278</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  278</span>                                                                           {</div>
<div class="line"><span class="lineno">  279</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a> = Arr::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>});</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a> == 0)</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>);</div>
<div class="line"><span class="lineno">  284</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> r = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a>);</div>
<div class="line"><span class="lineno">  285</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a> = std::sqrt(r);</div>
<div class="line"><span class="lineno">  286</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>);</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">for</span> (std::size_t <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  289</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a>;</div>
<div class="line"><span class="lineno">  290</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> *= r;</div>
<div class="line"><span class="lineno">  291</span>    }</div>
<div class="line"><span class="lineno">  292</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph.png" border="0" usemap="#amesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph" alt=""/></div>
<map name="amesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph" id="amesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,133,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="181,5,336,31"/>
<area shape="poly" title=" " alt="" coords="133,15,167,15,167,21,133,21"/>
</map>
</div>

</div>
</div>
<a id="a3c066f2c8e6d102d7a56de8cb42cf5a8" name="a3c066f2c8e6d102d7a56de8cb42cf5a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c066f2c8e6d102d7a56de8cb42cf5a8">&#9670;&#160;</a></span>merge_grids()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> merge_grids </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00674">674</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  674</span>                                                    {</div>
<div class="line"><span class="lineno">  675</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>;</div>
<div class="line"><span class="lineno">  676</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>.size() + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>.size());</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0;</div>
<div class="line"><span class="lineno">  679</span>    <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a> = [&amp;](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">val</a>) {</div>
<div class="line"><span class="lineno">  680</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.empty() || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.back() != <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">val</a>)</div>
<div class="line"><span class="lineno">  681</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">val</a>);</div>
<div class="line"><span class="lineno">  682</span>    };</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>.size() &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>.size()) {</div>
<div class="line"><span class="lineno">  685</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>]) {</div>
<div class="line"><span class="lineno">  686</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>++]);</div>
<div class="line"><span class="lineno">  687</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> - 1] == <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>])</div>
<div class="line"><span class="lineno">  688</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>++;</div>
<div class="line"><span class="lineno">  689</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  690</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>++]);</div>
<div class="line"><span class="lineno">  691</span>        }</div>
<div class="line"><span class="lineno">  692</span>    }</div>
<div class="line"><span class="lineno">  693</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>.size())</div>
<div class="line"><span class="lineno">  694</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>++]);</div>
<div class="line"><span class="lineno">  695</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>.size())</div>
<div class="line"><span class="lineno">  696</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>++]);</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>    <span class="keywordflow">return</span> xt::adapt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>);</div>
<div class="line"><span class="lineno">  699</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph.png" border="0" usemap="#amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph" alt=""/></div>
<map name="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph" id="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,108,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="156,5,311,31"/>
<area shape="poly" title=" " alt="" coords="108,15,142,15,142,21,108,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph.png" border="0" usemap="#amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph" alt=""/></div>
<map name="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph" id="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,877,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a0aaa6d60a9852531ccfc1d290284c611" name="a0aaa6d60a9852531ccfc1d290284c611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aaa6d60a9852531ccfc1d290284c611">&#9670;&#160;</a></span>refined_time_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> refined_time_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_refine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>t_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_lo_factor</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_hi_factor</em> = <code>10.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a refined logarithmic time grid with higher density around a specified time. </p>
<p>Constructs a three-segment logspace grid:</p><ul>
<li>Segment 1: [t_start, t_lo] with base resolution</li>
<li>Segment 2: [t_lo, t_hi] with higher resolution (around t_refine)</li>
<li>Segment 3: [t_hi, t_end] with base resolution</li>
</ul>
<p>Falls back to simple logspace if refinement is not applicable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_start</td><td>Start time of the grid </td></tr>
    <tr><td class="paramname">t_end</td><td>End time of the grid </td></tr>
    <tr><td class="paramname">t_refine</td><td>Time around which to refine (e.g., deceleration time) </td></tr>
    <tr><td class="paramname">t_num</td><td>Total number of grid points </td></tr>
    <tr><td class="paramname">refine_lo_factor</td><td>Lower bound factor for refinement region (t_lo = refine_lo_factor * t_refine) </td></tr>
    <tr><td class="paramname">refine_hi_factor</td><td>Upper bound factor for refinement region (t_hi = refine_hi_factor * t_refine) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of time grid points </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00762">762</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  763</span>                                                             {</div>
<div class="line"><span class="lineno">  764</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>});</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>);</div>
<div class="line"><span class="lineno">  767</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>);</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine &lt;= t_start || refine_lo_factor * t_refine &gt;</a>= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>) {</div>
<div class="line"><span class="lineno">  770</span>        <span class="keywordflow">return</span> xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>);</div>
<div class="line"><span class="lineno">  771</span>    }</div>
<div class="line"><span class="lineno">  772</span> </div>
<div class="line"><span class="lineno">  773</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_lo</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>);</div>
<div class="line"><span class="lineno">  774</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_hi</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>);</div>
<div class="line"><span class="lineno">  775</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_lo</a>);</div>
<div class="line"><span class="lineno">  776</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_hi</a>);</div>
<div class="line"><span class="lineno">  777</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>;</div>
<div class="line"><span class="lineno">  778</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a>;</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>    <span class="comment">// Distribute points proportionally with a 2x density boost for the refinement zone.</span></div>
<div class="line"><span class="lineno">  781</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_refine</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a>;</div>
<div class="line"><span class="lineno">  782</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_boost</a> = 2.0;</div>
<div class="line"><span class="lineno">  783</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eff</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_boost</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_refine</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a>;</div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a> &gt; 0) ? std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eff</a>), 2) : 0;</div>
<div class="line"><span class="lineno">  785</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a> &gt; 0) ? std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eff</a>), 2) : 0;</div>
<div class="line"><span class="lineno">  786</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shared</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> &gt; 0 ? 1 : 0) + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> &gt; 0 ? 1 : 0);</div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2_raw</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> + 2 &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shared</a>) ? (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shared</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a>) : 0;</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2_raw</a> &lt; 2) {</div>
<div class="line"><span class="lineno">  790</span>        <span class="keywordflow">return</span> xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>);</div>
<div class="line"><span class="lineno">  791</span>    }</div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2_raw</a>;</div>
<div class="line"><span class="lineno">  794</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a> = 0;</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>    <span class="comment">// Segment 1: [t_start, t_lo]</span></div>
<div class="line"><span class="lineno">  797</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  798</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg1</a> = xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a>);</div>
<div class="line"><span class="lineno">  799</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)</div>
<div class="line"><span class="lineno">  800</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a>++) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg1</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>);</div>
<div class="line"><span class="lineno">  801</span>    }</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>    <span class="comment">// Segment 2: [t_lo, t_hi] - skip first point if it overlaps with seg1</span></div>
<div class="line"><span class="lineno">  804</span>    {</div>
<div class="line"><span class="lineno">  805</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg2</a> = xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2</a>);</div>
<div class="line"><span class="lineno">  806</span>        <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k0</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> &gt; 0) ? 1 : 0;</div>
<div class="line"><span class="lineno">  807</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k0</a>; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)</div>
<div class="line"><span class="lineno">  808</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a>++) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg2</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>);</div>
<div class="line"><span class="lineno">  809</span>    }</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>    <span class="comment">// Segment 3: [t_hi, t_end] - skip first point (overlaps with seg2)</span></div>
<div class="line"><span class="lineno">  812</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  813</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg3</a> = xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a>);</div>
<div class="line"><span class="lineno">  814</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)</div>
<div class="line"><span class="lineno">  815</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a>++) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg3</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>);</div>
<div class="line"><span class="lineno">  816</span>    }</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>;</div>
<div class="line"><span class="lineno">  819</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a0aaa6d60a9852531ccfc1d290284c611_cgraph.png" border="0" usemap="#amesh_8h_a0aaa6d60a9852531ccfc1d290284c611_cgraph" alt=""/></div>
<map name="amesh_8h_a0aaa6d60a9852531ccfc1d290284c611_cgraph" id="amesh_8h_a0aaa6d60a9852531ccfc1d290284c611_cgraph">
<area shape="rect" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="5,5,141,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="189,5,344,31"/>
<area shape="poly" title=" " alt="" coords="141,15,176,15,176,21,141,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a0aaa6d60a9852531ccfc1d290284c611_icgraph.png" border="0" usemap="#amesh_8h_a0aaa6d60a9852531ccfc1d290284c611_icgraph" alt=""/></div>
<map name="amesh_8h_a0aaa6d60a9852531ccfc1d290284c611_icgraph" id="amesh_8h_a0aaa6d60a9852531ccfc1d290284c611_icgraph">
<area shape="rect" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="945,31,1081,56"/>
<area shape="rect" href="mesh_8h.html#a6130a6c9bb4bbe255dd8852fd154791d" title="Builds the engine&#45;time grid for each (phi, theta) cell in the coordinate system." alt="" coords="775,31,897,56"/>
<area shape="poly" title=" " alt="" coords="931,46,898,46,898,41,931,41"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aba685e866cceb5c13d7e357fcaa69529" name="aba685e866cceb5c13d7e357fcaa69529"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba685e866cceb5c13d7e357fcaa69529">&#9670;&#160;</a></span>log2_10</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">constexpr</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> log2_10 = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::numbers::ln10</a> / <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::numbers::ln2</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00021">21</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="mesh_8h.html">mesh.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
