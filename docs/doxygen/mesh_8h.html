<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: mesh.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mesh_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mesh.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;span&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">../util/macros.h</a>&quot;</code><br />
<code>#include &quot;boost/numeric/odeint.hpp&quot;</code><br />
<code>#include &quot;<a class="el" href="physics_8h_source.html">physics.h</a>&quot;</code><br />
<code>#include &quot;xtensor/containers/xadapt.hpp&quot;</code><br />
<code>#include &quot;xtensor/views/xview.hpp&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for mesh.h:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h__incl.png" border="0" usemap="#amesh_8h" alt=""/></div>
<map name="amesh_8h" id="amesh_8h">
<area shape="rect" title=" " alt="" coords="351,5,422,31"/>
<area shape="rect" title=" " alt="" coords="5,86,91,111"/>
<area shape="poly" title=" " alt="" coords="351,28,240,49,103,81,93,84,92,79,102,76,239,44,350,23"/>
<area shape="rect" title=" " alt="" coords="115,86,184,111"/>
<area shape="poly" title=" " alt="" coords="352,32,197,81,190,84,189,79,195,76,350,27"/>
<area shape="rect" title=" " alt="" coords="208,86,261,111"/>
<area shape="poly" title=" " alt="" coords="365,33,270,82,268,77,363,28"/>
<area shape="rect" title=" " alt="" coords="286,86,349,111"/>
<area shape="poly" title=" " alt="" coords="378,33,339,77,335,74,374,29"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="417,167,535,192"/>
<area shape="poly" title=" " alt="" coords="390,31,397,71,404,95,414,117,431,138,450,156,446,160,427,142,410,120,399,97,392,72,385,32"/>
<area shape="rect" title=" " alt="" coords="425,86,613,111"/>
<area shape="poly" title=" " alt="" coords="408,29,489,77,486,81,405,33"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="637,86,720,111"/>
<area shape="poly" title=" " alt="" coords="423,24,515,46,626,76,636,79,634,84,625,81,514,51,422,30"/>
<area shape="rect" title=" " alt="" coords="745,79,887,119"/>
<area shape="poly" title=" " alt="" coords="423,22,732,76,731,81,422,27"/>
<area shape="rect" title=" " alt="" coords="911,86,1094,111"/>
<area shape="poly" title=" " alt="" coords="423,20,626,41,900,76,931,81,930,86,900,81,625,46,422,25"/>
<area shape="rect" title=" " alt="" coords="353,247,412,273"/>
<area shape="poly" title=" " alt="" coords="464,194,409,240,405,236,461,190"/>
<area shape="rect" title=" " alt="" coords="437,247,515,273"/>
<area shape="poly" title=" " alt="" coords="479,192,479,233,473,233,473,192"/>
<area shape="rect" href="simulation-defaults_8h.html" title="Centralized simulation configuration defaults." alt="" coords="540,240,687,280"/>
<area shape="poly" title=" " alt="" coords="498,190,569,231,567,235,495,194"/>
<area shape="rect" title=" " alt="" coords="578,328,649,353"/>
<area shape="poly" title=" " alt="" coords="616,280,616,314,611,314,611,280"/>
<area shape="poly" title=" " alt="" coords="650,114,519,164,517,159,648,109"/>
<area shape="rect" title=" " alt="" coords="647,167,710,192"/>
<area shape="poly" title=" " alt="" coords="681,112,681,153,676,153,676,112"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h__dep__incl.png" border="0" usemap="#amesh_8hdep" alt=""/></div>
<map name="amesh_8hdep" id="amesh_8hdep">
<area shape="rect" title=" " alt="" coords="599,5,670,31"/>
<area shape="rect" href="IO_8h.html" title=" " alt="" coords="112,519,160,544"/>
<area shape="poly" title=" " alt="" coords="586,23,433,30,337,38,240,51,151,69,76,94,48,109,26,125,13,143,8,164,8,386,11,408,19,429,47,466,82,496,115,516,112,521,79,500,43,470,15,432,6,410,3,386,3,163,8,141,22,121,45,104,74,89,149,64,240,46,337,33,432,25,585,17"/>
<area shape="rect" href="afterglow_8h.html" title=" " alt="" coords="1241,592,1335,617"/>
<area shape="poly" title=" " alt="" coords="684,18,888,23,1165,35,1424,52,1517,63,1572,76,1605,91,1632,107,1650,130,1656,163,1656,459,1653,489,1643,510,1626,528,1601,546,1581,557,1552,566,1481,582,1336,602,1335,596,1480,577,1551,561,1579,552,1599,542,1622,524,1638,507,1648,487,1651,459,1651,164,1645,132,1628,112,1603,96,1570,81,1516,68,1423,57,1165,40,888,29,684,23"/>
<area shape="rect" href="inverse-compton_8h.html" title=" " alt="" coords="403,299,547,324"/>
<area shape="poly" title=" " alt="" coords="587,31,541,48,520,62,502,80,486,108,476,138,467,201,469,258,475,298,470,299,464,259,462,201,471,137,481,105,498,77,516,58,538,44,585,26"/>
<area shape="rect" href="mesh_8cpp.html" title=" " alt="" coords="512,79,597,104"/>
<area shape="poly" title=" " alt="" coords="614,42,570,80,566,76,610,38"/>
<area shape="rect" href="observer_8h.html" title=" " alt="" coords="879,299,969,324"/>
<area shape="poly" title=" " alt="" coords="656,39,715,102,914,297,910,300,711,106,652,43"/>
<area shape="rect" href="prompt_8h.html" title=" " alt="" coords="1477,79,1558,104"/>
<area shape="poly" title=" " alt="" coords="684,21,1476,84,1476,89,683,26"/>
<area shape="rect" href="quadrature_8h.html" title=" " alt="" coords="331,225,437,251"/>
<area shape="poly" title=" " alt="" coords="587,27,521,44,487,60,458,81,429,116,408,158,395,197,389,226,383,225,390,195,403,156,424,113,454,77,485,55,519,39,585,22"/>
<area shape="rect" href="shock_8h.html" title=" " alt="" coords="883,225,955,251"/>
<area shape="poly" title=" " alt="" coords="662,37,905,223,902,227,659,41"/>
<area shape="rect" href="utilities_8h.html" title=" " alt="" coords="831,79,913,104"/>
<area shape="poly" title=" " alt="" coords="684,31,835,76,833,81,683,36"/>
<area shape="rect" href="IO_8cpp.html" title=" " alt="" coords="105,592,167,617"/>
<area shape="poly" title=" " alt="" coords="139,558,139,592,133,592,133,558"/>
<area shape="poly" title=" " alt="" coords="174,534,259,541,836,578,1240,599,1240,604,836,583,258,547,173,539"/>
<area shape="rect" href="shock__dispatch_8h.html" title=" " alt="" coords="1221,665,1355,691"/>
<area shape="poly" title=" " alt="" coords="1291,631,1291,665,1285,665,1285,631"/>
<area shape="rect" href="pymodel_8h.html" title=" " alt="" coords="1243,739,1333,764"/>
<area shape="poly" title=" " alt="" coords="1291,704,1291,739,1285,739,1285,704"/>
<area shape="rect" href="pybind_8cpp.html" title=" " alt="" coords="1180,812,1273,837"/>
<area shape="poly" title=" " alt="" coords="1271,776,1239,814,1235,810,1267,773"/>
<area shape="rect" href="pymodel_8cpp.html" title=" " alt="" coords="1297,812,1404,837"/>
<area shape="poly" title=" " alt="" coords="1309,773,1343,810,1339,814,1305,776"/>
<area shape="poly" title=" " alt="" coords="432,331,378,356,326,390,307,408,296,428,294,448,304,469,333,500,363,520,393,531,425,535,498,535,540,536,586,541,775,567,962,585,1241,599,1240,605,961,590,774,573,585,547,539,541,498,540,425,540,392,536,360,525,329,505,299,472,288,449,290,426,303,405,323,385,375,352,429,327"/>
<area shape="rect" href="inverse-compton_8cpp.html" title=" " alt="" coords="766,519,925,544"/>
<area shape="poly" title=" " alt="" coords="524,326,573,345,624,370,688,408,748,450,833,516,830,521,744,454,685,413,621,374,571,350,522,331"/>
<area shape="rect" href="power-law-syn_8cpp.html" title=" " alt="" coords="94,445,239,471"/>
<area shape="poly" title=" " alt="" coords="416,330,356,349,295,374,231,412,183,447,180,443,228,408,292,370,354,344,414,325"/>
<area shape="rect" href="power-law-syn_8h.html" title=" " alt="" coords="93,372,224,397"/>
<area shape="poly" title=" " alt="" coords="411,330,210,374,209,369,410,324"/>
<area shape="rect" href="smooth-power-law-syn_8h.html" title=" " alt="" coords="363,372,547,397"/>
<area shape="poly" title=" " alt="" coords="470,338,460,373,455,371,465,337"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="537,445,647,471"/>
<area shape="poly" title=" " alt="" coords="511,329,537,347,561,370,582,410,592,444,587,446,577,412,557,374,534,351,508,333"/>
<area shape="rect" href="synchrotron_8cpp.html" title=" " alt="" coords="615,519,742,544"/>
<area shape="poly" title=" " alt="" coords="517,327,554,346,594,372,631,404,661,444,675,484,681,518,675,519,670,485,656,447,627,408,590,376,551,351,515,332"/>
<area shape="poly" title=" " alt="" coords="164,411,168,445,163,446,159,411"/>
<area shape="rect" href="smooth-power-law-syn_8cpp.html" title=" " alt="" coords="314,445,513,471"/>
<area shape="poly" title=" " alt="" coords="443,411,422,447,418,444,439,408"/>
<area shape="poly" title=" " alt="" coords="490,401,571,443,568,447,487,406"/>
<area shape="poly" title=" " alt="" coords="524,473,160,529,160,524,523,468"/>
<area shape="poly" title=" " alt="" coords="590,485,591,515,596,530,604,542,617,549,638,556,701,569,883,586,1085,596,1240,600,1240,605,1085,601,883,591,700,574,636,562,615,554,601,546,591,532,586,516,585,485"/>
<area shape="poly" title=" " alt="" coords="647,472,805,516,804,521,645,477"/>
<area shape="poly" title=" " alt="" coords="618,477,666,516,663,521,615,481"/>
<area shape="poly" title=" " alt="" coords="951,331,994,370,1034,419,1061,461,1090,501,1136,542,1189,571,1242,589,1240,594,1187,576,1133,546,1086,504,1057,464,1030,422,990,374,948,335"/>
<area shape="rect" href="observer_8cpp.html" title=" " alt="" coords="875,372,981,397"/>
<area shape="poly" title=" " alt="" coords="928,338,930,372,925,372,923,338"/>
<area shape="poly" title=" " alt="" coords="1545,111,1563,129,1580,151,1600,191,1605,237,1605,459,1605,486,1601,508,1591,527,1572,546,1555,557,1530,567,1467,582,1336,602,1335,596,1466,577,1528,562,1552,552,1569,542,1586,524,1596,506,1599,486,1600,459,1600,237,1595,193,1575,153,1559,133,1541,115"/>
<area shape="rect" href="prompt_8cpp.html" title=" " alt="" coords="1469,152,1565,177"/>
<area shape="poly" title=" " alt="" coords="1520,118,1520,152,1515,152,1515,118"/>
<area shape="poly" title=" " alt="" coords="411,257,461,296,458,301,408,261"/>
<area shape="poly" title=" " alt="" coords="869,242,691,245,574,251,451,261,331,278,223,301,177,316,138,333,106,352,83,374,70,397,68,419,73,442,84,469,101,496,122,516,118,520,97,500,79,472,68,444,62,419,65,395,79,370,103,348,135,328,175,311,222,296,330,273,450,256,573,245,690,239,869,236"/>
<area shape="poly" title=" " alt="" coords="869,250,547,301,546,296,869,245"/>
<area shape="poly" title=" " alt="" coords="892,260,611,447,608,443,889,256"/>
<area shape="poly" title=" " alt="" coords="923,264,926,298,920,299,918,265"/>
<area shape="rect" href="forward-shock_8hpp.html" title=" " alt="" coords="1057,372,1199,397"/>
<area shape="poly" title=" " alt="" coords="948,256,1113,370,1110,374,945,261"/>
<area shape="rect" href="shock-physics_8h.html" title=" " alt="" coords="1174,299,1301,324"/>
<area shape="poly" title=" " alt="" coords="969,248,1187,296,1185,301,968,253"/>
<area shape="rect" href="shock_8cpp.html" title=" " alt="" coords="1326,372,1413,397"/>
<area shape="poly" title=" " alt="" coords="969,239,1054,246,1154,256,1248,273,1286,284,1313,296,1333,313,1348,333,1367,371,1363,373,1344,336,1329,317,1311,301,1284,289,1247,278,1154,262,1053,251,969,245"/>
<area shape="poly" title=" " alt="" coords="1128,411,1127,440,1130,475,1138,511,1155,542,1173,560,1195,574,1241,592,1239,597,1192,579,1170,564,1151,546,1133,512,1124,476,1122,440,1122,411"/>
<area shape="poly" title=" " alt="" coords="1210,334,1147,374,1144,370,1207,329"/>
<area shape="rect" href="reverse-shock_8hpp.html" title=" " alt="" coords="1270,445,1413,471"/>
<area shape="poly" title=" " alt="" coords="1256,334,1335,444,1331,447,1252,337"/>
<area shape="poly" title=" " alt="" coords="1272,328,1349,369,1346,374,1269,333"/>
<area shape="rect" href="simple-shock_8hpp.html" title=" " alt="" coords="1166,519,1303,544"/>
<area shape="poly" title=" " alt="" coords="1240,338,1237,518,1232,518,1234,338"/>
<area shape="poly" title=" " alt="" coords="1337,485,1317,545,1296,593,1291,591,1312,543,1332,483"/>
<area shape="poly" title=" " alt="" coords="1254,553,1281,590,1277,593,1249,557"/>
<area shape="poly" title=" " alt="" coords="927,99,1250,157,1411,193,1469,209,1501,223,1525,241,1542,259,1552,281,1555,310,1555,460,1548,494,1531,522,1505,546,1474,564,1439,578,1402,589,1336,601,1335,596,1401,584,1437,573,1471,559,1502,541,1527,519,1543,492,1549,459,1549,310,1546,282,1537,262,1522,245,1499,228,1467,214,1410,198,1249,163,926,104"/>
<area shape="poly" title=" " alt="" coords="840,113,497,301,494,296,838,108"/>
<area shape="poly" title=" " alt="" coords="865,118,849,172,842,204,840,237,840,386,847,518,842,519,835,386,835,237,837,203,843,171,860,116"/>
<area shape="poly" title=" " alt="" coords="851,116,831,139,811,168,795,201,789,237,789,386,787,409,779,430,755,468,725,499,698,520,694,516,721,495,751,465,774,428,781,407,784,386,784,236,790,200,806,165,827,136,847,112"/>
<area shape="rect" href="jet_8h.html" title=" " alt="" coords="880,152,931,177"/>
<area shape="poly" title=" " alt="" coords="886,115,902,151,898,153,881,118"/>
<area shape="rect" href="medium_8h.html" title=" " alt="" coords="955,152,1043,177"/>
<area shape="poly" title=" " alt="" coords="906,108,979,149,977,154,903,113"/>
<area shape="rect" href="utilities_8cpp.html" title=" " alt="" coords="1347,152,1445,177"/>
<area shape="poly" title=" " alt="" coords="927,97,1328,149,1347,152,1346,158,1328,155,927,102"/>
<area shape="poly" title=" " alt="" coords="945,175,989,183,1033,188,1122,187,1285,177,1352,180,1381,187,1406,198,1426,216,1441,240,1450,271,1453,310,1453,460,1450,485,1439,508,1424,528,1405,546,1361,575,1321,594,1319,589,1359,570,1401,542,1420,525,1435,505,1444,483,1448,459,1448,310,1445,272,1436,242,1422,219,1403,203,1379,192,1352,185,1285,182,1122,193,1033,193,988,188,944,180"/>
<area shape="poly" title=" " alt="" coords="913,191,919,225,914,226,907,192"/>
<area shape="poly" title=" " alt="" coords="1056,163,1159,166,1281,175,1395,193,1439,206,1471,223,1490,242,1500,261,1503,283,1504,310,1504,459,1503,486,1499,507,1489,526,1471,546,1440,569,1405,585,1369,595,1336,602,1335,597,1368,590,1403,580,1437,564,1468,542,1484,523,1494,505,1498,485,1499,459,1499,310,1498,284,1495,263,1486,245,1468,227,1437,211,1393,198,1281,180,1159,172,1056,169"/>
<area shape="poly" title=" " alt="" coords="978,188,934,227,930,223,974,184"/>
</map>
</div>
</div>
<p><a href="mesh_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoord.html">Coord</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a coordinate system with arrays for phi, theta, and t.  <a href="classCoord.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afd05120c4d579ec7fa4906f677781a83" id="r_afd05120c4d579ec7fa4906f677781a83"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 1 &gt;</td></tr>
<tr class="memdesc:afd05120c4d579ec7fa4906f677781a83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 1D arrays (e.g., time points)  <br /></td></tr>
<tr class="separator:afd05120c4d579ec7fa4906f677781a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ec6be5d638ad03ae6697ff2b71ef91" id="r_ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 2 &gt;</td></tr>
<tr class="memdesc:ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 2D grids (e.g., spatial coordinates)  <br /></td></tr>
<tr class="separator:ae7ec6be5d638ad03ae6697ff2b71ef91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b76cc05bedc7fd9499c0bd3eec3bcb5" id="r_a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 3 &gt;</td></tr>
<tr class="memdesc:a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D grids (e.g., full spatial-temporal data)  <br /></td></tr>
<tr class="separator:a6b76cc05bedc7fd9499c0bd3eec3bcb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb738e18bf395ef0903c8c5d6f37c47f" id="r_afb738e18bf395ef0903c8c5d6f37c47f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">int</a>, 3 &gt;</td></tr>
<tr class="memdesc:afb738e18bf395ef0903c8c5d6f37c47f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for 3D boolean grids for masking operations.  <br /></td></tr>
<tr class="separator:afb738e18bf395ef0903c8c5d6f37c47f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27e3f4efb19b3f2b0694e0bee5fb25ae" id="r_a27e3f4efb19b3f2b0694e0bee5fb25ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a27e3f4efb19b3f2b0694e0bee5fb25ae">IndexGrid</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>, 2 &gt;</td></tr>
<tr class="separator:a27e3f4efb19b3f2b0694e0bee5fb25ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa5d127d3ecb19584c7f27ee212d49605" id="r_aa5d127d3ecb19584c7f27ee212d49605"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aa5d127d3ecb19584c7f27ee212d49605">is_linear_scale</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>=<a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a>)</td></tr>
<tr class="memdesc:aa5d127d3ecb19584c7f27ee212d49605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if an array is linearly scaled within a given tolerance.  <br /></td></tr>
<tr class="separator:aa5d127d3ecb19584c7f27ee212d49605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e56adbbf18a0c9a5c04a8d4de268d9" id="r_ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ac0e56adbbf18a0c9a5c04a8d4de268d9">is_log_scale</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>=<a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a>)</td></tr>
<tr class="memdesc:ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if an array is logarithmically scaled within a given tolerance.  <br /></td></tr>
<tr class="separator:ac0e56adbbf18a0c9a5c04a8d4de268d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a885b165e8d9c9d20f27ec99329a0c3cb" id="r_a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </td></tr>
<tr class="memitem:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a885b165e8d9c9d20f27ec99329a0c3cb">boundary_to_center</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>)</td></tr>
<tr class="memdesc:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using linear interpolation.  <br /></td></tr>
<tr class="separator:a885b165e8d9c9d20f27ec99329a0c3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba66986baad5475a202c20a92bda036e" id="r_aba66986baad5475a202c20a92bda036e"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </td></tr>
<tr class="memitem:aba66986baad5475a202c20a92bda036e"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aba66986baad5475a202c20a92bda036e">boundary_to_center_log</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>)</td></tr>
<tr class="memdesc:aba66986baad5475a202c20a92bda036e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using geometric mean (logarithmic interpolation)  <br /></td></tr>
<tr class="separator:aba66986baad5475a202c20a92bda036e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1622b29b5488dbee3ef9068b9f8c7d4" id="r_ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae1622b29b5488dbee3ef9068b9f8c7d4">boundary_to_center</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>)</td></tr>
<tr class="memdesc:ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using linear interpolation.  <br /></td></tr>
<tr class="separator:ae1622b29b5488dbee3ef9068b9f8c7d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac536f77c32691232cb5e7546595fb3d2" id="r_ac536f77c32691232cb5e7546595fb3d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ac536f77c32691232cb5e7546595fb3d2">boundary_to_center_log</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>)</td></tr>
<tr class="memdesc:ac536f77c32691232cb5e7546595fb3d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts boundary values to center values using geometric mean.  <br /></td></tr>
<tr class="separator:ac536f77c32691232cb5e7546595fb3d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96aa0a78a0de13a52955de3c2ce29ddd" id="r_a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classCoord.html">Coord</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd">auto_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;t_obs, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_cut</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_view, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> z, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi_resol=<a class="el" href="namespacedefaults_1_1grid.html#a81845ddcce8fb560efb401cdde437a16">defaults::grid::phi_resolution</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_resol=<a class="el" href="namespacedefaults_1_1grid.html#a372994c537be68d80989655f9b43c672">defaults::grid::theta_resolution</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_resol=<a class="el" href="namespacedefaults_1_1grid.html#aa203749fa338e32e6c7a711c82846582">defaults::grid::time_resolution</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>=<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">true</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi_view=0, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_theta_num</a>=<a class="el" href="namespacedefaults_1_1grid.html#a17f64e94f8f9cb660a1e9d80a2b1558c">defaults::grid::min_theta_points</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fwd_ratio</a>=<a class="el" href="namespacedefaults_1_1grid.html#ae654c737813ff06431141238b26e0a67">defaults::grid::forward_ratio</a>)</td></tr>
<tr class="memdesc:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a coordinate grid (<a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a>) for shock evolution.  <br /></td></tr>
<tr class="separator:a96aa0a78a0de13a52955de3c2ce29ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ba8f4400237a97c0d2fac934fb44cf" id="r_a28ba8f4400237a97c0d2fac934fb44cf"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a28ba8f4400237a97c0d2fac934fb44cf"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf">find_jet_edges</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_cut, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>)</td></tr>
<tr class="memdesc:a28ba8f4400237a97c0d2fac934fb44cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary.  <br /></td></tr>
<tr class="separator:a28ba8f4400237a97c0d2fac934fb44cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb4a7162e9b5a1e2ed39f7d9e94b53f" id="r_a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a7cb4a7162e9b5a1e2ed39f7d9e94b53f">jet_spreading_edge</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t0)</td></tr>
<tr class="memdesc:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the edge of the jet where the spreading is strongest.  <br /></td></tr>
<tr class="separator:a7cb4a7162e9b5a1e2ed39f7d9e94b53f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afadc5019976c36be16277dc4dc178a7f" id="r_afadc5019976c36be16277dc4dc178a7f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </td></tr>
<tr class="memitem:afadc5019976c36be16277dc4dc178a7f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#afadc5019976c36be16277dc4dc178a7f">logspace_center</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>)</td></tr>
<tr class="separator:afadc5019976c36be16277dc4dc178a7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76f104cdad403ea346ff1a6603c78ad6" id="r_a76f104cdad403ea346ff1a6603c78ad6"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </td></tr>
<tr class="memitem:a76f104cdad403ea346ff1a6603c78ad6"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a76f104cdad403ea346ff1a6603c78ad6">log2space</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">grid_per_order</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">array</a>)</td></tr>
<tr class="separator:a76f104cdad403ea346ff1a6603c78ad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7703ab8b66bb86ed857746606fac9a2" id="r_ad7703ab8b66bb86ed857746606fac9a2"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </td></tr>
<tr class="memitem:ad7703ab8b66bb86ed857746606fac9a2"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ad7703ab8b66bb86ed857746606fac9a2">logspace_boundary_center</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bin_width</a>)</td></tr>
<tr class="separator:ad7703ab8b66bb86ed857746606fac9a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e78f3cf4aabf7985519d581ce43182" id="r_ae2e78f3cf4aabf7985519d581ce43182"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ae2e78f3cf4aabf7985519d581ce43182">adaptive_grid_with_breaks</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">break_weights</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts_per_decade</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;grid, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_refined_breaks</a>=3, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius_decades</a>=0.5, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_factor</a>=3.0)</td></tr>
<tr class="memdesc:ae2e78f3cf4aabf7985519d581ce43182"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds an adaptive log-spaced grid with explicit break points.  <br /></td></tr>
<tr class="separator:ae2e78f3cf4aabf7985519d581ce43182"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49c59d8da915e118c4e550cc9bd4d3d9" id="r_a49c59d8da915e118c4e550cc9bd4d3d9"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &gt; </td></tr>
<tr class="memitem:a49c59d8da915e118c4e550cc9bd4d3d9"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &amp;&amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>)</td></tr>
<tr class="separator:a49c59d8da915e118c4e550cc9bd4d3d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc6828dd13a70c0c203dba03e765cea" id="r_a3dc6828dd13a70c0c203dba03e765cea"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a3dc6828dd13a70c0c203dba03e765cea"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>)</td></tr>
<tr class="separator:a3dc6828dd13a70c0c203dba03e765cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cba2da30fd9821858dc89b5caea3443" id="r_a9cba2da30fd9821858dc89b5caea3443"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443">edge_refinement_grid</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_min, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_resol)</td></tr>
<tr class="separator:a9cba2da30fd9821858dc89b5caea3443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83ae490737edde6ad03ede25e371a071" id="r_a83ae490737edde6ad03ede25e371a071"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </td></tr>
<tr class="memitem:a83ae490737edde6ad03ede25e371a071"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071">adaptive_phi_grid</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>)</td></tr>
<tr class="separator:a83ae490737edde6ad03ede25e371a071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c066f2c8e6d102d7a56de8cb42cf5a8" id="r_a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </td></tr>
<tr class="memitem:a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a> (<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>)</td></tr>
<tr class="separator:a3c066f2c8e6d102d7a56de8cb42cf5a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7505ad2e84c2a29610c1a13cd3b25e3" id="r_aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </td></tr>
<tr class="memitem:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a> (<a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;medium, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta)</td></tr>
<tr class="memdesc:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates deceleration time for a given angle from ejecta and medium properties.  <br /></td></tr>
<tr class="separator:aa7505ad2e84c2a29610c1a13cd3b25e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2b9eccaf75f7a9fe6bafd8696049bd2" id="r_ab2b9eccaf75f7a9fe6bafd8696049bd2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2">refined_time_grid</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine</a>, <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> t_resol, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a>=0.3, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a>=10.0)</td></tr>
<tr class="memdesc:ab2b9eccaf75f7a9fe6bafd8696049bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a refined logarithmic time grid with higher density around a specified time.  <br /></td></tr>
<tr class="separator:ab2b9eccaf75f7a9fe6bafd8696049bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aba685e866cceb5c13d7e357fcaa69529" id="r_aba685e866cceb5c13d7e357fcaa69529"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">constexpr</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mesh_8h.html#aba685e866cceb5c13d7e357fcaa69529">log2_10</a> = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::numbers::ln10</a> / <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::numbers::ln2</a></td></tr>
<tr class="separator:aba685e866cceb5c13d7e357fcaa69529"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="afd05120c4d579ec7fa4906f677781a83" name="afd05120c4d579ec7fa4906f677781a83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd05120c4d579ec7fa4906f677781a83">&#9670;&#160;</a></span>Array</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 1&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 1D arrays (e.g., time points) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00038">38</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="a27e3f4efb19b3f2b0694e0bee5fb25ae" name="a27e3f4efb19b3f2b0694e0bee5fb25ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27e3f4efb19b3f2b0694e0bee5fb25ae">&#9670;&#160;</a></span>IndexGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#a27e3f4efb19b3f2b0694e0bee5fb25ae">IndexGrid</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>, 2&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00046">46</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="afb738e18bf395ef0903c8c5d6f37c47f" name="afb738e18bf395ef0903c8c5d6f37c47f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb738e18bf395ef0903c8c5d6f37c47f">&#9670;&#160;</a></span>MaskGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">int</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D boolean grids for masking operations. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00044">44</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="ae7ec6be5d638ad03ae6697ff2b71ef91" name="ae7ec6be5d638ad03ae6697ff2b71ef91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ec6be5d638ad03ae6697ff2b71ef91">&#9670;&#160;</a></span>MeshGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 2&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 2D grids (e.g., spatial coordinates) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00040">40</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<a id="a6b76cc05bedc7fd9499c0bd3eec3bcb5" name="a6b76cc05bedc7fd9499c0bd3eec3bcb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b76cc05bedc7fd9499c0bd3eec3bcb5">&#9670;&#160;</a></span>MeshGrid3d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">using</a> <a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a> =  <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">xt::xtensor</a>&lt;<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type alias for 3D grids (e.g., full spatial-temporal data) </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00042">42</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae2e78f3cf4aabf7985519d581ce43182" name="ae2e78f3cf4aabf7985519d581ce43182"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e78f3cf4aabf7985519d581ce43182">&#9670;&#160;</a></span>adaptive_grid_with_breaks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a> adaptive_grid_with_breaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td>
          <td class="paramname"><em>breaks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::span</a>&lt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt;&#160;</td>
          <td class="paramname"><em>break_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>pts_per_decade</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>max_refined_breaks</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_radius_decades</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_factor</em> = <code>3.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Builds an adaptive log-spaced grid with explicit break points. </p>
<p>Places grid points at endpoints and break frequencies, then fills segments between with approximately <code>pts_per_decade</code> log-spaced points. Nearby points are merged automatically based on the local step size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lg2_min</td><td>Log2 of minimum grid value </td></tr>
    <tr><td class="paramname">lg2_max</td><td>Log2 of maximum grid value </td></tr>
    <tr><td class="paramname">breaks</td><td>Break frequencies (linear scale) to include </td></tr>
    <tr><td class="paramname">break_weights</td><td>Importance weights for each break (top values get refined regions) </td></tr>
    <tr><td class="paramname">pts_per_decade</td><td>Base density of fill points per decade </td></tr>
    <tr><td class="paramname">grid</td><td>Output array of grid point values (resized internally) </td></tr>
    <tr><td class="paramname">max_refined_breaks</td><td>Maximum number of breaks to refine (sorted by weight) </td></tr>
    <tr><td class="paramname">refine_radius_decades</td><td>Half-width of the refined region around each break (in decades) </td></tr>
    <tr><td class="paramname">refine_factor</td><td>Grid density multiplier inside refined regions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of grid points </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00291">291</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  294</span>                                                                  {</div>
<div class="line"><span class="lineno">  295</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a> = 256;</div>
<div class="line"><span class="lineno">  296</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_per_decade</a> = <a class="code hl_variable" href="mesh_8h.html#aba685e866cceb5c13d7e357fcaa69529">log2_10</a>;</div>
<div class="line"><span class="lineno">  297</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius_decades</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_per_decade</a>;</div>
<div class="line"><span class="lineno">  298</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_per_decade</a> / std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts_per_decade</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>(1e-6));</div>
<div class="line"><span class="lineno">  299</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fine_step</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_factor</a>;</div>
<div class="line"><span class="lineno">  300</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merge_eps</a> = 0.5 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fine_step</a>;</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="comment">// Collect valid breaks within range with weights</span></div>
<div class="line"><span class="lineno">  303</span>    <span class="keyword">struct </span><a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Break</a> {</div>
<div class="line"><span class="lineno">  304</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a>;</div>
<div class="line"><span class="lineno">  305</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weight</a>;</div>
<div class="line"><span class="lineno">  306</span>    };</div>
<div class="line"><span class="lineno">  307</span>    std::vector&lt;Break&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>;</div>
<div class="line"><span class="lineno">  308</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>.size());</div>
<div class="line"><span class="lineno">  309</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  310</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">breaks</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>];</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">if</span> (!(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> &gt; 0) || !std::isfinite(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>)) {</div>
<div class="line"><span class="lineno">  312</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  313</span>        }</div>
<div class="line"><span class="lineno">  314</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a> = std::log2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>);</div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a> &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a> &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>) {</div>
<div class="line"><span class="lineno">  316</span>            <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a> = 1;</div>
<div class="line"><span class="lineno">  317</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">break_weights</a>.size()) {</div>
<div class="line"><span class="lineno">  318</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">break_weights</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>];</div>
<div class="line"><span class="lineno">  319</span>                <span class="keywordflow">if</span> (std::isfinite(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a>) &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a> &gt;= 0) {</div>
<div class="line"><span class="lineno">  320</span>                    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">wi</a>;</div>
<div class="line"><span class="lineno">  321</span>                }</div>
<div class="line"><span class="lineno">  322</span>            }</div>
<div class="line"><span class="lineno">  323</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_b</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a>});</div>
<div class="line"><span class="lineno">  324</span>        }</div>
<div class="line"><span class="lineno">  325</span>    }</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    <span class="comment">// Sort by weight descending; top N get refinement</span></div>
<div class="line"><span class="lineno">  328</span>    std::ranges::sort(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>, [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) { <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>.weight &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>.weight; });</div>
<div class="line"><span class="lineno">  329</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_refine</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_refined_breaks</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>.size());</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>    <span class="comment">// Build grid points with break tracking for merge protection</span></div>
<div class="line"><span class="lineno">  332</span>    <span class="keyword">struct </span><a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Pt</a> {</div>
<div class="line"><span class="lineno">  333</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a>;</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_break</a>;</div>
<div class="line"><span class="lineno">  335</span>    };</div>
<div class="line"><span class="lineno">  336</span>    std::vector&lt;Pt&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>;</div>
<div class="line"><span class="lineno">  337</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a> * 2);</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>    <span class="comment">// Coarse uniform grid</span></div>
<div class="line"><span class="lineno">  340</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>(0));</div>
<div class="line"><span class="lineno">  341</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_coarse</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> &gt; 0 &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a> &gt; 0)</div>
<div class="line"><span class="lineno">  342</span>                                ? std::max&lt;size_t&gt;(1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::ceil(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coarse_step</a>)))</div>
<div class="line"><span class="lineno">  343</span>                                : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>(1);</div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_coarse</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  345</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">span</a> * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_coarse</a>), <span class="keyword">false</span>});</div>
<div class="line"><span class="lineno">  346</span>    }</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <span class="comment">// Break anchors</span></div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">br</a> : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>) {</div>
<div class="line"><span class="lineno">  350</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">br</a>.lg2, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  351</span>    }</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    <span class="comment">// Refinement around top-weighted breaks</span></div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_refine</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  355</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>].<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius</a>);</div>
<div class="line"><span class="lineno">  356</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">valid_breaks</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>].<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_radius</a>);</div>
<div class="line"><span class="lineno">  357</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fine_step</a>));</div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt;= n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) {</div>
<div class="line"><span class="lineno">  359</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(n), <span class="keyword">false</span>});</div>
<div class="line"><span class="lineno">  360</span>        }</div>
<div class="line"><span class="lineno">  361</span>    }</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    <span class="comment">// Sort and merge close points, protecting break positions</span></div>
<div class="line"><span class="lineno">  364</span>    std::ranges::sort(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>, [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) { <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a>.lg2 &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>.lg2; });</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    std::vector&lt;Pt&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>;</div>
<div class="line"><span class="lineno">  367</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>.size());</div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pts</a>) {</div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.empty() &amp;&amp; p.lg2 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().lg2 &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merge_eps</a>) {</div>
<div class="line"><span class="lineno">  370</span>            <span class="keywordflow">if</span> (p.is_break &amp;&amp; !<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().is_break) {</div>
<div class="line"><span class="lineno">  371</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back() = p;</div>
<div class="line"><span class="lineno">  372</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  373</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().is_break = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().is_break || p.is_break;</div>
<div class="line"><span class="lineno">  374</span>            }</div>
<div class="line"><span class="lineno">  375</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  376</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back(p);</div>
<div class="line"><span class="lineno">  377</span>        }</div>
<div class="line"><span class="lineno">  378</span>    }</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <span class="comment">// Ensure endpoints</span></div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.empty()) {</div>
<div class="line"><span class="lineno">  382</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  383</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  384</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  385</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.front().lg2 = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>;</div>
<div class="line"><span class="lineno">  386</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size() == 1) {</div>
<div class="line"><span class="lineno">  387</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.push_back({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, <span class="keyword">true</span>});</div>
<div class="line"><span class="lineno">  388</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  389</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.back().lg2 = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>;</div>
<div class="line"><span class="lineno">  390</span>        }</div>
<div class="line"><span class="lineno">  391</span>    }</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>    <span class="comment">// Hard cap with uniform subsampling</span></div>
<div class="line"><span class="lineno">  394</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size() &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a>) {</div>
<div class="line"><span class="lineno">  395</span>        std::vector&lt;Pt&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>;</div>
<div class="line"><span class="lineno">  396</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a>);</div>
<div class="line"><span class="lineno">  397</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  398</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size() - 1) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">MAX_PTS</a> - 1)]);</div>
<div class="line"><span class="lineno">  399</span>        }</div>
<div class="line"><span class="lineno">  400</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.swap(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">capped</a>);</div>
<div class="line"><span class="lineno">  401</span>    }</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>    grid = Array::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size()});</div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  405</span>        grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>].<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2</a>);</div>
<div class="line"><span class="lineno">  406</span>    }</div>
<div class="line"><span class="lineno">  407</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">merged</a>.size();</div>
<div class="line"><span class="lineno">  408</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00024">macros.h:24</a></div></div>
<div class="ttc" id="amesh_8h_html_aba685e866cceb5c13d7e357fcaa69529"><div class="ttname"><a href="mesh_8h.html#aba685e866cceb5c13d7e357fcaa69529">log2_10</a></div><div class="ttdeci">constexpr Real log2_10</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00018">mesh.h:18</a></div></div>
<div class="ttc" id="apybind_8cpp_html_ad93eae6422741850877b46bd61f08c89"><div class="ttname"><a href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">make_native_binary</a></div><div class="ttdeci">BinaryFunc make_native_binary(uintptr_t addr, std::vector&lt; Real &gt; const &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="pybind_8cpp_source.html#l00027">pybind.cpp:27</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph.png" border="0" usemap="#amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph" alt=""/></div>
<map name="amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph" id="amesh_8h_ae2e78f3cf4aabf7985519d581ce43182_cgraph">
<area shape="rect" title="Builds an adaptive log&#45;spaced grid with explicit break points." alt="" coords="5,5,152,45"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="200,13,355,38"/>
<area shape="poly" title=" " alt="" coords="152,23,186,23,186,28,152,28"/>
</map>
</div>

</div>
</div>
<a id="a83ae490737edde6ad03ede25e371a071" name="a83ae490737edde6ad03ede25e371a071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83ae490737edde6ad03ede25e371a071">&#9670;&#160;</a></span>adaptive_phi_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> adaptive_phi_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>phi_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00579">579</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  579</span>                                                                                                               {</div>
<div class="line"><span class="lineno">  580</span>    <span class="keywordflow">if</span> ((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a> == 0 &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>) || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a> &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>) {</div>
<div class="line"><span class="lineno">  581</span>        <span class="keywordflow">return</span> xt::linspace(0., 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>);</div>
<div class="line"><span class="lineno">  582</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  583</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_tv</a> = std::cos(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>);</div>
<div class="line"><span class="lineno">  584</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sin_tv</a> = std::sin(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>);</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>        <span class="comment">// Sample a few theta values to find the peak Doppler weight at each phi</span></div>
<div class="line"><span class="lineno">  587</span>        <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta_sample</a> = 8;</div>
<div class="line"><span class="lineno">  588</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a> = [=, &amp;<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span>&amp; <span class="comment">/*cdf*/</span>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> phi) {</div>
<div class="line"><span class="lineno">  591</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_phi</a> = std::cos(phi);</div>
<div class="line"><span class="lineno">  592</span>            <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a> = 0;</div>
<div class="line"><span class="lineno">  593</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta_sample</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>) {</div>
<div class="line"><span class="lineno">  594</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">it</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_theta_sample</a> - 1);</div>
<div class="line"><span class="lineno">  595</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, theta);</div>
<div class="line"><span class="lineno">  596</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> = std::sqrt(std::fabs(Gamma * Gamma - 1)) / Gamma;</div>
<div class="line"><span class="lineno">  597</span>                <span class="comment">// cos(angle to LOS) = cos(theta)cos(theta_v) + sin(theta)sin(theta_v)cos(phi)</span></div>
<div class="line"><span class="lineno">  598</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_alpha</a> = std::cos(theta) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_tv</a> + std::sin(theta) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sin_tv</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_phi</a>;</div>
<div class="line"><span class="lineno">  599</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> = (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cos_alpha</a>);</div>
<div class="line"><span class="lineno">  600</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weight</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> * Gamma * std::sqrt((Gamma - 1) * Gamma) * std::sin(theta);</div>
<div class="line"><span class="lineno">  601</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weight</a>);</div>
<div class="line"><span class="lineno">  602</span>            }</div>
<div class="line"><span class="lineno">  603</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">max_weight</a>;</div>
<div class="line"><span class="lineno">  604</span>        };</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a>, 0, 2 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>);</div>
<div class="line"><span class="lineno">  607</span>    }</div>
<div class="line"><span class="lineno">  608</span>}</div>
<div class="ttc" id="amesh_8h_html_a49c59d8da915e118c4e550cc9bd4d3d9"><div class="ttname"><a href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a></div><div class="ttdeci">Array inverse_CFD_sampling(Func &amp;&amp;pdf, Real min, Real max, size_t num)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00499">mesh.h:499</a></div></div>
<div class="ttc" id="anamespacecon_html_aa0ccd904b754d0f907898a942516d121"><div class="ttname"><a href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a></div><div class="ttdeci">constexpr Real pi</div><div class="ttdoc">Pi.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00097">macros.h:97</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1grid_html_af2b7c5de15cb9c537f0de0e0e56148b1"><div class="ttname"><a href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a></div><div class="ttdeci">constexpr double theta_min</div><div class="ttdoc">Minimum polar angle (avoids singularity at theta=0)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00080">simulation-defaults.h:80</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph.png" border="0" usemap="#amesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph" alt=""/></div>
<map name="amesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph" id="amesh_8h_a83ae490737edde6ad03ede25e371a071_cgraph">
<area shape="rect" title=" " alt="" coords="5,96,144,121"/>
<area shape="rect" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9" title=" " alt="" coords="192,46,363,72"/>
<area shape="poly" title=" " alt="" coords="127,93,211,73,212,78,128,98"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="509,46,664,72"/>
<area shape="poly" title=" " alt="" coords="144,114,211,118,291,120,376,117,461,106,506,93,548,76,550,81,508,98,462,111,377,122,291,125,211,124,144,119"/>
<area shape="poly" title=" " alt="" coords="299,44,330,28,371,14,416,4,462,6,509,20,551,38,548,43,507,25,461,11,416,10,372,19,333,33,302,49"/>
<area shape="rect" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491" title="Returns the value of a single parameter." alt="" coords="411,21,461,46"/>
<area shape="poly" title=" " alt="" coords="357,44,397,37,398,43,358,49"/>
<area shape="rect" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1" title="Returns the value of a single parameter." alt="" coords="413,70,459,96"/>
<area shape="poly" title=" " alt="" coords="362,69,400,75,399,80,361,74"/>
<area shape="poly" title=" " alt="" coords="462,35,498,42,497,47,461,41"/>
<area shape="poly" title=" " alt="" coords="459,77,495,71,496,76,460,82"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph.png" border="0" usemap="#amesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph" alt=""/></div>
<map name="amesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph" id="amesh_8h_a83ae490737edde6ad03ede25e371a071_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,913,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a3dc6828dd13a70c0c203dba03e765cea" name="a3dc6828dd13a70c0c203dba03e765cea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dc6828dd13a70c0c203dba03e765cea">&#9670;&#160;</a></span>adaptive_theta_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> adaptive_theta_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>theta_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00537">537</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  537</span>                                                                                                             {</div>
<div class="line"><span class="lineno">  538</span>    <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a> = [=, &amp;<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span>&amp; <span class="comment">/*cdf*/</span>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>, <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta) {</div>
<div class="line"><span class="lineno">  539</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Gamma = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, theta);</div>
<div class="line"><span class="lineno">  540</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> = std::sqrt(std::fabs(Gamma * Gamma - 1)) / Gamma;</div>
<div class="line"><span class="lineno">  541</span>        <span class="comment">// Real D = 1 / (Gamma * (1 - beta * std::cos(theta - theta_v)));</span></div>
<div class="line"><span class="lineno">  542</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> = (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * std::cos(theta - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v</a>));</div>
<div class="line"><span class="lineno">  543</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">a</a> * Gamma * std::sqrt((Gamma - 1) * Gamma) * std::sin(theta);</div>
<div class="line"><span class="lineno">  544</span>        <span class="comment">// pdf = D * std::sin(theta);</span></div>
<div class="line"><span class="lineno">  545</span>    };</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9">inverse_CFD_sampling</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eqn</a>, theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>);</div>
<div class="line"><span class="lineno">  548</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph.png" border="0" usemap="#amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph" alt=""/></div>
<map name="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph" id="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_cgraph">
<area shape="rect" title=" " alt="" coords="5,96,157,121"/>
<area shape="rect" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9" title=" " alt="" coords="205,46,376,72"/>
<area shape="poly" title=" " alt="" coords="135,93,222,72,224,78,137,98"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="523,46,677,72"/>
<area shape="poly" title=" " alt="" coords="158,114,225,119,305,120,390,117,474,106,520,93,561,76,563,81,522,98,475,111,391,122,305,126,225,124,157,119"/>
<area shape="poly" title=" " alt="" coords="312,44,344,28,384,14,429,4,475,6,522,20,564,38,562,43,520,25,474,11,430,10,385,19,346,33,315,49"/>
<area shape="rect" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491" title="Returns the value of a single parameter." alt="" coords="424,21,475,46"/>
<area shape="poly" title=" " alt="" coords="370,44,410,37,411,43,371,49"/>
<area shape="rect" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1" title="Returns the value of a single parameter." alt="" coords="426,70,473,96"/>
<area shape="poly" title=" " alt="" coords="375,69,413,75,412,80,374,74"/>
<area shape="poly" title=" " alt="" coords="476,35,511,42,511,47,475,41"/>
<area shape="poly" title=" " alt="" coords="473,77,509,71,510,76,474,82"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph.png" border="0" usemap="#amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph" alt=""/></div>
<map name="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph" id="amesh_8h_a3dc6828dd13a70c0c203dba03e765cea_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,927,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a96aa0a78a0de13a52955de3c2ce29ddd" name="a96aa0a78a0de13a52955de3c2ce29ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96aa0a78a0de13a52955de3c2ce29ddd">&#9670;&#160;</a></span>auto_grid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCoord.html">Coord</a> auto_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_view</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a81845ddcce8fb560efb401cdde437a16">defaults::grid::phi_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a372994c537be68d80989655f9b43c672">defaults::grid::theta_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_resol</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#aa203749fa338e32e6c7a711c82846582">defaults::grid::time_resolution</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em> = <code><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">true</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi_view</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>min_theta_num</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#a17f64e94f8f9cb660a1e9d80a2b1558c">defaults::grid::min_theta_points</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>fwd_ratio</em> = <code><a class="el" href="namespacedefaults_1_1grid.html#ae654c737813ff06431141238b26e0a67">defaults::grid::forward_ratio</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a coordinate grid (<a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a>) for shock evolution. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">theta_cut</td><td>Maximum theta value to include </td></tr>
    <tr><td class="paramname">theta_view</td><td>Viewing angle </td></tr>
    <tr><td class="paramname">z</td><td>Redshift </td></tr>
    <tr><td class="paramname">phi_resol</td><td></td></tr>
    <tr><td class="paramname">theta_resol</td><td></td></tr>
    <tr><td class="paramname">t_resol</td><td></td></tr>
    <tr><td class="paramname">is_axisymmetric</td><td>Whether the jet is axisymmetric (default: true) </td></tr>
    <tr><td class="paramname">phi_view</td><td>Viewing angle (default: 0) </td></tr>
    <tr><td class="paramname">min_theta_num</td><td>Minimum number of theta grid points (default: 56) </td></tr>
    <tr><td class="paramname">fwd_ratio</td><td>Forward ratio for grid resolution (default: 0.3) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="classCoord.html" title="Represents a coordinate system with arrays for phi, theta, and t.">Coord</a> object with the constructed grid</dd></dl>
<p>The grid is based on the observation times (t_obs), maximum theta value (theta_cut), and specified numbers of grid points in phi, theta, and t. The radial grid is logarithmically spaced between t_min and t_max, and the theta grid is generated linearly. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00756">756</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  758</span>                                                      {</div>
<div class="line"><span class="lineno">  759</span>    <a class="code hl_class" href="classCoord.html">Coord</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>;</div>
<div class="line"><span class="lineno">  760</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.<a class="code hl_variable" href="classCoord.html#aeb5bef37e495fdeefad735154e99bf73">theta_view</a> = theta_view;</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a> = <a class="code hl_function" href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf">find_jet_edges</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="code hl_variable" href="namespacecon.html#a9c6b1c9b349c790392fa370c8d9e13a8">con::Gamma_cut</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>);</div>
<div class="line"><span class="lineno">  763</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edge</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>.empty() ? <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_cut</a> : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>.back(); <span class="comment">// outermost edge (fallback if no edges)</span></div>
<div class="line"><span class="lineno">  764</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  765</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edge</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_cut</a>);</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">min_theta_num</a> + <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) * 180 / <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> * theta_resol);</div>
<div class="line"><span class="lineno">  768</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta_num</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">fwd_ratio</a>);</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta_num</a>;</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta</a> = xt::linspace(theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta_num</a>);</div>
<div class="line"><span class="lineno">  772</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta</a> = <a class="code hl_function" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta_num</a>, theta_view);</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_num</a>;</div>
<div class="line"><span class="lineno">  775</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge_theta</a> = <a class="code hl_function" href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443">edge_refinement_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>, theta_min, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a>, theta_resol);</div>
<div class="line"><span class="lineno">  776</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta = <a class="code hl_function" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a>(<a class="code hl_function" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">uniform_theta</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">adaptive_theta</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge_theta</a>);</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>    <span class="comment">// coord.theta = uniform_theta;</span></div>
<div class="line"><span class="lineno">  779</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a> = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(360 * phi_resol), 1);</div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi = <a class="code hl_function" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071">adaptive_phi_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_num</a>, theta_view, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a>);</div>
<div class="line"><span class="lineno">  782</span> </div>
<div class="line"><span class="lineno">  783</span>    <span class="keywordflow">if</span> (t_obs.size() == 0) {</div>
<div class="line"><span class="lineno">  784</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">assert</a>(<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;auto_grid: t_obs is empty&quot;</span>);</div>
<div class="line"><span class="lineno">  785</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>;</div>
<div class="line"><span class="lineno">  786</span>    }</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a> = *std::ranges::max_element(t_obs);</div>
<div class="line"><span class="lineno">  789</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a> = *std::ranges::min_element(t_obs);</div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>    <span class="comment">// Compute base time grid size + extra points for refinement around t_dec</span></div>
<div class="line"><span class="lineno">  792</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">base_t_num</a> = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a>) * t_resol), 24);</div>
<div class="line"><span class="lineno">  793</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_ratio</a> = 2.0;</div>
<div class="line"><span class="lineno">  794</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a> = 0.3;</div>
<div class="line"><span class="lineno">  795</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> = 10.0;</div>
<div class="line"><span class="lineno">  796</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_extra</a> =</div>
<div class="line"><span class="lineno">  797</span>        <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_ratio</a> - 1.0) * t_resol * std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a>));</div>
<div class="line"><span class="lineno">  798</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">base_t_num</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_extra</a>;</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta.size();</div>
<div class="line"><span class="lineno">  801</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">is_axisymmetric</a> ? 1 : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi.size();</div>
<div class="line"><span class="lineno">  802</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v_max</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta.back() + theta_view;</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.t = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a>, theta_size, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>});</div>
<div class="line"><span class="lineno">  805</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">phi_size_needed</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  806</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; theta_size; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  807</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a> = <a class="code hl_function" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090">physics::relativistic::gamma_to_beta</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>)));</div>
<div class="line"><span class="lineno">  808</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a> =</div>
<div class="line"><span class="lineno">  809</span>                std::max&lt;Real&gt;(0.99 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_min</a> * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) / (1 - std::cos(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_v_max</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">b</a>) / (1 + z), 1e-2 * <a class="code hl_variable" href="namespaceunit.html#a4e7c438655d3f34c7c30a155ec38f250">unit::sec</a>);</div>
<div class="line"><span class="lineno">  810</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a> = 1.01 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_max</a> / (1 + z);</div>
<div class="line"><span class="lineno">  811</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_dec</a> = <a class="code hl_function" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>, medium, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.phi(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.theta(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>));</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>            xt::view(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>.t, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>, xt::all()) =</div>
<div class="line"><span class="lineno">  814</span>                <a class="code hl_function" href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2">refined_time_grid</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_dec</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>, t_resol, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a>);</div>
<div class="line"><span class="lineno">  815</span>        }</div>
<div class="line"><span class="lineno">  816</span>    }</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">coord</a>;</div>
<div class="line"><span class="lineno">  819</span>}</div>
<div class="ttc" id="aclassCoord_html"><div class="ttname"><a href="classCoord.html">Coord</a></div><div class="ttdoc">Represents a coordinate system with arrays for phi, theta, and t.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00057">mesh.h:57</a></div></div>
<div class="ttc" id="aclassCoord_html_aeb5bef37e495fdeefad735154e99bf73"><div class="ttname"><a href="classCoord.html#aeb5bef37e495fdeefad735154e99bf73">Coord::theta_view</a></div><div class="ttdeci">Real theta_view</div><div class="ttdoc">Viewing angle.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00065">mesh.h:65</a></div></div>
<div class="ttc" id="amesh_8h_html_a28ba8f4400237a97c0d2fac934fb44cf"><div class="ttname"><a href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf">find_jet_edges</a></div><div class="ttdeci">std::vector&lt; Real &gt; find_jet_edges(Ejecta const &amp;jet, Real gamma_cut, bool is_axisymmetric)</div><div class="ttdoc">Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00411">mesh.h:411</a></div></div>
<div class="ttc" id="amesh_8h_html_a3c066f2c8e6d102d7a56de8cb42cf5a8"><div class="ttname"><a href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8">merge_grids</a></div><div class="ttdeci">Array merge_grids(Arr const &amp;arr1, Arr const &amp;arr2)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00611">mesh.h:611</a></div></div>
<div class="ttc" id="amesh_8h_html_a3dc6828dd13a70c0c203dba03e765cea"><div class="ttname"><a href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea">adaptive_theta_grid</a></div><div class="ttdeci">Array adaptive_theta_grid(Ejecta const &amp;jet, Real theta_min, Real theta_max, size_t theta_num, Real theta_v)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00537">mesh.h:537</a></div></div>
<div class="ttc" id="amesh_8h_html_a83ae490737edde6ad03ede25e371a071"><div class="ttname"><a href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071">adaptive_phi_grid</a></div><div class="ttdeci">Array adaptive_phi_grid(Ejecta const &amp;jet, size_t phi_num, Real theta_v, Real theta_max, bool is_axisymmetric)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00579">mesh.h:579</a></div></div>
<div class="ttc" id="amesh_8h_html_a9cba2da30fd9821858dc89b5caea3443"><div class="ttname"><a href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443">edge_refinement_grid</a></div><div class="ttdeci">Array edge_refinement_grid(std::vector&lt; Real &gt; const &amp;jet_edges, Real theta_min, Real theta_max, Real avg_spacing, Real theta_resol)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00550">mesh.h:550</a></div></div>
<div class="ttc" id="amesh_8h_html_aa7505ad2e84c2a29610c1a13cd3b25e3"><div class="ttname"><a href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3">estimate_t_dec</a></div><div class="ttdeci">Real estimate_t_dec(Ejecta const &amp;jet, Medium const &amp;medium, Real phi, Real theta)</div><div class="ttdoc">Estimates deceleration time for a given angle from ejecta and medium properties.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00645">mesh.h:645</a></div></div>
<div class="ttc" id="amesh_8h_html_ab2b9eccaf75f7a9fe6bafd8696049bd2"><div class="ttname"><a href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2">refined_time_grid</a></div><div class="ttdeci">Array refined_time_grid(Real t_start, Real t_end, Real t_refine, size_t t_num, Real t_resol, Real refine_lo_factor=0.3, Real refine_hi_factor=10.0)</div><div class="ttdoc">Create a refined logarithmic time grid with higher density around a specified time.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00700">mesh.h:700</a></div></div>
<div class="ttc" id="amesh_8h_html_afd05120c4d579ec7fa4906f677781a83"><div class="ttname"><a href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a></div><div class="ttdeci">xt::xtensor&lt; Real, 1 &gt; Array</div><div class="ttdoc">Type alias for 1D arrays (e.g., time points)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00038">mesh.h:38</a></div></div>
<div class="ttc" id="anamespacecon_html_a9c6b1c9b349c790392fa370c8d9e13a8"><div class="ttname"><a href="namespacecon.html#a9c6b1c9b349c790392fa370c8d9e13a8">con::Gamma_cut</a></div><div class="ttdeci">constexpr Real Gamma_cut</div><div class="ttdoc">Cutoff Lorentz factor value.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00102">macros.h:102</a></div></div>
<div class="ttc" id="anamespacephysics_1_1relativistic_html_aed1c46f33c9d25ffa27131014b190090"><div class="ttname"><a href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090">physics::relativistic::gamma_to_beta</a></div><div class="ttdeci">Real gamma_to_beta(Real gamma) noexcept</div><div class="ttdoc">Converts Lorentz factor (gamma) to a velocity fraction (beta)</div><div class="ttdef"><b>Definition</b> <a href="physics_8h_source.html#l00036">physics.h:36</a></div></div>
<div class="ttc" id="anamespaceunit_html_a4e7c438655d3f34c7c30a155ec38f250"><div class="ttname"><a href="namespaceunit.html#a4e7c438655d3f34c7c30a155ec38f250">unit::sec</a></div><div class="ttdeci">constexpr Real sec</div><div class="ttdoc">Second in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00046">macros.h:46</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph.png" border="0" usemap="#amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph" alt=""/></div>
<map name="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph" id="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_cgraph">
<area shape="rect" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="5,348,88,374"/>
<area shape="rect" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071" title=" " alt="" coords="143,168,281,194"/>
<area shape="poly" title=" " alt="" coords="52,347,84,293,107,260,134,230,174,199,177,203,138,234,112,264,89,296,57,350"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="739,270,893,295"/>
<area shape="poly" title=" " alt="" coords="48,348,56,311,72,259,97,204,114,178,134,154,181,113,225,90,274,76,335,61,436,30,519,7,559,3,600,6,644,20,692,44,719,65,742,90,762,118,778,149,800,208,813,256,807,257,795,209,773,151,757,121,738,93,716,69,689,49,642,25,599,12,559,8,520,12,438,35,337,66,275,81,227,95,184,117,138,158,119,181,102,207,77,261,61,312,53,349"/>
<area shape="rect" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea" title=" " alt="" coords="136,244,288,270"/>
<area shape="poly" title=" " alt="" coords="60,346,93,318,135,288,164,273,166,277,137,293,96,322,63,350"/>
<area shape="rect" href="mesh_8h.html#a9cba2da30fd9821858dc89b5caea3443" title=" " alt="" coords="339,295,503,320"/>
<area shape="poly" title=" " alt="" coords="86,346,135,333,233,319,326,310,326,315,234,324,137,338,87,351"/>
<area shape="rect" href="mesh_8h.html#aa7505ad2e84c2a29610c1a13cd3b25e3" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="151,348,273,374"/>
<area shape="poly" title=" " alt="" coords="88,358,137,358,137,364,88,364"/>
<area shape="rect" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090" title="Converts Lorentz factor (gamma) to a velocity fraction (beta)" alt="" coords="347,396,495,436"/>
<area shape="poly" title=" " alt="" coords="89,371,137,382,239,398,334,407,333,413,238,403,135,388,88,376"/>
<area shape="rect" href="mesh_8h.html#a28ba8f4400237a97c0d2fac934fb44cf" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="565,452,681,478"/>
<area shape="poly" title=" " alt="" coords="67,372,99,391,137,409,191,426,247,440,360,457,465,464,551,465,551,470,465,469,360,462,246,445,190,432,135,414,96,396,65,376"/>
<area shape="rect" href="mesh_8h.html#a3c066f2c8e6d102d7a56de8cb42cf5a8" title=" " alt="" coords="370,511,473,536"/>
<area shape="poly" title=" " alt="" coords="55,373,66,399,83,431,107,463,137,489,191,513,249,525,306,530,356,528,356,534,305,535,248,531,189,518,135,494,103,467,78,434,61,401,50,375"/>
<area shape="rect" href="mesh_8h.html#ab2b9eccaf75f7a9fe6bafd8696049bd2" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="555,558,691,583"/>
<area shape="poly" title=" " alt="" coords="53,373,61,407,76,452,101,497,118,517,137,534,187,560,240,579,296,590,353,596,408,597,461,594,550,583,551,588,461,600,408,602,353,601,296,596,239,584,185,565,135,538,114,521,97,500,71,454,55,409,47,375"/>
<area shape="rect" href="mesh_8h.html#a49c59d8da915e118c4e550cc9bd4d3d9" title=" " alt="" coords="336,168,507,194"/>
<area shape="poly" title=" " alt="" coords="282,178,322,178,322,184,282,184"/>
<area shape="poly" title=" " alt="" coords="231,166,309,121,364,95,426,71,493,54,561,47,595,48,628,53,661,63,692,77,716,94,738,115,772,164,796,214,810,255,805,257,791,216,767,167,734,119,713,98,689,82,659,68,627,59,594,54,561,52,494,59,428,76,366,100,311,126,234,170"/>
<area shape="poly" title=" " alt="" coords="493,166,539,162,589,161,641,166,692,179,724,194,753,215,797,257,794,261,749,219,721,199,690,184,640,171,589,166,539,167,494,171"/>
<area shape="rect" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491" title="Returns the value of a single parameter." alt="" coords="597,194,648,219"/>
<area shape="poly" title=" " alt="" coords="507,189,584,199,584,204,507,194"/>
<area shape="rect" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1" title="Returns the value of a single parameter." alt="" coords="599,92,646,118"/>
<area shape="poly" title=" " alt="" coords="455,166,586,116,588,121,457,171"/>
<area shape="poly" title=" " alt="" coords="649,214,771,262,769,267,647,218"/>
<area shape="poly" title=" " alt="" coords="647,111,670,121,692,135,726,165,756,198,801,257,797,260,752,201,722,168,689,139,667,126,645,115"/>
<area shape="poly" title=" " alt="" coords="247,242,372,196,373,201,249,247"/>
<area shape="poly" title=" " alt="" coords="288,258,691,274,725,276,725,281,691,280,288,263"/>
<area shape="poly" title=" " alt="" coords="503,300,724,286,725,291,504,305"/>
<area shape="poly" title=" " alt="" coords="273,353,506,329,690,302,734,295,735,300,691,308,507,334,274,358"/>
<area shape="poly" title=" " alt="" coords="262,371,335,390,333,396,261,376"/>
<area shape="poly" title=" " alt="" coords="496,412,590,402,641,391,690,375,719,360,746,341,790,303,794,307,749,345,721,364,692,380,642,396,591,407,496,418"/>
<area shape="poly" title=" " alt="" coords="655,450,689,430,722,399,752,366,797,305,802,308,757,369,726,403,692,434,657,455"/>
<area shape="poly" title=" " alt="" coords="473,527,522,528,578,524,636,512,664,501,689,487,712,469,733,447,766,398,790,348,805,307,810,309,795,350,771,401,737,450,716,473,692,491,666,506,638,517,579,530,522,534,473,532"/>
<area shape="poly" title=" " alt="" coords="657,555,689,534,712,507,733,477,766,414,790,355,805,308,810,309,795,356,771,417,737,480,716,510,692,538,660,560"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph.png" border="0" usemap="#amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph" alt=""/></div>
<map name="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph" id="amesh_8h_a96aa0a78a0de13a52955de3c2ce29ddd_icgraph">
<area shape="rect" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a885b165e8d9c9d20f27ec99329a0c3cb" name="a885b165e8d9c9d20f27ec99329a0c3cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a885b165e8d9c9d20f27ec99329a0c3cb">&#9670;&#160;</a></span>boundary_to_center() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> boundary_to_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using linear interpolation. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Arr1</td><td>Type of the input array </td></tr>
    <tr><td class="paramname">Arr2</td><td>Type of the output array </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
    <tr><td class="paramname">center</td><td>Output array of center values</td></tr>
  </table>
  </dd>
</dl>
<p>This is used to compute cell-centered values from cell-boundary values. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00205">205</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  205</span>                                                            {</div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2 || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size() + 1 != <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size()) {</div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  208</span>    }</div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  210</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph.png" border="0" usemap="#amesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph" alt=""/></div>
<map name="amesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph" id="amesh_8h_a885b165e8d9c9d20f27ec99329a0c3cb_cgraph">
<area shape="rect" title="Converts boundary values to center values using linear interpolation." alt="" coords="5,5,156,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="204,5,359,31"/>
<area shape="poly" title=" " alt="" coords="156,15,191,15,191,21,156,21"/>
</map>
</div>

</div>
</div>
<a id="ae1622b29b5488dbee3ef9068b9f8c7d4" name="ae1622b29b5488dbee3ef9068b9f8c7d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1622b29b5488dbee3ef9068b9f8c7d4">&#9670;&#160;</a></span>boundary_to_center() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> boundary_to_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using linear interpolation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of center values </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00038">38</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>                                                {</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2) {</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">return</span> Array::from_shape({0});</div>
<div class="line"><span class="lineno">   41</span>    }</div>
<div class="line"><span class="lineno">   42</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() - 1}, 0);</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   44</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">   45</span>    }</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>;</div>
<div class="line"><span class="lineno">   47</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph.png" border="0" usemap="#amesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph" alt=""/></div>
<map name="amesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph" id="amesh_8h_ae1622b29b5488dbee3ef9068b9f8c7d4_cgraph">
<area shape="rect" title="Converts boundary values to center values using linear interpolation." alt="" coords="5,5,156,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="204,5,359,31"/>
<area shape="poly" title=" " alt="" coords="156,15,191,15,191,21,156,21"/>
</map>
</div>

</div>
</div>
<a id="aba66986baad5475a202c20a92bda036e" name="aba66986baad5475a202c20a92bda036e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba66986baad5475a202c20a92bda036e">&#9670;&#160;</a></span>boundary_to_center_log() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> boundary_to_center_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr1</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr2</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using geometric mean (logarithmic interpolation) </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Arr1</td><td>Type of the input array </td></tr>
    <tr><td class="paramname">Arr2</td><td>Type of the output array </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
    <tr><td class="paramname">center</td><td>Output array of center values</td></tr>
  </table>
  </dd>
</dl>
<p>This is used when working with logarithmically scaled quantities. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00215">215</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  215</span>                                                                {</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2 || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size() + 1 != <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size()) {</div>
<div class="line"><span class="lineno">  217</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  218</span>    }</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  220</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = std::sqrt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">  221</span>    }</div>
<div class="line"><span class="lineno">  222</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aba66986baad5475a202c20a92bda036e_cgraph.png" border="0" usemap="#amesh_8h_aba66986baad5475a202c20a92bda036e_cgraph" alt=""/></div>
<map name="amesh_8h_aba66986baad5475a202c20a92bda036e_cgraph" id="amesh_8h_aba66986baad5475a202c20a92bda036e_cgraph">
<area shape="rect" title="Converts boundary values to center values using geometric mean (logarithmic interpolation)" alt="" coords="5,5,184,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="232,5,387,31"/>
<area shape="poly" title=" " alt="" coords="184,15,218,15,218,21,184,21"/>
</map>
</div>

</div>
</div>
<a id="ac536f77c32691232cb5e7546595fb3d2" name="ac536f77c32691232cb5e7546595fb3d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac536f77c32691232cb5e7546595fb3d2">&#9670;&#160;</a></span>boundary_to_center_log() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> boundary_to_center_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts boundary values to center values using geometric mean. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Input array of boundary values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of center values </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00049">49</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>                                                    {</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() &lt; 2) {</div>
<div class="line"><span class="lineno">   51</span>        <span class="keywordflow">return</span> Array::from_shape({0});</div>
<div class="line"><span class="lineno">   52</span>    }</div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>.size() - 1}, 0);</div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   55</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] = std::sqrt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundary</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> + 1]);</div>
<div class="line"><span class="lineno">   56</span>    }</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>;</div>
<div class="line"><span class="lineno">   58</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph.png" border="0" usemap="#amesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph" alt=""/></div>
<map name="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph" id="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_cgraph">
<area shape="rect" title="Converts boundary values to center values using geometric mean." alt="" coords="5,5,184,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="232,5,387,31"/>
<area shape="poly" title=" " alt="" coords="184,15,218,15,218,21,184,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph.png" border="0" usemap="#amesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph" alt=""/></div>
<map name="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph" id="amesh_8h_ac536f77c32691232cb5e7546595fb3d2_icgraph">
<area shape="rect" title="Converts boundary values to center values using geometric mean." alt="" coords="167,29,345,55"/>
<area shape="rect" href="classObserver.html#a2588a9ebaec5465d6b5bd08fadadcb99" title="Computes the integrated flux over a frequency band." alt="" coords="5,29,119,55"/>
<area shape="poly" title=" " alt="" coords="153,45,119,45,119,39,153,39"/>
<area shape="poly" title=" " alt="" coords="96,19,86,11,62,8,42,10,31,15,29,20,35,28,30,31,24,21,27,11,40,5,62,3,88,6,99,15"/>
</map>
</div>

</div>
</div>
<a id="a9cba2da30fd9821858dc89b5caea3443" name="a9cba2da30fd9821858dc89b5caea3443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cba2da30fd9821858dc89b5caea3443">&#9670;&#160;</a></span>edge_refinement_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> edge_refinement_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>avg_spacing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_resol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00550">550</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  551</span>                                                    {</div>
<div class="line"><span class="lineno">  552</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>;</div>
<div class="line"><span class="lineno">  553</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.reserve(150);</div>
<div class="line"><span class="lineno">  554</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> : <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet_edges</a>) {</div>
<div class="line"><span class="lineno">  555</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> &gt;= <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> / 2 - 0.01)</div>
<div class="line"><span class="lineno">  556</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  557</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">half</a> = 3 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">avg_spacing</a>;</div>
<div class="line"><span class="lineno">  558</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(10 * theta_resol), 2);</div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt;= n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  560</span>            <span class="comment">// Log-spaced offsets: denser near the edge</span></div>
<div class="line"><span class="lineno">  561</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">frac</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno">  562</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">offset</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">half</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">frac</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">frac</a>;</div>
<div class="line"><span class="lineno">  563</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">below</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">offset</a>;</div>
<div class="line"><span class="lineno">  564</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">above</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">offset</a>;</div>
<div class="line"><span class="lineno">  565</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">below</a> &gt;= theta_min)</div>
<div class="line"><span class="lineno">  566</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">below</a>);</div>
<div class="line"><span class="lineno">  567</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">above</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>)</div>
<div class="line"><span class="lineno">  568</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">above</a>);</div>
<div class="line"><span class="lineno">  569</span>        }</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> &gt;= theta_min &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>)</div>
<div class="line"><span class="lineno">  571</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edge</a>);</div>
<div class="line"><span class="lineno">  572</span>    }</div>
<div class="line"><span class="lineno">  573</span>    std::ranges::sort(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>);</div>
<div class="line"><span class="lineno">  574</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.erase(std::ranges::unique(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>).<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">begin</a>(), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.end());</div>
<div class="line"><span class="lineno">  575</span>    <span class="keywordflow">return</span> xt::adapt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>, {<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">points</a>.size()});</div>
<div class="line"><span class="lineno">  576</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph.png" border="0" usemap="#amesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph" alt=""/></div>
<map name="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph" id="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,169,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="217,5,372,31"/>
<area shape="poly" title=" " alt="" coords="170,15,203,15,203,21,170,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph.png" border="0" usemap="#amesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph" alt=""/></div>
<map name="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph" id="amesh_8h_a9cba2da30fd9821858dc89b5caea3443_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,939,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="aa7505ad2e84c2a29610c1a13cd3b25e3" name="aa7505ad2e84c2a29610c1a13cd3b25e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7505ad2e84c2a29610c1a13cd3b25e3">&#9670;&#160;</a></span>estimate_t_dec()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> estimate_t_dec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimates deceleration time for a given angle from ejecta and medium properties. </p>
<p>Integrates swept mass outward until m_swept = m_jet/Gamma0(phi,theta). Returns lab-frame time. </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00645">645</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  645</span>                                                                                   {</div>
<div class="line"><span class="lineno">  646</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, theta);</div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a> &lt;= 1) {</div>
<div class="line"><span class="lineno">  648</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecon.html#ad61313f4a5b7876e54ae46d02d4a04bd">con::inf</a>;</div>
<div class="line"><span class="lineno">  649</span>    }</div>
<div class="line"><span class="lineno">  650</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> = <a class="code hl_function" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090">physics::relativistic::gamma_to_beta</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a>);</div>
<div class="line"><span class="lineno">  651</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> m_jet = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.eps_k(phi, theta) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a> * <a class="code hl_variable" href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a>);</div>
<div class="line"><span class="lineno">  652</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">target</a> = m_jet / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">gamma</a>;</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">N</a> = 256;</div>
<div class="line"><span class="lineno">  655</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a> = std::log(1e-3);</div>
<div class="line"><span class="lineno">  656</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_max</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a> + 40 * std::log(10.0);</div>
<div class="line"><span class="lineno">  657</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">du</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">N</a>;</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> mass = 0;</div>
<div class="line"><span class="lineno">  660</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> = std::exp(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a>);</div>
<div class="line"><span class="lineno">  661</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> = medium.rho(phi, theta, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a>;</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">N</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  664</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a> = std::exp(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_min</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">du</a>);</div>
<div class="line"><span class="lineno">  665</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a> = medium.rho(phi, theta, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a>;</div>
<div class="line"><span class="lineno">  666</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dr</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a>;</div>
<div class="line"><span class="lineno">  667</span>        mass += 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dr</a>;</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">if</span> (mass &gt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">target</a>) {</div>
<div class="line"><span class="lineno">  670</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_dec</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">target</a> - (mass - 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dr</a>)) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>;</div>
<div class="line"><span class="lineno">  671</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_dec</a> * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a>);</div>
<div class="line"><span class="lineno">  672</span>        }</div>
<div class="line"><span class="lineno">  673</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_prev</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">f_i</a>;</div>
<div class="line"><span class="lineno">  674</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_prev</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">r_i</a>;</div>
<div class="line"><span class="lineno">  675</span>    }</div>
<div class="line"><span class="lineno">  676</span>    <span class="keywordflow">return</span> std::exp(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">u_max</a>) * (1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">beta</a> * <a class="code hl_variable" href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a>);</div>
<div class="line"><span class="lineno">  677</span>}</div>
<div class="ttc" id="anamespacecon_html_a26ef2b83dd09c356e324bd243b498764"><div class="ttname"><a href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a></div><div class="ttdeci">constexpr Real c2</div><div class="ttdoc">Speed of light squared.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00088">macros.h:88</a></div></div>
<div class="ttc" id="anamespacecon_html_a2ff3edf57629ccb9a49d5bde7278a7c4"><div class="ttname"><a href="namespacecon.html#a2ff3edf57629ccb9a49d5bde7278a7c4">con::c</a></div><div class="ttdeci">constexpr Real c</div><div class="ttdoc">Speed of light (normalized to 1 in code units)</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00087">macros.h:87</a></div></div>
<div class="ttc" id="anamespacecon_html_ad61313f4a5b7876e54ae46d02d4a04bd"><div class="ttname"><a href="namespacecon.html#ad61313f4a5b7876e54ae46d02d4a04bd">con::inf</a></div><div class="ttdeci">constexpr Real inf</div><div class="ttdoc">Infinity value.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00104">macros.h:104</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph.png" border="0" usemap="#amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph" alt=""/></div>
<map name="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph" id="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_cgraph">
<area shape="rect" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="5,42,128,67"/>
<area shape="rect" href="namespacephysics_1_1relativistic.html#aed1c46f33c9d25ffa27131014b190090" title="Converts Lorentz factor (gamma) to a velocity fraction (beta)" alt="" coords="176,5,324,45"/>
<area shape="poly" title=" " alt="" coords="128,42,162,37,163,42,129,48"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="372,42,527,67"/>
<area shape="poly" title=" " alt="" coords="129,54,176,55,324,55,358,54,358,59,324,60,176,60,128,59"/>
<area shape="poly" title=" " alt="" coords="324,34,359,39,358,44,324,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph.png" border="0" usemap="#amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph" alt=""/></div>
<map name="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph" id="amesh_8h_aa7505ad2e84c2a29610c1a13cd3b25e3_icgraph">
<area shape="rect" title="Estimates deceleration time for a given angle from ejecta and medium properties." alt="" coords="775,31,897,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a28ba8f4400237a97c0d2fac934fb44cf" name="a28ba8f4400237a97c0d2fac934fb44cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ba8f4400237a97c0d2fac934fb44cf">&#9670;&#160;</a></span>find_jet_edges()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::vector</a>&lt; <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> &gt; find_jet_edges </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a>&#160;</td>
          <td class="paramname"><em>is_axisymmetric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">gamma_cut</td><td>Lorentz factor cutoff value </td></tr>
    <tr><td class="paramname">is_axisymmetric</td><td>Flag for axisymmetric jets </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Sorted vector of edge theta positions; last element is the outermost jet edge </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00411">411</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  411</span>                                                                                                         {</div>
<div class="line"><span class="lineno">  412</span>    <span class="comment">// Find all edges in the active jet region (Gamma0 &gt;= gamma_cut).</span></div>
<div class="line"><span class="lineno">  413</span>    <span class="comment">// Sharp edges: large fractional jumps (&gt; 50%) between adjacent scan points.</span></div>
<div class="line"><span class="lineno">  414</span>    <span class="comment">// Smooth jets: the outermost theta where Gamma0 crosses gamma_cut.</span></div>
<div class="line"><span class="lineno">  415</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a> = 512;</div>
<div class="line"><span class="lineno">  416</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eps</a> = <a class="code hl_variable" href="namespacedefaults_1_1solver.html#a29443c4987378f49066f9b406c391afc">defaults::solver::binary_search_eps</a>;</div>
<div class="line"><span class="lineno">  417</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a> = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">defaults::grid::theta_min</a>;</div>
<div class="line"><span class="lineno">  418</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> = <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> / 2;</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a>) &gt;= gamma_cut) {</div>
<div class="line"><span class="lineno">  421</span>        <span class="keywordflow">return</span> {<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a>};</div>
<div class="line"><span class="lineno">  422</span>    }</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>;</div>
<div class="line"><span class="lineno">  425</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.reserve(100);</div>
<div class="line"><span class="lineno">  426</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>;</div>
<div class="line"><span class="lineno">  427</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>);</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  430</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a> + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>) * <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a> - 1);</div>
<div class="line"><span class="lineno">  431</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a>);</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> &gt;= gamma_cut || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> &gt;= gamma_cut) {</div>
<div class="line"><span class="lineno">  434</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a> = std::abs(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a>);</div>
<div class="line"><span class="lineno">  435</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">scale</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> - 1, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a> - 1);</div>
<div class="line"><span class="lineno">  436</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">scale</a> &gt; 0 &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a> &gt; 0.5 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">scale</a>) {</div>
<div class="line"><span class="lineno">  437</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_th</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a>;</div>
<div class="line"><span class="lineno">  438</span>                <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">eps</a>) {</div>
<div class="line"><span class="lineno">  439</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a> = 0.5 * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a>);</div>
<div class="line"><span class="lineno">  440</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">G_mid</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a>);</div>
<div class="line"><span class="lineno">  441</span>                    <span class="keywordflow">if</span> (std::abs(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">G_mid</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a>) &lt; std::abs(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">G_mid</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a>)) {</div>
<div class="line"><span class="lineno">  442</span>                        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a>;</div>
<div class="line"><span class="lineno">  443</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  444</span>                        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">hi</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">mid</a>;</div>
<div class="line"><span class="lineno">  445</span>                    }</div>
<div class="line"><span class="lineno">  446</span>                }</div>
<div class="line"><span class="lineno">  447</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lo</a>);</div>
<div class="line"><span class="lineno">  448</span>            }</div>
<div class="line"><span class="lineno">  449</span>        }</div>
<div class="line"><span class="lineno">  450</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_th</a>;</div>
<div class="line"><span class="lineno">  451</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">prev_G</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cur_G</a>;</div>
<div class="line"><span class="lineno">  452</span>    }</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    <span class="comment">// Smooth jet: no sharp edges found  scan downward from pi/2 to find outermost Gamma0 &gt;= gamma_cut</span></div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.empty()) {</div>
<div class="line"><span class="lineno">  456</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n_scan</a>;</div>
<div class="line"><span class="lineno">  457</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_hi</a>; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a> &gt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_lo</a>; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a> -= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>) {</div>
<div class="line"><span class="lineno">  458</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a>) &gt;= <a class="code hl_variable" href="namespacedefaults_1_1cutoffs.html#a6cda2def28c77f63dbee9eb169d9d87a">gamma_cut</a>) {</div>
<div class="line"><span class="lineno">  459</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th</a>);</div>
<div class="line"><span class="lineno">  460</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  461</span>            }</div>
<div class="line"><span class="lineno">  462</span>        }</div>
<div class="line"><span class="lineno">  463</span>    }</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">edges</a>;</div>
<div class="line"><span class="lineno">  466</span>}</div>
<div class="ttc" id="anamespacedefaults_1_1cutoffs_html_a6cda2def28c77f63dbee9eb169d9d87a"><div class="ttname"><a href="namespacedefaults_1_1cutoffs.html#a6cda2def28c77f63dbee9eb169d9d87a">defaults::cutoffs::gamma_cut</a></div><div class="ttdeci">constexpr double gamma_cut</div><div class="ttdoc">Lorentz factor below which the flow is considered non-relativistic Used to terminate shock evolution ...</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00041">simulation-defaults.h:41</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1solver_html_a29443c4987378f49066f9b406c391afc"><div class="ttname"><a href="namespacedefaults_1_1solver.html#a29443c4987378f49066f9b406c391afc">defaults::solver::binary_search_eps</a></div><div class="ttdeci">constexpr double binary_search_eps</div><div class="ttdoc">Tolerance for binary search (jet edge finding)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00098">simulation-defaults.h:98</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph.png" border="0" usemap="#amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph" alt=""/></div>
<map name="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph" id="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_cgraph">
<area shape="rect" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="5,5,121,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="169,5,324,31"/>
<area shape="poly" title=" " alt="" coords="121,15,155,15,155,21,121,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph.png" border="0" usemap="#amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph" alt=""/></div>
<map name="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph" id="amesh_8h_a28ba8f4400237a97c0d2fac934fb44cf_icgraph">
<area shape="rect" title="Finds all sharp edges in the jet Gamma0 profile plus the outermost boundary." alt="" coords="775,31,891,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="a49c59d8da915e118c4e550cc9bd4d3d9" name="a49c59d8da915e118c4e550cc9bd4d3d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49c59d8da915e118c4e550cc9bd4d3d9">&#9670;&#160;</a></span>inverse_CFD_sampling()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> inverse_CFD_sampling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Func</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00499">499</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  499</span>                                                                       {</div>
<div class="line"><span class="lineno">  500</span>    <span class="keyword">using namespace </span>boost::numeric::odeint;</div>
<div class="line"><span class="lineno">  501</span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> rtol = <a class="code hl_variable" href="namespacedefaults_1_1solver.html#a3469dc43cf2d60069d164931e7656d12">defaults::solver::ode_rtol</a>;</div>
<div class="line"><span class="lineno">  502</span>    <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a> = <a class="code hl_variable" href="namespacedefaults_1_1sampling.html#afb3d6cb58a2dc84e4f0a2ed64d7e1609">defaults::sampling::theta_samples</a>;</div>
<div class="line"><span class="lineno">  503</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a> = xt::linspace(<a class="code hl_function" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a>, <a class="code hl_function" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>);</div>
<div class="line"><span class="lineno">  504</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>});</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>    <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">make_dense_output</a>(rtol, rtol, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">runge_kutta_dopri5&lt;Real&gt;</a>());</div>
<div class="line"><span class="lineno">  507</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.initialize(0, <a class="code hl_function" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a>, (<a class="code hl_function" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a> - <a class="code hl_function" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a>) / 1e3);</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.current_time() &lt;= <a class="code hl_function" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a>;) {</div>
<div class="line"><span class="lineno">  510</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.do_step(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">pdf</a>);</div>
<div class="line"><span class="lineno">  511</span>        <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>.size() &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.current_time() &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)) {</div>
<div class="line"><span class="lineno">  512</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">stepper</a>.calc_state(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>));</div>
<div class="line"><span class="lineno">  513</span>            ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>;</div>
<div class="line"><span class="lineno">  514</span>        }</div>
<div class="line"><span class="lineno">  515</span>    }</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_out</a> = xt::linspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>.front(), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>.back(), <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>);</div>
<div class="line"><span class="lineno">  518</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>});</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">num</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) {</div>
<div class="line"><span class="lineno">  521</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">sample_num</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">  522</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>)) {</div>
<div class="line"><span class="lineno">  523</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> == 0) {</div>
<div class="line"><span class="lineno">  524</span>                    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>);</div>
<div class="line"><span class="lineno">  525</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  526</span>                    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> slope = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1)) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1));</div>
<div class="line"><span class="lineno">  527</span>                    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1) + slope * (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_out</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">CDF_i</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1));</div>
<div class="line"><span class="lineno">  528</span>                }</div>
<div class="line"><span class="lineno">  529</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  530</span>            }</div>
<div class="line"><span class="lineno">  531</span>        }</div>
<div class="line"><span class="lineno">  532</span>    }</div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">x_out</a>;</div>
<div class="line"><span class="lineno">  534</span>}</div>
<div class="ttc" id="anamespacedefaults_1_1sampling_html_afb3d6cb58a2dc84e4f0a2ed64d7e1609"><div class="ttname"><a href="namespacedefaults_1_1sampling.html#afb3d6cb58a2dc84e4f0a2ed64d7e1609">defaults::sampling::theta_samples</a></div><div class="ttdeci">constexpr std::size_t theta_samples</div><div class="ttdoc">Number of sample points for theta integration.</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00122">simulation-defaults.h:122</a></div></div>
<div class="ttc" id="anamespacedefaults_1_1solver_html_a3469dc43cf2d60069d164931e7656d12"><div class="ttname"><a href="namespacedefaults_1_1solver.html#a3469dc43cf2d60069d164931e7656d12">defaults::solver::ode_rtol</a></div><div class="ttdeci">constexpr double ode_rtol</div><div class="ttdoc">Relative tolerance for ODE integration (Runge-Kutta)</div><div class="ttdef"><b>Definition</b> <a href="simulation-defaults_8h_source.html#l00092">simulation-defaults.h:92</a></div></div>
<div class="ttc" id="autilities_8h_html_a87dde689be8887c64263f13adace7ae1"><div class="ttname"><a href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1">min</a></div><div class="ttdeci">constexpr T min(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00232">utilities.h:232</a></div></div>
<div class="ttc" id="autilities_8h_html_ab0cbe75cc4de84810290ad6f3075e491"><div class="ttname"><a href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491">max</a></div><div class="ttdeci">constexpr T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00260">utilities.h:260</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph.png" border="0" usemap="#amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph" alt=""/></div>
<map name="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph" id="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_cgraph">
<area shape="rect" title=" " alt="" coords="5,19,176,45"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="323,19,477,45"/>
<area shape="poly" title=" " alt="" coords="138,17,203,6,239,3,275,4,335,14,334,19,274,9,239,8,203,11,139,22"/>
<area shape="rect" href="utilities_8h.html#ab0cbe75cc4de84810290ad6f3075e491" title="Returns the value of a single parameter." alt="" coords="224,19,275,45"/>
<area shape="poly" title=" " alt="" coords="176,29,210,29,210,35,176,35"/>
<area shape="rect" href="utilities_8h.html#a87dde689be8887c64263f13adace7ae1" title="Returns the value of a single parameter." alt="" coords="226,69,273,94"/>
<area shape="poly" title=" " alt="" coords="133,42,214,68,212,73,131,47"/>
<area shape="poly" title=" " alt="" coords="275,29,309,29,309,35,275,35"/>
<area shape="poly" title=" " alt="" coords="272,71,347,47,348,52,274,77"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph.png" border="0" usemap="#amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph" alt=""/></div>
<map name="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph" id="amesh_8h_a49c59d8da915e118c4e550cc9bd4d3d9_icgraph">
<area shape="rect" title=" " alt="" coords="975,31,1145,56"/>
<area shape="rect" href="mesh_8h.html#a83ae490737edde6ad03ede25e371a071" title=" " alt="" coords="781,5,920,31"/>
<area shape="poly" title=" " alt="" coords="961,34,920,29,920,24,962,29"/>
<area shape="rect" href="mesh_8h.html#a3dc6828dd13a70c0c203dba03e765cea" title=" " alt="" coords="775,55,927,80"/>
<area shape="poly" title=" " alt="" coords="961,57,927,61,926,56,961,52"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="768,33,727,40,727,34,767,28"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
<area shape="poly" title=" " alt="" coords="761,57,726,52,727,47,762,52"/>
</map>
</div>

</div>
</div>
<a id="aa5d127d3ecb19584c7f27ee212d49605" name="aa5d127d3ecb19584c7f27ee212d49605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d127d3ecb19584c7f27ee212d49605">&#9670;&#160;</a></span>is_linear_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> is_linear_scale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code><a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if an array is linearly scaled within a given tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arr</td><td>The array to check </td></tr>
    <tr><td class="paramname">tolerance</td><td>Maximum allowed deviation from linearity (default: 1e-6) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the array is linearly scaled, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00012">12</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   12</span>                                                       {</div>
<div class="line"><span class="lineno">   13</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size() &lt; 2)</div>
<div class="line"><span class="lineno">   14</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// At least two elements are needed.</span></div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">diff</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[1] - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[0];</div>
<div class="line"><span class="lineno">   17</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 2; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   18</span>        <span class="keywordflow">if</span> (std::fabs((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> - 1] - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">diff</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">diff</a>) &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>) {</div>
<div class="line"><span class="lineno">   19</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   20</span>        }</div>
<div class="line"><span class="lineno">   21</span>    }</div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   23</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph.png" border="0" usemap="#amesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph" alt=""/></div>
<map name="amesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph" id="amesh_8h_aa5d127d3ecb19584c7f27ee212d49605_cgraph">
<area shape="rect" title="Checks if an array is linearly scaled within a given tolerance." alt="" coords="5,5,124,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="172,5,327,31"/>
<area shape="poly" title=" " alt="" coords="124,15,158,15,158,21,124,21"/>
</map>
</div>

</div>
</div>
<a id="ac0e56adbbf18a0c9a5c04a8d4de268d9" name="ac0e56adbbf18a0c9a5c04a8d4de268d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e56adbbf18a0c9a5c04a8d4de268d9">&#9670;&#160;</a></span>is_log_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bool</a> is_log_scale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code><a class="el" href="namespacedefaults_1_1solver.html#a401c502a93d34d6eddb6d31ec991ae44">defaults::solver::scale_check_tol</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if an array is logarithmically scaled within a given tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arr</td><td>The array to check </td></tr>
    <tr><td class="paramname">tolerance</td><td>Maximum allowed deviation from logarithmic scaling (default: 1e-6) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the array is logarithmically scaled, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8cpp_source.html#l00025">25</a> of file <a class="el" href="mesh_8cpp_source.html">mesh.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   25</span>                                                    {</div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size() &lt; 2)</div>
<div class="line"><span class="lineno">   27</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// At least two elements are needed.</span></div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> ratio = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[1] / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[0];</div>
<div class="line"><span class="lineno">   30</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 2; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>.size(); ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">   31</span>        <span class="keywordflow">if</span> (std::fabs((<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> - 1] - ratio) / ratio) &gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">tolerance</a>) {</div>
<div class="line"><span class="lineno">   32</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   33</span>        }</div>
<div class="line"><span class="lineno">   34</span>    }</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   36</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph.png" border="0" usemap="#amesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph" alt=""/></div>
<map name="amesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph" id="amesh_8h_ac0e56adbbf18a0c9a5c04a8d4de268d9_cgraph">
<area shape="rect" title="Checks if an array is logarithmically scaled within a given tolerance." alt="" coords="5,5,107,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="155,5,309,31"/>
<area shape="poly" title=" " alt="" coords="107,15,141,15,141,21,107,21"/>
</map>
</div>

</div>
</div>
<a id="a7cb4a7162e9b5a1e2ed39f7d9e94b53f" name="a7cb4a7162e9b5a1e2ed39f7d9e94b53f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb4a7162e9b5a1e2ed39f7d9e94b53f">&#9670;&#160;</a></span>jet_spreading_edge()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classEjecta.html">Ejecta</a> , <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="classMedium.html">Medium</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> jet_spreading_edge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEjecta.html">Ejecta</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>jet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMedium.html">Medium</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>medium</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>theta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the edge of the jet where the spreading is strongest. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classEjecta.html" title="Represents generic ejecta properties for a simulation.">Ejecta</a></td><td>Type of the jet/ejecta class </td></tr>
    <tr><td class="paramname"><a class="el" href="classMedium.html" title="Represents the generic medium or any user-defined surrounding medium that the GRB jet interacts with.">Medium</a></td><td>Type of the ambient medium </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jet</td><td>The jet/ejecta object </td></tr>
    <tr><td class="paramname">medium</td><td>The ambient medium object </td></tr>
    <tr><td class="paramname">phi</td><td>Azimuthal angle </td></tr>
    <tr><td class="paramname">theta_min</td><td>Minimum polar angle to consider </td></tr>
    <tr><td class="paramname">theta_max</td><td>Maximum polar angle to consider </td></tr>
    <tr><td class="paramname">t0</td><td>Initial time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Angle (in radians) where the spreading is strongest</dd></dl>
<p>The spreading strength is measured by the derivative of the pressure with respect to theta, which is proportional to d((Gamma-1)Gamma rho)/dtheta </p>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00469">469</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  470</span>                                {</div>
<div class="line"><span class="lineno">  471</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a> - <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>) / 256;</div>
<div class="line"><span class="lineno">  472</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta_s = <a class="code hl_variable" href="namespacedefaults_1_1grid.html#af2b7c5de15cb9c537f0de0e0e56148b1">theta_min</a>;</div>
<div class="line"><span class="lineno">  473</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a> = 0;</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> theta = theta_min; theta &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>; theta += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>) {</div>
<div class="line"><span class="lineno">  476</span>        <span class="comment">// Real G = jet.Gamma0(phi, theta);</span></div>
<div class="line"><span class="lineno">  477</span>        <span class="comment">// Real beta0 = physics::relativistic::gamma_to_beta(G);</span></div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">// Real r0 = beta0 * con::c * t0 / (1 - beta0);</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="comment">// Real rho = medium.rho(phi, theta, 0);</span></div>
<div class="line"><span class="lineno">  480</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_lo</a> = std::max(theta - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>, theta_min);</div>
<div class="line"><span class="lineno">  481</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_hi</a> = std::min(theta + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">step</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>);</div>
<div class="line"><span class="lineno">  482</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_hi</a>) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">jet</a>.Gamma0(phi, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_lo</a>)) / (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_hi</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">th_lo</a>);</div>
<div class="line"><span class="lineno">  483</span>        <span class="comment">// Real drho = (medium.rho(phi, th_hi, r0) - medium.rho(phi, th_lo, r0)) / (th_hi - th_lo);</span></div>
<div class="line"><span class="lineno">  484</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dG</a>; <span class="comment">//(2 * G - 1) * rho * dG + (G - 1) * G * drho;</span></div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a>) {</div>
<div class="line"><span class="lineno">  487</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp</a>;</div>
<div class="line"><span class="lineno">  488</span>            theta_s = theta;</div>
<div class="line"><span class="lineno">  489</span>        }</div>
<div class="line"><span class="lineno">  490</span>    }</div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dp_min</a> == 0) {</div>
<div class="line"><span class="lineno">  492</span>        theta_s = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">theta_max</a>;</div>
<div class="line"><span class="lineno">  493</span>    }</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordflow">return</span> theta_s;</div>
<div class="line"><span class="lineno">  496</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph.png" border="0" usemap="#amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph" alt=""/></div>
<map name="amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph" id="amesh_8h_a7cb4a7162e9b5a1e2ed39f7d9e94b53f_cgraph">
<area shape="rect" title="Determines the edge of the jet where the spreading is strongest." alt="" coords="5,5,155,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="203,5,357,31"/>
<area shape="poly" title=" " alt="" coords="155,15,189,15,189,21,155,21"/>
</map>
</div>

</div>
</div>
<a id="a76f104cdad403ea346ff1a6603c78ad6" name="a76f104cdad403ea346ff1a6603c78ad6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76f104cdad403ea346ff1a6603c78ad6">&#9670;&#160;</a></span>log2space()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> log2space </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>grid_per_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00242">242</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  242</span>                                                                            {</div>
<div class="line"><span class="lineno">  243</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">decades</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>) / <a class="code hl_variable" href="mesh_8h.html#aba685e866cceb5c13d7e357fcaa69529">log2_10</a>;</div>
<div class="line"><span class="lineno">  244</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = std::max&lt;size_t&gt;(2, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::ceil(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">decades</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">grid_per_order</a>)));</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">array</a> = xt::logspace&lt;Real&gt;(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a>, n + 1, 2.0);</div>
<div class="line"><span class="lineno">  247</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph.png" border="0" usemap="#amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph" alt=""/></div>
<map name="amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph" id="amesh_8h_a76f104cdad403ea346ff1a6603c78ad6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,93,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="141,5,296,31"/>
<area shape="poly" title=" " alt="" coords="94,15,128,15,128,21,94,21"/>
</map>
</div>

</div>
</div>
<a id="ad7703ab8b66bb86ed857746606fac9a2" name="ad7703ab8b66bb86ed857746606fac9a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7703ab8b66bb86ed857746606fac9a2">&#9670;&#160;</a></span>logspace_boundary_center()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> logspace_boundary_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>bin_width</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00250">250</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  250</span>                                                                                                      {</div>
<div class="line"><span class="lineno">  251</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a> = Arr::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>});</div>
<div class="line"><span class="lineno">  252</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bin_width</a> = Array::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>});</div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a> == 0)</div>
<div class="line"><span class="lineno">  254</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>);</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> r = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a>);</div>
<div class="line"><span class="lineno">  259</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a> = std::sqrt(r);</div>
<div class="line"><span class="lineno">  260</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a> = r - 1.;</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>);</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">for</span> (std::size_t <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  265</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a>;</div>
<div class="line"><span class="lineno">  266</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">bin_width</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">w</a>;</div>
<div class="line"><span class="lineno">  267</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> *= r;</div>
<div class="line"><span class="lineno">  268</span>    }</div>
<div class="line"><span class="lineno">  269</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph.png" border="0" usemap="#amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph" alt=""/></div>
<map name="amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph" id="amesh_8h_ad7703ab8b66bb86ed857746606fac9a2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,201,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="249,5,404,31"/>
<area shape="poly" title=" " alt="" coords="201,15,236,15,236,21,201,21"/>
</map>
</div>

</div>
</div>
<a id="afadc5019976c36be16277dc4dc178a7f" name="afadc5019976c36be16277dc4dc178a7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afadc5019976c36be16277dc4dc178a7f">&#9670;&#160;</a></span>logspace_center()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a>  = Array&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> logspace_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>lg2_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &amp;&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00225">225</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  225</span>                                                                           {</div>
<div class="line"><span class="lineno">  226</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a> = Arr::from_shape({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>});</div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a> == 0)</div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_max</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>) / <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>);</div>
<div class="line"><span class="lineno">  231</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> r = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dlg2</a>);</div>
<div class="line"><span class="lineno">  232</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a> = std::sqrt(r);</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> = std::exp2(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">lg2_min</a>);</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">for</span> (std::size_t <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  236</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">center</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">s</a>;</div>
<div class="line"><span class="lineno">  237</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">left</a> *= r;</div>
<div class="line"><span class="lineno">  238</span>    }</div>
<div class="line"><span class="lineno">  239</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph.png" border="0" usemap="#amesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph" alt=""/></div>
<map name="amesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph" id="amesh_8h_afadc5019976c36be16277dc4dc178a7f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,133,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="181,5,336,31"/>
<area shape="poly" title=" " alt="" coords="133,15,167,15,167,21,133,21"/>
</map>
</div>

</div>
</div>
<a id="a3c066f2c8e6d102d7a56de8cb42cf5a8" name="a3c066f2c8e6d102d7a56de8cb42cf5a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c066f2c8e6d102d7a56de8cb42cf5a8">&#9670;&#160;</a></span>merge_grids()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">typename</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> merge_grids </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">Arr</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>arr2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00611">611</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  611</span>                                                    {</div>
<div class="line"><span class="lineno">  612</span>    std::vector&lt;Real&gt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>;</div>
<div class="line"><span class="lineno">  613</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.reserve(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>.size() + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>.size());</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0;</div>
<div class="line"><span class="lineno">  616</span>    <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a> = [&amp;](<a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">val</a>) {</div>
<div class="line"><span class="lineno">  617</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.empty() || <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.back() != <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">val</a>)</div>
<div class="line"><span class="lineno">  618</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>.push_back(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">val</a>);</div>
<div class="line"><span class="lineno">  619</span>    };</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>.size() &amp;&amp; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>.size()) {</div>
<div class="line"><span class="lineno">  622</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>] &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>]) {</div>
<div class="line"><span class="lineno">  623</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>++]);</div>
<div class="line"><span class="lineno">  624</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> - 1] == <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>])</div>
<div class="line"><span class="lineno">  625</span>                <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>++;</div>
<div class="line"><span class="lineno">  626</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  627</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>++]);</div>
<div class="line"><span class="lineno">  628</span>        }</div>
<div class="line"><span class="lineno">  629</span>    }</div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>.size())</div>
<div class="line"><span class="lineno">  631</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr1</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>++]);</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>.size())</div>
<div class="line"><span class="lineno">  633</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">add_unique</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">arr2</a>[<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>++]);</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">return</span> xt::adapt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>);</div>
<div class="line"><span class="lineno">  636</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph.png" border="0" usemap="#amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph" alt=""/></div>
<map name="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph" id="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,108,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="156,5,311,31"/>
<area shape="poly" title=" " alt="" coords="108,15,142,15,142,21,108,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph.png" border="0" usemap="#amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph" alt=""/></div>
<map name="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph" id="amesh_8h_a3c066f2c8e6d102d7a56de8cb42cf5a8_icgraph">
<area shape="rect" title=" " alt="" coords="775,31,877,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<a id="ab2b9eccaf75f7a9fe6bafd8696049bd2" name="ab2b9eccaf75f7a9fe6bafd8696049bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2b9eccaf75f7a9fe6bafd8696049bd2">&#9670;&#160;</a></span>refined_time_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> refined_time_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_refine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">size_t</a>&#160;</td>
          <td class="paramname"><em>t_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_resol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_lo_factor</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>refine_hi_factor</em> = <code>10.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a refined logarithmic time grid with higher density around a specified time. </p>
<p>Constructs a three-segment logspace grid:</p><ul>
<li>Segment 1: [t_start, t_lo] with base resolution</li>
<li>Segment 2: [t_lo, t_hi] with higher resolution (around t_refine)</li>
<li>Segment 3: [t_hi, t_end] with base resolution</li>
</ul>
<p>Falls back to simple logspace if refinement is not applicable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_start</td><td>Start time of the grid </td></tr>
    <tr><td class="paramname">t_end</td><td>End time of the grid </td></tr>
    <tr><td class="paramname">t_refine</td><td>Time around which to refine (e.g., deceleration time) </td></tr>
    <tr><td class="paramname">t_num</td><td>Total number of grid points </td></tr>
    <tr><td class="paramname">t_resol</td><td>Resolution parameter (points per decade) </td></tr>
    <tr><td class="paramname">refine_lo_factor</td><td>Lower bound factor for refinement region (t_lo = refine_lo_factor * t_refine) </td></tr>
    <tr><td class="paramname">refine_hi_factor</td><td>Upper bound factor for refinement region (t_hi = refine_hi_factor * t_refine) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of time grid points </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00700">700</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  701</span>                                                                                          {</div>
<div class="line"><span class="lineno">  702</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a> = xt::zeros&lt;Real&gt;({<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>});</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>);</div>
<div class="line"><span class="lineno">  705</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>);</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine &lt;= t_start || t_refine &gt;</a>= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>) {</div>
<div class="line"><span class="lineno">  708</span>        <span class="keywordflow">return</span> xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>);</div>
<div class="line"><span class="lineno">  709</span>    }</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_lo</a> = std::max(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_lo_factor</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_start</a>);</div>
<div class="line"><span class="lineno">  712</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_hi</a> = std::min(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">refine_hi_factor</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_refine</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_end</a>);</div>
<div class="line"><span class="lineno">  713</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_lo</a>);</div>
<div class="line"><span class="lineno">  714</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a> = std::log10(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_hi</a>);</div>
<div class="line"><span class="lineno">  715</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>;</div>
<div class="line"><span class="lineno">  716</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a>;</div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a> &gt; 0) ? std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(t_resol * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_before</a>), 2) : 0;</div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a> &gt; 0) ? std::max&lt;size_t&gt;(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(t_resol * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_after</a>), 2) : 0;</div>
<div class="line"><span class="lineno">  720</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shared</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> &gt; 0 ? 1 : 0) + (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> &gt; 0 ? 1 : 0);</div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2_raw</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> + 2 &lt;= <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shared</a>) ? (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">shared</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a>) : 0;</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2_raw</a> &lt; 2) {</div>
<div class="line"><span class="lineno">  724</span>        <span class="keywordflow">return</span> xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">t_num</a>);</div>
<div class="line"><span class="lineno">  725</span>    }</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2_raw</a>;</div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a> = 0;</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>    <span class="comment">// Segment 1: [t_start, t_lo]</span></div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  732</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg1</a> = xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_s</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a>);</div>
<div class="line"><span class="lineno">  733</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)</div>
<div class="line"><span class="lineno">  734</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a>++) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg1</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>);</div>
<div class="line"><span class="lineno">  735</span>    }</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>    <span class="comment">// Segment 2: [t_lo, t_hi] - skip first point if it overlaps with seg1</span></div>
<div class="line"><span class="lineno">  738</span>    {</div>
<div class="line"><span class="lineno">  739</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg2</a> = xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_lo</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2</a>);</div>
<div class="line"><span class="lineno">  740</span>        <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k0</a> = (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n1</a> &gt; 0) ? 1 : 0;</div>
<div class="line"><span class="lineno">  741</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k0</a>; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n2</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)</div>
<div class="line"><span class="lineno">  742</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a>++) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg2</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>);</div>
<div class="line"><span class="lineno">  743</span>    }</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    <span class="comment">// Segment 3: [t_hi, t_end] - skip first point (overlaps with seg2)</span></div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  747</span>        <span class="keyword">auto</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg3</a> = xt::logspace(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_hi</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">log_e</a>, <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a>);</div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a> &lt; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">n3</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>)</div>
<div class="line"><span class="lineno">  749</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">idx</a>++) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">seg3</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">k</a>);</div>
<div class="line"><span class="lineno">  750</span>    }</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">result</a>;</div>
<div class="line"><span class="lineno">  753</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph.png" border="0" usemap="#amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph" alt=""/></div>
<map name="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph" id="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_cgraph">
<area shape="rect" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="5,5,141,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="189,5,344,31"/>
<area shape="poly" title=" " alt="" coords="141,15,176,15,176,21,141,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph.png" border="0" usemap="#amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph" alt=""/></div>
<map name="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph" id="amesh_8h_ab2b9eccaf75f7a9fe6bafd8696049bd2_icgraph">
<area shape="rect" title="Create a refined logarithmic time grid with higher density around a specified time." alt="" coords="775,31,911,56"/>
<area shape="rect" href="mesh_8h.html#a96aa0a78a0de13a52955de3c2ce29ddd" title="Constructs a coordinate grid (Coord) for shock evolution." alt="" coords="644,31,727,56"/>
<area shape="poly" title=" " alt="" coords="761,46,727,46,727,41,761,41"/>
<area shape="rect" href="shock__dispatch_8h.html#af0bfd363789cd64adc2bb8fa697f96ae" title="Solve forward shock dynamics with variant dispatch." alt="" coords="463,5,595,31"/>
<area shape="poly" title=" " alt="" coords="630,37,594,31,595,26,631,32"/>
<area shape="rect" href="shock__dispatch_8h.html#a943fd075e455647c377f134a2bd02f5d" title="Solve forward + reverse shock pair with variant dispatch." alt="" coords="461,55,596,80"/>
<area shape="poly" title=" " alt="" coords="631,54,597,60,596,54,630,49"/>
<area shape="rect" href="classPyModel.html#a3debe3d2ed8ff2a53bec469a6711cfa8" title=" " alt="" coords="204,5,413,31"/>
<area shape="poly" title=" " alt="" coords="448,21,413,21,413,15,448,15"/>
<area shape="rect" href="classPyModel.html#ac47bbdbe6025c4def5d4a65f3ed6be34" title="Get comprehensive details of the shock evolution and model configuration." alt="" coords="243,55,374,80"/>
<area shape="poly" title=" " alt="" coords="459,36,367,57,366,52,457,31"/>
<area shape="rect" href="pybind_8cpp.html#a8c92987849ad296e28ec6c07c8e7860b" title=" " alt="" coords="5,55,156,80"/>
<area shape="poly" title=" " alt="" coords="229,70,156,70,156,65,229,65"/>
<area shape="poly" title=" " alt="" coords="457,54,366,33,367,28,459,49"/>
<area shape="poly" title=" " alt="" coords="447,70,374,70,374,65,447,65"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aba685e866cceb5c13d7e357fcaa69529" name="aba685e866cceb5c13d7e357fcaa69529"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba685e866cceb5c13d7e357fcaa69529">&#9670;&#160;</a></span>log2_10</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">constexpr</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> log2_10 = <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::numbers::ln10</a> / <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">std::numbers::ln2</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh_8h_source.html#l00018">18</a> of file <a class="el" href="mesh_8h_source.html">mesh.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="mesh_8h.html">mesh.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
