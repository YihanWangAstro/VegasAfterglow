<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: inverse-compton.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('inverse-compton_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">inverse-compton.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="inverse-compton_8h_source.html">inverse-compton.h</a>&quot;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &quot;<a class="el" href="IO_8h_source.html">IO.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for inverse-compton.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp__incl.png" border="0" usemap="#ainverse-compton_8cpp" alt=""/></div>
<map name="ainverse-compton_8cpp" id="ainverse-compton_8cpp">
<area shape="rect" title=" " alt="" coords="749,5,907,31"/>
<area shape="rect" href="inverse-compton_8h.html" title=" " alt="" coords="388,79,532,104"/>
<area shape="poly" title=" " alt="" coords="769,33,533,79,532,73,768,28"/>
<area shape="rect" title=" " alt="" coords="1443,599,1506,625"/>
<area shape="poly" title=" " alt="" coords="908,21,1045,34,1123,45,1199,59,1269,77,1325,100,1347,114,1364,129,1375,145,1379,163,1379,459,1386,498,1404,533,1428,564,1452,588,1448,592,1424,568,1400,536,1381,500,1373,460,1373,164,1370,147,1360,132,1344,118,1323,105,1267,82,1198,64,1122,50,1045,39,907,26"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="39,599,121,625"/>
<area shape="poly" title=" " alt="" coords="748,25,456,43,306,60,244,70,198,81,146,94,101,104,83,112,69,124,60,140,57,164,57,459,64,528,76,585,71,586,59,529,52,459,52,163,55,139,65,121,80,108,99,99,145,89,197,76,243,65,305,54,455,38,748,20"/>
<area shape="rect" href="utilities_8h.html" title=" " alt="" coords="249,445,332,471"/>
<area shape="poly" title=" " alt="" coords="748,22,581,29,483,38,386,50,297,69,225,93,197,108,176,125,163,143,159,164,159,313,161,333,168,352,193,387,225,415,257,436,254,441,222,420,189,391,164,355,156,335,153,313,153,163,158,141,172,121,194,104,222,88,296,64,385,45,482,32,580,24,748,17"/>
<area shape="rect" title=" " alt="" coords="876,79,956,104"/>
<area shape="poly" title=" " alt="" coords="844,29,893,68,889,72,840,33"/>
<area shape="rect" title=" " alt="" coords="980,79,1044,104"/>
<area shape="poly" title=" " alt="" coords="859,28,970,71,968,76,857,33"/>
<area shape="rect" href="IO_8h.html" title=" " alt="" coords="804,79,852,104"/>
<area shape="poly" title=" " alt="" coords="831,31,831,65,825,65,825,31"/>
<area shape="rect" title=" " alt="" coords="497,152,553,177"/>
<area shape="poly" title=" " alt="" coords="473,103,507,140,504,144,469,106"/>
<area shape="poly" title=" " alt="" coords="512,102,723,149,812,165,882,175,950,189,1033,223,1106,253,1168,279,1193,295,1213,317,1225,346,1229,383,1229,459,1235,469,1252,484,1308,520,1440,591,1438,595,1306,525,1249,488,1231,472,1224,460,1224,383,1220,347,1208,320,1190,299,1166,283,1104,258,1031,228,949,195,881,180,811,171,722,155,511,107"/>
<area shape="rect" title=" " alt="" coords="397,299,451,324"/>
<area shape="poly" title=" " alt="" coords="460,105,439,226,430,285,425,284,433,225,455,104"/>
<area shape="rect" title=" " alt="" coords="447,225,510,251"/>
<area shape="poly" title=" " alt="" coords="464,104,478,211,473,212,459,105"/>
<area shape="poly" title=" " alt="" coords="388,106,301,129,254,146,209,168,169,195,137,227,116,265,110,287,108,310,108,459,101,529,89,586,84,585,96,528,103,459,103,310,105,286,111,263,133,224,166,190,206,163,252,141,299,124,387,101"/>
<area shape="rect" href="medium_8h.html" title=" " alt="" coords="420,372,508,397"/>
<area shape="poly" title=" " alt="" coords="452,106,425,143,395,198,384,229,377,261,378,293,388,323,405,346,428,363,425,367,401,349,383,325,373,294,372,261,378,228,390,196,420,141,448,103"/>
<area shape="poly" title=" " alt="" coords="389,106,337,124,313,137,291,154,274,173,265,191,261,211,260,237,260,313,262,345,268,377,284,432,279,433,263,379,257,346,255,313,255,237,256,210,260,189,270,170,287,150,310,132,335,119,387,101"/>
<area shape="rect" href="mesh_8h.html" title=" " alt="" coords="853,519,923,544"/>
<area shape="poly" title=" " alt="" coords="446,106,422,127,400,153,382,188,373,226,365,278,364,321,369,341,377,359,390,377,410,395,461,431,518,459,577,482,637,499,750,519,839,526,838,532,750,524,636,504,575,487,516,464,458,435,406,399,386,381,372,362,363,342,359,322,360,278,368,225,377,186,395,151,418,123,442,102"/>
<area shape="rect" href="shock_8h.html" title=" " alt="" coords="605,225,677,251"/>
<area shape="poly" title=" " alt="" coords="533,98,633,117,676,132,703,150,710,169,703,187,690,204,673,219,669,215,686,201,699,185,704,169,699,154,674,136,632,122,532,103"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="578,152,689,177"/>
<area shape="poly" title=" " alt="" coords="489,102,593,144,591,149,487,106"/>
<area shape="rect" title=" " alt="" coords="5,680,64,705"/>
<area shape="poly" title=" " alt="" coords="76,626,51,669,46,667,71,624"/>
<area shape="rect" title=" " alt="" coords="88,680,163,705"/>
<area shape="poly" title=" " alt="" coords="89,624,114,667,109,669,84,626"/>
<area shape="poly" title=" " alt="" coords="464,398,456,428,441,469,418,511,402,530,384,546,352,567,322,578,293,584,265,585,206,584,172,587,134,595,124,598,122,592,133,589,171,582,205,579,265,580,293,579,320,573,349,562,381,542,398,526,413,508,436,466,451,427,459,397"/>
<area shape="poly" title=" " alt="" coords="437,400,333,442,331,438,435,395"/>
<area shape="poly" title=" " alt="" coords="267,473,227,494,183,521,139,556,103,591,99,587,135,552,180,516,224,489,265,468"/>
<area shape="rect" title=" " alt="" coords="278,519,370,544"/>
<area shape="poly" title=" " alt="" coords="299,470,315,505,310,507,294,472"/>
<area shape="rect" title=" " alt="" coords="194,519,254,544"/>
<area shape="poly" title=" " alt="" coords="282,473,246,510,242,507,278,469"/>
<area shape="poly" title=" " alt="" coords="333,462,839,522,839,527,332,467"/>
<area shape="poly" title=" " alt="" coords="924,538,943,541,1017,551,1081,555,1189,557,1297,563,1360,573,1433,589,1440,592,1439,597,1431,595,1359,578,1296,569,1189,562,1080,560,1017,556,942,547,923,543"/>
<area shape="poly" title=" " alt="" coords="853,543,834,547,727,558,637,563,482,563,408,563,328,567,239,576,134,595,122,598,120,592,133,589,238,571,328,561,408,558,482,558,637,558,727,553,833,541,852,538"/>
<area shape="rect" title=" " alt="" coords="1110,592,1253,632"/>
<area shape="poly" title=" " alt="" coords="924,539,1098,586,1097,591,923,545"/>
<area shape="rect" title=" " alt="" coords="1277,592,1419,632"/>
<area shape="poly" title=" " alt="" coords="924,538,943,541,1102,565,1264,589,1263,594,1101,570,942,547,923,543"/>
<area shape="rect" title=" " alt="" coords="146,592,289,632"/>
<area shape="poly" title=" " alt="" coords="853,543,834,547,686,564,570,570,452,577,303,594,302,589,452,571,569,565,686,558,833,541,852,538"/>
<area shape="rect" title=" " alt="" coords="313,599,490,625"/>
<area shape="poly" title=" " alt="" coords="853,543,834,547,668,571,503,595,475,599,474,594,502,589,668,566,833,541,852,538"/>
<area shape="rect" title=" " alt="" coords="514,599,705,625"/>
<area shape="poly" title=" " alt="" coords="853,545,664,598,662,593,851,540"/>
<area shape="rect" title=" " alt="" coords="729,599,879,625"/>
<area shape="poly" title=" " alt="" coords="877,546,828,592,825,588,874,542"/>
<area shape="rect" title=" " alt="" coords="903,599,1086,625"/>
<area shape="poly" title=" " alt="" coords="905,542,969,589,966,593,902,546"/>
<area shape="poly" title=" " alt="" coords="607,253,466,299,464,294,606,248"/>
<area shape="poly" title=" " alt="" coords="629,253,490,365,487,361,625,249"/>
<area shape="poly" title=" " alt="" coords="643,251,643,284,652,323,670,356,692,386,746,440,803,481,853,510,850,515,801,486,743,444,688,390,665,359,647,325,638,285,638,251"/>
<area shape="rect" title=" " alt="" coords="679,299,867,324"/>
<area shape="poly" title=" " alt="" coords="664,248,741,290,739,294,661,253"/>
<area shape="rect" href="jet_8h.html" title=" " alt="" coords="727,372,777,397"/>
<area shape="poly" title=" " alt="" coords="645,250,653,285,660,304,670,322,692,345,718,363,715,367,689,349,666,326,655,307,647,286,640,251"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="943,299,1025,324"/>
<area shape="poly" title=" " alt="" coords="678,244,930,296,929,301,677,249"/>
<area shape="poly" title=" " alt="" coords="767,396,803,426,857,467,923,508,994,542,1058,560,1113,570,1163,572,1211,571,1310,570,1367,576,1433,589,1440,592,1439,597,1431,595,1366,581,1309,575,1211,577,1163,578,1113,575,1057,566,992,546,920,513,854,471,800,431,763,400"/>
<area shape="poly" title=" " alt="" coords="727,393,346,451,345,446,726,387"/>
<area shape="poly" title=" " alt="" coords="993,323,1023,365,1072,425,1135,488,1171,517,1209,542,1240,556,1268,565,1317,572,1369,576,1433,589,1439,591,1437,597,1431,595,1368,581,1317,577,1266,571,1238,561,1207,546,1168,522,1132,492,1068,428,1019,368,989,326"/>
<area shape="poly" title=" " alt="" coords="959,327,790,400,605,481,523,513,414,547,336,564,274,571,212,579,134,595,123,598,122,593,133,589,211,573,273,566,335,559,413,541,521,508,603,476,788,395,957,322"/>
<area shape="poly" title=" " alt="" coords="943,321,522,378,521,373,942,316"/>
<area shape="poly" title=" " alt="" coords="981,325,901,507,896,505,976,323"/>
<area shape="poly" title=" " alt="" coords="948,327,792,374,790,369,946,321"/>
<area shape="poly" title=" " alt="" coords="610,180,517,222,515,217,607,175"/>
<area shape="poly" title=" " alt="" coords="626,179,484,362,479,359,622,176"/>
<area shape="poly" title=" " alt="" coords="689,168,857,187,940,203,974,212,999,223,1022,238,1038,253,1049,272,1060,298,1067,326,1068,351,1063,373,1052,394,1020,432,978,473,951,495,923,514,920,509,948,491,974,469,1016,428,1048,391,1058,372,1062,351,1062,327,1055,300,1045,275,1034,257,1018,242,996,228,972,217,939,208,857,192,689,173"/>
<area shape="poly" title=" " alt="" coords="637,177,641,212,636,212,632,178"/>
<area shape="poly" title=" " alt="" coords="853,98,864,101,932,108,1022,112,1107,122,1141,133,1165,150,1181,173,1193,195,1200,217,1202,239,1194,281,1172,322,1140,361,1100,399,1008,473,970,497,932,516,930,511,968,492,1005,468,1096,395,1136,358,1168,319,1189,279,1196,239,1194,218,1188,197,1177,176,1161,154,1139,138,1106,128,1021,117,932,113,864,107,852,103"/>
<area shape="poly" title=" " alt="" coords="816,106,724,179,670,219,667,215,721,175,813,102"/>
<area shape="poly" title=" " alt="" coords="805,104,678,150,676,145,803,99"/>
<area shape="rect" title=" " alt="" coords="1092,152,1151,177"/>
<area shape="poly" title=" " alt="" coords="853,98,865,101,970,126,1079,149,1078,154,969,131,863,107,852,103"/>
<area shape="rect" href="prompt_8h.html" title=" " alt="" coords="903,225,985,251"/>
<area shape="poly" title=" " alt="" coords="840,103,928,213,924,216,835,106"/>
<area shape="rect" title=" " alt="" coords="917,152,1067,177"/>
<area shape="poly" title=" " alt="" coords="853,101,954,144,952,149,851,106"/>
<area shape="poly" title=" " alt="" coords="978,248,1012,267,1028,281,1040,298,1043,311,1040,325,1015,382,980,435,944,479,913,511,909,507,940,475,976,431,1010,380,1035,323,1038,311,1035,300,1024,284,1009,272,976,253"/>
<area shape="poly" title=" " alt="" coords="940,253,917,288,882,326,837,354,791,374,789,369,834,350,878,322,913,285,935,250"/>
<area shape="poly" title=" " alt="" coords="953,250,973,285,968,288,948,252"/>
</map>
</div>
</div>
<p><a href="inverse-compton_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad89f660f1954e9c12551a19840d656bb" id="r_ad89f660f1954e9c12551a19840d656bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb">eta_rad</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_m, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_c, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> p)</td></tr>
<tr class="separator:ad89f660f1954e9c12551a19840d656bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9474d0630c4e995f6902006749d116" id="r_acd9474d0630c4e995f6902006749d116"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> B, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_com</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> eps_e, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> eps_B, <a class="el" href="structSynElectrons.html">SynElectrons</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;e)</td></tr>
<tr class="separator:acd9474d0630c4e995f6902006749d116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689ca8481a7d3e7e760a3300503f2781" id="r_a689ca8481a7d3e7e760a3300503f2781"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#a689ca8481a7d3e7e760a3300503f2781">compton_cross_section</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> nu)</td></tr>
<tr class="memdesc:a689ca8481a7d3e7e760a3300503f2781"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Compton scattering cross-section as a function of frequency (nu).  <br /></td></tr>
<tr class="separator:a689ca8481a7d3e7e760a3300503f2781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8bb7586cf0642ee2a887483b0f72f5d" id="r_aa8bb7586cf0642ee2a887483b0f72f5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#aa8bb7586cf0642ee2a887483b0f72f5d">generate_IC_photons</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a> KN) <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">noexcept</a></td></tr>
<tr class="memdesc:aa8bb7586cf0642ee2a887483b0f72f5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and generates an IC photon grid from electron and photon distributions.  <br /></td></tr>
<tr class="separator:aa8bb7586cf0642ee2a887483b0f72f5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a330c8cd380f08f2ddce282201dae597b" id="r_a330c8cd380f08f2ddce282201dae597b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#a330c8cd380f08f2ddce282201dae597b">Thomson_cooling</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>)</td></tr>
<tr class="memdesc:a330c8cd380f08f2ddce282201dae597b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies Thomson cooling to electrons based on photon distribution.  <br /></td></tr>
<tr class="separator:a330c8cd380f08f2ddce282201dae597b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af25c21cb4c714787c8260f220a6c2ee9" id="r_af25c21cb4c714787c8260f220a6c2ee9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#af25c21cb4c714787c8260f220a6c2ee9">KN_cooling</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>)</td></tr>
<tr class="memdesc:af25c21cb4c714787c8260f220a6c2ee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies Klein-Nishina cooling to electrons based on photon distribution.  <br /></td></tr>
<tr class="separator:af25c21cb4c714787c8260f220a6c2ee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a689ca8481a7d3e7e760a3300503f2781" name="a689ca8481a7d3e7e760a3300503f2781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a689ca8481a7d3e7e760a3300503f2781">&#9670;&#160;</a></span>compton_cross_section()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> compton_cross_section </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>nu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the Compton scattering cross-section as a function of frequency (nu). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nu</td><td>The frequency at which to compute the cross-section </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>For x = (h * nu) / (me * c²) &lt;= 1, returns the Thomson cross-section (<a class="el" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6" title="Thomson cross-section in code units.">con::sigmaT</a>), otherwise 0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00141">141</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span>                                    {</div>
<div class="line"><span class="lineno">  142</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a> / (<a class="code hl_variable" href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a> * <a class="code hl_variable" href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a>) * nu;</div>
<div class="line"><span class="lineno">  143</span>    <span class="comment">/*if (x &lt;= 1) {</span></div>
<div class="line"><span class="lineno">  144</span><span class="comment">        return con::sigmaT;</span></div>
<div class="line"><span class="lineno">  145</span><span class="comment">    } else {</span></div>
<div class="line"><span class="lineno">  146</span><span class="comment">        return 0;</span></div>
<div class="line"><span class="lineno">  147</span><span class="comment">    }*/</span></div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> &lt; 1e-2) {</div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a> * (1 - 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>);</div>
<div class="line"><span class="lineno">  151</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> &gt; 1e2) {</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">return</span> 3. / 8 * <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a> * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log</a>(2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) + 0.5) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>;</div>
<div class="line"><span class="lineno">  153</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  154</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_term</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log</a>(1 + 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>);</div>
<div class="line"><span class="lineno">  155</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a> = 1 + 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>;</div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">return</span> 0.75 * <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a> *</div>
<div class="line"><span class="lineno">  157</span>               ((1 + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) * (2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> * (1 + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_term</a>) + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_term</a> / (2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) -</div>
<div class="line"><span class="lineno">  158</span>                (1 + 3 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a>));</div>
<div class="line"><span class="lineno">  159</span>    }</div>
<div class="line"><span class="lineno">  160</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00022">macros.h:22</a></div></div>
<div class="ttc" id="anamespacecon_html_a07ddec20ab09a3078fce714358b65b4b"><div class="ttname"><a href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a></div><div class="ttdeci">constexpr Real h</div><div class="ttdoc">Planck constant in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00087">macros.h:87</a></div></div>
<div class="ttc" id="anamespacecon_html_a26ef2b83dd09c356e324bd243b498764"><div class="ttname"><a href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a></div><div class="ttdeci">constexpr Real c2</div><div class="ttdoc">Speed of light squared.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00082">macros.h:82</a></div></div>
<div class="ttc" id="anamespacecon_html_a740c8edb3d4f2d904a1c76002f84fb7e"><div class="ttname"><a href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a></div><div class="ttdeci">constexpr Real me</div><div class="ttdoc">Electron mass in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00084">macros.h:84</a></div></div>
<div class="ttc" id="anamespacecon_html_ad19e5b64c85c3e709fd0944358be97f6"><div class="ttname"><a href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a></div><div class="ttdeci">constexpr Real sigmaT</div><div class="ttdoc">Thomson cross-section in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00092">macros.h:92</a></div></div>
<div class="ttc" id="autilities_8h_html_ab8e81118f023df135835db8cce4f5f42"><div class="ttname"><a href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a></div><div class="ttdeci">T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00330">utilities.h:330</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_cgraph" id="ainverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_cgraph">
<area shape="rect" title="Computes the Compton scattering cross&#45;section as a function of frequency (nu)." alt="" coords="5,29,180,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="228,29,279,55"/>
<area shape="poly" title=" " alt="" coords="180,39,214,39,214,45,180,45"/>
<area shape="poly" title=" " alt="" coords="226,31,221,21,224,11,235,5,253,3,275,6,285,15,281,19,273,11,253,8,237,10,228,15,226,20,231,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_icgraph.png" border="0" usemap="#ainverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_icgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_icgraph" id="ainverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_icgraph">
<area shape="rect" title="Computes the Compton scattering cross&#45;section as a function of frequency (nu)." alt="" coords="481,13,656,38"/>
<area shape="rect" href="structICPhoton.html#a6a2ac815d7fa191cddae0bebe39cdae6" title="Fill the integration grid for the IC photon spectrum." alt="" coords="219,13,433,38"/>
<area shape="poly" title=" " alt="" coords="467,28,433,28,433,23,467,23"/>
<area shape="rect" href="structICPhoton.html#aabcd1cc2a89ddb1683292dfefa74b14a" title="Generates the IC photon spectrum from the given electron and photon data." alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="acd9474d0630c4e995f6902006749d116" name="acd9474d0630c4e995f6902006749d116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd9474d0630c4e995f6902006749d116">&#9670;&#160;</a></span>compute_Thomson_Y()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> compute_Thomson_Y </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_com</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>eps_e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>eps_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSynElectrons.html">SynElectrons</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00108">108</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  108</span>                                                                                          {</div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eta_e</a> = <a class="code hl_function" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb">eta_rad</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.p);</div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eta_e</a> * eps_e / eps_B;</div>
<div class="line"><span class="lineno">  111</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a> = (std::sqrt(1 + 4 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>) - 1) / 2;</div>
<div class="line"><span class="lineno">  112</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y1</a> = 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>;</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">for</span> (; std::fabs((<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y1</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>) &gt; 1<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>-4;) {</div>
<div class="line"><span class="lineno">  114</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y1</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>;</div>
<div class="line"><span class="lineno">  115</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_c = <a class="code hl_function" href="synchrotron_8h.html#a52e34d49dd7497d65ea5261e80d615d4">compute_gamma_c</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_com</a>, B, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.Ys, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.p);</div>
<div class="line"><span class="lineno">  116</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eta_e</a> = <a class="code hl_function" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb">eta_rad</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m, gamma_c, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.p);</div>
<div class="line"><span class="lineno">  117</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eta_e</a> * eps_e / eps_B;</div>
<div class="line"><span class="lineno">  118</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a> = (std::sqrt(1 + 4 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>) - 1) / 2;</div>
<div class="line"><span class="lineno">  119</span>    }</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>;</div>
<div class="line"><span class="lineno">  121</span>}</div>
<div class="ttc" id="ainverse-compton_8cpp_html_ad89f660f1954e9c12551a19840d656bb"><div class="ttname"><a href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb">eta_rad</a></div><div class="ttdeci">Real eta_rad(Real gamma_m, Real gamma_c, Real p)</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8cpp_source.html#l00089">inverse-compton.cpp:89</a></div></div>
<div class="ttc" id="anamespacecon_html_af12a6df01bfe61fa034307dfcaa1fe7f"><div class="ttname"><a href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">con::e</a></div><div class="ttdeci">constexpr Real e</div><div class="ttdoc">Elementary charge in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00088">macros.h:88</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_a52e34d49dd7497d65ea5261e80d615d4"><div class="ttname"><a href="synchrotron_8h.html#a52e34d49dd7497d65ea5261e80d615d4">compute_gamma_c</a></div><div class="ttdeci">Real compute_gamma_c(Real t_com, Real B, InverseComptonY const &amp;Ys, Real p)</div><div class="ttdoc">Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00555">synchrotron.cpp:555</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_cgraph" id="ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_cgraph">
<area shape="rect" title=" " alt="" coords="5,101,167,126"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="215,101,365,126"/>
<area shape="poly" title=" " alt="" coords="167,111,201,111,201,116,167,116"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1173,119,1224,145"/>
<area shape="poly" title=" " alt="" coords="116,98,185,71,282,40,395,14,454,6,512,3,951,3,1004,6,1044,16,1081,35,1127,62,1156,83,1180,107,1176,111,1152,88,1124,66,1079,39,1042,21,1003,11,951,8,512,8,454,11,396,19,283,45,186,76,118,103"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="726,207,797,233"/>
<area shape="poly" title=" " alt="" coords="121,123,248,167,330,189,414,207,495,216,577,220,712,220,712,225,577,226,495,222,413,212,329,195,246,172,119,129"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="413,157,613,197"/>
<area shape="poly" title=" " alt="" coords="336,124,431,151,429,156,335,129"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="413,93,613,133"/>
<area shape="poly" title=" " alt="" coords="365,111,399,111,399,116,365,116"/>
<area shape="poly" title=" " alt="" coords="332,98,413,79,510,64,586,57,760,53,951,53,1011,59,1068,74,1120,92,1162,111,1160,116,1118,97,1067,79,1010,64,951,59,760,59,586,62,510,69,414,84,333,103"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="661,93,861,133"/>
<area shape="poly" title=" " alt="" coords="613,111,648,111,648,116,613,116"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="909,194,991,219"/>
<area shape="poly" title=" " alt="" coords="804,131,912,185,910,190,801,136"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="917,98,983,123"/>
<area shape="poly" title=" " alt="" coords="862,109,903,109,904,114,862,115"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1039,145,1125,170"/>
<area shape="poly" title=" " alt="" coords="984,191,1033,173,1035,178,986,196"/>
<area shape="poly" title=" " alt="" coords="978,217,1009,229,1047,238,1087,240,1106,237,1124,230,1144,215,1161,196,1185,156,1190,159,1166,199,1148,219,1127,234,1107,242,1087,245,1046,243,1008,234,976,222"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1041,194,1123,219"/>
<area shape="poly" title=" " alt="" coords="991,204,1027,204,1027,209,991,209"/>
<area shape="poly" title=" " alt="" coords="1125,145,1159,138,1161,143,1126,151"/>
<area shape="poly" title=" " alt="" coords="1179,120,1175,111,1177,102,1185,95,1199,93,1215,96,1222,104,1218,108,1212,101,1199,98,1187,100,1181,104,1180,110,1183,118"/>
<area shape="poly" title=" " alt="" coords="1104,191,1124,179,1167,150,1170,155,1127,184,1107,196"/>
<area shape="poly" title=" " alt="" coords="983,111,1160,126,1159,131,983,116"/>
<area shape="poly" title=" " alt="" coords="797,215,895,208,896,213,797,220"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_icgraph.png" border="0" usemap="#ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_icgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_icgraph" id="ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_icgraph">
<area shape="rect" title=" " alt="" coords="189,31,351,56"/>
<area shape="rect" href="inverse-compton_8cpp.html#af25c21cb4c714787c8260f220a6c2ee9" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="26,5,121,31"/>
<area shape="poly" title=" " alt="" coords="175,34,121,27,121,21,176,29"/>
<area shape="rect" href="inverse-compton_8cpp.html#a330c8cd380f08f2ddce282201dae597b" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,55,141,80"/>
<area shape="poly" title=" " alt="" coords="176,57,142,62,142,56,176,52"/>
</map>
</div>

</div>
</div>
<a id="ad89f660f1954e9c12551a19840d656bb" name="ad89f660f1954e9c12551a19840d656bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad89f660f1954e9c12551a19840d656bb">&#9670;&#160;</a></span>eta_rad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> eta_rad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00089">89</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   89</span>                                                        {</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">return</span> gamma_c &lt; gamma_m ? 1 : <a class="code hl_function" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404">fast_pow</a>(gamma_c / gamma_m, (2 - p));</div>
<div class="line"><span class="lineno">   91</span>}</div>
<div class="ttc" id="autilities_8h_html_a4520a27a10a2aef33c99ad8c679da404"><div class="ttname"><a href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404">fast_pow</a></div><div class="ttdeci">Real fast_pow(Real a, Real b)</div><div class="ttdoc">Fast approximation of a raised to the power of b.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00491">utilities.h:491</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_cgraph" id="ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,76,81"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="124,56,205,81"/>
<area shape="poly" title=" " alt="" coords="76,66,110,66,110,71,76,71"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="253,5,340,31"/>
<area shape="poly" title=" " alt="" coords="198,53,249,33,251,38,200,58"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="388,56,439,81"/>
<area shape="poly" title=" " alt="" coords="206,66,374,66,374,71,206,71"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="255,107,338,132"/>
<area shape="poly" title=" " alt="" coords="200,79,251,99,249,104,198,84"/>
<area shape="poly" title=" " alt="" coords="328,28,376,50,374,55,326,33"/>
<area shape="poly" title=" " alt="" coords="393,57,389,48,391,38,400,32,413,29,429,33,436,41,432,45,427,37,413,35,402,37,396,41,395,47,398,55"/>
<area shape="poly" title=" " alt="" coords="326,104,374,83,376,87,328,109"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_icgraph.png" border="0" usemap="#ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_icgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_icgraph" id="ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_icgraph">
<area shape="rect" title=" " alt="" coords="399,31,469,56"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="189,31,351,56"/>
<area shape="poly" title=" " alt="" coords="385,46,351,46,351,41,385,41"/>
<area shape="rect" href="inverse-compton_8cpp.html#af25c21cb4c714787c8260f220a6c2ee9" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="26,5,121,31"/>
<area shape="poly" title=" " alt="" coords="175,34,121,27,121,21,176,29"/>
<area shape="rect" href="inverse-compton_8cpp.html#a330c8cd380f08f2ddce282201dae597b" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,55,141,80"/>
<area shape="poly" title=" " alt="" coords="176,57,142,62,142,56,176,52"/>
</map>
</div>

</div>
</div>
<a id="aa8bb7586cf0642ee2a887483b0f72f5d" name="aa8bb7586cf0642ee2a887483b0f72f5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8bb7586cf0642ee2a887483b0f72f5d">&#9670;&#160;</a></span>generate_IC_photons()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a> generate_IC_photons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a>&#160;</td>
          <td class="paramname"><em>KN</em> = <code><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">true</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and generates an IC photon grid from electron and photon distributions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 3D grid of IC photons </dd></dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00162">162</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  162</span>                                                                                                                   {</div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordtype">size_t</span> t_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  166</span>    <a class="code hl_typedef" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>({phi_size, theta_size, t_size});</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  170</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  171</span>                <span class="comment">// Generate the IC photon spectrum for each grid cell.</span></div>
<div class="line"><span class="lineno">  172</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).compute_IC_spectrum(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), KN);</div>
<div class="line"><span class="lineno">  173</span>            }</div>
<div class="line"><span class="lineno">  174</span>        }</div>
<div class="line"><span class="lineno">  175</span>    }</div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>;</div>
<div class="line"><span class="lineno">  177</span>}</div>
<div class="ttc" id="ainverse-compton_8h_html_adcfaf3d2807fe6de421ca3e9c5332252"><div class="ttname"><a href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a></div><div class="ttdeci">xt::xtensor&lt; ICPhoton, 3 &gt; ICPhotonGrid</div><div class="ttdoc">Defines a 3D grid (using xt::xtensor) for storing ICPhoton objects.</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8h_source.html#l00231">inverse-compton.h:231</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_aa8bb7586cf0642ee2a887483b0f72f5d_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_aa8bb7586cf0642ee2a887483b0f72f5d_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_aa8bb7586cf0642ee2a887483b0f72f5d_cgraph" id="ainverse-compton_8cpp_aa8bb7586cf0642ee2a887483b0f72f5d_cgraph">
<area shape="rect" title="Creates and generates an IC photon grid from electron and photon distributions." alt="" coords="5,29,164,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="212,29,263,55"/>
<area shape="poly" title=" " alt="" coords="164,39,198,39,198,45,164,45"/>
<area shape="poly" title=" " alt="" coords="212,31,206,21,209,11,220,5,237,3,258,6,267,15,264,19,256,11,237,8,222,10,213,15,212,20,216,28"/>
</map>
</div>

</div>
</div>
<a id="af25c21cb4c714787c8260f220a6c2ee9" name="af25c21cb4c714787c8260f220a6c2ee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af25c21cb4c714787c8260f220a6c2ee9">&#9670;&#160;</a></span>KN_cooling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> KN_cooling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies Klein-Nishina cooling to electrons based on photon distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid to be modified </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
    <tr><td class="paramname">shock</td><td>The shock properties </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00197">197</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  197</span>                                                                                        {</div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_size</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  203</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_size</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  204</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y_T = <a class="code hl_function" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.t_comv(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_e, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_B,</div>
<div class="line"><span class="lineno">  205</span>                                             <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>));</div>
<div class="line"><span class="lineno">  206</span>                <span class="comment">// Clear existing Ys and emplace a new InverseComptonY with additional synchrotron frequency parameters.</span></div>
<div class="line"><span class="lineno">  207</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).Ys =</div>
<div class="line"><span class="lineno">  208</span>                    <a class="code hl_struct" href="structInverseComptonY.html">InverseComptonY</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).nu_m, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).nu_c, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), Y_T);</div>
<div class="line"><span class="lineno">  209</span>            }</div>
<div class="line"><span class="lineno">  210</span>        }</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span>    <a class="code hl_function" href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  213</span>    <a class="code hl_function" href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>);</div>
<div class="line"><span class="lineno">  214</span>}</div>
<div class="ttc" id="ainverse-compton_8cpp_html_acd9474d0630c4e995f6902006749d116"><div class="ttname"><a href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a></div><div class="ttdeci">Real compute_Thomson_Y(Real B, Real t_com, Real eps_e, Real eps_B, SynElectrons const &amp;e)</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8cpp_source.html#l00108">inverse-compton.cpp:108</a></div></div>
<div class="ttc" id="astructInverseComptonY_html"><div class="ttname"><a href="structInverseComptonY.html">InverseComptonY</a></div><div class="ttdoc">Handles Inverse Compton Y parameter calculations and related threshold values.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8h_source.html#l00021">synchrotron.h:21</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_a331f545228d2b18e84e0252510e295f8"><div class="ttname"><a href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a></div><div class="ttdeci">SynPhotonGrid generate_syn_photons(Shock const &amp;shock, SynElectronGrid const &amp;electrons)</div><div class="ttdoc">Creates and returns a new photon grid based on shock and electron grid.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00752">synchrotron.cpp:752</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_af56f9b4417a5f3e717102da3e81a7d37"><div class="ttname"><a href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a></div><div class="ttdeci">void update_electrons_4Y(SynElectronGrid &amp;electrons, Shock const &amp;shock)</div><div class="ttdoc">Updates electron properties throughout the grid based on shock parameters and IC Y values.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00630">synchrotron.cpp:630</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_af25c21cb4c714787c8260f220a6c2ee9_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_af25c21cb4c714787c8260f220a6c2ee9_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_af25c21cb4c714787c8260f220a6c2ee9_cgraph" id="ainverse-compton_8cpp_af25c21cb4c714787c8260f220a6c2ee9_cgraph">
<area shape="rect" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="5,284,100,309"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="148,199,309,224"/>
<area shape="poly" title=" " alt="" coords="79,281,188,228,190,233,81,286"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1436,297,1487,323"/>
<area shape="poly" title=" " alt="" coords="60,282,110,215,149,170,196,123,251,78,312,40,378,14,413,7,449,5,1171,5,1237,3,1290,5,1315,10,1339,20,1364,35,1390,57,1411,83,1428,111,1450,174,1461,235,1463,283,1458,283,1455,235,1445,175,1423,114,1407,86,1386,61,1361,40,1337,25,1313,15,1290,10,1237,8,1171,10,449,10,414,12,380,19,315,45,254,82,200,127,153,174,114,219,64,285"/>
<area shape="rect" href="synchrotron_8cpp.html#a331f545228d2b18e84e0252510e295f8" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="854,575,1023,600"/>
<area shape="poly" title=" " alt="" coords="68,308,103,341,149,377,236,425,329,465,424,498,519,525,611,545,697,560,841,578,840,583,697,565,610,550,518,530,422,503,327,470,234,430,147,382,100,346,64,312"/>
<area shape="rect" href="synchrotron_8cpp.html#af56f9b4417a5f3e717102da3e81a7d37" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="150,341,307,367"/>
<area shape="poly" title=" " alt="" coords="93,307,177,335,175,340,92,312"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="375,227,525,252"/>
<area shape="poly" title=" " alt="" coords="310,219,361,225,361,231,309,224"/>
<area shape="poly" title=" " alt="" coords="250,196,321,159,427,112,489,90,555,72,622,60,689,55,1171,55,1236,53,1289,52,1313,55,1338,63,1363,77,1390,97,1409,117,1424,141,1446,192,1457,242,1462,284,1456,284,1452,243,1441,193,1420,143,1405,121,1386,101,1360,81,1336,68,1312,61,1289,57,1236,58,1171,61,689,61,623,65,556,77,491,95,429,117,323,163,253,201"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="655,169,726,195"/>
<area shape="poly" title=" " alt="" coords="309,204,641,182,642,188,310,209"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="591,219,791,259"/>
<area shape="poly" title=" " alt="" coords="525,237,577,237,577,242,525,242"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="591,283,791,323"/>
<area shape="poly" title=" " alt="" coords="500,250,602,277,601,282,498,255"/>
<area shape="poly" title=" " alt="" coords="466,224,519,189,554,170,590,154,684,125,760,111,838,106,937,106,1171,106,1235,102,1287,97,1311,98,1336,103,1362,114,1390,132,1407,147,1421,166,1441,207,1454,248,1460,283,1455,284,1449,250,1436,209,1416,169,1403,151,1386,136,1359,118,1334,108,1311,103,1287,102,1235,107,1171,111,937,111,838,112,761,116,686,130,592,159,556,174,522,193,469,229"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="839,239,1039,279"/>
<area shape="poly" title=" " alt="" coords="790,283,825,277,826,282,791,288"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="1129,247,1211,272"/>
<area shape="poly" title=" " alt="" coords="1039,257,1116,257,1116,262,1039,262"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="1312,147,1377,172"/>
<area shape="poly" title=" " alt="" coords="1020,237,1298,168,1299,173,1022,242"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1301,196,1388,221"/>
<area shape="poly" title=" " alt="" coords="1210,245,1287,222,1289,228,1212,250"/>
<area shape="poly" title=" " alt="" coords="1211,259,1293,267,1389,283,1424,293,1422,299,1387,289,1293,273,1211,264"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1303,297,1386,323"/>
<area shape="poly" title=" " alt="" coords="1212,268,1291,292,1289,297,1210,273"/>
<area shape="poly" title=" " alt="" coords="1366,219,1390,239,1440,286,1436,289,1386,243,1362,224"/>
<area shape="poly" title=" " alt="" coords="1441,298,1437,289,1439,279,1448,273,1461,271,1477,274,1484,282,1480,286,1475,279,1461,276,1450,278,1444,282,1443,288,1446,296"/>
<area shape="poly" title=" " alt="" coords="1387,307,1422,307,1422,313,1387,313"/>
<area shape="poly" title=" " alt="" coords="1375,170,1390,181,1411,206,1428,233,1453,283,1448,286,1424,236,1406,209,1386,185,1372,174"/>
<area shape="poly" title=" " alt="" coords="726,183,864,198,1039,225,1116,242,1115,247,1038,230,863,203,726,188"/>
<area shape="poly" title=" " alt="" coords="997,597,1085,609,1137,611,1191,609,1246,600,1298,585,1345,560,1386,525,1403,504,1417,479,1437,427,1449,377,1455,336,1461,337,1455,378,1442,429,1422,482,1407,507,1390,529,1348,565,1300,590,1247,606,1192,614,1137,616,1085,614,997,603"/>
<area shape="poly" title=" " alt="" coords="954,572,994,535,1036,486,1050,458,1057,433,1065,409,1085,385,1134,353,1188,332,1242,318,1289,311,1290,316,1243,323,1189,337,1136,358,1088,389,1070,412,1062,435,1055,460,1041,489,998,539,957,576"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="1099,549,1241,575"/>
<area shape="poly" title=" " alt="" coords="1024,575,1085,569,1085,574,1024,581"/>
<area shape="poly" title=" " alt="" coords="249,339,356,277,403,255,405,260,359,282,252,343"/>
<area shape="poly" title=" " alt="" coords="308,347,419,339,542,326,577,321,577,326,543,331,419,344,308,352"/>
<area shape="poly" title=" " alt="" coords="243,365,290,414,323,443,359,468,510,556,573,589,634,616,697,636,765,650,844,658,937,661,1171,661,1238,660,1291,651,1315,643,1338,630,1386,587,1408,558,1425,525,1438,491,1447,455,1456,388,1458,336,1464,337,1462,389,1452,456,1443,492,1430,528,1413,561,1390,590,1341,634,1317,648,1293,657,1239,665,1171,666,937,666,844,663,765,655,696,641,632,621,571,594,507,560,356,472,319,447,286,418,239,368"/>
<area shape="rect" href="synchrotron_8cpp.html#ab09dbe28fcecfc3d846577c1c34fcca6" title=" " alt="" coords="848,449,1029,475"/>
<area shape="poly" title=" " alt="" coords="247,365,295,398,326,415,358,427,420,444,483,455,612,469,732,472,834,468,834,474,732,477,612,474,483,461,419,449,357,433,323,419,292,402,244,369"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="357,291,543,316"/>
<area shape="poly" title=" " alt="" coords="285,339,380,316,381,322,286,344"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="1099,399,1241,424"/>
<area shape="poly" title=" " alt="" coords="308,357,591,377,1085,404,1085,410,591,382,307,362"/>
<area shape="poly" title=" " alt="" coords="946,447,998,374,1039,329,1085,289,1115,273,1118,278,1088,294,1042,333,1003,377,950,451"/>
<area shape="poly" title=" " alt="" coords="970,472,1049,500,1101,513,1158,524,1217,528,1277,525,1334,511,1387,485,1403,471,1417,454,1438,413,1450,372,1455,336,1461,337,1455,373,1443,415,1422,457,1407,475,1389,490,1336,516,1278,530,1217,534,1157,529,1100,519,1048,505,968,477"/>
<area shape="poly" title=" " alt="" coords="967,472,1088,528,1123,542,1121,547,1086,532,965,477"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="1087,448,1253,473"/>
<area shape="poly" title=" " alt="" coords="1030,459,1073,459,1073,464,1030,464"/>
<area shape="poly" title=" " alt="" coords="498,288,601,260,602,265,500,293"/>
<area shape="poly" title=" " alt="" coords="543,301,577,301,577,306,543,306"/>
<area shape="poly" title=" " alt="" coords="499,313,591,333,764,354,937,358,1171,358,1280,354,1387,333,1422,322,1424,327,1389,338,1281,359,1171,363,937,363,763,359,590,338,498,319"/>
<area shape="poly" title=" " alt="" coords="1241,409,1314,400,1351,391,1387,377,1417,356,1441,331,1444,335,1420,360,1389,382,1353,396,1315,406,1242,414"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="1317,449,1373,475"/>
<area shape="poly" title=" " alt="" coords="1215,422,1304,448,1303,453,1214,427"/>
<area shape="poly" title=" " alt="" coords="1364,447,1386,428,1421,380,1446,334,1451,336,1426,383,1390,432,1368,451"/>
</map>
</div>

</div>
</div>
<a id="a330c8cd380f08f2ddce282201dae597b" name="a330c8cd380f08f2ddce282201dae597b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a330c8cd380f08f2ddce282201dae597b">&#9670;&#160;</a></span>Thomson_cooling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> Thomson_cooling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies Thomson cooling to electrons based on photon distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid to be modified </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
    <tr><td class="paramname">shock</td><td>The shock properties </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00179">179</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  179</span>                                                                                             {</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordtype">size_t</span> t_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>++) {</div>
<div class="line"><span class="lineno">  185</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  186</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  187</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y_T = <a class="code hl_function" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.t_comv(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_e, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_B,</div>
<div class="line"><span class="lineno">  188</span>                                             <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>));</div>
<div class="line"><span class="lineno">  189</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).Ys = <a class="code hl_struct" href="structInverseComptonY.html">InverseComptonY</a>(Y_T);</div>
<div class="line"><span class="lineno">  190</span>            }</div>
<div class="line"><span class="lineno">  191</span>        }</div>
<div class="line"><span class="lineno">  192</span>    }</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_function" href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_function" href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>);</div>
<div class="line"><span class="lineno">  195</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_a330c8cd380f08f2ddce282201dae597b_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_a330c8cd380f08f2ddce282201dae597b_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_a330c8cd380f08f2ddce282201dae597b_cgraph" id="ainverse-compton_8cpp_a330c8cd380f08f2ddce282201dae597b_cgraph">
<area shape="rect" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,284,141,309"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="189,199,351,224"/>
<area shape="poly" title=" " alt="" coords="103,281,226,227,228,232,105,286"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1477,297,1528,323"/>
<area shape="poly" title=" " alt="" coords="81,282,134,215,176,170,226,123,284,78,348,40,417,14,453,7,490,5,1213,5,1278,3,1332,5,1356,10,1380,20,1405,35,1431,57,1453,83,1470,111,1492,174,1502,235,1505,283,1499,283,1497,235,1487,175,1465,114,1448,86,1427,61,1402,40,1378,25,1355,15,1331,10,1278,8,1213,10,490,10,454,12,419,19,350,45,287,82,230,127,180,174,138,219,86,285"/>
<area shape="rect" href="synchrotron_8cpp.html#a331f545228d2b18e84e0252510e295f8" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="895,575,1065,600"/>
<area shape="poly" title=" " alt="" coords="92,307,135,341,191,377,279,422,372,460,468,491,563,518,740,555,882,575,881,581,739,560,562,523,466,497,371,465,277,427,188,382,132,345,89,312"/>
<area shape="rect" href="synchrotron_8cpp.html#af56f9b4417a5f3e717102da3e81a7d37" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="191,341,349,367"/>
<area shape="poly" title=" " alt="" coords="118,307,214,335,212,340,117,312"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="416,227,567,252"/>
<area shape="poly" title=" " alt="" coords="351,219,403,225,402,231,351,224"/>
<area shape="poly" title=" " alt="" coords="292,196,362,159,469,112,531,90,596,72,663,60,731,55,1213,55,1277,53,1330,52,1355,55,1379,63,1404,77,1431,97,1450,117,1466,141,1487,192,1498,242,1503,284,1498,284,1493,243,1482,193,1461,143,1446,121,1428,101,1401,81,1377,68,1353,61,1330,57,1278,58,1213,61,731,61,664,65,597,77,532,95,471,117,365,163,294,201"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="697,169,767,195"/>
<area shape="poly" title=" " alt="" coords="351,204,683,182,683,188,351,209"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="632,219,832,259"/>
<area shape="poly" title=" " alt="" coords="567,237,618,237,618,242,567,242"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="632,283,832,323"/>
<area shape="poly" title=" " alt="" coords="541,250,644,277,642,282,540,255"/>
<area shape="poly" title=" " alt="" coords="508,224,561,189,595,170,631,154,726,125,802,111,879,106,979,106,1213,106,1276,102,1328,97,1353,98,1377,103,1403,114,1431,132,1448,147,1462,166,1483,207,1495,248,1501,283,1496,284,1490,250,1478,209,1457,169,1444,151,1428,136,1401,118,1376,108,1352,103,1328,102,1277,107,1213,111,979,111,880,112,802,116,727,130,633,159,597,174,563,193,511,229"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="880,239,1080,279"/>
<area shape="poly" title=" " alt="" coords="832,283,866,277,867,282,833,288"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="1171,247,1252,272"/>
<area shape="poly" title=" " alt="" coords="1080,257,1157,257,1157,262,1080,262"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="1353,147,1419,172"/>
<area shape="poly" title=" " alt="" coords="1062,237,1339,168,1341,173,1063,242"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1343,196,1429,221"/>
<area shape="poly" title=" " alt="" coords="1251,245,1329,222,1330,228,1253,250"/>
<area shape="poly" title=" " alt="" coords="1252,259,1335,267,1430,283,1465,293,1463,299,1429,289,1334,273,1252,264"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1345,297,1427,323"/>
<area shape="poly" title=" " alt="" coords="1253,268,1332,292,1331,297,1251,273"/>
<area shape="poly" title=" " alt="" coords="1407,219,1431,239,1481,286,1478,289,1428,243,1404,224"/>
<area shape="poly" title=" " alt="" coords="1483,298,1479,289,1481,279,1489,273,1503,271,1519,274,1526,282,1522,286,1516,279,1503,276,1491,278,1485,282,1484,288,1487,296"/>
<area shape="poly" title=" " alt="" coords="1428,307,1463,307,1463,313,1428,313"/>
<area shape="poly" title=" " alt="" coords="1416,170,1431,181,1452,206,1470,233,1494,283,1489,286,1465,236,1448,209,1427,185,1413,174"/>
<area shape="poly" title=" " alt="" coords="768,183,905,198,1080,225,1158,242,1157,247,1080,230,904,203,767,188"/>
<area shape="poly" title=" " alt="" coords="1039,597,1127,609,1178,611,1233,609,1287,600,1339,585,1387,560,1427,525,1444,504,1458,479,1479,427,1491,377,1497,336,1502,337,1496,378,1484,429,1463,482,1449,507,1431,529,1390,565,1341,590,1288,606,1233,614,1178,616,1126,614,1038,603"/>
<area shape="poly" title=" " alt="" coords="995,572,1035,535,1078,486,1092,458,1098,433,1106,409,1126,385,1175,353,1229,332,1283,318,1331,311,1331,316,1284,323,1231,337,1177,358,1130,389,1111,412,1103,435,1097,460,1082,489,1039,539,999,576"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="1140,549,1283,575"/>
<area shape="poly" title=" " alt="" coords="1065,575,1126,569,1126,574,1065,581"/>
<area shape="poly" title=" " alt="" coords="290,339,397,277,444,255,447,260,400,282,293,343"/>
<area shape="poly" title=" " alt="" coords="349,347,460,339,584,326,618,321,619,326,584,331,461,344,349,352"/>
<area shape="poly" title=" " alt="" coords="284,365,331,414,364,443,400,468,551,556,615,589,676,616,738,636,807,650,886,658,979,661,1213,661,1280,660,1333,651,1356,643,1379,630,1427,587,1449,558,1466,525,1479,491,1488,455,1498,388,1500,336,1505,337,1503,389,1494,456,1484,492,1471,528,1454,561,1431,590,1382,634,1358,648,1334,657,1280,665,1213,666,979,666,885,663,806,655,737,641,674,621,612,594,549,560,397,472,361,447,328,418,280,368"/>
<area shape="rect" href="synchrotron_8cpp.html#ab09dbe28fcecfc3d846577c1c34fcca6" title=" " alt="" coords="889,449,1071,475"/>
<area shape="poly" title=" " alt="" coords="289,365,336,398,367,415,399,427,461,444,525,455,653,469,774,472,875,468,875,474,774,477,653,474,524,461,460,449,398,433,365,419,333,402,285,369"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="399,291,584,316"/>
<area shape="poly" title=" " alt="" coords="326,339,421,316,423,322,327,344"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="1140,399,1283,424"/>
<area shape="poly" title=" " alt="" coords="349,357,632,377,1126,404,1126,410,632,382,349,362"/>
<area shape="poly" title=" " alt="" coords="987,447,1040,374,1080,329,1126,289,1157,273,1159,278,1130,294,1084,333,1044,377,991,451"/>
<area shape="poly" title=" " alt="" coords="1012,472,1090,500,1142,513,1199,524,1259,528,1318,525,1375,511,1428,485,1445,471,1459,454,1479,413,1491,372,1497,336,1502,337,1496,373,1484,415,1463,457,1449,475,1431,490,1377,516,1319,530,1259,534,1198,529,1141,519,1089,505,1010,477"/>
<area shape="poly" title=" " alt="" coords="1009,472,1129,528,1164,542,1162,547,1127,532,1006,477"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="1128,448,1295,473"/>
<area shape="poly" title=" " alt="" coords="1071,459,1114,459,1114,464,1071,464"/>
<area shape="poly" title=" " alt="" coords="540,288,642,260,644,265,541,293"/>
<area shape="poly" title=" " alt="" coords="584,301,618,301,618,306,584,306"/>
<area shape="poly" title=" " alt="" coords="541,313,632,333,805,354,979,358,1213,358,1322,354,1429,333,1464,322,1465,327,1430,338,1322,359,1213,363,979,363,804,359,632,338,539,319"/>
<area shape="poly" title=" " alt="" coords="1282,409,1355,400,1393,391,1428,377,1458,356,1482,331,1486,335,1462,360,1431,382,1394,396,1356,406,1283,414"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="1358,449,1414,475"/>
<area shape="poly" title=" " alt="" coords="1257,422,1346,448,1344,453,1255,427"/>
<area shape="poly" title=" " alt="" coords="1406,447,1427,428,1462,380,1487,334,1492,336,1467,383,1431,432,1409,451"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4ecbb2552d02e976219f567964484fc4.html">radiation</a></li><li class="navelem"><a class="el" href="inverse-compton_8cpp.html">inverse-compton.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
