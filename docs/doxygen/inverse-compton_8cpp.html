<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: inverse-compton.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('inverse-compton_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">inverse-compton.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="inverse-compton_8h_source.html">inverse-compton.h</a>&quot;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &quot;<a class="el" href="IO_8h_source.html">IO.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for inverse-compton.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp__incl.png" border="0" usemap="#ainverse-compton_8cpp" alt=""/></div>
<map name="ainverse-compton_8cpp" id="ainverse-compton_8cpp">
<area shape="rect" title=" " alt="" coords="1887,5,2046,31"/>
<area shape="rect" href="inverse-compton_8h.html" title=" " alt="" coords="1516,225,1660,251"/>
<area shape="poly" title=" " alt="" coords="1948,33,1621,221,1619,216,1946,28"/>
<area shape="rect" title=" " alt="" coords="75,680,138,705"/>
<area shape="poly" title=" " alt="" coords="1887,24,1438,36,808,62,504,81,248,104,148,118,72,133,24,148,12,156,8,164,8,532,16,574,35,611,60,644,84,669,81,673,56,647,30,614,11,575,3,533,3,163,8,153,21,144,70,127,147,113,247,99,503,76,808,56,1437,30,1887,18"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="1748,680,1831,705"/>
<area shape="poly" title=" " alt="" coords="1976,30,2003,86,2015,123,2020,163,2020,533,2015,563,2002,590,1982,613,1957,632,1901,662,1845,681,1843,676,1899,657,1955,628,1978,609,1998,587,2010,562,2015,532,2015,163,2010,125,1998,87,1971,32"/>
<area shape="rect" href="utilities_8h.html" title=" " alt="" coords="1717,445,1800,471"/>
<area shape="poly" title=" " alt="" coords="1969,31,1969,163,1969,313,1965,340,1954,364,1936,384,1915,402,1864,429,1814,447,1812,442,1862,424,1912,398,1933,380,1949,361,1960,338,1964,312,1964,163,1964,31"/>
<area shape="rect" title=" " alt="" coords="2055,79,2135,104"/>
<area shape="poly" title=" " alt="" coords="1989,28,2063,69,2060,74,1986,33"/>
<area shape="rect" title=" " alt="" coords="2159,79,2223,104"/>
<area shape="poly" title=" " alt="" coords="2003,28,2146,73,2145,78,2002,33"/>
<area shape="rect" href="IO_8h.html" title=" " alt="" coords="1204,79,1252,104"/>
<area shape="poly" title=" " alt="" coords="1888,30,1266,89,1266,84,1887,24"/>
<area shape="rect" title=" " alt="" coords="1651,299,1707,324"/>
<area shape="poly" title=" " alt="" coords="1604,249,1655,288,1651,292,1601,253"/>
<area shape="poly" title=" " alt="" coords="1594,250,1608,307,1614,345,1616,383,1616,533,1617,589,1609,612,1589,634,1566,643,1520,650,1374,663,1172,673,939,681,470,690,152,694,152,688,470,685,939,676,1172,668,1373,658,1519,645,1564,638,1587,630,1605,609,1611,588,1611,533,1611,383,1608,345,1602,308,1589,251"/>
<area shape="rect" title=" " alt="" coords="1470,372,1525,397"/>
<area shape="poly" title=" " alt="" coords="1581,252,1546,300,1512,361,1507,358,1542,297,1577,249"/>
<area shape="rect" title=" " alt="" coords="1411,299,1474,324"/>
<area shape="poly" title=" " alt="" coords="1566,253,1480,295,1477,290,1563,248"/>
<area shape="poly" title=" " alt="" coords="1640,248,1693,267,1747,296,1809,346,1854,391,1887,444,1916,518,1919,549,1913,584,1904,614,1894,634,1868,659,1837,676,1835,672,1865,654,1890,630,1899,612,1908,582,1914,549,1911,519,1882,447,1849,394,1806,350,1744,301,1691,272,1638,253"/>
<area shape="rect" href="mesh_8h.html" title=" " alt="" coords="934,519,1005,544"/>
<area shape="poly" title=" " alt="" coords="1591,251,1588,281,1581,321,1566,363,1554,382,1539,399,1499,425,1442,448,1373,467,1296,485,1141,511,1019,527,1018,522,1140,506,1295,480,1371,462,1440,442,1497,420,1536,395,1550,379,1561,361,1576,319,1583,280,1585,251"/>
<area shape="rect" href="shock_8h.html" title=" " alt="" coords="1315,299,1387,324"/>
<area shape="poly" title=" " alt="" coords="1551,253,1401,298,1399,293,1549,248"/>
<area shape="poly" title=" " alt="" coords="1634,248,1679,267,1701,280,1721,297,1742,329,1755,365,1761,401,1762,432,1757,432,1756,402,1750,366,1738,331,1717,300,1698,285,1676,272,1632,253"/>
<area shape="rect" title=" " alt="" coords="1715,753,1773,779"/>
<area shape="poly" title=" " alt="" coords="1784,707,1761,743,1756,740,1780,704"/>
<area shape="rect" title=" " alt="" coords="1797,753,1872,779"/>
<area shape="poly" title=" " alt="" coords="1799,704,1822,740,1818,743,1795,707"/>
<area shape="poly" title=" " alt="" coords="934,535,753,538,499,546,373,553,263,564,179,577,151,585,134,594,121,609,113,628,108,667,103,666,108,627,117,607,130,590,149,580,178,572,262,558,373,548,499,541,753,532,934,530"/>
<area shape="poly" title=" " alt="" coords="1006,538,1024,541,1086,549,1139,551,1231,551,1275,552,1321,557,1372,569,1430,590,1447,599,1457,610,1467,620,1483,630,1548,653,1616,670,1680,680,1734,686,1734,691,1679,685,1614,675,1546,658,1480,634,1464,624,1454,614,1443,603,1428,594,1370,574,1320,562,1274,557,1231,556,1139,557,1086,554,1024,547,1005,543"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="1493,599,1576,625"/>
<area shape="poly" title=" " alt="" coords="1006,538,1024,541,1151,556,1250,562,1349,569,1475,589,1489,593,1488,598,1474,595,1349,574,1250,567,1150,562,1024,547,1005,543"/>
<area shape="rect" title=" " alt="" coords="942,592,1085,632"/>
<area shape="poly" title=" " alt="" coords="978,543,998,579,994,581,974,545"/>
<area shape="rect" title=" " alt="" coords="1109,592,1251,632"/>
<area shape="poly" title=" " alt="" coords="1001,542,1118,585,1116,590,999,547"/>
<area shape="rect" title=" " alt="" coords="1275,592,1418,632"/>
<area shape="poly" title=" " alt="" coords="1006,538,1025,541,1262,589,1261,594,1023,547,1005,543"/>
<area shape="rect" title=" " alt="" coords="145,599,322,625"/>
<area shape="poly" title=" " alt="" coords="934,538,683,556,510,573,334,595,303,600,302,594,333,589,509,568,682,551,933,532"/>
<area shape="rect" title=" " alt="" coords="346,599,537,625"/>
<area shape="poly" title=" " alt="" coords="934,540,550,595,519,600,518,594,549,589,934,535"/>
<area shape="rect" title=" " alt="" coords="561,599,711,625"/>
<area shape="poly" title=" " alt="" coords="934,544,699,599,698,594,933,538"/>
<area shape="rect" title=" " alt="" coords="735,599,918,625"/>
<area shape="poly" title=" " alt="" coords="950,547,861,595,858,590,947,542"/>
<area shape="poly" title=" " alt="" coords="1494,625,1430,635,1238,653,1043,667,667,685,352,693,152,694,152,689,352,687,666,680,1043,662,1238,648,1429,629,1493,619"/>
<area shape="poly" title=" " alt="" coords="1572,622,1740,673,1738,678,1571,627"/>
<area shape="poly" title=" " alt="" coords="1375,322,1462,364,1460,368,1373,326"/>
<area shape="poly" title=" " alt="" coords="1315,326,1258,346,1195,374,1136,409,1081,446,995,512,992,508,1078,442,1134,404,1192,370,1256,341,1314,321"/>
<area shape="poly" title=" " alt="" coords="1365,322,1407,370,1445,429,1479,489,1526,586,1522,588,1474,491,1441,432,1403,374,1361,326"/>
<area shape="rect" title=" " alt="" coords="1206,372,1394,397"/>
<area shape="poly" title=" " alt="" coords="1344,326,1318,362,1314,359,1340,323"/>
<area shape="rect" href="jet_8h.html" title=" " alt="" coords="1080,372,1131,397"/>
<area shape="poly" title=" " alt="" coords="1315,326,1144,375,1143,370,1314,321"/>
<area shape="rect" href="medium_8h.html" title=" " alt="" coords="1651,372,1739,397"/>
<area shape="poly" title=" " alt="" coords="1387,319,1399,321,1638,370,1637,375,1398,327,1386,324"/>
<area shape="poly" title=" " alt="" coords="1080,390,885,402,742,416,587,436,433,462,292,497,232,518,179,541,137,566,107,594,99,610,96,629,101,667,96,668,91,629,94,609,103,590,134,562,177,536,230,513,291,492,432,457,586,430,742,411,884,397,1079,384"/>
<area shape="poly" title=" " alt="" coords="1131,387,1194,395,1704,449,1703,454,1193,400,1130,392"/>
<area shape="poly" title=" " alt="" coords="1801,463,1851,481,1874,497,1893,517,1902,539,1902,561,1896,583,1884,605,1852,644,1818,674,1814,670,1848,640,1880,602,1891,581,1897,560,1897,540,1888,520,1871,501,1848,486,1800,468"/>
<area shape="poly" title=" " alt="" coords="1717,466,1019,528,1018,523,1717,460"/>
<area shape="rect" title=" " alt="" coords="1786,519,1878,544"/>
<area shape="poly" title=" " alt="" coords="1773,469,1812,507,1808,511,1769,473"/>
<area shape="rect" title=" " alt="" coords="1702,519,1762,544"/>
<area shape="poly" title=" " alt="" coords="1757,472,1744,507,1739,505,1752,470"/>
<area shape="poly" title=" " alt="" coords="1695,398,1686,461,1686,502,1693,543,1708,580,1729,614,1771,668,1767,671,1724,617,1704,582,1688,545,1681,503,1680,461,1689,397"/>
<area shape="poly" title=" " alt="" coords="1707,396,1741,433,1737,437,1703,399"/>
<area shape="poly" title=" " alt="" coords="1204,96,953,102,767,111,567,124,375,142,212,167,148,182,100,199,69,217,61,227,59,237,59,385,66,400,87,415,120,428,165,441,280,464,417,483,705,511,920,525,920,530,705,516,417,489,279,469,164,446,119,433,84,419,62,404,53,387,53,236,56,225,65,213,97,194,147,177,211,161,374,137,566,118,766,105,953,97,1203,90"/>
<area shape="poly" title=" " alt="" coords="1254,101,1287,121,1317,150,1334,184,1345,221,1353,285,1348,285,1340,222,1329,186,1313,154,1284,125,1251,105"/>
<area shape="rect" title=" " alt="" coords="1069,152,1128,177"/>
<area shape="poly" title=" " alt="" coords="1208,106,1133,147,1131,143,1206,102"/>
<area shape="rect" href="prompt_8h.html" title=" " alt="" coords="991,299,1073,324"/>
<area shape="poly" title=" " alt="" coords="1204,96,1171,100,1131,110,1092,127,1059,154,1042,185,1033,220,1030,255,1031,285,1026,285,1025,255,1027,219,1037,183,1055,150,1089,122,1130,105,1170,95,1204,91"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="1383,152,1494,177"/>
<area shape="poly" title=" " alt="" coords="1253,98,1393,145,1391,150,1251,103"/>
<area shape="rect" title=" " alt="" coords="1153,152,1303,177"/>
<area shape="poly" title=" " alt="" coords="1231,104,1231,138,1225,138,1225,104"/>
<area shape="poly" title=" " alt="" coords="1031,325,979,506,974,504,1026,324"/>
<area shape="poly" title=" " alt="" coords="1037,324,1047,359,1057,378,1070,395,1101,421,1147,448,1264,504,1389,555,1490,592,1488,597,1387,559,1262,508,1144,452,1098,425,1066,399,1052,381,1042,361,1032,325"/>
<area shape="poly" title=" " alt="" coords="1046,322,1085,360,1082,364,1042,326"/>
<area shape="poly" title=" " alt="" coords="1464,175,1552,217,1550,222,1462,180"/>
<area shape="poly" title=" " alt="" coords="1442,178,1445,285,1439,285,1436,178"/>
<area shape="poly" title=" " alt="" coords="1384,179,1260,204,1114,238,1048,257,993,276,956,294,947,303,944,311,944,386,951,451,964,505,959,506,946,452,939,386,939,309,943,300,953,290,991,271,1046,252,1113,233,1259,198,1383,174"/>
<area shape="poly" title=" " alt="" coords="1434,179,1367,288,1362,286,1429,176"/>
<area shape="poly" title=" " alt="" coords="1495,166,1537,172,1583,182,1630,199,1674,223,1693,239,1705,255,1721,298,1723,314,1722,331,1711,361,1706,359,1716,330,1718,315,1716,299,1701,258,1689,243,1670,228,1628,204,1582,187,1536,177,1494,171"/>
</map>
</div>
</div>
<p><a href="inverse-compton_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad89f660f1954e9c12551a19840d656bb" id="r_ad89f660f1954e9c12551a19840d656bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb">eta_rad</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_m, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_c, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> p)</td></tr>
<tr class="separator:ad89f660f1954e9c12551a19840d656bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9474d0630c4e995f6902006749d116" id="r_acd9474d0630c4e995f6902006749d116"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> B, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_com</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> eps_e, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> eps_B, <a class="el" href="structSynElectrons.html">SynElectrons</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;e)</td></tr>
<tr class="separator:acd9474d0630c4e995f6902006749d116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689ca8481a7d3e7e760a3300503f2781" id="r_a689ca8481a7d3e7e760a3300503f2781"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#a689ca8481a7d3e7e760a3300503f2781">compton_cross_section</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> nu)</td></tr>
<tr class="memdesc:a689ca8481a7d3e7e760a3300503f2781"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Compton scattering cross-section as a function of frequency (nu).  <br /></td></tr>
<tr class="separator:a689ca8481a7d3e7e760a3300503f2781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8bb7586cf0642ee2a887483b0f72f5d" id="r_aa8bb7586cf0642ee2a887483b0f72f5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="inverse-compton_8h.html#ab408d6b9a087160261ae396763eaf060">ICPhotonGrid</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#aa8bb7586cf0642ee2a887483b0f72f5d">generate_IC_photons</a> (<a class="el" href="inverse-compton_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="el" href="inverse-compton_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a> KN) <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">noexcept</a></td></tr>
<tr class="memdesc:aa8bb7586cf0642ee2a887483b0f72f5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and generates an IC photon grid from electron and photon distributions.  <br /></td></tr>
<tr class="separator:aa8bb7586cf0642ee2a887483b0f72f5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a330c8cd380f08f2ddce282201dae597b" id="r_a330c8cd380f08f2ddce282201dae597b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#a330c8cd380f08f2ddce282201dae597b">Thomson_cooling</a> (<a class="el" href="inverse-compton_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="el" href="inverse-compton_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>)</td></tr>
<tr class="memdesc:a330c8cd380f08f2ddce282201dae597b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies Thomson cooling to electrons based on photon distribution.  <br /></td></tr>
<tr class="separator:a330c8cd380f08f2ddce282201dae597b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af25c21cb4c714787c8260f220a6c2ee9" id="r_af25c21cb4c714787c8260f220a6c2ee9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8cpp.html#af25c21cb4c714787c8260f220a6c2ee9">KN_cooling</a> (<a class="el" href="inverse-compton_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="el" href="inverse-compton_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>)</td></tr>
<tr class="memdesc:af25c21cb4c714787c8260f220a6c2ee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies Klein-Nishina cooling to electrons based on photon distribution.  <br /></td></tr>
<tr class="separator:af25c21cb4c714787c8260f220a6c2ee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a689ca8481a7d3e7e760a3300503f2781" name="a689ca8481a7d3e7e760a3300503f2781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a689ca8481a7d3e7e760a3300503f2781">&#9670;&#160;</a></span>compton_cross_section()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> compton_cross_section </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>nu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the Compton scattering cross-section as a function of frequency (nu). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nu</td><td>The frequency at which to compute the cross-section </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Compton cross-section </dd></dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00239">239</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  239</span>                                    {</div>
<div class="line"><span class="lineno">  240</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a> / (<a class="code hl_variable" href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a> * <a class="code hl_variable" href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a>) * nu;</div>
<div class="line"><span class="lineno">  241</span>    <span class="comment">/*if (x &lt;= 1) {</span></div>
<div class="line"><span class="lineno">  242</span><span class="comment">        return con::sigmaT;</span></div>
<div class="line"><span class="lineno">  243</span><span class="comment">    } else {</span></div>
<div class="line"><span class="lineno">  244</span><span class="comment">        return 0;</span></div>
<div class="line"><span class="lineno">  245</span><span class="comment">    }*/</span></div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> &lt; 1e-2) {</div>
<div class="line"><span class="lineno">  248</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a> * (1 - 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>);</div>
<div class="line"><span class="lineno">  249</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> &gt; 1e2) {</div>
<div class="line"><span class="lineno">  250</span>        <span class="keywordflow">return</span> 3. / 8 * <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a> * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log</a>(2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) + 0.5) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>;</div>
<div class="line"><span class="lineno">  251</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  252</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_term</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log</a>(1 + 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>);</div>
<div class="line"><span class="lineno">  253</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a> = 1 + 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>;</div>
<div class="line"><span class="lineno">  254</span>        <span class="keywordflow">return</span> 0.75 * <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a> *</div>
<div class="line"><span class="lineno">  255</span>               ((1 + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) * (2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> * (1 + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_term</a>) + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_term</a> / (2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) -</div>
<div class="line"><span class="lineno">  256</span>                (1 + 3 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a>));</div>
<div class="line"><span class="lineno">  257</span>    }</div>
<div class="line"><span class="lineno">  258</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00022">macros.h:22</a></div></div>
<div class="ttc" id="anamespacecon_html_a07ddec20ab09a3078fce714358b65b4b"><div class="ttname"><a href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a></div><div class="ttdeci">constexpr Real h</div><div class="ttdoc">Planck constant in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00087">macros.h:87</a></div></div>
<div class="ttc" id="anamespacecon_html_a26ef2b83dd09c356e324bd243b498764"><div class="ttname"><a href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a></div><div class="ttdeci">constexpr Real c2</div><div class="ttdoc">Speed of light squared.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00082">macros.h:82</a></div></div>
<div class="ttc" id="anamespacecon_html_a740c8edb3d4f2d904a1c76002f84fb7e"><div class="ttname"><a href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a></div><div class="ttdeci">constexpr Real me</div><div class="ttdoc">Electron mass in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00084">macros.h:84</a></div></div>
<div class="ttc" id="anamespacecon_html_ad19e5b64c85c3e709fd0944358be97f6"><div class="ttname"><a href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a></div><div class="ttdeci">constexpr Real sigmaT</div><div class="ttdoc">Thomson cross-section in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00092">macros.h:92</a></div></div>
<div class="ttc" id="autilities_8h_html_ab8e81118f023df135835db8cce4f5f42"><div class="ttname"><a href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a></div><div class="ttdeci">T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00287">utilities.h:287</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_cgraph" id="ainverse-compton_8cpp_a689ca8481a7d3e7e760a3300503f2781_cgraph">
<area shape="rect" title="Computes the Compton scattering cross&#45;section as a function of frequency (nu)." alt="" coords="5,29,180,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="228,29,279,55"/>
<area shape="poly" title=" " alt="" coords="180,39,214,39,214,45,180,45"/>
<area shape="poly" title=" " alt="" coords="226,31,221,21,224,11,235,5,253,3,275,6,285,15,281,19,273,11,253,8,237,10,228,15,226,20,231,28"/>
</map>
</div>

</div>
</div>
<a id="acd9474d0630c4e995f6902006749d116" name="acd9474d0630c4e995f6902006749d116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd9474d0630c4e995f6902006749d116">&#9670;&#160;</a></span>compute_Thomson_Y()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> compute_Thomson_Y </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_com</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>eps_e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>eps_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSynElectrons.html">SynElectrons</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00206">206</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  206</span>                                                                                          {</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eta_e</a> = <a class="code hl_function" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb">eta_rad</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_c, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.p);</div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eta_e</a> * eps_e / eps_B;</div>
<div class="line"><span class="lineno">  209</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a> = (std::sqrt(1 + 4 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>) - 1) / 2;</div>
<div class="line"><span class="lineno">  210</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y1</a> = 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>;</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">for</span> (; std::fabs((<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y1</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>) &gt; 1<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>-4;) {</div>
<div class="line"><span class="lineno">  212</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y1</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>;</div>
<div class="line"><span class="lineno">  213</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> gamma_c = <a class="code hl_function" href="synchrotron_8h.html#a52e34d49dd7497d65ea5261e80d615d4">compute_gamma_c</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_com</a>, B, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.Ys, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.p);</div>
<div class="line"><span class="lineno">  214</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eta_e</a> = <a class="code hl_function" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb">eta_rad</a>(<a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.gamma_m, gamma_c, <a class="code hl_variable" href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">e</a>.p);</div>
<div class="line"><span class="lineno">  215</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">eta_e</a> * eps_e / eps_B;</div>
<div class="line"><span class="lineno">  216</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a> = (std::sqrt(1 + 4 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">b</a>) - 1) / 2;</div>
<div class="line"><span class="lineno">  217</span>    }</div>
<div class="line"><span class="lineno">  218</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">Y0</a>;</div>
<div class="line"><span class="lineno">  219</span>}</div>
<div class="ttc" id="ainverse-compton_8cpp_html_ad89f660f1954e9c12551a19840d656bb"><div class="ttname"><a href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb">eta_rad</a></div><div class="ttdeci">Real eta_rad(Real gamma_m, Real gamma_c, Real p)</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8cpp_source.html#l00187">inverse-compton.cpp:187</a></div></div>
<div class="ttc" id="anamespacecon_html_af12a6df01bfe61fa034307dfcaa1fe7f"><div class="ttname"><a href="namespacecon.html#af12a6df01bfe61fa034307dfcaa1fe7f">con::e</a></div><div class="ttdeci">constexpr Real e</div><div class="ttdoc">Elementary charge in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00088">macros.h:88</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_a52e34d49dd7497d65ea5261e80d615d4"><div class="ttname"><a href="synchrotron_8h.html#a52e34d49dd7497d65ea5261e80d615d4">compute_gamma_c</a></div><div class="ttdeci">Real compute_gamma_c(Real t_com, Real B, InverseComptonY const &amp;Ys, Real p)</div><div class="ttdoc">Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00488">synchrotron.cpp:488</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_cgraph" id="ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_cgraph">
<area shape="rect" title=" " alt="" coords="5,101,167,126"/>
<area shape="rect" href="synchrotron_8cpp.html#a2e3e0590c05be72f722acd3b077abd16" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="215,101,365,126"/>
<area shape="poly" title=" " alt="" coords="167,111,201,111,201,116,167,116"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1173,119,1224,145"/>
<area shape="poly" title=" " alt="" coords="116,98,185,71,282,40,395,14,454,6,512,3,951,3,1004,6,1044,16,1081,35,1127,62,1156,83,1180,107,1176,111,1152,88,1124,66,1079,39,1042,21,1003,11,951,8,512,8,454,11,396,19,283,45,186,76,118,103"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="726,207,797,233"/>
<area shape="poly" title=" " alt="" coords="121,123,248,167,330,189,414,207,495,216,577,220,712,220,712,225,577,226,495,222,413,212,329,195,246,172,119,129"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="413,157,613,197"/>
<area shape="poly" title=" " alt="" coords="336,124,431,151,429,156,335,129"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="413,93,613,133"/>
<area shape="poly" title=" " alt="" coords="365,111,399,111,399,116,365,116"/>
<area shape="poly" title=" " alt="" coords="332,98,413,79,510,64,586,57,760,53,951,53,1011,59,1068,74,1120,92,1162,111,1160,116,1118,97,1067,79,1010,64,951,59,760,59,586,62,510,69,414,84,333,103"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="661,93,861,133"/>
<area shape="poly" title=" " alt="" coords="613,111,648,111,648,116,613,116"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="909,194,991,219"/>
<area shape="poly" title=" " alt="" coords="804,131,912,185,910,190,801,136"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="917,98,983,123"/>
<area shape="poly" title=" " alt="" coords="862,109,903,109,904,114,862,115"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1039,145,1125,170"/>
<area shape="poly" title=" " alt="" coords="984,191,1033,173,1035,178,986,196"/>
<area shape="poly" title=" " alt="" coords="978,217,1009,229,1047,238,1087,240,1106,237,1124,230,1144,215,1161,196,1185,156,1190,159,1166,199,1148,219,1127,234,1107,242,1087,245,1046,243,1008,234,976,222"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1041,194,1123,219"/>
<area shape="poly" title=" " alt="" coords="991,204,1027,204,1027,209,991,209"/>
<area shape="poly" title=" " alt="" coords="1125,145,1159,138,1161,143,1126,151"/>
<area shape="poly" title=" " alt="" coords="1179,120,1175,111,1177,102,1185,95,1199,93,1215,96,1222,104,1218,108,1212,101,1199,98,1187,100,1181,104,1180,110,1183,118"/>
<area shape="poly" title=" " alt="" coords="1104,191,1124,179,1167,150,1170,155,1127,184,1107,196"/>
<area shape="poly" title=" " alt="" coords="983,111,1160,126,1159,131,983,116"/>
<area shape="poly" title=" " alt="" coords="797,215,895,208,896,213,797,220"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_icgraph.png" border="0" usemap="#ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_icgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_icgraph" id="ainverse-compton_8cpp_acd9474d0630c4e995f6902006749d116_icgraph">
<area shape="rect" title=" " alt="" coords="189,31,351,56"/>
<area shape="rect" href="inverse-compton_8cpp.html#af25c21cb4c714787c8260f220a6c2ee9" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="26,5,121,31"/>
<area shape="poly" title=" " alt="" coords="175,34,121,27,121,21,176,29"/>
<area shape="rect" href="inverse-compton_8cpp.html#a330c8cd380f08f2ddce282201dae597b" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,55,141,80"/>
<area shape="poly" title=" " alt="" coords="176,57,142,62,142,56,176,52"/>
</map>
</div>

</div>
</div>
<a id="ad89f660f1954e9c12551a19840d656bb" name="ad89f660f1954e9c12551a19840d656bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad89f660f1954e9c12551a19840d656bb">&#9670;&#160;</a></span>eta_rad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> eta_rad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>gamma_c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00187">187</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  187</span>                                                        {</div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">return</span> gamma_c &lt; gamma_m ? 1 : <a class="code hl_function" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404">fast_pow</a>(gamma_c / gamma_m, (2 - p));</div>
<div class="line"><span class="lineno">  189</span>}</div>
<div class="ttc" id="autilities_8h_html_a4520a27a10a2aef33c99ad8c679da404"><div class="ttname"><a href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404">fast_pow</a></div><div class="ttdeci">Real fast_pow(Real a, Real b)</div><div class="ttdoc">Fast approximation of a raised to the power of b.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00448">utilities.h:448</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_cgraph" id="ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,76,81"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="124,56,205,81"/>
<area shape="poly" title=" " alt="" coords="76,66,110,66,110,71,76,71"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="253,5,340,31"/>
<area shape="poly" title=" " alt="" coords="198,53,249,33,251,38,200,58"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="388,56,439,81"/>
<area shape="poly" title=" " alt="" coords="206,66,374,66,374,71,206,71"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="255,107,338,132"/>
<area shape="poly" title=" " alt="" coords="200,79,251,99,249,104,198,84"/>
<area shape="poly" title=" " alt="" coords="328,28,376,50,374,55,326,33"/>
<area shape="poly" title=" " alt="" coords="393,57,389,48,391,38,400,32,413,29,429,33,436,41,432,45,427,37,413,35,402,37,396,41,395,47,398,55"/>
<area shape="poly" title=" " alt="" coords="326,104,374,83,376,87,328,109"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_icgraph.png" border="0" usemap="#ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_icgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_icgraph" id="ainverse-compton_8cpp_ad89f660f1954e9c12551a19840d656bb_icgraph">
<area shape="rect" title=" " alt="" coords="399,31,469,56"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="189,31,351,56"/>
<area shape="poly" title=" " alt="" coords="385,46,351,46,351,41,385,41"/>
<area shape="rect" href="inverse-compton_8cpp.html#af25c21cb4c714787c8260f220a6c2ee9" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="26,5,121,31"/>
<area shape="poly" title=" " alt="" coords="175,34,121,27,121,21,176,29"/>
<area shape="rect" href="inverse-compton_8cpp.html#a330c8cd380f08f2ddce282201dae597b" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,55,141,80"/>
<area shape="poly" title=" " alt="" coords="176,57,142,62,142,56,176,52"/>
</map>
</div>

</div>
</div>
<a id="aa8bb7586cf0642ee2a887483b0f72f5d" name="aa8bb7586cf0642ee2a887483b0f72f5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8bb7586cf0642ee2a887483b0f72f5d">&#9670;&#160;</a></span>generate_IC_photons()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="inverse-compton_8h.html#ab408d6b9a087160261ae396763eaf060">ICPhotonGrid</a> generate_IC_photons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="inverse-compton_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="inverse-compton_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a>&#160;</td>
          <td class="paramname"><em>KN</em> = <code><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">true</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and generates an IC photon grid from electron and photon distributions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 3D grid of IC photons </dd></dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00260">260</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  260</span>                                                                                                                   {</div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordtype">size_t</span> t_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  264</span>    <a class="code hl_typedef" href="inverse-compton_8h.html#ab408d6b9a087160261ae396763eaf060">ICPhotonGrid</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>({phi_size, theta_size, t_size});</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  267</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  268</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  269</span>                <span class="comment">// Generate the IC photon spectrum for each grid cell.</span></div>
<div class="line"><span class="lineno">  270</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).compute_IC_spectrum(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), KN);</div>
<div class="line"><span class="lineno">  271</span>            }</div>
<div class="line"><span class="lineno">  272</span>        }</div>
<div class="line"><span class="lineno">  273</span>    }</div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>;</div>
<div class="line"><span class="lineno">  275</span>}</div>
<div class="ttc" id="ainverse-compton_8h_html_ab408d6b9a087160261ae396763eaf060"><div class="ttname"><a href="inverse-compton_8h.html#ab408d6b9a087160261ae396763eaf060">ICPhotonGrid</a></div><div class="ttdeci">xt::xtensor&lt; ICPhoton, 3 &gt; ICPhotonGrid</div><div class="ttdoc">Defines a 3D grid (using xt::xtensor) for storing ICPhoton objects.</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8h_source.html#l00301">inverse-compton.h:301</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_aa8bb7586cf0642ee2a887483b0f72f5d_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_aa8bb7586cf0642ee2a887483b0f72f5d_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_aa8bb7586cf0642ee2a887483b0f72f5d_cgraph" id="ainverse-compton_8cpp_aa8bb7586cf0642ee2a887483b0f72f5d_cgraph">
<area shape="rect" title="Creates and generates an IC photon grid from electron and photon distributions." alt="" coords="5,29,164,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="212,29,263,55"/>
<area shape="poly" title=" " alt="" coords="164,39,198,39,198,45,164,45"/>
<area shape="poly" title=" " alt="" coords="212,31,206,21,209,11,220,5,237,3,258,6,267,15,264,19,256,11,237,8,222,10,213,15,212,20,216,28"/>
</map>
</div>

</div>
</div>
<a id="af25c21cb4c714787c8260f220a6c2ee9" name="af25c21cb4c714787c8260f220a6c2ee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af25c21cb4c714787c8260f220a6c2ee9">&#9670;&#160;</a></span>KN_cooling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> KN_cooling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="inverse-compton_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="inverse-compton_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies Klein-Nishina cooling to electrons based on photon distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid to be modified </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
    <tr><td class="paramname">shock</td><td>The shock properties </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00295">295</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  295</span>                                                                                        {</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  297</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_size</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  301</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_size</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  302</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y_T = <a class="code hl_function" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.t_comv(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.rad.eps_e, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.rad.eps_B,</div>
<div class="line"><span class="lineno">  303</span>                                             <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>));</div>
<div class="line"><span class="lineno">  304</span>                <span class="comment">// Clear existing Ys and emplace a new InverseComptonY with additional synchrotron frequency parameters.</span></div>
<div class="line"><span class="lineno">  305</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).Ys =</div>
<div class="line"><span class="lineno">  306</span>                    <a class="code hl_struct" href="structInverseComptonY.html">InverseComptonY</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).nu_m, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).nu_c, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), Y_T);</div>
<div class="line"><span class="lineno">  307</span>            }</div>
<div class="line"><span class="lineno">  308</span>        }</div>
<div class="line"><span class="lineno">  309</span>    }</div>
<div class="line"><span class="lineno">  310</span>    <a class="code hl_function" href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  311</span>    <a class="code hl_function" href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>);</div>
<div class="line"><span class="lineno">  312</span>}</div>
<div class="ttc" id="ainverse-compton_8cpp_html_acd9474d0630c4e995f6902006749d116"><div class="ttname"><a href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a></div><div class="ttdeci">Real compute_Thomson_Y(Real B, Real t_com, Real eps_e, Real eps_B, SynElectrons const &amp;e)</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8cpp_source.html#l00206">inverse-compton.cpp:206</a></div></div>
<div class="ttc" id="astructInverseComptonY_html"><div class="ttname"><a href="structInverseComptonY.html">InverseComptonY</a></div><div class="ttdoc">Handles Inverse Compton Y parameter calculations and related threshold values.</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8h_source.html#l00031">inverse-compton.h:31</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_a331f545228d2b18e84e0252510e295f8"><div class="ttname"><a href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a></div><div class="ttdeci">SynPhotonGrid generate_syn_photons(Shock const &amp;shock, SynElectronGrid const &amp;electrons)</div><div class="ttdoc">Creates and returns a new photon grid based on shock and electron grid.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00670">synchrotron.cpp:670</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_af56f9b4417a5f3e717102da3e81a7d37"><div class="ttname"><a href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a></div><div class="ttdeci">void update_electrons_4Y(SynElectronGrid &amp;electrons, Shock const &amp;shock)</div><div class="ttdoc">Updates electron properties throughout the grid based on shock parameters and IC Y values.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00577">synchrotron.cpp:577</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_af25c21cb4c714787c8260f220a6c2ee9_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_af25c21cb4c714787c8260f220a6c2ee9_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_af25c21cb4c714787c8260f220a6c2ee9_cgraph" id="ainverse-compton_8cpp_af25c21cb4c714787c8260f220a6c2ee9_cgraph">
<area shape="rect" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="5,107,100,133"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="148,186,309,211"/>
<area shape="poly" title=" " alt="" coords="83,130,188,178,185,183,81,135"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1444,434,1495,459"/>
<area shape="poly" title=" " alt="" coords="78,105,141,76,232,43,338,14,393,6,449,3,1172,3,1219,10,1291,28,1360,49,1398,67,1415,95,1429,134,1450,235,1463,340,1469,420,1464,420,1457,340,1444,236,1424,136,1410,97,1394,71,1358,54,1290,33,1218,15,1171,8,449,8,394,11,339,20,233,48,143,81,80,110"/>
<area shape="rect" href="synchrotron_8cpp.html#a331f545228d2b18e84e0252510e295f8" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="854,67,1023,93"/>
<area shape="poly" title=" " alt="" coords="100,115,840,82,840,87,100,121"/>
<area shape="rect" href="synchrotron_8cpp.html#af56f9b4417a5f3e717102da3e81a7d37" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="150,395,307,421"/>
<area shape="poly" title=" " alt="" coords="64,131,215,382,210,385,59,134"/>
<area shape="rect" href="synchrotron_8cpp.html#a2e3e0590c05be72f722acd3b077abd16" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="375,226,525,251"/>
<area shape="poly" title=" " alt="" coords="300,209,366,221,365,226,299,214"/>
<area shape="poly" title=" " alt="" coords="281,183,360,166,461,148,574,134,689,128,1172,128,1222,141,1294,171,1362,205,1398,227,1429,275,1450,328,1462,379,1469,419,1463,420,1457,380,1445,329,1425,277,1394,231,1359,209,1292,176,1221,146,1171,133,689,133,575,139,462,154,361,172,282,189"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="655,398,726,423"/>
<area shape="poly" title=" " alt="" coords="241,210,288,264,321,295,359,322,432,355,510,379,582,395,642,403,641,409,581,400,508,384,430,360,356,326,318,299,284,268,237,213"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="591,219,791,259"/>
<area shape="poly" title=" " alt="" coords="525,236,577,236,577,241,525,241"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="591,333,791,373"/>
<area shape="poly" title=" " alt="" coords="487,249,544,272,644,324,642,329,542,277,485,254"/>
<area shape="poly" title=" " alt="" coords="498,223,590,204,763,183,937,179,1171,179,1243,184,1271,191,1297,202,1345,235,1398,285,1423,317,1442,354,1465,420,1460,422,1437,356,1419,320,1394,288,1342,239,1295,207,1270,196,1242,189,1171,184,937,184,764,188,591,209,499,229"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="839,333,1039,373"/>
<area shape="poly" title=" " alt="" coords="791,351,825,351,825,356,791,356"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="1129,398,1211,423"/>
<area shape="poly" title=" " alt="" coords="1021,371,1116,395,1115,400,1019,376"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="1316,334,1381,359"/>
<area shape="poly" title=" " alt="" coords="1039,349,1302,345,1302,350,1039,354"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1305,383,1392,409"/>
<area shape="poly" title=" " alt="" coords="1211,405,1291,398,1291,403,1211,410"/>
<area shape="poly" title=" " alt="" coords="1211,413,1431,439,1430,445,1210,418"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1307,485,1390,510"/>
<area shape="poly" title=" " alt="" coords="1208,421,1254,440,1317,475,1314,480,1252,445,1206,426"/>
<area shape="poly" title=" " alt="" coords="1381,406,1432,428,1430,433,1379,411"/>
<area shape="poly" title=" " alt="" coords="1448,435,1444,426,1446,416,1455,410,1469,407,1486,411,1493,419,1489,423,1483,415,1469,413,1457,415,1451,419,1450,425,1453,433"/>
<area shape="poly" title=" " alt="" coords="1379,482,1430,460,1432,465,1381,487"/>
<area shape="poly" title=" " alt="" coords="1380,357,1398,369,1427,395,1451,421,1447,425,1423,398,1394,373,1377,362"/>
<area shape="poly" title=" " alt="" coords="726,408,1115,408,1115,413,726,413"/>
<area shape="poly" title=" " alt="" coords="985,65,1071,48,1124,42,1181,41,1239,45,1296,57,1350,78,1398,110,1415,133,1429,166,1449,254,1462,347,1469,420,1464,421,1457,348,1444,255,1423,168,1410,135,1394,114,1347,82,1294,62,1238,50,1181,46,1124,48,1072,53,986,70"/>
<area shape="poly" title=" " alt="" coords="901,69,893,59,897,49,913,43,939,41,971,45,983,54,980,58,969,49,939,46,914,48,901,53,898,58,905,65"/>
<area shape="poly" title=" " alt="" coords="237,394,284,337,318,303,356,272,392,254,394,259,359,277,321,307,288,340,241,397"/>
<area shape="poly" title=" " alt="" coords="307,396,576,364,577,369,308,401"/>
<area shape="poly" title=" " alt="" coords="297,418,474,444,582,455,689,459,940,459,1100,454,1169,461,1254,486,1269,494,1279,504,1288,513,1302,520,1328,528,1349,531,1370,529,1395,520,1412,510,1427,498,1451,469,1455,473,1431,501,1415,515,1397,525,1371,534,1349,536,1327,533,1300,525,1285,517,1275,508,1266,498,1252,490,1168,466,1100,459,940,464,689,464,581,460,474,450,297,423"/>
<area shape="rect" href="synchrotron_8cpp.html#ad1107cc37702b503577dcadee93e165a" title=" " alt="" coords="848,537,1029,562"/>
<area shape="poly" title=" " alt="" coords="249,419,297,449,358,477,484,510,612,531,732,542,834,546,834,552,732,547,611,536,482,515,356,483,294,454,246,423"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="357,287,543,313"/>
<area shape="poly" title=" " alt="" coords="249,393,356,334,399,315,402,320,359,338,252,397"/>
<area shape="rect" href="synchrotron_8cpp.html#ad0ce654aca1c62f43ae108ca8772ed0f" title=" " alt="" coords="371,566,529,591"/>
<area shape="poly" title=" " alt="" coords="241,419,287,477,321,512,359,542,392,559,389,563,356,546,317,515,283,481,237,422"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="1099,751,1241,777"/>
<area shape="poly" title=" " alt="" coords="237,420,252,457,277,507,312,559,334,582,359,602,449,653,546,693,647,722,748,742,846,756,937,763,1085,765,1085,771,937,768,845,761,747,748,646,727,544,698,447,658,356,606,331,586,308,562,272,510,247,459,232,422"/>
<area shape="poly" title=" " alt="" coords="960,534,1134,428,1137,433,962,539"/>
<area shape="poly" title=" " alt="" coords="967,560,1022,583,1087,604,1176,633,1249,658,1284,663,1318,662,1354,651,1394,628,1412,613,1426,595,1447,553,1459,510,1464,472,1469,473,1464,511,1452,555,1431,598,1416,617,1398,633,1357,656,1319,667,1283,669,1248,663,1175,638,1086,609,1020,588,965,565"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="1099,499,1241,525"/>
<area shape="poly" title=" " alt="" coords="1018,534,1085,523,1086,528,1018,539"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="1087,549,1253,574"/>
<area shape="poly" title=" " alt="" coords="1030,551,1073,554,1073,559,1030,557"/>
<area shape="rect" href="utilities_8h.html#a29a716285d00743072d357c4a64a7f85" title="Finds the root of a function using the bisection method." alt="" coords="1301,593,1396,618"/>
<area shape="poly" title=" " alt="" coords="983,560,1087,584,1193,596,1287,601,1287,607,1192,601,1086,589,981,565"/>
<area shape="poly" title=" " alt="" coords="1366,591,1394,565,1429,516,1454,470,1458,473,1433,519,1398,568,1370,595"/>
<area shape="poly" title=" " alt="" coords="500,285,598,260,599,265,501,290"/>
<area shape="poly" title=" " alt="" coords="509,310,587,328,586,333,508,315"/>
<area shape="poly" title=" " alt="" coords="543,296,937,293,1171,293,1237,290,1290,285,1315,286,1340,292,1367,302,1398,319,1422,341,1440,367,1463,420,1458,422,1436,370,1418,344,1394,323,1365,307,1339,297,1314,292,1290,291,1237,295,1171,299,937,299,543,301"/>
<area shape="rect" href="synchrotron_8cpp.html#a35361f36f8d73e95dffabdc7cb0f3177" title=" " alt="" coords="859,608,1018,648"/>
<area shape="poly" title=" " alt="" coords="530,584,846,616,845,621,529,589"/>
<area shape="poly" title=" " alt="" coords="982,646,1065,679,1117,694,1173,706,1232,712,1289,709,1344,695,1370,684,1394,669,1415,649,1432,626,1444,600,1453,572,1463,518,1466,473,1471,474,1469,519,1458,574,1449,602,1436,629,1419,653,1398,673,1373,688,1346,700,1290,714,1231,717,1173,712,1116,700,1063,684,980,651"/>
<area shape="poly" title=" " alt="" coords="1242,770,1280,770,1321,765,1360,752,1394,730,1407,712,1420,685,1440,613,1454,535,1462,472,1468,473,1459,536,1445,614,1425,687,1412,715,1398,734,1363,757,1322,770,1281,775,1242,776"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="1321,802,1377,827"/>
<area shape="poly" title=" " alt="" coords="1216,774,1308,801,1307,806,1215,779"/>
<area shape="poly" title=" " alt="" coords="1374,800,1394,781,1416,742,1433,700,1455,613,1464,533,1466,473,1471,473,1469,533,1460,614,1438,702,1421,744,1398,784,1377,804"/>
</map>
</div>

</div>
</div>
<a id="a330c8cd380f08f2ddce282201dae597b" name="a330c8cd380f08f2ddce282201dae597b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a330c8cd380f08f2ddce282201dae597b">&#9670;&#160;</a></span>Thomson_cooling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> Thomson_cooling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="inverse-compton_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="inverse-compton_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies Thomson cooling to electrons based on photon distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid to be modified </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
    <tr><td class="paramname">shock</td><td>The shock properties </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00277">277</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  277</span>                                                                                             {</div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  279</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordtype">size_t</span> t_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>++) {</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  284</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  285</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y_T = <a class="code hl_function" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.t_comv(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.rad.eps_e, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.rad.eps_B,</div>
<div class="line"><span class="lineno">  286</span>                                             <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>));</div>
<div class="line"><span class="lineno">  287</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).Ys = <a class="code hl_struct" href="structInverseComptonY.html">InverseComptonY</a>(Y_T);</div>
<div class="line"><span class="lineno">  288</span>            }</div>
<div class="line"><span class="lineno">  289</span>        }</div>
<div class="line"><span class="lineno">  290</span>    }</div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_function" href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  292</span>    <a class="code hl_function" href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>);</div>
<div class="line"><span class="lineno">  293</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8cpp_a330c8cd380f08f2ddce282201dae597b_cgraph.png" border="0" usemap="#ainverse-compton_8cpp_a330c8cd380f08f2ddce282201dae597b_cgraph" alt=""/></div>
<map name="ainverse-compton_8cpp_a330c8cd380f08f2ddce282201dae597b_cgraph" id="ainverse-compton_8cpp_a330c8cd380f08f2ddce282201dae597b_cgraph">
<area shape="rect" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,107,141,133"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="189,186,351,211"/>
<area shape="poly" title=" " alt="" coords="107,130,225,178,223,183,105,135"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1485,434,1536,459"/>
<area shape="poly" title=" " alt="" coords="100,105,167,76,262,43,374,14,432,6,490,3,1213,3,1260,10,1332,28,1401,49,1439,67,1456,95,1470,134,1491,235,1504,340,1510,420,1505,420,1499,340,1486,236,1465,136,1451,97,1436,71,1399,54,1331,33,1259,15,1212,8,490,8,433,11,375,20,264,48,169,81,102,110"/>
<area shape="rect" href="synchrotron_8cpp.html#a331f545228d2b18e84e0252510e295f8" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="895,67,1065,93"/>
<area shape="poly" title=" " alt="" coords="141,114,882,82,882,87,142,120"/>
<area shape="rect" href="synchrotron_8cpp.html#af56f9b4417a5f3e717102da3e81a7d37" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="191,395,349,421"/>
<area shape="poly" title=" " alt="" coords="85,131,254,382,250,385,81,134"/>
<area shape="rect" href="synchrotron_8cpp.html#a2e3e0590c05be72f722acd3b077abd16" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="416,226,567,251"/>
<area shape="poly" title=" " alt="" coords="342,209,408,221,407,226,341,214"/>
<area shape="poly" title=" " alt="" coords="322,183,401,166,502,148,616,134,731,128,1213,128,1264,141,1336,171,1403,205,1439,227,1471,275,1492,328,1504,379,1510,419,1505,420,1499,380,1486,329,1466,277,1435,231,1400,209,1334,176,1262,146,1212,133,731,133,616,139,503,154,402,172,324,189"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="697,398,767,423"/>
<area shape="poly" title=" " alt="" coords="283,210,329,264,362,295,400,322,474,355,551,379,624,395,683,403,683,409,623,400,550,384,472,360,397,326,359,299,325,268,279,213"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="632,219,832,259"/>
<area shape="poly" title=" " alt="" coords="567,236,618,236,618,241,567,241"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="632,333,832,373"/>
<area shape="poly" title=" " alt="" coords="529,249,585,272,685,324,683,329,583,277,527,254"/>
<area shape="poly" title=" " alt="" coords="539,223,632,204,804,183,979,179,1213,179,1284,184,1313,191,1339,202,1387,235,1439,285,1465,317,1484,354,1506,420,1501,422,1479,356,1460,320,1435,288,1383,239,1336,207,1311,196,1283,189,1213,184,979,184,805,188,632,209,541,229"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="880,333,1080,373"/>
<area shape="poly" title=" " alt="" coords="832,351,866,351,866,356,832,356"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="1171,398,1252,423"/>
<area shape="poly" title=" " alt="" coords="1062,371,1158,395,1156,400,1061,376"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="1357,334,1423,359"/>
<area shape="poly" title=" " alt="" coords="1080,349,1344,345,1344,350,1081,354"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1347,383,1433,409"/>
<area shape="poly" title=" " alt="" coords="1252,405,1332,398,1333,403,1252,410"/>
<area shape="poly" title=" " alt="" coords="1252,413,1472,439,1471,445,1252,418"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1349,485,1431,510"/>
<area shape="poly" title=" " alt="" coords="1250,421,1296,440,1358,475,1356,480,1294,445,1248,426"/>
<area shape="poly" title=" " alt="" coords="1422,406,1474,428,1472,433,1420,411"/>
<area shape="poly" title=" " alt="" coords="1490,435,1486,426,1488,416,1496,410,1511,407,1527,411,1535,419,1531,423,1525,415,1511,413,1499,415,1492,419,1491,425,1495,433"/>
<area shape="poly" title=" " alt="" coords="1420,482,1472,460,1474,465,1422,487"/>
<area shape="poly" title=" " alt="" coords="1421,357,1439,369,1468,395,1492,421,1488,425,1464,398,1436,373,1418,362"/>
<area shape="poly" title=" " alt="" coords="768,408,1157,408,1157,413,768,413"/>
<area shape="poly" title=" " alt="" coords="1026,65,1112,48,1165,42,1222,41,1280,45,1337,57,1391,78,1439,110,1456,133,1470,166,1491,254,1504,347,1510,420,1505,421,1498,348,1485,255,1465,168,1451,135,1435,114,1389,82,1336,62,1279,50,1222,46,1166,48,1113,53,1027,70"/>
<area shape="poly" title=" " alt="" coords="943,69,935,59,939,49,954,43,980,41,1012,45,1025,54,1021,58,1010,49,980,46,955,48,942,53,940,58,947,65"/>
<area shape="poly" title=" " alt="" coords="278,394,325,337,359,303,397,272,433,254,435,259,400,277,363,307,329,340,283,397"/>
<area shape="poly" title=" " alt="" coords="348,396,618,364,618,369,349,401"/>
<area shape="poly" title=" " alt="" coords="339,418,516,444,623,455,731,459,981,459,1141,454,1211,461,1296,486,1311,494,1320,504,1330,513,1344,520,1369,528,1391,531,1411,529,1436,520,1453,510,1468,498,1492,469,1496,473,1472,501,1456,515,1438,525,1412,534,1390,536,1368,533,1342,525,1327,517,1317,508,1307,498,1294,490,1210,466,1141,459,981,464,731,464,623,460,515,450,338,423"/>
<area shape="rect" href="synchrotron_8cpp.html#ad1107cc37702b503577dcadee93e165a" title=" " alt="" coords="889,537,1071,562"/>
<area shape="poly" title=" " alt="" coords="290,419,338,449,400,477,525,510,653,531,774,542,875,546,875,552,773,547,653,536,524,515,398,483,335,454,287,423"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="399,287,584,313"/>
<area shape="poly" title=" " alt="" coords="291,393,397,334,441,315,443,320,400,338,293,397"/>
<area shape="rect" href="synchrotron_8cpp.html#ad0ce654aca1c62f43ae108ca8772ed0f" title=" " alt="" coords="412,566,571,591"/>
<area shape="poly" title=" " alt="" coords="282,419,329,477,362,512,400,542,433,559,430,563,397,546,359,515,325,481,278,422"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="1140,751,1283,777"/>
<area shape="poly" title=" " alt="" coords="278,420,293,457,318,507,354,559,376,582,400,602,490,653,587,693,688,722,790,742,887,756,978,763,1126,765,1126,771,978,768,887,761,789,748,687,727,586,698,488,658,397,606,372,586,350,562,313,510,288,459,273,422"/>
<area shape="poly" title=" " alt="" coords="1001,534,1176,428,1179,433,1004,539"/>
<area shape="poly" title=" " alt="" coords="1009,560,1063,583,1129,604,1218,633,1291,658,1325,663,1359,662,1396,651,1436,628,1453,613,1468,595,1488,553,1500,510,1505,472,1511,473,1505,511,1493,555,1472,598,1457,617,1439,633,1398,656,1360,667,1325,669,1290,663,1216,638,1127,609,1061,588,1007,565"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="1140,499,1283,525"/>
<area shape="poly" title=" " alt="" coords="1059,534,1126,523,1127,528,1060,539"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="1128,549,1295,574"/>
<area shape="poly" title=" " alt="" coords="1071,551,1115,554,1114,559,1071,557"/>
<area shape="rect" href="utilities_8h.html#a29a716285d00743072d357c4a64a7f85" title="Finds the root of a function using the bisection method." alt="" coords="1343,593,1437,618"/>
<area shape="poly" title=" " alt="" coords="1024,560,1128,584,1234,596,1329,601,1329,607,1234,601,1128,589,1023,565"/>
<area shape="poly" title=" " alt="" coords="1407,591,1435,565,1470,516,1495,470,1500,473,1474,519,1439,568,1411,595"/>
<area shape="poly" title=" " alt="" coords="541,285,639,260,640,265,543,290"/>
<area shape="poly" title=" " alt="" coords="550,310,629,328,627,333,549,315"/>
<area shape="poly" title=" " alt="" coords="584,296,979,293,1213,293,1278,290,1331,285,1356,286,1382,292,1409,302,1439,319,1463,341,1482,367,1505,420,1500,422,1477,370,1459,344,1436,323,1407,307,1380,297,1356,292,1331,291,1279,295,1213,299,979,299,584,301"/>
<area shape="rect" href="synchrotron_8cpp.html#a35361f36f8d73e95dffabdc7cb0f3177" title=" " alt="" coords="901,608,1059,648"/>
<area shape="poly" title=" " alt="" coords="571,584,887,616,886,621,570,589"/>
<area shape="poly" title=" " alt="" coords="1023,646,1106,679,1158,694,1215,706,1273,712,1331,709,1386,695,1411,684,1436,669,1457,649,1473,626,1485,600,1495,572,1505,518,1507,473,1513,474,1510,519,1500,574,1490,602,1478,629,1461,653,1439,673,1414,688,1387,700,1331,714,1273,717,1214,712,1157,700,1104,684,1021,651"/>
<area shape="poly" title=" " alt="" coords="1283,770,1322,770,1362,765,1402,752,1436,730,1449,712,1461,685,1481,613,1495,535,1504,472,1509,473,1501,536,1486,614,1466,687,1453,715,1439,734,1404,757,1364,770,1322,775,1283,776"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="1362,802,1418,827"/>
<area shape="poly" title=" " alt="" coords="1258,774,1350,801,1348,806,1256,779"/>
<area shape="poly" title=" " alt="" coords="1415,800,1435,781,1457,742,1474,700,1496,613,1505,533,1507,473,1513,473,1511,533,1501,614,1479,702,1462,744,1439,784,1419,804"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4ecbb2552d02e976219f567964484fc4.html">radiation</a></li><li class="navelem"><a class="el" href="inverse-compton_8cpp.html">inverse-compton.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
