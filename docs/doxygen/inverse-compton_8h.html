<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: inverse-compton.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('inverse-compton_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">inverse-compton.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;array&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;tuple&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="medium_8h_source.html">medium.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mesh_8h_source.html">mesh.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="shock_8h_source.html">shock.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="synchrotron_8h_source.html">synchrotron.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for inverse-compton.h:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h__incl.png" border="0" usemap="#ainverse-compton_8h" alt=""/></div>
<map name="ainverse-compton_8h" id="ainverse-compton_8h">
<area shape="rect" title=" " alt="" coords="1481,5,1625,31"/>
<area shape="rect" title=" " alt="" coords="853,79,909,104"/>
<area shape="poly" title=" " alt="" coords="1481,25,1235,43,1081,59,928,81,923,82,922,77,927,76,1081,54,1234,38,1480,20"/>
<area shape="rect" title=" " alt="" coords="1303,526,1365,551"/>
<area shape="poly" title=" " alt="" coords="1481,27,1354,42,1212,68,1148,86,1097,108,1062,134,1053,148,1050,164,1050,239,1057,290,1078,336,1107,379,1144,416,1185,450,1226,478,1297,518,1295,522,1223,482,1181,454,1141,420,1103,382,1073,339,1052,291,1045,240,1045,163,1048,146,1058,131,1094,104,1147,81,1211,63,1353,37,1480,22"/>
<area shape="rect" title=" " alt="" coords="1608,225,1663,251"/>
<area shape="poly" title=" " alt="" coords="1564,29,1596,77,1615,113,1627,151,1637,211,1631,212,1622,153,1610,115,1592,80,1559,32"/>
<area shape="rect" title=" " alt="" coords="1549,152,1612,177"/>
<area shape="poly" title=" " alt="" coords="1560,30,1577,78,1583,138,1578,138,1571,79,1555,32"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="1391,526,1474,551"/>
<area shape="poly" title=" " alt="" coords="1625,27,1684,43,1742,69,1767,87,1787,108,1800,134,1805,163,1805,386,1802,399,1795,412,1769,435,1731,457,1684,476,1581,508,1488,529,1487,524,1579,503,1682,471,1728,452,1766,431,1791,409,1797,397,1799,386,1799,164,1795,135,1782,111,1764,91,1740,74,1683,48,1624,32"/>
<area shape="rect" href="medium_8h.html" title=" " alt="" coords="1494,299,1582,324"/>
<area shape="poly" title=" " alt="" coords="1569,29,1612,67,1659,122,1678,154,1689,187,1690,220,1678,252,1661,271,1641,285,1596,303,1594,298,1638,280,1658,267,1673,249,1685,219,1684,188,1673,156,1655,125,1608,70,1566,33"/>
<area shape="rect" href="utilities_8h.html" title=" " alt="" coords="1497,372,1579,397"/>
<area shape="poly" title=" " alt="" coords="1600,28,1648,46,1699,73,1720,91,1738,112,1750,136,1754,163,1754,240,1750,267,1738,291,1720,312,1697,330,1645,357,1593,374,1592,369,1643,352,1694,326,1716,308,1733,288,1745,265,1749,239,1749,164,1745,138,1734,115,1717,95,1696,78,1646,51,1598,33"/>
<area shape="rect" href="mesh_8h.html" title=" " alt="" coords="961,445,1032,471"/>
<area shape="poly" title=" " alt="" coords="1480,24,1368,30,1237,40,1115,57,1066,68,1030,81,997,97,971,112,955,132,949,164,949,313,952,346,961,378,985,432,981,434,956,380,947,347,943,313,943,163,950,130,968,108,995,92,1028,76,1065,63,1114,52,1237,35,1368,25,1480,19"/>
<area shape="rect" href="shock_8h.html" title=" " alt="" coords="1390,152,1462,177"/>
<area shape="poly" title=" " alt="" coords="1512,33,1474,51,1456,64,1442,80,1430,109,1427,138,1422,138,1425,107,1437,77,1452,60,1471,47,1510,28"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="1451,79,1561,104"/>
<area shape="poly" title=" " alt="" coords="1547,32,1523,69,1519,66,1543,30"/>
<area shape="rect" title=" " alt="" coords="1358,607,1417,632"/>
<area shape="poly" title=" " alt="" coords="1428,553,1403,596,1399,593,1424,550"/>
<area shape="rect" title=" " alt="" coords="1441,607,1515,632"/>
<area shape="poly" title=" " alt="" coords="1442,550,1467,593,1462,596,1437,553"/>
<area shape="poly" title=" " alt="" coords="1527,326,1506,347,1487,373,1469,409,1456,447,1439,513,1434,512,1451,446,1464,407,1482,371,1502,344,1523,322"/>
<area shape="poly" title=" " alt="" coords="1541,324,1541,358,1535,358,1535,324"/>
<area shape="poly" title=" " alt="" coords="1580,394,1616,407,1647,423,1659,434,1667,445,1668,459,1661,472,1634,492,1589,509,1488,531,1487,526,1588,504,1631,488,1657,469,1663,458,1662,447,1655,437,1644,428,1613,411,1579,399"/>
<area shape="rect" title=" " alt="" coords="1471,445,1563,471"/>
<area shape="poly" title=" " alt="" coords="1537,398,1527,433,1521,431,1532,397"/>
<area shape="rect" title=" " alt="" coords="1587,445,1647,471"/>
<area shape="poly" title=" " alt="" coords="1552,395,1596,434,1592,438,1549,399"/>
<area shape="poly" title=" " alt="" coords="1497,394,1046,453,1045,448,1496,389"/>
<area shape="poly" title=" " alt="" coords="1032,461,1148,481,1220,497,1291,516,1298,518,1296,523,1289,521,1218,502,1147,486,1032,467"/>
<area shape="poly" title=" " alt="" coords="1033,460,1184,479,1281,495,1379,516,1390,519,1389,524,1377,521,1280,501,1183,484,1032,465"/>
<area shape="rect" title=" " alt="" coords="5,519,148,559"/>
<area shape="poly" title=" " alt="" coords="961,463,832,466,637,476,404,493,162,521,162,516,404,488,637,470,832,461,961,457"/>
<area shape="rect" title=" " alt="" coords="172,519,315,559"/>
<area shape="poly" title=" " alt="" coords="961,463,701,480,519,497,329,521,328,516,518,491,701,474,961,458"/>
<area shape="rect" title=" " alt="" coords="339,519,481,559"/>
<area shape="poly" title=" " alt="" coords="961,465,767,484,634,500,496,521,495,516,633,495,766,479,961,460"/>
<area shape="rect" title=" " alt="" coords="505,526,683,551"/>
<area shape="poly" title=" " alt="" coords="962,469,667,526,666,521,961,464"/>
<area shape="rect" title=" " alt="" coords="707,526,897,551"/>
<area shape="poly" title=" " alt="" coords="969,473,844,523,842,518,967,468"/>
<area shape="rect" title=" " alt="" coords="922,526,1071,551"/>
<area shape="poly" title=" " alt="" coords="999,471,999,512,994,512,994,471"/>
<area shape="rect" title=" " alt="" coords="1096,526,1279,551"/>
<area shape="poly" title=" " alt="" coords="1025,468,1148,518,1146,523,1023,473"/>
<area shape="poly" title=" " alt="" coords="1460,175,1596,220,1594,226,1459,180"/>
<area shape="poly" title=" " alt="" coords="1437,176,1523,286,1519,290,1433,179"/>
<area shape="poly" title=" " alt="" coords="1390,172,1246,191,1174,207,1145,217,1125,227,1111,242,1095,263,1062,320,1009,433,1004,431,1057,318,1091,260,1107,238,1122,223,1143,212,1172,202,1245,186,1389,167"/>
<area shape="rect" title=" " alt="" coords="1243,225,1431,251"/>
<area shape="poly" title=" " alt="" coords="1413,179,1364,219,1360,214,1410,175"/>
<area shape="rect" href="jet_8h.html" title=" " alt="" coords="1419,299,1470,324"/>
<area shape="poly" title=" " alt="" coords="1433,177,1446,225,1449,285,1443,285,1441,226,1428,178"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="1135,225,1218,251"/>
<area shape="poly" title=" " alt="" coords="1390,179,1230,224,1229,219,1389,174"/>
<area shape="poly" title=" " alt="" coords="1441,325,1348,514,1343,512,1437,323"/>
<area shape="poly" title=" " alt="" coords="1461,322,1514,361,1510,366,1458,326"/>
<area shape="poly" title=" " alt="" coords="1185,250,1324,512,1319,515,1180,252"/>
<area shape="poly" title=" " alt="" coords="1190,249,1236,297,1340,418,1417,513,1413,517,1336,422,1232,300,1186,253"/>
<area shape="poly" title=" " alt="" coords="1219,246,1231,248,1481,296,1480,301,1229,253,1218,251"/>
<area shape="poly" title=" " alt="" coords="1174,252,1140,318,1113,360,1081,399,1056,422,1030,440,1027,436,1053,417,1077,396,1109,357,1135,315,1169,249"/>
<area shape="poly" title=" " alt="" coords="1219,248,1407,297,1406,302,1218,253"/>
<area shape="poly" title=" " alt="" coords="1520,102,1560,141,1557,144,1516,106"/>
<area shape="poly" title=" " alt="" coords="1510,104,1537,285,1532,285,1505,105"/>
<area shape="poly" title=" " alt="" coords="1451,101,1375,113,1282,136,1234,153,1186,173,1140,198,1098,227,1076,249,1057,275,1029,332,1011,388,1002,432,997,431,1006,386,1024,330,1052,272,1072,246,1095,223,1137,193,1184,168,1232,148,1281,131,1374,108,1450,95"/>
<area shape="poly" title=" " alt="" coords="1495,106,1451,145,1447,141,1491,102"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h__dep__incl.png" border="0" usemap="#ainverse-compton_8hdep" alt=""/></div>
<map name="ainverse-compton_8hdep" id="ainverse-compton_8hdep">
<area shape="rect" title=" " alt="" coords="334,5,478,31"/>
<area shape="rect" href="afterglow_8h.html" title=" " alt="" coords="200,79,295,104"/>
<area shape="poly" title=" " alt="" coords="369,39,274,81,272,76,367,34"/>
<area shape="rect" href="synchrotron_8cpp.html" title=" " alt="" coords="416,152,543,177"/>
<area shape="poly" title=" " alt="" coords="414,44,422,73,435,103,452,129,470,150,466,154,448,132,430,105,417,74,409,45"/>
<area shape="rect" href="inverse-compton_8cpp.html" title=" " alt="" coords="444,79,603,104"/>
<area shape="poly" title=" " alt="" coords="438,35,506,76,503,81,435,40"/>
<area shape="rect" href="mcmc_8h.html" title=" " alt="" coords="317,152,391,177"/>
<area shape="poly" title=" " alt="" coords="277,109,338,150,335,154,274,114"/>
<area shape="rect" href="observer_8h.html" title=" " alt="" coords="37,152,127,177"/>
<area shape="poly" title=" " alt="" coords="203,111,103,154,101,149,200,106"/>
<area shape="rect" href="pymodel_8cpp.html" title=" " alt="" coords="135,225,242,251"/>
<area shape="poly" title=" " alt="" coords="222,114,205,132,192,153,187,172,186,191,189,225,184,225,181,191,182,171,188,151,201,129,219,111"/>
<area shape="rect" href="pymodel_8h.html" title=" " alt="" coords="202,152,293,177"/>
<area shape="poly" title=" " alt="" coords="250,118,250,152,245,152,245,118"/>
<area shape="poly" title=" " alt="" coords="298,105,443,149,441,154,297,110"/>
<area shape="rect" href="mcmc_8cpp.html" title=" " alt="" coords="384,225,473,251"/>
<area shape="poly" title=" " alt="" coords="378,185,418,223,415,227,374,189"/>
<area shape="rect" href="pybind_8cpp.html" title=" " alt="" coords="266,225,359,251"/>
<area shape="poly" title=" " alt="" coords="343,191,322,227,317,224,338,188"/>
<area shape="poly" title=" " alt="" coords="127,144,227,102,229,106,129,149"/>
<area shape="rect" href="observer_8cpp.html" title=" " alt="" coords="5,225,111,251"/>
<area shape="poly" title=" " alt="" coords="76,191,64,226,59,224,71,189"/>
<area shape="poly" title=" " alt="" coords="269,186,304,223,300,227,265,189"/>
<area shape="poly" title=" " alt="" coords="231,190,200,227,196,224,227,186"/>
</map>
</div>
</div>
<p><a href="inverse-compton_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structIntegratorGrid.html">IntegratorGrid</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a grid for numerical integration in log-space.  <a href="structIntegratorGrid.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structICPhoton.html">ICPhoton</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a single inverse Compton (IC) photon.  <a href="structICPhoton.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:adcfaf3d2807fe6de421ca3e9c5332252" id="r_adcfaf3d2807fe6de421ca3e9c5332252"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a> = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt; <a class="el" href="structICPhoton.html">ICPhoton</a>, 3 &gt;</td></tr>
<tr class="memdesc:adcfaf3d2807fe6de421ca3e9c5332252"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a 3D grid (using xt::xtensor) for storing <a class="el" href="structICPhoton.html" title="Represents a single inverse Compton (IC) photon.">ICPhoton</a> objects.  <br /></td></tr>
<tr class="separator:adcfaf3d2807fe6de421ca3e9c5332252"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a689ca8481a7d3e7e760a3300503f2781" id="r_a689ca8481a7d3e7e760a3300503f2781"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#a689ca8481a7d3e7e760a3300503f2781">compton_cross_section</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> nu)</td></tr>
<tr class="memdesc:a689ca8481a7d3e7e760a3300503f2781"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Compton scattering cross-section as a function of frequency (nu).  <br /></td></tr>
<tr class="separator:a689ca8481a7d3e7e760a3300503f2781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca4102bfefd39902a464c456253645cc" id="r_aca4102bfefd39902a464c456253645cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#aca4102bfefd39902a464c456253645cc">generate_IC_photons</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electron</a>, <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photon</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a> KN=<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">true</a>) <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">noexcept</a></td></tr>
<tr class="memdesc:aca4102bfefd39902a464c456253645cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and generates an IC photon grid from electron and photon distributions.  <br /></td></tr>
<tr class="separator:aca4102bfefd39902a464c456253645cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83d78cd6b52bd3932fb1ae9561a1c148" id="r_a83d78cd6b52bd3932fb1ae9561a1c148"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#a83d78cd6b52bd3932fb1ae9561a1c148">Thomson_cooling</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electron</a>, <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photon</a>, <a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>)</td></tr>
<tr class="memdesc:a83d78cd6b52bd3932fb1ae9561a1c148"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies Thomson cooling to electrons based on photon distribution.  <br /></td></tr>
<tr class="separator:a83d78cd6b52bd3932fb1ae9561a1c148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7dc4640209861b76e05ae991771552e" id="r_ac7dc4640209861b76e05ae991771552e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#ac7dc4640209861b76e05ae991771552e">KN_cooling</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electron</a>, <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photon</a>, <a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>)</td></tr>
<tr class="memdesc:ac7dc4640209861b76e05ae991771552e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies Klein-Nishina cooling to electrons based on photon distribution.  <br /></td></tr>
<tr class="separator:ac7dc4640209861b76e05ae991771552e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2bf720c7c87d960838095b276b09c664" id="r_a2bf720c7c87d960838095b276b09c664"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#a2bf720c7c87d960838095b276b09c664">IC_x0</a> = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::sqrt</a>(2) / 3</td></tr>
<tr class="memdesc:a2bf720c7c87d960838095b276b09c664"><td class="mdescLeft">&#160;</td><td class="mdescRight">A constant used in the IC photon calculation, defined as √2/3.  <br /></td></tr>
<tr class="separator:a2bf720c7c87d960838095b276b09c664"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="adcfaf3d2807fe6de421ca3e9c5332252" name="adcfaf3d2807fe6de421ca3e9c5332252"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcfaf3d2807fe6de421ca3e9c5332252">&#9670;&#160;</a></span>ICPhotonGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines a 3D grid (using xt::xtensor) for storing <a class="el" href="structICPhoton.html" title="Represents a single inverse Compton (IC) photon.">ICPhoton</a> objects. </p>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8h_source.html#l00188">188</a> of file <a class="el" href="inverse-compton_8h_source.html">inverse-compton.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a689ca8481a7d3e7e760a3300503f2781" name="a689ca8481a7d3e7e760a3300503f2781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a689ca8481a7d3e7e760a3300503f2781">&#9670;&#160;</a></span>compton_cross_section()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> compton_cross_section </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>nu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the Compton scattering cross-section as a function of frequency (nu). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nu</td><td>The frequency at which to compute the cross-section </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>For x = (h * nu) / (me * c²) &lt;= 1, returns the Thomson cross-section (<a class="el" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6" title="Thomson cross-section in code units.">con::sigmaT</a>), otherwise 0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00131">131</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  131</span>                                    {</div>
<div class="line"><span class="lineno">  132</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a> / (<a class="code hl_variable" href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a> * <a class="code hl_variable" href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a>) * nu;</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> &lt;= 1) {</div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a>;</div>
<div class="line"><span class="lineno">  135</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  136</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  137</span>    }</div>
<div class="line"><span class="lineno">  138</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  139</span><span class="comment">    if (x &lt; 1e-2) {</span></div>
<div class="line"><span class="lineno">  140</span><span class="comment">         return con::sigmaT * (1 - 2 * x);</span></div>
<div class="line"><span class="lineno">  141</span><span class="comment">     } else if (x &gt; 1e2) {</span></div>
<div class="line"><span class="lineno">  142</span><span class="comment">         return 3. / 8 * con::sigmaT * (log(2 * x) + 1.0 / 2) / x;</span></div>
<div class="line"><span class="lineno">  143</span><span class="comment">     } else {</span></div>
<div class="line"><span class="lineno">  144</span><span class="comment">         return 0.75 * con::sigmaT *</span></div>
<div class="line"><span class="lineno">  145</span><span class="comment">                ((1 + x) / (x * x * x) * (2 * x * (1 + x) / (1 + 2 * x) - log(1 + 2 * x)) + log(1 + 2 * x) / (2 * x) -</span></div>
<div class="line"><span class="lineno">  146</span><span class="comment">                 (1 + 3 * x) / (1 + 2 * x) / (1 + 2 * x));</span></div>
<div class="line"><span class="lineno">  147</span><span class="comment">     }</span></div>
<div class="line"><span class="lineno">  148</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno">  149</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00022">macros.h:22</a></div></div>
<div class="ttc" id="anamespacecon_html_a07ddec20ab09a3078fce714358b65b4b"><div class="ttname"><a href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a></div><div class="ttdeci">constexpr Real h</div><div class="ttdoc">Planck constant in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00087">macros.h:87</a></div></div>
<div class="ttc" id="anamespacecon_html_a26ef2b83dd09c356e324bd243b498764"><div class="ttname"><a href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a></div><div class="ttdeci">constexpr Real c2</div><div class="ttdoc">Speed of light squared.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00082">macros.h:82</a></div></div>
<div class="ttc" id="anamespacecon_html_a740c8edb3d4f2d904a1c76002f84fb7e"><div class="ttname"><a href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a></div><div class="ttdeci">constexpr Real me</div><div class="ttdoc">Electron mass in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00084">macros.h:84</a></div></div>
<div class="ttc" id="anamespacecon_html_ad19e5b64c85c3e709fd0944358be97f6"><div class="ttname"><a href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a></div><div class="ttdeci">constexpr Real sigmaT</div><div class="ttdoc">Thomson cross-section in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00092">macros.h:92</a></div></div>
<div class="ttc" id="autilities_8h_html_ab8e81118f023df135835db8cce4f5f42"><div class="ttname"><a href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a></div><div class="ttdeci">T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00330">utilities.h:330</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_cgraph.png" border="0" usemap="#ainverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_cgraph" alt=""/></div>
<map name="ainverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_cgraph" id="ainverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_cgraph">
<area shape="rect" title="Computes the Compton scattering cross&#45;section as a function of frequency (nu)." alt="" coords="5,29,180,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="228,29,279,55"/>
<area shape="poly" title=" " alt="" coords="180,39,214,39,214,45,180,45"/>
<area shape="poly" title=" " alt="" coords="226,31,221,21,224,11,235,5,253,3,275,6,285,15,281,19,273,11,253,8,237,10,228,15,226,20,231,28"/>
</map>
</div>

</div>
</div>
<a id="aca4102bfefd39902a464c456253645cc" name="aca4102bfefd39902a464c456253645cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca4102bfefd39902a464c456253645cc">&#9670;&#160;</a></span>generate_IC_photons()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a> generate_IC_photons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a>&#160;</td>
          <td class="paramname"><em>KN</em> = <code><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">true</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and generates an IC photon grid from electron and photon distributions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 3D grid of IC photons </dd></dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00151">151</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  151</span>                                                                                                                   {</div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordtype">size_t</span> t_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_typedef" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>({phi_size, theta_size, t_size});</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  159</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  160</span>                <span class="comment">// Generate the IC photon spectrum for each grid cell.</span></div>
<div class="line"><span class="lineno">  161</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).compute_IC_spectrum(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), KN);</div>
<div class="line"><span class="lineno">  162</span>            }</div>
<div class="line"><span class="lineno">  163</span>        }</div>
<div class="line"><span class="lineno">  164</span>    }</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>;</div>
<div class="line"><span class="lineno">  166</span>}</div>
<div class="ttc" id="ainverse-compton_8h_html_adcfaf3d2807fe6de421ca3e9c5332252"><div class="ttname"><a href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a></div><div class="ttdeci">xt::xtensor&lt; ICPhoton, 3 &gt; ICPhotonGrid</div><div class="ttdoc">Defines a 3D grid (using xt::xtensor) for storing ICPhoton objects.</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8h_source.html#l00188">inverse-compton.h:188</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h_aca4102bfefd39902a464c456253645cc_cgraph.png" border="0" usemap="#ainverse-compton_8h_aca4102bfefd39902a464c456253645cc_cgraph" alt=""/></div>
<map name="ainverse-compton_8h_aca4102bfefd39902a464c456253645cc_cgraph" id="ainverse-compton_8h_aca4102bfefd39902a464c456253645cc_cgraph">
<area shape="rect" title="Creates and generates an IC photon grid from electron and photon distributions." alt="" coords="5,29,164,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="212,29,263,55"/>
<area shape="poly" title=" " alt="" coords="164,39,198,39,198,45,164,45"/>
<area shape="poly" title=" " alt="" coords="212,31,206,21,209,11,220,5,237,3,258,6,267,15,264,19,256,11,237,8,222,10,213,15,212,20,216,28"/>
</map>
</div>

</div>
</div>
<a id="ac7dc4640209861b76e05ae991771552e" name="ac7dc4640209861b76e05ae991771552e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7dc4640209861b76e05ae991771552e">&#9670;&#160;</a></span>KN_cooling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> KN_cooling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies Klein-Nishina cooling to electrons based on photon distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid to be modified </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
    <tr><td class="paramname">shock</td><td>The shock properties </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00186">186</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  186</span>                                                                                        {</div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  189</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_size</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  191</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  192</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_size</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  193</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y_T = <a class="code hl_function" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.t_comv(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_e, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_B,</div>
<div class="line"><span class="lineno">  194</span>                                             <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>));</div>
<div class="line"><span class="lineno">  195</span>                <span class="comment">// Clear existing Ys and emplace a new InverseComptonY with additional synchrotron frequency parameters.</span></div>
<div class="line"><span class="lineno">  196</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).Ys =</div>
<div class="line"><span class="lineno">  197</span>                    <a class="code hl_struct" href="structInverseComptonY.html">InverseComptonY</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).nu_m, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).nu_c, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), Y_T);</div>
<div class="line"><span class="lineno">  198</span>            }</div>
<div class="line"><span class="lineno">  199</span>        }</div>
<div class="line"><span class="lineno">  200</span>    }</div>
<div class="line"><span class="lineno">  201</span>    <a class="code hl_function" href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  202</span>    <a class="code hl_function" href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>);</div>
<div class="line"><span class="lineno">  203</span>}</div>
<div class="ttc" id="ainverse-compton_8cpp_html_acd9474d0630c4e995f6902006749d116"><div class="ttname"><a href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a></div><div class="ttdeci">Real compute_Thomson_Y(Real B, Real t_com, Real eps_e, Real eps_B, SynElectrons const &amp;e)</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8cpp_source.html#l00098">inverse-compton.cpp:98</a></div></div>
<div class="ttc" id="astructInverseComptonY_html"><div class="ttname"><a href="structInverseComptonY.html">InverseComptonY</a></div><div class="ttdoc">Handles Inverse Compton Y parameter calculations and related threshold values.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8h_source.html#l00021">synchrotron.h:21</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_a331f545228d2b18e84e0252510e295f8"><div class="ttname"><a href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a></div><div class="ttdeci">SynPhotonGrid generate_syn_photons(Shock const &amp;shock, SynElectronGrid const &amp;electrons)</div><div class="ttdoc">Creates and returns a new photon grid based on shock and electron grid.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00752">synchrotron.cpp:752</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_af56f9b4417a5f3e717102da3e81a7d37"><div class="ttname"><a href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a></div><div class="ttdeci">void update_electrons_4Y(SynElectronGrid &amp;electrons, Shock const &amp;shock)</div><div class="ttdoc">Updates electron properties throughout the grid based on shock parameters and IC Y values.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00630">synchrotron.cpp:630</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h_ac7dc4640209861b76e05ae991771552e_cgraph.png" border="0" usemap="#ainverse-compton_8h_ac7dc4640209861b76e05ae991771552e_cgraph" alt=""/></div>
<map name="ainverse-compton_8h_ac7dc4640209861b76e05ae991771552e_cgraph" id="ainverse-compton_8h_ac7dc4640209861b76e05ae991771552e_cgraph">
<area shape="rect" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="5,209,100,234"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="148,133,309,158"/>
<area shape="poly" title=" " alt="" coords="82,206,185,161,187,166,84,211"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1436,297,1487,322"/>
<area shape="poly" title=" " alt="" coords="61,207,95,164,119,139,146,118,223,66,288,30,321,18,358,9,449,3,1171,3,1238,4,1292,11,1316,20,1340,32,1390,74,1409,98,1425,125,1447,182,1458,238,1462,282,1457,283,1452,239,1441,184,1420,127,1405,101,1386,78,1337,37,1314,24,1290,16,1238,9,1171,8,449,8,358,15,323,23,290,35,226,71,150,122,123,143,99,167,65,210"/>
<area shape="rect" href="synchrotron_8cpp.html#a331f545228d2b18e84e0252510e295f8" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="854,498,1023,523"/>
<area shape="poly" title=" " alt="" coords="66,233,107,282,173,351,214,387,259,422,308,452,358,476,420,497,484,511,550,521,615,526,737,528,840,521,841,526,737,533,614,532,549,526,483,517,418,502,356,481,305,457,256,426,211,391,169,355,103,285,62,236"/>
<area shape="rect" href="synchrotron_8cpp.html#af56f9b4417a5f3e717102da3e81a7d37" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="150,266,307,291"/>
<area shape="poly" title=" " alt="" coords="93,232,177,259,175,264,92,237"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="375,157,525,182"/>
<area shape="poly" title=" " alt="" coords="310,152,361,157,361,162,309,157"/>
<area shape="poly" title=" " alt="" coords="255,130,302,110,357,92,449,71,521,59,595,54,689,53,1171,53,1237,54,1290,60,1315,67,1339,79,1390,118,1420,157,1441,202,1453,246,1460,283,1455,284,1448,247,1436,204,1416,160,1386,122,1336,84,1313,72,1289,65,1237,59,1171,59,689,59,595,60,522,64,450,76,358,97,304,115,257,135"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="415,107,485,133"/>
<area shape="poly" title=" " alt="" coords="309,134,401,123,402,128,310,139"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="591,144,791,184"/>
<area shape="poly" title=" " alt="" coords="525,165,577,164,577,169,525,170"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="591,259,791,299"/>
<area shape="poly" title=" " alt="" coords="497,180,544,196,598,222,646,249,644,254,595,227,542,201,496,185"/>
<area shape="poly" title=" " alt="" coords="496,154,590,129,687,115,763,107,937,104,1171,104,1236,104,1289,108,1337,124,1390,159,1416,187,1435,221,1457,282,1452,284,1430,223,1411,191,1386,163,1334,129,1287,113,1236,109,1171,109,937,109,763,112,688,120,591,135,498,159"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="839,239,1039,279"/>
<area shape="poly" title=" " alt="" coords="791,268,825,265,825,271,791,273"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="1129,246,1211,271"/>
<area shape="poly" title=" " alt="" coords="1039,256,1116,256,1116,261,1039,261"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="1312,195,1377,221"/>
<area shape="poly" title=" " alt="" coords="1039,239,1086,232,1298,209,1298,215,1087,237,1039,244"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1301,297,1388,322"/>
<area shape="poly" title=" " alt="" coords="1212,268,1289,291,1287,296,1210,273"/>
<area shape="poly" title=" " alt="" coords="1211,259,1293,267,1389,283,1424,293,1422,298,1387,288,1293,272,1211,264"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1303,398,1386,423"/>
<area shape="poly" title=" " alt="" coords="1188,270,1320,387,1317,391,1184,274"/>
<area shape="poly" title=" " alt="" coords="1388,307,1422,307,1422,312,1388,312"/>
<area shape="poly" title=" " alt="" coords="1441,298,1437,288,1439,279,1448,272,1461,270,1477,274,1484,282,1480,285,1475,278,1461,275,1450,277,1444,282,1443,288,1446,296"/>
<area shape="poly" title=" " alt="" coords="1362,396,1386,377,1436,330,1440,334,1390,381,1366,400"/>
<area shape="poly" title=" " alt="" coords="1366,219,1390,238,1440,285,1436,289,1386,242,1362,223"/>
<area shape="poly" title=" " alt="" coords="961,521,1037,564,1090,588,1149,608,1211,622,1274,625,1304,622,1333,614,1360,603,1386,586,1400,569,1412,543,1432,473,1446,397,1455,335,1460,336,1452,398,1438,475,1417,545,1404,572,1390,590,1363,607,1335,620,1305,627,1274,631,1211,627,1148,613,1088,592,1035,568,958,526"/>
<area shape="poly" title=" " alt="" coords="993,495,1253,432,1289,423,1291,428,1254,437,995,501"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="1099,397,1241,422"/>
<area shape="poly" title=" " alt="" coords="965,496,1086,439,1121,425,1123,430,1088,444,967,500"/>
<area shape="poly" title=" " alt="" coords="246,264,294,231,356,196,388,184,390,189,358,201,297,235,249,268"/>
<area shape="poly" title=" " alt="" coords="307,276,577,276,577,281,307,281"/>
<area shape="poly" title=" " alt="" coords="278,289,358,308,720,385,880,410,1087,432,1194,436,1301,433,1327,436,1347,441,1365,442,1387,434,1411,414,1429,388,1442,360,1451,334,1456,336,1447,362,1434,390,1415,417,1389,438,1366,447,1346,446,1326,442,1301,439,1194,441,1086,437,879,415,719,390,357,313,276,294"/>
<area shape="rect" href="synchrotron_8cpp.html#ab09dbe28fcecfc3d846577c1c34fcca6" title=" " alt="" coords="848,323,1029,349"/>
<area shape="poly" title=" " alt="" coords="308,283,591,308,835,326,834,332,590,313,307,289"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="357,211,543,237"/>
<area shape="poly" title=" " alt="" coords="280,263,384,238,385,243,281,269"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="1099,549,1241,574"/>
<area shape="poly" title=" " alt="" coords="236,291,250,329,275,381,311,434,333,457,359,477,403,502,449,523,547,555,648,576,749,587,847,590,937,587,1085,573,1085,578,938,593,847,595,749,592,647,581,545,561,447,528,400,506,356,481,330,461,307,437,270,383,245,331,231,293"/>
<area shape="poly" title=" " alt="" coords="977,321,1117,273,1119,279,979,326"/>
<area shape="poly" title=" " alt="" coords="1030,333,1388,332,1422,323,1424,328,1388,337,1030,339"/>
<area shape="poly" title=" " alt="" coords="977,346,1087,383,1111,390,1110,395,1086,388,976,351"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="1087,347,1253,373"/>
<area shape="poly" title=" " alt="" coords="1030,343,1073,347,1073,353,1029,348"/>
<area shape="poly" title=" " alt="" coords="501,209,596,185,597,190,502,214"/>
<area shape="poly" title=" " alt="" coords="507,234,589,253,588,258,506,239"/>
<area shape="poly" title=" " alt="" coords="543,215,1038,183,1273,174,1351,175,1389,180,1415,202,1434,229,1447,257,1456,283,1451,284,1442,259,1429,231,1411,205,1387,185,1351,180,1273,180,1038,189,543,220"/>
<area shape="poly" title=" " alt="" coords="1241,547,1278,537,1316,523,1353,503,1386,478,1413,445,1432,406,1445,368,1453,335,1458,337,1450,369,1437,408,1417,447,1390,482,1356,508,1318,528,1279,542,1242,553"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="1317,550,1373,575"/>
<area shape="poly" title=" " alt="" coords="1242,559,1303,560,1303,565,1242,565"/>
<area shape="poly" title=" " alt="" coords="1366,548,1386,529,1414,479,1434,426,1447,375,1454,335,1459,336,1452,377,1439,427,1419,482,1390,532,1370,552"/>
</map>
</div>

</div>
</div>
<a id="a83d78cd6b52bd3932fb1ae9561a1c148" name="a83d78cd6b52bd3932fb1ae9561a1c148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83d78cd6b52bd3932fb1ae9561a1c148">&#9670;&#160;</a></span>Thomson_cooling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> Thomson_cooling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies Thomson cooling to electrons based on photon distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid to be modified </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
    <tr><td class="paramname">shock</td><td>The shock properties </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00168">168</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  168</span>                                                                                             {</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  171</span>    <span class="keywordtype">size_t</span> t_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>++) {</div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  175</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  176</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y_T = <a class="code hl_function" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.t_comv(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_e, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_B,</div>
<div class="line"><span class="lineno">  177</span>                                             <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>));</div>
<div class="line"><span class="lineno">  178</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).Ys = <a class="code hl_struct" href="structInverseComptonY.html">InverseComptonY</a>(Y_T);</div>
<div class="line"><span class="lineno">  179</span>            }</div>
<div class="line"><span class="lineno">  180</span>        }</div>
<div class="line"><span class="lineno">  181</span>    }</div>
<div class="line"><span class="lineno">  182</span>    <a class="code hl_function" href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  183</span>    <a class="code hl_function" href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>);</div>
<div class="line"><span class="lineno">  184</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h_a83d78cd6b52bd3932fb1ae9561a1c148_cgraph.png" border="0" usemap="#ainverse-compton_8h_a83d78cd6b52bd3932fb1ae9561a1c148_cgraph" alt=""/></div>
<map name="ainverse-compton_8h_a83d78cd6b52bd3932fb1ae9561a1c148_cgraph" id="ainverse-compton_8h_a83d78cd6b52bd3932fb1ae9561a1c148_cgraph">
<area shape="rect" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,209,141,234"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="189,133,351,158"/>
<area shape="poly" title=" " alt="" coords="106,206,223,161,225,166,108,211"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1477,297,1528,322"/>
<area shape="poly" title=" " alt="" coords="84,207,127,164,157,140,188,118,266,69,331,33,363,20,399,10,441,5,490,3,1213,3,1279,4,1333,11,1357,20,1381,32,1431,74,1451,98,1466,125,1488,182,1499,238,1503,282,1498,283,1494,239,1483,184,1462,127,1446,101,1427,78,1378,37,1355,24,1332,16,1279,9,1213,8,490,8,441,10,400,16,365,25,333,37,269,73,191,122,160,144,131,168,88,210"/>
<area shape="rect" href="synchrotron_8cpp.html#a331f545228d2b18e84e0252510e295f8" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="895,498,1065,523"/>
<area shape="poly" title=" " alt="" coords="87,232,132,281,203,350,247,387,295,421,346,452,400,476,461,496,526,510,591,520,656,525,779,526,882,520,882,526,779,532,656,530,591,525,525,516,460,501,398,481,344,457,292,426,244,391,200,354,128,285,83,236"/>
<area shape="rect" href="synchrotron_8cpp.html#af56f9b4417a5f3e717102da3e81a7d37" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="191,266,349,291"/>
<area shape="poly" title=" " alt="" coords="118,232,214,260,212,265,117,237"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="416,157,567,182"/>
<area shape="poly" title=" " alt="" coords="351,152,403,157,402,162,351,157"/>
<area shape="poly" title=" " alt="" coords="296,130,343,110,398,92,490,71,563,59,636,54,731,53,1213,53,1279,54,1332,60,1356,67,1380,79,1431,118,1462,157,1482,202,1495,246,1501,283,1496,284,1490,247,1477,204,1457,160,1427,122,1377,84,1354,72,1330,65,1278,59,1213,59,731,59,636,60,563,64,491,76,399,97,345,115,299,135"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="456,107,527,133"/>
<area shape="poly" title=" " alt="" coords="351,134,442,123,443,128,351,139"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="632,144,832,184"/>
<area shape="poly" title=" " alt="" coords="567,165,618,164,618,169,567,170"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="632,259,832,299"/>
<area shape="poly" title=" " alt="" coords="539,180,585,196,639,222,687,249,685,254,636,227,583,201,537,185"/>
<area shape="poly" title=" " alt="" coords="538,154,631,129,728,115,804,107,979,104,1213,104,1278,104,1330,108,1378,124,1431,159,1457,187,1476,221,1498,282,1493,284,1471,223,1453,191,1428,163,1376,129,1329,113,1277,109,1213,109,979,109,805,112,729,120,633,135,539,159"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="880,239,1080,279"/>
<area shape="poly" title=" " alt="" coords="832,268,866,265,867,271,832,273"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="1171,246,1252,271"/>
<area shape="poly" title=" " alt="" coords="1080,256,1157,256,1157,261,1080,261"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="1353,195,1419,221"/>
<area shape="poly" title=" " alt="" coords="1080,239,1128,232,1339,209,1340,215,1128,237,1081,244"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1343,297,1429,322"/>
<area shape="poly" title=" " alt="" coords="1253,268,1330,291,1329,296,1251,273"/>
<area shape="poly" title=" " alt="" coords="1252,259,1335,267,1430,283,1465,293,1463,298,1429,288,1334,272,1252,264"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1345,398,1427,423"/>
<area shape="poly" title=" " alt="" coords="1229,270,1362,387,1358,391,1226,274"/>
<area shape="poly" title=" " alt="" coords="1430,307,1464,307,1464,312,1430,312"/>
<area shape="poly" title=" " alt="" coords="1483,298,1479,288,1481,279,1489,272,1503,270,1519,274,1526,282,1522,285,1516,278,1503,275,1491,277,1485,282,1484,288,1487,296"/>
<area shape="poly" title=" " alt="" coords="1404,396,1428,377,1478,330,1481,334,1431,381,1407,400"/>
<area shape="poly" title=" " alt="" coords="1407,219,1431,238,1481,285,1478,289,1428,242,1404,223"/>
<area shape="poly" title=" " alt="" coords="1002,521,1078,564,1132,588,1191,608,1253,622,1315,625,1345,622,1374,614,1402,603,1428,586,1441,569,1454,543,1474,473,1488,397,1496,335,1501,336,1493,398,1479,475,1459,545,1446,572,1431,590,1404,607,1376,620,1346,627,1315,631,1252,627,1189,613,1130,592,1076,568,1000,526"/>
<area shape="poly" title=" " alt="" coords="1035,495,1294,432,1331,423,1332,428,1295,437,1036,501"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="1140,397,1283,422"/>
<area shape="poly" title=" " alt="" coords="1006,496,1127,439,1162,425,1164,430,1129,444,1008,500"/>
<area shape="poly" title=" " alt="" coords="287,264,336,231,398,196,429,184,431,189,400,201,338,235,290,268"/>
<area shape="poly" title=" " alt="" coords="349,276,618,276,618,281,349,281"/>
<area shape="poly" title=" " alt="" coords="319,289,399,308,762,385,921,410,1128,432,1235,436,1343,433,1368,436,1388,441,1407,442,1428,434,1452,414,1470,388,1484,360,1493,334,1498,336,1489,362,1475,390,1456,417,1431,438,1408,447,1388,446,1367,442,1343,439,1235,441,1128,437,921,415,761,390,398,313,318,294"/>
<area shape="rect" href="synchrotron_8cpp.html#ab09dbe28fcecfc3d846577c1c34fcca6" title=" " alt="" coords="889,323,1071,349"/>
<area shape="poly" title=" " alt="" coords="349,283,632,308,876,326,876,332,632,313,348,289"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="399,211,584,237"/>
<area shape="poly" title=" " alt="" coords="321,263,425,238,427,243,323,269"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="1140,549,1283,574"/>
<area shape="poly" title=" " alt="" coords="278,291,292,329,316,381,352,434,375,457,400,477,444,502,491,523,588,555,689,576,790,587,888,590,979,587,1126,573,1127,578,979,593,888,595,790,592,688,581,587,561,489,528,442,506,397,481,371,461,348,437,312,383,287,331,273,293"/>
<area shape="poly" title=" " alt="" coords="1018,321,1158,273,1160,279,1020,326"/>
<area shape="poly" title=" " alt="" coords="1071,333,1429,332,1464,323,1465,328,1430,337,1071,339"/>
<area shape="poly" title=" " alt="" coords="1019,346,1129,383,1153,390,1151,395,1127,388,1017,351"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="1128,347,1295,373"/>
<area shape="poly" title=" " alt="" coords="1071,343,1115,347,1114,353,1071,348"/>
<area shape="poly" title=" " alt="" coords="542,209,637,185,639,190,544,214"/>
<area shape="poly" title=" " alt="" coords="548,234,631,253,629,258,547,239"/>
<area shape="poly" title=" " alt="" coords="584,215,1079,183,1314,174,1392,175,1430,180,1456,202,1475,229,1489,257,1498,283,1493,284,1484,259,1470,231,1452,205,1428,185,1392,180,1314,180,1079,189,584,220"/>
<area shape="poly" title=" " alt="" coords="1282,547,1319,537,1358,523,1395,503,1427,478,1454,445,1473,406,1486,368,1494,335,1499,337,1492,369,1478,408,1459,447,1431,482,1398,508,1360,528,1321,542,1284,553"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="1358,550,1414,575"/>
<area shape="poly" title=" " alt="" coords="1283,559,1344,560,1344,565,1283,565"/>
<area shape="poly" title=" " alt="" coords="1407,548,1427,529,1455,479,1475,426,1488,375,1495,335,1501,336,1493,377,1480,427,1460,482,1431,532,1411,552"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2bf720c7c87d960838095b276b09c664" name="a2bf720c7c87d960838095b276b09c664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bf720c7c87d960838095b276b09c664">&#9670;&#160;</a></span>IC_x0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> IC_x0 = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::sqrt</a>(2) / 3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A constant used in the IC photon calculation, defined as √2/3. </p>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8h_source.html#l00029">29</a> of file <a class="el" href="inverse-compton_8h_source.html">inverse-compton.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="inverse-compton_8h.html">inverse-compton.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
