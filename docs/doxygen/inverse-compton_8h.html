<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: inverse-compton.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('inverse-compton_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">inverse-compton.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;array&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;tuple&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="medium_8h_source.html">medium.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mesh_8h_source.html">mesh.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="shock_8h_source.html">shock.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="synchrotron_8h_source.html">synchrotron.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for inverse-compton.h:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h__incl.png" border="0" usemap="#ainverse-compton_8h" alt=""/></div>
<map name="ainverse-compton_8h" id="ainverse-compton_8h">
<area shape="rect" title=" " alt="" coords="1481,5,1625,31"/>
<area shape="rect" title=" " alt="" coords="853,79,909,104"/>
<area shape="poly" title=" " alt="" coords="1481,25,1235,43,1081,59,928,81,923,82,922,77,927,76,1081,54,1234,38,1480,20"/>
<area shape="rect" title=" " alt="" coords="1303,526,1365,551"/>
<area shape="poly" title=" " alt="" coords="1481,27,1354,42,1212,68,1148,86,1097,108,1062,134,1053,148,1050,164,1050,239,1057,290,1078,336,1107,379,1144,416,1185,450,1226,478,1297,518,1295,522,1223,482,1181,454,1141,420,1103,382,1073,339,1052,291,1045,240,1045,163,1048,146,1058,131,1094,104,1147,81,1211,63,1353,37,1480,22"/>
<area shape="rect" title=" " alt="" coords="1608,225,1663,251"/>
<area shape="poly" title=" " alt="" coords="1564,29,1596,77,1615,113,1627,151,1637,211,1631,212,1622,153,1610,115,1592,80,1559,32"/>
<area shape="rect" title=" " alt="" coords="1549,152,1612,177"/>
<area shape="poly" title=" " alt="" coords="1560,30,1577,78,1583,138,1578,138,1571,79,1555,32"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="1391,526,1474,551"/>
<area shape="poly" title=" " alt="" coords="1625,27,1684,43,1742,69,1767,87,1787,108,1800,134,1805,163,1805,386,1802,399,1795,412,1769,435,1731,457,1684,476,1581,508,1488,529,1487,524,1579,503,1682,471,1728,452,1766,431,1791,409,1797,397,1799,386,1799,164,1795,135,1782,111,1764,91,1740,74,1683,48,1624,32"/>
<area shape="rect" href="medium_8h.html" title=" " alt="" coords="1494,299,1582,324"/>
<area shape="poly" title=" " alt="" coords="1569,29,1612,67,1659,122,1678,154,1689,187,1690,220,1678,252,1661,271,1641,285,1596,303,1594,298,1638,280,1658,267,1673,249,1685,219,1684,188,1673,156,1655,125,1608,70,1566,33"/>
<area shape="rect" href="utilities_8h.html" title=" " alt="" coords="1497,372,1579,397"/>
<area shape="poly" title=" " alt="" coords="1600,28,1648,46,1699,73,1720,91,1738,112,1750,136,1754,163,1754,240,1750,267,1738,291,1720,312,1697,330,1645,357,1593,374,1592,369,1643,352,1694,326,1716,308,1733,288,1745,265,1749,239,1749,164,1745,138,1734,115,1717,95,1696,78,1646,51,1598,33"/>
<area shape="rect" href="mesh_8h.html" title=" " alt="" coords="961,445,1032,471"/>
<area shape="poly" title=" " alt="" coords="1480,24,1368,30,1237,40,1115,57,1066,68,1030,81,997,97,971,112,955,132,949,164,949,313,952,346,961,378,985,432,981,434,956,380,947,347,943,313,943,163,950,130,968,108,995,92,1028,76,1065,63,1114,52,1237,35,1368,25,1480,19"/>
<area shape="rect" href="shock_8h.html" title=" " alt="" coords="1390,152,1462,177"/>
<area shape="poly" title=" " alt="" coords="1512,33,1474,51,1456,64,1442,80,1430,109,1427,138,1422,138,1425,107,1437,77,1452,60,1471,47,1510,28"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="1451,79,1561,104"/>
<area shape="poly" title=" " alt="" coords="1547,32,1523,69,1519,66,1543,30"/>
<area shape="rect" title=" " alt="" coords="1358,607,1417,632"/>
<area shape="poly" title=" " alt="" coords="1428,553,1403,596,1399,593,1424,550"/>
<area shape="rect" title=" " alt="" coords="1441,607,1515,632"/>
<area shape="poly" title=" " alt="" coords="1442,550,1467,593,1462,596,1437,553"/>
<area shape="poly" title=" " alt="" coords="1527,326,1506,347,1487,373,1469,409,1456,447,1439,513,1434,512,1451,446,1464,407,1482,371,1502,344,1523,322"/>
<area shape="poly" title=" " alt="" coords="1541,324,1541,358,1535,358,1535,324"/>
<area shape="poly" title=" " alt="" coords="1580,394,1616,407,1647,423,1659,434,1667,445,1668,459,1661,472,1634,492,1589,509,1488,531,1487,526,1588,504,1631,488,1657,469,1663,458,1662,447,1655,437,1644,428,1613,411,1579,399"/>
<area shape="rect" title=" " alt="" coords="1471,445,1563,471"/>
<area shape="poly" title=" " alt="" coords="1537,398,1527,433,1521,431,1532,397"/>
<area shape="rect" title=" " alt="" coords="1587,445,1647,471"/>
<area shape="poly" title=" " alt="" coords="1552,395,1596,434,1592,438,1549,399"/>
<area shape="poly" title=" " alt="" coords="1497,394,1046,453,1045,448,1496,389"/>
<area shape="poly" title=" " alt="" coords="1032,461,1148,481,1220,497,1291,516,1298,518,1296,523,1289,521,1218,502,1147,486,1032,467"/>
<area shape="poly" title=" " alt="" coords="1033,460,1184,479,1281,495,1379,516,1390,519,1389,524,1377,521,1280,501,1183,484,1032,465"/>
<area shape="rect" title=" " alt="" coords="5,519,148,559"/>
<area shape="poly" title=" " alt="" coords="961,463,832,466,637,476,404,493,162,521,162,516,404,488,637,470,832,461,961,457"/>
<area shape="rect" title=" " alt="" coords="172,519,315,559"/>
<area shape="poly" title=" " alt="" coords="961,463,701,480,519,497,329,521,328,516,518,491,701,474,961,458"/>
<area shape="rect" title=" " alt="" coords="339,519,481,559"/>
<area shape="poly" title=" " alt="" coords="961,465,767,484,634,500,496,521,495,516,633,495,766,479,961,460"/>
<area shape="rect" title=" " alt="" coords="505,526,683,551"/>
<area shape="poly" title=" " alt="" coords="962,469,667,526,666,521,961,464"/>
<area shape="rect" title=" " alt="" coords="707,526,897,551"/>
<area shape="poly" title=" " alt="" coords="969,473,844,523,842,518,967,468"/>
<area shape="rect" title=" " alt="" coords="922,526,1071,551"/>
<area shape="poly" title=" " alt="" coords="999,471,999,512,994,512,994,471"/>
<area shape="rect" title=" " alt="" coords="1096,526,1279,551"/>
<area shape="poly" title=" " alt="" coords="1025,468,1148,518,1146,523,1023,473"/>
<area shape="poly" title=" " alt="" coords="1460,175,1596,220,1594,226,1459,180"/>
<area shape="poly" title=" " alt="" coords="1437,176,1523,286,1519,290,1433,179"/>
<area shape="poly" title=" " alt="" coords="1390,172,1246,191,1174,207,1145,217,1125,227,1111,242,1095,263,1062,320,1009,433,1004,431,1057,318,1091,260,1107,238,1122,223,1143,212,1172,202,1245,186,1389,167"/>
<area shape="rect" title=" " alt="" coords="1243,225,1431,251"/>
<area shape="poly" title=" " alt="" coords="1413,179,1364,219,1360,214,1410,175"/>
<area shape="rect" href="jet_8h.html" title=" " alt="" coords="1419,299,1470,324"/>
<area shape="poly" title=" " alt="" coords="1433,177,1446,225,1449,285,1443,285,1441,226,1428,178"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="1135,225,1218,251"/>
<area shape="poly" title=" " alt="" coords="1390,179,1230,224,1229,219,1389,174"/>
<area shape="poly" title=" " alt="" coords="1441,325,1348,514,1343,512,1437,323"/>
<area shape="poly" title=" " alt="" coords="1461,322,1514,361,1510,366,1458,326"/>
<area shape="poly" title=" " alt="" coords="1185,250,1324,512,1319,515,1180,252"/>
<area shape="poly" title=" " alt="" coords="1190,249,1236,297,1340,418,1417,513,1413,517,1336,422,1232,300,1186,253"/>
<area shape="poly" title=" " alt="" coords="1219,246,1231,248,1481,296,1480,301,1229,253,1218,251"/>
<area shape="poly" title=" " alt="" coords="1174,252,1140,318,1113,360,1081,399,1056,422,1030,440,1027,436,1053,417,1077,396,1109,357,1135,315,1169,249"/>
<area shape="poly" title=" " alt="" coords="1219,248,1407,297,1406,302,1218,253"/>
<area shape="poly" title=" " alt="" coords="1520,102,1560,141,1557,144,1516,106"/>
<area shape="poly" title=" " alt="" coords="1510,104,1537,285,1532,285,1505,105"/>
<area shape="poly" title=" " alt="" coords="1451,101,1375,113,1282,136,1234,153,1186,173,1140,198,1098,227,1076,249,1057,275,1029,332,1011,388,1002,432,997,431,1006,386,1024,330,1052,272,1072,246,1095,223,1137,193,1184,168,1232,148,1281,131,1374,108,1450,95"/>
<area shape="poly" title=" " alt="" coords="1495,106,1451,145,1447,141,1491,102"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h__dep__incl.png" border="0" usemap="#ainverse-compton_8hdep" alt=""/></div>
<map name="ainverse-compton_8hdep" id="ainverse-compton_8hdep">
<area shape="rect" title=" " alt="" coords="334,5,478,31"/>
<area shape="rect" href="afterglow_8h.html" title=" " alt="" coords="200,79,295,104"/>
<area shape="poly" title=" " alt="" coords="369,39,274,81,272,76,367,34"/>
<area shape="rect" href="synchrotron_8cpp.html" title=" " alt="" coords="416,152,543,177"/>
<area shape="poly" title=" " alt="" coords="414,44,422,73,435,103,452,129,470,150,466,154,448,132,430,105,417,74,409,45"/>
<area shape="rect" href="inverse-compton_8cpp.html" title=" " alt="" coords="444,79,603,104"/>
<area shape="poly" title=" " alt="" coords="438,35,506,76,503,81,435,40"/>
<area shape="rect" href="mcmc_8h.html" title=" " alt="" coords="317,152,391,177"/>
<area shape="poly" title=" " alt="" coords="277,109,338,150,335,154,274,114"/>
<area shape="rect" href="observer_8h.html" title=" " alt="" coords="37,152,127,177"/>
<area shape="poly" title=" " alt="" coords="203,111,103,154,101,149,200,106"/>
<area shape="rect" href="pymodel_8cpp.html" title=" " alt="" coords="135,225,242,251"/>
<area shape="poly" title=" " alt="" coords="222,114,205,132,192,153,187,172,186,191,189,225,184,225,181,191,182,171,188,151,201,129,219,111"/>
<area shape="rect" href="pymodel_8h.html" title=" " alt="" coords="202,152,293,177"/>
<area shape="poly" title=" " alt="" coords="250,118,250,152,245,152,245,118"/>
<area shape="poly" title=" " alt="" coords="298,105,443,149,441,154,297,110"/>
<area shape="rect" href="mcmc_8cpp.html" title=" " alt="" coords="384,225,473,251"/>
<area shape="poly" title=" " alt="" coords="378,185,418,223,415,227,374,189"/>
<area shape="rect" href="pybind_8cpp.html" title=" " alt="" coords="266,225,359,251"/>
<area shape="poly" title=" " alt="" coords="343,191,322,227,317,224,338,188"/>
<area shape="poly" title=" " alt="" coords="127,144,227,102,229,106,129,149"/>
<area shape="rect" href="observer_8cpp.html" title=" " alt="" coords="5,225,111,251"/>
<area shape="poly" title=" " alt="" coords="76,191,64,226,59,224,71,189"/>
<area shape="poly" title=" " alt="" coords="269,186,304,223,300,227,265,189"/>
<area shape="poly" title=" " alt="" coords="231,190,200,227,196,224,227,186"/>
</map>
</div>
</div>
<p><a href="inverse-compton_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structIntegratorGrid.html">IntegratorGrid</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a grid for numerical integration in log-space.  <a href="structIntegratorGrid.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structIntegratorGridDynamic.html">IntegratorGridDynamic</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structICPhoton.html">ICPhoton</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a single inverse Compton (IC) photon.  <a href="structICPhoton.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:adcfaf3d2807fe6de421ca3e9c5332252" id="r_adcfaf3d2807fe6de421ca3e9c5332252"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">using</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a> = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">xt::xtensor</a>&lt; <a class="el" href="structICPhoton.html">ICPhoton</a>, 3 &gt;</td></tr>
<tr class="memdesc:adcfaf3d2807fe6de421ca3e9c5332252"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a 3D grid (using xt::xtensor) for storing <a class="el" href="structICPhoton.html" title="Represents a single inverse Compton (IC) photon.">ICPhoton</a> objects.  <br /></td></tr>
<tr class="separator:adcfaf3d2807fe6de421ca3e9c5332252"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a689ca8481a7d3e7e760a3300503f2781" id="r_a689ca8481a7d3e7e760a3300503f2781"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#a689ca8481a7d3e7e760a3300503f2781">compton_cross_section</a> (<a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> nu)</td></tr>
<tr class="memdesc:a689ca8481a7d3e7e760a3300503f2781"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Compton scattering cross-section as a function of frequency (nu).  <br /></td></tr>
<tr class="separator:a689ca8481a7d3e7e760a3300503f2781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca4102bfefd39902a464c456253645cc" id="r_aca4102bfefd39902a464c456253645cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#aca4102bfefd39902a464c456253645cc">generate_IC_photons</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electron</a>, <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photon</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a> KN=<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">true</a>) <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">noexcept</a></td></tr>
<tr class="memdesc:aca4102bfefd39902a464c456253645cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and generates an IC photon grid from electron and photon distributions.  <br /></td></tr>
<tr class="separator:aca4102bfefd39902a464c456253645cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83d78cd6b52bd3932fb1ae9561a1c148" id="r_a83d78cd6b52bd3932fb1ae9561a1c148"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#a83d78cd6b52bd3932fb1ae9561a1c148">Thomson_cooling</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electron</a>, <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photon</a>, <a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>)</td></tr>
<tr class="memdesc:a83d78cd6b52bd3932fb1ae9561a1c148"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies Thomson cooling to electrons based on photon distribution.  <br /></td></tr>
<tr class="separator:a83d78cd6b52bd3932fb1ae9561a1c148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7dc4640209861b76e05ae991771552e" id="r_ac7dc4640209861b76e05ae991771552e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#ac7dc4640209861b76e05ae991771552e">KN_cooling</a> (<a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electron</a>, <a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photon</a>, <a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>)</td></tr>
<tr class="memdesc:ac7dc4640209861b76e05ae991771552e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies Klein-Nishina cooling to electrons based on photon distribution.  <br /></td></tr>
<tr class="separator:ac7dc4640209861b76e05ae991771552e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2bf720c7c87d960838095b276b09c664" id="r_a2bf720c7c87d960838095b276b09c664"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inverse-compton_8h.html#a2bf720c7c87d960838095b276b09c664">IC_x0</a> = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::sqrt</a>(2) / 3</td></tr>
<tr class="memdesc:a2bf720c7c87d960838095b276b09c664"><td class="mdescLeft">&#160;</td><td class="mdescRight">A constant used in the IC photon calculation, defined as √2/3.  <br /></td></tr>
<tr class="separator:a2bf720c7c87d960838095b276b09c664"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="adcfaf3d2807fe6de421ca3e9c5332252" name="adcfaf3d2807fe6de421ca3e9c5332252"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcfaf3d2807fe6de421ca3e9c5332252">&#9670;&#160;</a></span>ICPhotonGrid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines a 3D grid (using xt::xtensor) for storing <a class="el" href="structICPhoton.html" title="Represents a single inverse Compton (IC) photon.">ICPhoton</a> objects. </p>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8h_source.html#l00231">231</a> of file <a class="el" href="inverse-compton_8h_source.html">inverse-compton.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a689ca8481a7d3e7e760a3300503f2781" name="a689ca8481a7d3e7e760a3300503f2781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a689ca8481a7d3e7e760a3300503f2781">&#9670;&#160;</a></span>compton_cross_section()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> compton_cross_section </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>nu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the Compton scattering cross-section as a function of frequency (nu). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nu</td><td>The frequency at which to compute the cross-section </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>For x = (h * nu) / (me * c²) &lt;= 1, returns the Thomson cross-section (<a class="el" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6" title="Thomson cross-section in code units.">con::sigmaT</a>), otherwise 0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00141">141</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span>                                    {</div>
<div class="line"><span class="lineno">  142</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a> / (<a class="code hl_variable" href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a> * <a class="code hl_variable" href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a>) * nu;</div>
<div class="line"><span class="lineno">  143</span>    <span class="comment">/*if (x &lt;= 1) {</span></div>
<div class="line"><span class="lineno">  144</span><span class="comment">        return con::sigmaT;</span></div>
<div class="line"><span class="lineno">  145</span><span class="comment">    } else {</span></div>
<div class="line"><span class="lineno">  146</span><span class="comment">        return 0;</span></div>
<div class="line"><span class="lineno">  147</span><span class="comment">    }*/</span></div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> &lt; 1e-2) {</div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a> * (1 - 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>);</div>
<div class="line"><span class="lineno">  151</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> &gt; 1e2) {</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">return</span> 3. / 8 * <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a> * (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log</a>(2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) + 0.5) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>;</div>
<div class="line"><span class="lineno">  153</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  154</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_term</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log</a>(1 + 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>);</div>
<div class="line"><span class="lineno">  155</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a> = 1 + 2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>;</div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">return</span> 0.75 * <a class="code hl_variable" href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a> *</div>
<div class="line"><span class="lineno">  157</span>               ((1 + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) * (2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a> * (1 + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_term</a>) + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log_term</a> / (2 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) -</div>
<div class="line"><span class="lineno">  158</span>                (1 + 3 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">x</a>) / (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">term1</a>));</div>
<div class="line"><span class="lineno">  159</span>    }</div>
<div class="line"><span class="lineno">  160</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00022">macros.h:22</a></div></div>
<div class="ttc" id="anamespacecon_html_a07ddec20ab09a3078fce714358b65b4b"><div class="ttname"><a href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a></div><div class="ttdeci">constexpr Real h</div><div class="ttdoc">Planck constant in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00087">macros.h:87</a></div></div>
<div class="ttc" id="anamespacecon_html_a26ef2b83dd09c356e324bd243b498764"><div class="ttname"><a href="namespacecon.html#a26ef2b83dd09c356e324bd243b498764">con::c2</a></div><div class="ttdeci">constexpr Real c2</div><div class="ttdoc">Speed of light squared.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00082">macros.h:82</a></div></div>
<div class="ttc" id="anamespacecon_html_a740c8edb3d4f2d904a1c76002f84fb7e"><div class="ttname"><a href="namespacecon.html#a740c8edb3d4f2d904a1c76002f84fb7e">con::me</a></div><div class="ttdeci">constexpr Real me</div><div class="ttdoc">Electron mass in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00084">macros.h:84</a></div></div>
<div class="ttc" id="anamespacecon_html_ad19e5b64c85c3e709fd0944358be97f6"><div class="ttname"><a href="namespacecon.html#ad19e5b64c85c3e709fd0944358be97f6">con::sigmaT</a></div><div class="ttdeci">constexpr Real sigmaT</div><div class="ttdoc">Thomson cross-section in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00092">macros.h:92</a></div></div>
<div class="ttc" id="autilities_8h_html_ab8e81118f023df135835db8cce4f5f42"><div class="ttname"><a href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a></div><div class="ttdeci">T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00330">utilities.h:330</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_cgraph.png" border="0" usemap="#ainverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_cgraph" alt=""/></div>
<map name="ainverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_cgraph" id="ainverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_cgraph">
<area shape="rect" title="Computes the Compton scattering cross&#45;section as a function of frequency (nu)." alt="" coords="5,29,180,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="228,29,279,55"/>
<area shape="poly" title=" " alt="" coords="180,39,214,39,214,45,180,45"/>
<area shape="poly" title=" " alt="" coords="226,31,221,21,224,11,235,5,253,3,275,6,285,15,281,19,273,11,253,8,237,10,228,15,226,20,231,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_icgraph.png" border="0" usemap="#ainverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_icgraph" alt=""/></div>
<map name="ainverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_icgraph" id="ainverse-compton_8h_a689ca8481a7d3e7e760a3300503f2781_icgraph">
<area shape="rect" title="Computes the Compton scattering cross&#45;section as a function of frequency (nu)." alt="" coords="481,13,656,38"/>
<area shape="rect" href="structICPhoton.html#a6a2ac815d7fa191cddae0bebe39cdae6" title="Fill the integration grid for the IC photon spectrum." alt="" coords="219,13,433,38"/>
<area shape="poly" title=" " alt="" coords="467,28,433,28,433,23,467,23"/>
<area shape="rect" href="structICPhoton.html#aabcd1cc2a89ddb1683292dfefa74b14a" title="Generates the IC photon spectrum from the given electron and photon data." alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="aca4102bfefd39902a464c456253645cc" name="aca4102bfefd39902a464c456253645cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca4102bfefd39902a464c456253645cc">&#9670;&#160;</a></span>generate_IC_photons()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a> generate_IC_photons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">bool</a>&#160;</td>
          <td class="paramname"><em>KN</em> = <code><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">true</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and generates an IC photon grid from electron and photon distributions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 3D grid of IC photons </dd></dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00162">162</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  162</span>                                                                                                                   {</div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordtype">size_t</span> t_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  166</span>    <a class="code hl_typedef" href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>({phi_size, theta_size, t_size});</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  170</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  171</span>                <span class="comment">// Generate the IC photon spectrum for each grid cell.</span></div>
<div class="line"><span class="lineno">  172</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).compute_IC_spectrum(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), KN);</div>
<div class="line"><span class="lineno">  173</span>            }</div>
<div class="line"><span class="lineno">  174</span>        }</div>
<div class="line"><span class="lineno">  175</span>    }</div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">IC_ph</a>;</div>
<div class="line"><span class="lineno">  177</span>}</div>
<div class="ttc" id="ainverse-compton_8h_html_adcfaf3d2807fe6de421ca3e9c5332252"><div class="ttname"><a href="inverse-compton_8h.html#adcfaf3d2807fe6de421ca3e9c5332252">ICPhotonGrid</a></div><div class="ttdeci">xt::xtensor&lt; ICPhoton, 3 &gt; ICPhotonGrid</div><div class="ttdoc">Defines a 3D grid (using xt::xtensor) for storing ICPhoton objects.</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8h_source.html#l00231">inverse-compton.h:231</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h_aca4102bfefd39902a464c456253645cc_cgraph.png" border="0" usemap="#ainverse-compton_8h_aca4102bfefd39902a464c456253645cc_cgraph" alt=""/></div>
<map name="ainverse-compton_8h_aca4102bfefd39902a464c456253645cc_cgraph" id="ainverse-compton_8h_aca4102bfefd39902a464c456253645cc_cgraph">
<area shape="rect" title="Creates and generates an IC photon grid from electron and photon distributions." alt="" coords="5,29,164,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="212,29,263,55"/>
<area shape="poly" title=" " alt="" coords="164,39,198,39,198,45,164,45"/>
<area shape="poly" title=" " alt="" coords="212,31,206,21,209,11,220,5,237,3,258,6,267,15,264,19,256,11,237,8,222,10,213,15,212,20,216,28"/>
</map>
</div>

</div>
</div>
<a id="ac7dc4640209861b76e05ae991771552e" name="ac7dc4640209861b76e05ae991771552e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7dc4640209861b76e05ae991771552e">&#9670;&#160;</a></span>KN_cooling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> KN_cooling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies Klein-Nishina cooling to electrons based on photon distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid to be modified </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
    <tr><td class="paramname">shock</td><td>The shock properties </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00197">197</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  197</span>                                                                                        {</div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_size</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  203</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">r_size</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  204</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y_T = <a class="code hl_function" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.t_comv(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_e, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_B,</div>
<div class="line"><span class="lineno">  205</span>                                             <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>));</div>
<div class="line"><span class="lineno">  206</span>                <span class="comment">// Clear existing Ys and emplace a new InverseComptonY with additional synchrotron frequency parameters.</span></div>
<div class="line"><span class="lineno">  207</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).Ys =</div>
<div class="line"><span class="lineno">  208</span>                    <a class="code hl_struct" href="structInverseComptonY.html">InverseComptonY</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).nu_m, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).nu_c, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), Y_T);</div>
<div class="line"><span class="lineno">  209</span>            }</div>
<div class="line"><span class="lineno">  210</span>        }</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span>    <a class="code hl_function" href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  213</span>    <a class="code hl_function" href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>);</div>
<div class="line"><span class="lineno">  214</span>}</div>
<div class="ttc" id="ainverse-compton_8cpp_html_acd9474d0630c4e995f6902006749d116"><div class="ttname"><a href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a></div><div class="ttdeci">Real compute_Thomson_Y(Real B, Real t_com, Real eps_e, Real eps_B, SynElectrons const &amp;e)</div><div class="ttdef"><b>Definition</b> <a href="inverse-compton_8cpp_source.html#l00108">inverse-compton.cpp:108</a></div></div>
<div class="ttc" id="astructInverseComptonY_html"><div class="ttname"><a href="structInverseComptonY.html">InverseComptonY</a></div><div class="ttdoc">Handles Inverse Compton Y parameter calculations and related threshold values.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8h_source.html#l00021">synchrotron.h:21</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_a331f545228d2b18e84e0252510e295f8"><div class="ttname"><a href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a></div><div class="ttdeci">SynPhotonGrid generate_syn_photons(Shock const &amp;shock, SynElectronGrid const &amp;electrons)</div><div class="ttdoc">Creates and returns a new photon grid based on shock and electron grid.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00752">synchrotron.cpp:752</a></div></div>
<div class="ttc" id="asynchrotron_8h_html_af56f9b4417a5f3e717102da3e81a7d37"><div class="ttname"><a href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a></div><div class="ttdeci">void update_electrons_4Y(SynElectronGrid &amp;electrons, Shock const &amp;shock)</div><div class="ttdoc">Updates electron properties throughout the grid based on shock parameters and IC Y values.</div><div class="ttdef"><b>Definition</b> <a href="synchrotron_8cpp_source.html#l00630">synchrotron.cpp:630</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h_ac7dc4640209861b76e05ae991771552e_cgraph.png" border="0" usemap="#ainverse-compton_8h_ac7dc4640209861b76e05ae991771552e_cgraph" alt=""/></div>
<map name="ainverse-compton_8h_ac7dc4640209861b76e05ae991771552e_cgraph" id="ainverse-compton_8h_ac7dc4640209861b76e05ae991771552e_cgraph">
<area shape="rect" title="Applies Klein&#45;Nishina cooling to electrons based on photon distribution." alt="" coords="5,284,100,309"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="148,199,309,224"/>
<area shape="poly" title=" " alt="" coords="79,281,188,228,190,233,81,286"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1436,297,1487,323"/>
<area shape="poly" title=" " alt="" coords="60,282,110,215,149,170,196,123,251,78,312,40,378,14,413,7,449,5,1171,5,1237,3,1290,5,1315,10,1339,20,1364,35,1390,57,1411,83,1428,111,1450,174,1461,235,1463,283,1458,283,1455,235,1445,175,1423,114,1407,86,1386,61,1361,40,1337,25,1313,15,1290,10,1237,8,1171,10,449,10,414,12,380,19,315,45,254,82,200,127,153,174,114,219,64,285"/>
<area shape="rect" href="synchrotron_8cpp.html#a331f545228d2b18e84e0252510e295f8" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="854,575,1023,600"/>
<area shape="poly" title=" " alt="" coords="68,308,103,341,149,377,236,425,329,465,424,498,519,525,611,545,697,560,841,578,840,583,697,565,610,550,518,530,422,503,327,470,234,430,147,382,100,346,64,312"/>
<area shape="rect" href="synchrotron_8cpp.html#af56f9b4417a5f3e717102da3e81a7d37" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="150,341,307,367"/>
<area shape="poly" title=" " alt="" coords="93,307,177,335,175,340,92,312"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="375,227,525,252"/>
<area shape="poly" title=" " alt="" coords="310,219,361,225,361,231,309,224"/>
<area shape="poly" title=" " alt="" coords="250,196,321,159,427,112,489,90,555,72,622,60,689,55,1171,55,1236,53,1289,52,1313,55,1338,63,1363,77,1390,97,1409,117,1424,141,1446,192,1457,242,1462,284,1456,284,1452,243,1441,193,1420,143,1405,121,1386,101,1360,81,1336,68,1312,61,1289,57,1236,58,1171,61,689,61,623,65,556,77,491,95,429,117,323,163,253,201"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="655,169,726,195"/>
<area shape="poly" title=" " alt="" coords="309,204,641,182,642,188,310,209"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="591,219,791,259"/>
<area shape="poly" title=" " alt="" coords="525,237,577,237,577,242,525,242"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="591,283,791,323"/>
<area shape="poly" title=" " alt="" coords="500,250,602,277,601,282,498,255"/>
<area shape="poly" title=" " alt="" coords="466,224,519,189,554,170,590,154,684,125,760,111,838,106,937,106,1171,106,1235,102,1287,97,1311,98,1336,103,1362,114,1390,132,1407,147,1421,166,1441,207,1454,248,1460,283,1455,284,1449,250,1436,209,1416,169,1403,151,1386,136,1359,118,1334,108,1311,103,1287,102,1235,107,1171,111,937,111,838,112,761,116,686,130,592,159,556,174,522,193,469,229"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="839,239,1039,279"/>
<area shape="poly" title=" " alt="" coords="790,283,825,277,826,282,791,288"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="1129,247,1211,272"/>
<area shape="poly" title=" " alt="" coords="1039,257,1116,257,1116,262,1039,262"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="1312,147,1377,172"/>
<area shape="poly" title=" " alt="" coords="1020,237,1298,168,1299,173,1022,242"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1301,196,1388,221"/>
<area shape="poly" title=" " alt="" coords="1210,245,1287,222,1289,228,1212,250"/>
<area shape="poly" title=" " alt="" coords="1211,259,1293,267,1389,283,1424,293,1422,299,1387,289,1293,273,1211,264"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1303,297,1386,323"/>
<area shape="poly" title=" " alt="" coords="1212,268,1291,292,1289,297,1210,273"/>
<area shape="poly" title=" " alt="" coords="1366,219,1390,239,1440,286,1436,289,1386,243,1362,224"/>
<area shape="poly" title=" " alt="" coords="1441,298,1437,289,1439,279,1448,273,1461,271,1477,274,1484,282,1480,286,1475,279,1461,276,1450,278,1444,282,1443,288,1446,296"/>
<area shape="poly" title=" " alt="" coords="1387,307,1422,307,1422,313,1387,313"/>
<area shape="poly" title=" " alt="" coords="1375,170,1390,181,1411,206,1428,233,1453,283,1448,286,1424,236,1406,209,1386,185,1372,174"/>
<area shape="poly" title=" " alt="" coords="726,183,864,198,1039,225,1116,242,1115,247,1038,230,863,203,726,188"/>
<area shape="poly" title=" " alt="" coords="997,597,1085,609,1137,611,1191,609,1246,600,1298,585,1345,560,1386,525,1403,504,1417,479,1437,427,1449,377,1455,336,1461,337,1455,378,1442,429,1422,482,1407,507,1390,529,1348,565,1300,590,1247,606,1192,614,1137,616,1085,614,997,603"/>
<area shape="poly" title=" " alt="" coords="954,572,994,535,1036,486,1050,458,1057,433,1065,409,1085,385,1134,353,1188,332,1242,318,1289,311,1290,316,1243,323,1189,337,1136,358,1088,389,1070,412,1062,435,1055,460,1041,489,998,539,957,576"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="1099,549,1241,575"/>
<area shape="poly" title=" " alt="" coords="1024,575,1085,569,1085,574,1024,581"/>
<area shape="poly" title=" " alt="" coords="249,339,356,277,403,255,405,260,359,282,252,343"/>
<area shape="poly" title=" " alt="" coords="308,347,419,339,542,326,577,321,577,326,543,331,419,344,308,352"/>
<area shape="poly" title=" " alt="" coords="243,365,290,414,323,443,359,468,510,556,573,589,634,616,697,636,765,650,844,658,937,661,1171,661,1238,660,1291,651,1315,643,1338,630,1386,587,1408,558,1425,525,1438,491,1447,455,1456,388,1458,336,1464,337,1462,389,1452,456,1443,492,1430,528,1413,561,1390,590,1341,634,1317,648,1293,657,1239,665,1171,666,937,666,844,663,765,655,696,641,632,621,571,594,507,560,356,472,319,447,286,418,239,368"/>
<area shape="rect" href="synchrotron_8cpp.html#ab09dbe28fcecfc3d846577c1c34fcca6" title=" " alt="" coords="848,449,1029,475"/>
<area shape="poly" title=" " alt="" coords="247,365,295,398,326,415,358,427,420,444,483,455,612,469,732,472,834,468,834,474,732,477,612,474,483,461,419,449,357,433,323,419,292,402,244,369"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="357,291,543,316"/>
<area shape="poly" title=" " alt="" coords="285,339,380,316,381,322,286,344"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="1099,399,1241,424"/>
<area shape="poly" title=" " alt="" coords="308,357,591,377,1085,404,1085,410,591,382,307,362"/>
<area shape="poly" title=" " alt="" coords="946,447,998,374,1039,329,1085,289,1115,273,1118,278,1088,294,1042,333,1003,377,950,451"/>
<area shape="poly" title=" " alt="" coords="970,472,1049,500,1101,513,1158,524,1217,528,1277,525,1334,511,1387,485,1403,471,1417,454,1438,413,1450,372,1455,336,1461,337,1455,373,1443,415,1422,457,1407,475,1389,490,1336,516,1278,530,1217,534,1157,529,1100,519,1048,505,968,477"/>
<area shape="poly" title=" " alt="" coords="967,472,1088,528,1123,542,1121,547,1086,532,965,477"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="1087,448,1253,473"/>
<area shape="poly" title=" " alt="" coords="1030,459,1073,459,1073,464,1030,464"/>
<area shape="poly" title=" " alt="" coords="498,288,601,260,602,265,500,293"/>
<area shape="poly" title=" " alt="" coords="543,301,577,301,577,306,543,306"/>
<area shape="poly" title=" " alt="" coords="499,313,591,333,764,354,937,358,1171,358,1280,354,1387,333,1422,322,1424,327,1389,338,1281,359,1171,363,937,363,763,359,590,338,498,319"/>
<area shape="poly" title=" " alt="" coords="1241,409,1314,400,1351,391,1387,377,1417,356,1441,331,1444,335,1420,360,1389,382,1353,396,1315,406,1242,414"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="1317,449,1373,475"/>
<area shape="poly" title=" " alt="" coords="1215,422,1304,448,1303,453,1214,427"/>
<area shape="poly" title=" " alt="" coords="1364,447,1386,428,1421,380,1446,334,1451,336,1426,383,1390,432,1368,451"/>
</map>
</div>

</div>
</div>
<a id="a83d78cd6b52bd3932fb1ae9561a1c148" name="a83d78cd6b52bd3932fb1ae9561a1c148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83d78cd6b52bd3932fb1ae9561a1c148">&#9670;&#160;</a></span>Thomson_cooling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> Thomson_cooling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a1ed93cca9de717545d10f8619effaf3a">SynElectronGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>electron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="synchrotron_8h.html#a0ab8637927d98b2552ae0f5b9eb5e5c2">SynPhotonGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>photon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies Thomson cooling to electrons based on photon distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">electron</td><td>The electron grid to be modified </td></tr>
    <tr><td class="paramname">photon</td><td>The photon grid </td></tr>
    <tr><td class="paramname">shock</td><td>The shock properties </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8cpp_source.html#l00179">179</a> of file <a class="el" href="inverse-compton_8cpp_source.html">inverse-compton.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  179</span>                                                                                             {</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordtype">size_t</span> phi_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[0];</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordtype">size_t</span> theta_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[1];</div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordtype">size_t</span> t_size = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>.shape()[2];</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; phi_size; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>++) {</div>
<div class="line"><span class="lineno">  185</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  186</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_size; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) {</div>
<div class="line"><span class="lineno">  187</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> Y_T = <a class="code hl_function" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116">compute_Thomson_Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.B(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.t_comv(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_e, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.eps_B,</div>
<div class="line"><span class="lineno">  188</span>                                             <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>));</div>
<div class="line"><span class="lineno">  189</span>                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>).Ys = <a class="code hl_struct" href="structInverseComptonY.html">InverseComptonY</a>(Y_T);</div>
<div class="line"><span class="lineno">  190</span>            }</div>
<div class="line"><span class="lineno">  191</span>        }</div>
<div class="line"><span class="lineno">  192</span>    }</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_function" href="synchrotron_8h.html#af56f9b4417a5f3e717102da3e81a7d37">update_electrons_4Y</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_function" href="synchrotron_8h.html#a331f545228d2b18e84e0252510e295f8">generate_syn_photons</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">electrons</a>);</div>
<div class="line"><span class="lineno">  195</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="inverse-compton_8h_a83d78cd6b52bd3932fb1ae9561a1c148_cgraph.png" border="0" usemap="#ainverse-compton_8h_a83d78cd6b52bd3932fb1ae9561a1c148_cgraph" alt=""/></div>
<map name="ainverse-compton_8h_a83d78cd6b52bd3932fb1ae9561a1c148_cgraph" id="ainverse-compton_8h_a83d78cd6b52bd3932fb1ae9561a1c148_cgraph">
<area shape="rect" title="Applies Thomson cooling to electrons based on photon distribution." alt="" coords="5,284,141,309"/>
<area shape="rect" href="inverse-compton_8cpp.html#acd9474d0630c4e995f6902006749d116" title=" " alt="" coords="189,199,351,224"/>
<area shape="poly" title=" " alt="" coords="103,281,226,227,228,232,105,286"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="1477,297,1528,323"/>
<area shape="poly" title=" " alt="" coords="81,282,134,215,176,170,226,123,284,78,348,40,417,14,453,7,490,5,1213,5,1278,3,1332,5,1356,10,1380,20,1405,35,1431,57,1453,83,1470,111,1492,174,1502,235,1505,283,1499,283,1497,235,1487,175,1465,114,1448,86,1427,61,1402,40,1378,25,1355,15,1331,10,1278,8,1213,10,490,10,454,12,419,19,350,45,287,82,230,127,180,174,138,219,86,285"/>
<area shape="rect" href="synchrotron_8cpp.html#a331f545228d2b18e84e0252510e295f8" title="Creates and returns a new photon grid based on shock and electron grid." alt="" coords="895,575,1065,600"/>
<area shape="poly" title=" " alt="" coords="92,307,135,341,191,377,279,422,372,460,468,491,563,518,740,555,882,575,881,581,739,560,562,523,466,497,371,465,277,427,188,382,132,345,89,312"/>
<area shape="rect" href="synchrotron_8cpp.html#af56f9b4417a5f3e717102da3e81a7d37" title="Updates electron properties throughout the grid based on shock parameters and IC Y values." alt="" coords="191,341,349,367"/>
<area shape="poly" title=" " alt="" coords="118,307,214,335,212,340,117,312"/>
<area shape="rect" href="synchrotron_8cpp.html#a52e34d49dd7497d65ea5261e80d615d4" title="Calculates cooling Lorentz factor based on comoving time, magnetic field, and IC parameters." alt="" coords="416,227,567,252"/>
<area shape="poly" title=" " alt="" coords="351,219,403,225,402,231,351,224"/>
<area shape="poly" title=" " alt="" coords="292,196,362,159,469,112,531,90,596,72,663,60,731,55,1213,55,1277,53,1330,52,1355,55,1379,63,1404,77,1431,97,1450,117,1466,141,1487,192,1498,242,1503,284,1498,284,1493,243,1482,193,1461,143,1446,121,1428,101,1401,81,1377,68,1353,61,1330,57,1278,58,1213,61,731,61,664,65,597,77,532,95,471,117,365,163,294,201"/>
<area shape="rect" href="inverse-compton_8cpp.html#ad89f660f1954e9c12551a19840d656bb" title=" " alt="" coords="697,169,767,195"/>
<area shape="poly" title=" " alt="" coords="351,204,683,182,683,188,351,209"/>
<area shape="rect" href="structInverseComptonY.html#a05b76b4d84f50b82728333a42362fc0f" title="Returns the Thomson Y parameter from the provided InverseComptonY object." alt="" coords="632,219,832,259"/>
<area shape="poly" title=" " alt="" coords="567,237,618,237,618,242,567,242"/>
<area shape="rect" href="structInverseComptonY.html#a9a35d3af9bd23acdde9d09d38ee116eb" title="Calculates the effective Y parameter at a specific Lorentz factor and spectral index." alt="" coords="632,283,832,323"/>
<area shape="poly" title=" " alt="" coords="541,250,644,277,642,282,540,255"/>
<area shape="poly" title=" " alt="" coords="508,224,561,189,595,170,631,154,726,125,802,111,879,106,979,106,1213,106,1276,102,1328,97,1353,98,1377,103,1403,114,1431,132,1448,147,1462,166,1483,207,1495,248,1501,283,1496,284,1490,250,1478,209,1457,169,1444,151,1428,136,1401,118,1376,108,1352,103,1328,102,1277,107,1213,111,979,111,880,112,802,116,727,130,633,159,597,174,563,193,511,229"/>
<area shape="rect" href="structInverseComptonY.html#ae483ec2ba4108fbf96fb15c3e978c0b3" title="Calculates the effective Y parameter for a given Lorentz factor and spectral index." alt="" coords="880,239,1080,279"/>
<area shape="poly" title=" " alt="" coords="832,283,866,277,867,282,833,288"/>
<area shape="rect" href="utilities_8h.html#a4520a27a10a2aef33c99ad8c679da404" title="Fast approximation of a raised to the power of b." alt="" coords="1171,247,1252,272"/>
<area shape="poly" title=" " alt="" coords="1080,257,1157,257,1157,262,1080,262"/>
<area shape="rect" href="utilities_8h.html#ae490b13fdcc1b917ecdd08c0cecf3556" title="Computes a^(4/3)" alt="" coords="1353,147,1419,172"/>
<area shape="poly" title=" " alt="" coords="1062,237,1339,168,1341,173,1063,242"/>
<area shape="rect" href="utilities_8h.html#afc584c30c352192de6847b1f4b8caf0e" title="Fast approximation of 2 raised to a power." alt="" coords="1343,196,1429,221"/>
<area shape="poly" title=" " alt="" coords="1251,245,1329,222,1330,228,1253,250"/>
<area shape="poly" title=" " alt="" coords="1252,259,1335,267,1430,283,1465,293,1463,299,1429,289,1334,273,1252,264"/>
<area shape="rect" href="utilities_8h.html#afe0a1b1b7509ac4df83fcc0e510f281b" title="Fast approximation of the base&#45;2 logarithm." alt="" coords="1345,297,1427,323"/>
<area shape="poly" title=" " alt="" coords="1253,268,1332,292,1331,297,1251,273"/>
<area shape="poly" title=" " alt="" coords="1407,219,1431,239,1481,286,1478,289,1428,243,1404,224"/>
<area shape="poly" title=" " alt="" coords="1483,298,1479,289,1481,279,1489,273,1503,271,1519,274,1526,282,1522,286,1516,279,1503,276,1491,278,1485,282,1484,288,1487,296"/>
<area shape="poly" title=" " alt="" coords="1428,307,1463,307,1463,313,1428,313"/>
<area shape="poly" title=" " alt="" coords="1416,170,1431,181,1452,206,1470,233,1494,283,1489,286,1465,236,1448,209,1427,185,1413,174"/>
<area shape="poly" title=" " alt="" coords="768,183,905,198,1080,225,1158,242,1157,247,1080,230,904,203,767,188"/>
<area shape="poly" title=" " alt="" coords="1039,597,1127,609,1178,611,1233,609,1287,600,1339,585,1387,560,1427,525,1444,504,1458,479,1479,427,1491,377,1497,336,1502,337,1496,378,1484,429,1463,482,1449,507,1431,529,1390,565,1341,590,1288,606,1233,614,1178,616,1126,614,1038,603"/>
<area shape="poly" title=" " alt="" coords="995,572,1035,535,1078,486,1092,458,1098,433,1106,409,1126,385,1175,353,1229,332,1283,318,1331,311,1331,316,1284,323,1231,337,1177,358,1130,389,1111,412,1103,435,1097,460,1082,489,1039,539,999,576"/>
<area shape="rect" href="synchrotron_8cpp.html#a936bfaa522ec8295a21d253e5453188d" title="Calculates synchrotron frequency for a given Lorentz factor and magnetic field." alt="" coords="1140,549,1283,575"/>
<area shape="poly" title=" " alt="" coords="1065,575,1126,569,1126,574,1065,581"/>
<area shape="poly" title=" " alt="" coords="290,339,397,277,444,255,447,260,400,282,293,343"/>
<area shape="poly" title=" " alt="" coords="349,347,460,339,584,326,618,321,619,326,584,331,461,344,349,352"/>
<area shape="poly" title=" " alt="" coords="284,365,331,414,364,443,400,468,551,556,615,589,676,616,738,636,807,650,886,658,979,661,1213,661,1280,660,1333,651,1356,643,1379,630,1427,587,1449,558,1466,525,1479,491,1488,455,1498,388,1500,336,1505,337,1503,389,1494,456,1484,492,1471,528,1454,561,1431,590,1382,634,1358,648,1334,657,1280,665,1213,666,979,666,885,663,806,655,737,641,674,621,612,594,549,560,397,472,361,447,328,418,280,368"/>
<area shape="rect" href="synchrotron_8cpp.html#ab09dbe28fcecfc3d846577c1c34fcca6" title=" " alt="" coords="889,449,1071,475"/>
<area shape="poly" title=" " alt="" coords="289,365,336,398,367,415,399,427,461,444,525,455,653,469,774,472,875,468,875,474,774,477,653,474,524,461,460,449,398,433,365,419,333,402,285,369"/>
<area shape="rect" href="synchrotron_8cpp.html#a1c5ae0a77c927eb60684c180ba559567" title=" " alt="" coords="399,291,584,316"/>
<area shape="poly" title=" " alt="" coords="326,339,421,316,423,322,327,344"/>
<area shape="rect" href="synchrotron_8cpp.html#a5813eed02877ed5f35a34e929a68d263" title=" " alt="" coords="1140,399,1283,424"/>
<area shape="poly" title=" " alt="" coords="349,357,632,377,1126,404,1126,410,632,382,349,362"/>
<area shape="poly" title=" " alt="" coords="987,447,1040,374,1080,329,1126,289,1157,273,1159,278,1130,294,1084,333,1044,377,991,451"/>
<area shape="poly" title=" " alt="" coords="1012,472,1090,500,1142,513,1199,524,1259,528,1318,525,1375,511,1428,485,1445,471,1459,454,1479,413,1491,372,1497,336,1502,337,1496,373,1484,415,1463,457,1449,475,1431,490,1377,516,1319,530,1259,534,1198,529,1141,519,1089,505,1010,477"/>
<area shape="poly" title=" " alt="" coords="1009,472,1129,528,1164,542,1162,547,1127,532,1006,477"/>
<area shape="rect" href="synchrotron_8cpp.html#a85433be4a0da2f510240a603da8f7dff" title=" " alt="" coords="1128,448,1295,473"/>
<area shape="poly" title=" " alt="" coords="1071,459,1114,459,1114,464,1071,464"/>
<area shape="poly" title=" " alt="" coords="540,288,642,260,644,265,541,293"/>
<area shape="poly" title=" " alt="" coords="584,301,618,301,618,306,584,306"/>
<area shape="poly" title=" " alt="" coords="541,313,632,333,805,354,979,358,1213,358,1322,354,1429,333,1464,322,1465,327,1430,338,1322,359,1213,363,979,363,804,359,632,338,539,319"/>
<area shape="poly" title=" " alt="" coords="1282,409,1355,400,1393,391,1428,377,1458,356,1482,331,1486,335,1462,360,1431,382,1394,396,1356,406,1283,414"/>
<area shape="rect" href="synchrotron_8cpp.html#a59b47fc71384572d072692740171988e" title=" " alt="" coords="1358,449,1414,475"/>
<area shape="poly" title=" " alt="" coords="1257,422,1346,448,1344,453,1255,427"/>
<area shape="poly" title=" " alt="" coords="1406,447,1427,428,1462,380,1487,334,1492,336,1467,383,1431,432,1409,451"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2bf720c7c87d960838095b276b09c664" name="a2bf720c7c87d960838095b276b09c664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bf720c7c87d960838095b276b09c664">&#9670;&#160;</a></span>IC_x0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> IC_x0 = <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">std::sqrt</a>(2) / 3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A constant used in the IC photon calculation, defined as √2/3. </p>

<p class="definition">Definition at line <a class="el" href="inverse-compton_8h_source.html#l00029">29</a> of file <a class="el" href="inverse-compton_8h_source.html">inverse-compton.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="inverse-compton_8h.html">inverse-compton.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
