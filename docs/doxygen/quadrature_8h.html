<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: quadrature.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('quadrature_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">quadrature.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mesh_8h_source.html">mesh.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for quadrature.h:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h__incl.png" border="0" usemap="#aquadrature_8h" alt=""/></div>
<map name="aquadrature_8h" id="aquadrature_8h">
<area shape="rect" title=" " alt="" coords="507,5,613,31"/>
<area shape="rect" href="mesh_8h.html" title=" " alt="" coords="525,79,595,104"/>
<area shape="poly" title=" " alt="" coords="563,31,563,65,557,65,557,31"/>
<area shape="rect" title=" " alt="" coords="5,159,91,185"/>
<area shape="poly" title=" " alt="" coords="525,97,343,115,223,131,103,155,91,158,90,153,102,149,223,126,342,109,524,92"/>
<area shape="rect" title=" " alt="" coords="115,159,184,185"/>
<area shape="poly" title=" " alt="" coords="525,99,380,117,288,133,197,155,189,157,187,152,195,149,287,128,379,111,524,93"/>
<area shape="rect" title=" " alt="" coords="208,159,275,185"/>
<area shape="poly" title=" " alt="" coords="525,101,418,121,287,155,281,157,279,152,286,149,417,116,524,96"/>
<area shape="rect" title=" " alt="" coords="299,159,373,185"/>
<area shape="poly" title=" " alt="" coords="526,107,386,155,380,157,378,152,384,149,524,102"/>
<area shape="rect" title=" " alt="" coords="397,159,451,185"/>
<area shape="poly" title=" " alt="" coords="541,106,457,155,455,150,539,102"/>
<area shape="rect" title=" " alt="" coords="475,159,538,185"/>
<area shape="poly" title=" " alt="" coords="554,106,525,149,520,146,550,103"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="657,240,775,265"/>
<area shape="poly" title=" " alt="" coords="597,100,640,119,662,133,681,150,693,168,703,188,714,225,709,227,698,190,689,171,677,154,658,137,637,124,594,105"/>
<area shape="rect" href="traits_8h.html" title=" " alt="" coords="562,159,667,185"/>
<area shape="poly" title=" " alt="" coords="570,103,601,147,597,150,566,106"/>
<area shape="rect" title=" " alt="" coords="743,159,931,185"/>
<area shape="poly" title=" " alt="" coords="596,100,784,153,783,158,595,105"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="956,159,1039,185"/>
<area shape="poly" title=" " alt="" coords="596,93,748,112,846,128,945,149,956,152,954,158,943,155,845,133,748,117,595,99"/>
<area shape="rect" title=" " alt="" coords="1063,152,1206,192"/>
<area shape="poly" title=" " alt="" coords="596,93,786,113,1050,149,1050,155,785,118,596,98"/>
<area shape="rect" title=" " alt="" coords="1230,159,1413,185"/>
<area shape="poly" title=" " alt="" coords="596,92,856,111,1036,128,1219,149,1251,154,1250,160,1218,155,1035,133,855,116,595,97"/>
<area shape="rect" title=" " alt="" coords="593,321,652,346"/>
<area shape="poly" title=" " alt="" coords="704,268,649,314,645,310,701,263"/>
<area shape="rect" title=" " alt="" coords="677,321,755,346"/>
<area shape="poly" title=" " alt="" coords="719,266,719,307,713,307,713,266"/>
<area shape="rect" href="simulation-defaults_8h.html" title="Centralized simulation configuration defaults." alt="" coords="780,313,927,353"/>
<area shape="poly" title=" " alt="" coords="738,263,809,304,807,309,735,268"/>
<area shape="rect" title=" " alt="" coords="818,401,889,427"/>
<area shape="poly" title=" " alt="" coords="856,354,856,387,851,387,851,354"/>
<area shape="poly" title=" " alt="" coords="631,183,692,229,688,233,628,187"/>
<area shape="rect" title=" " alt="" coords="576,240,632,265"/>
<area shape="poly" title=" " alt="" coords="616,185,610,227,605,226,610,184"/>
<area shape="poly" title=" " alt="" coords="967,187,945,195,778,239,777,234,943,189,965,182"/>
<area shape="rect" title=" " alt="" coords="966,240,1029,265"/>
<area shape="poly" title=" " alt="" coords="1000,185,1000,226,995,226,995,185"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h__dep__incl.png" border="0" usemap="#aquadrature_8hdep" alt=""/></div>
<map name="aquadrature_8hdep" id="aquadrature_8hdep">
<area shape="rect" title=" " alt="" coords="107,5,213,31"/>
<area shape="rect" href="inverse-compton_8h.html" title=" " alt="" coords="88,79,232,104"/>
<area shape="poly" title=" " alt="" coords="163,44,163,79,157,79,157,44"/>
<area shape="rect" href="afterglow_8h.html" title=" " alt="" coords="329,372,423,397"/>
<area shape="poly" title=" " alt="" coords="101,111,66,128,35,154,18,177,10,199,9,222,16,250,25,274,35,292,48,307,69,322,101,339,135,352,205,370,272,379,328,382,328,387,272,385,204,376,133,357,99,344,66,326,45,311,30,295,20,276,11,251,4,222,5,198,14,175,31,150,63,124,99,106"/>
<area shape="rect" href="inverse-compton_8cpp.html" title=" " alt="" coords="79,299,238,324"/>
<area shape="poly" title=" " alt="" coords="126,113,84,139,45,172,31,191,22,210,21,230,29,249,43,266,60,278,100,296,98,301,57,283,39,269,24,252,16,230,17,209,26,188,41,169,81,135,123,108"/>
<area shape="rect" href="power-law-syn_8cpp.html" title=" " alt="" coords="39,225,185,251"/>
<area shape="poly" title=" " alt="" coords="125,113,102,130,85,153,81,171,85,190,104,223,100,226,80,192,76,172,80,151,98,127,122,109"/>
<area shape="rect" href="power-law-syn_8h.html" title=" " alt="" coords="95,152,225,177"/>
<area shape="poly" title=" " alt="" coords="163,118,163,152,157,152,157,118"/>
<area shape="rect" href="smooth-power-law-syn_8h.html" title=" " alt="" coords="249,152,433,177"/>
<area shape="poly" title=" " alt="" coords="203,106,313,149,311,154,201,111"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="431,225,542,251"/>
<area shape="poly" title=" " alt="" coords="246,99,362,119,412,133,447,150,463,167,475,188,487,224,482,226,470,190,459,170,444,154,410,138,360,124,245,105"/>
<area shape="rect" href="synchrotron_8cpp.html" title=" " alt="" coords="517,299,643,324"/>
<area shape="poly" title=" " alt="" coords="246,94,299,100,358,110,418,127,474,150,502,165,522,179,539,198,557,224,574,263,581,298,576,299,569,265,552,227,535,201,519,183,499,169,472,154,416,132,357,116,299,105,246,99"/>
<area shape="rect" href="shock__dispatch_8h.html" title=" " alt="" coords="309,445,443,471"/>
<area shape="poly" title=" " alt="" coords="379,411,379,445,373,445,373,411"/>
<area shape="rect" href="pymodel_8h.html" title=" " alt="" coords="331,519,421,544"/>
<area shape="poly" title=" " alt="" coords="379,484,379,519,373,519,373,484"/>
<area shape="rect" href="pybind_8cpp.html" title=" " alt="" coords="268,592,361,617"/>
<area shape="poly" title=" " alt="" coords="359,556,327,594,322,590,355,553"/>
<area shape="rect" href="pymodel_8cpp.html" title=" " alt="" coords="385,592,492,617"/>
<area shape="poly" title=" " alt="" coords="397,553,430,590,426,594,393,556"/>
<area shape="poly" title=" " alt="" coords="147,190,122,227,117,224,142,187"/>
<area shape="rect" href="smooth-power-law-syn_8cpp.html" title=" " alt="" coords="209,225,407,251"/>
<area shape="poly" title=" " alt="" coords="332,191,316,226,311,224,328,189"/>
<area shape="poly" title=" " alt="" coords="378,181,464,223,462,228,376,186"/>
<area shape="poly" title=" " alt="" coords="467,263,434,300,385,373,380,370,430,297,463,259"/>
<area shape="poly" title=" " alt="" coords="421,256,212,301,211,296,420,251"/>
<area shape="rect" href="IO_8h.html" title=" " alt="" coords="444,299,492,324"/>
<area shape="poly" title=" " alt="" coords="483,265,474,299,468,298,477,263"/>
<area shape="poly" title=" " alt="" coords="514,257,566,296,563,301,511,261"/>
<area shape="poly" title=" " alt="" coords="444,334,393,374,389,370,441,330"/>
<area shape="rect" href="IO_8cpp.html" title=" " alt="" coords="447,372,510,397"/>
<area shape="poly" title=" " alt="" coords="474,337,479,371,474,372,469,338"/>
</map>
</div>
</div>
<p><a href="quadrature_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad8e274e15883ecba8f7f8b8868512e9f" id="r_ad8e274e15883ecba8f7f8b8868512e9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#ad8e274e15883ecba8f7f8b8868512e9f">compute_bin_widths</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dg</a>)</td></tr>
<tr class="memdesc:ad8e274e15883ecba8f7f8b8868512e9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes interval widths dg(j) = grid(j+1) - grid(j) from a grid of boundaries.  <br /></td></tr>
<tr class="separator:ad8e274e15883ecba8f7f8b8868512e9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8c6daba33e031c452a1a793f84a90c2" id="r_aa8c6daba33e031c452a1a793f84a90c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#aa8c6daba33e031c452a1a793f84a90c2">compute_midpoint_grid</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundaries</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">centers</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>)</td></tr>
<tr class="memdesc:aa8c6daba33e031c452a1a793f84a90c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a boundary grid to a midpoint grid with bin widths (midpoint rule, O(h^2)).  <br /></td></tr>
<tr class="separator:aa8c6daba33e031c452a1a793f84a90c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4065ed7135838f03cf8f636b5731674e" id="r_a4065ed7135838f03cf8f636b5731674e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#a4065ed7135838f03cf8f636b5731674e">compute_rectangle_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>)</td></tr>
<tr class="memdesc:a4065ed7135838f03cf8f636b5731674e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes left-rectangle quadrature weights (O(h)).  <br /></td></tr>
<tr class="separator:a4065ed7135838f03cf8f636b5731674e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70287ab6faa3f63aeec720921229fa48" id="r_a70287ab6faa3f63aeec720921229fa48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#a70287ab6faa3f63aeec720921229fa48">compute_trapezoidal_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>)</td></tr>
<tr class="memdesc:a70287ab6faa3f63aeec720921229fa48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes trapezoidal quadrature weights for a non-uniform grid.  <br /></td></tr>
<tr class="separator:a70287ab6faa3f63aeec720921229fa48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a982f638aed9a35e7ed8d734cabaeba99" id="r_a982f638aed9a35e7ed8d734cabaeba99"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#a982f638aed9a35e7ed8d734cabaeba99">compute_simpson_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>)</td></tr>
<tr class="memdesc:a982f638aed9a35e7ed8d734cabaeba99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes composite Simpson's quadrature weights for a non-uniform grid.  <br /></td></tr>
<tr class="separator:a982f638aed9a35e7ed8d734cabaeba99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a160a2956a4466e2e97a7f1c2b88626c9" id="r_a160a2956a4466e2e97a7f1c2b88626c9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#a160a2956a4466e2e97a7f1c2b88626c9">compute_boole_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>)</td></tr>
<tr class="memdesc:a160a2956a4466e2e97a7f1c2b88626c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes Boole's rule (Newton-Cotes 4th order, O(h^6)) weights for a uniform log-spaced grid.  <br /></td></tr>
<tr class="separator:a160a2956a4466e2e97a7f1c2b88626c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1455a160700818cfb5466e5517482ee" id="r_aa1455a160700818cfb5466e5517482ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#aa1455a160700818cfb5466e5517482ee">compute_nc7_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>)</td></tr>
<tr class="memdesc:aa1455a160700818cfb5466e5517482ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes 7-point Newton-Cotes (O(h^8)) weights for a uniform log-spaced grid.  <br /></td></tr>
<tr class="separator:aa1455a160700818cfb5466e5517482ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad8e274e15883ecba8f7f8b8868512e9f" name="ad8e274e15883ecba8f7f8b8868512e9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8e274e15883ecba8f7f8b8868512e9f">&#9670;&#160;</a></span>compute_bin_widths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> compute_bin_widths </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>dg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes interval widths dg(j) = grid(j+1) - grid(j) from a grid of boundaries. </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00017">17</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   17</span>                                                             {</div>
<div class="line"><span class="lineno">   18</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a> = grid.size();</div>
<div class="line"><span class="lineno">   19</span>    <span class="keywordflow">if</span> (m &gt;= 2) {</div>
<div class="line"><span class="lineno">   20</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dg</a> = Array::from_shape({<a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a> - 1});</div>
<div class="line"><span class="lineno">   21</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1 &lt; <a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>)</div>
<div class="line"><span class="lineno">   22</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dg</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) = grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) - grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>);</div>
<div class="line"><span class="lineno">   23</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   24</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">dg</a> = Array::from_shape({0});</div>
<div class="line"><span class="lineno">   25</span>    }</div>
<div class="line"><span class="lineno">   26</span>}</div>
<div class="ttc" id="anamespaceunit_html_a6b886b7bc31732cd2aee3752b854f00c"><div class="ttname"><a href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">unit::m</a></div><div class="ttdeci">constexpr Real m</div><div class="ttdoc">Meter in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00066">macros.h:66</a></div></div>
<div class="ttc" id="apybind_8cpp_html_ad93eae6422741850877b46bd61f08c89"><div class="ttname"><a href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">make_native_binary</a></div><div class="ttdeci">BinaryFunc make_native_binary(uintptr_t addr, std::vector&lt; Real &gt; const &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="pybind_8cpp_source.html#l00027">pybind.cpp:27</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_ad8e274e15883ecba8f7f8b8868512e9f_cgraph.png" border="0" usemap="#aquadrature_8h_ad8e274e15883ecba8f7f8b8868512e9f_cgraph" alt=""/></div>
<map name="aquadrature_8h_ad8e274e15883ecba8f7f8b8868512e9f_cgraph" id="aquadrature_8h_ad8e274e15883ecba8f7f8b8868512e9f_cgraph">
<area shape="rect" title="Computes interval widths dg(j) = grid(j+1) &#45; grid(j) from a grid of boundaries." alt="" coords="5,5,161,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="209,5,364,31"/>
<area shape="poly" title=" " alt="" coords="162,15,195,15,195,21,162,21"/>
</map>
</div>

</div>
</div>
<a id="a160a2956a4466e2e97a7f1c2b88626c9" name="a160a2956a4466e2e97a7f1c2b88626c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a160a2956a4466e2e97a7f1c2b88626c9">&#9670;&#160;</a></span>compute_boole_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> compute_boole_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes Boole's rule (Newton-Cotes 4th order, O(h^6)) weights for a uniform log-spaced grid. </p>
<p>Operates in log-space where the grid is uniform, then applies the Jacobian (gamma_i) to convert back to linear-space weights. Groups of 4 intervals use Boole's coefficients [7, 32, 12, 32, 7] * 2h/45. Leftovers use Simpson's 3/8, 1/3, or trapezoidal. </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00138">138</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  138</span>                                                                     {</div>
<div class="line"><span class="lineno">  139</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">  140</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a> = xt::zeros&lt;Real&gt;({n});</div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordflow">if</span> (n &lt; 2)</div>
<div class="line"><span class="lineno">  142</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    <span class="comment">// Uniform spacing in log space</span></div>
<div class="line"><span class="lineno">  145</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> = std::log(grid(1) / grid(0));</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">// Process groups of 4 intervals (5 points) with Boole&#39;s rule</span></div>
<div class="line"><span class="lineno">  148</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> = 2.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 45.0;</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0;</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">for</span> (; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 4 &lt; n; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> += 4) {</div>
<div class="line"><span class="lineno">  151</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 7;</div>
<div class="line"><span class="lineno">  152</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 32;</div>
<div class="line"><span class="lineno">  153</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 12;</div>
<div class="line"><span class="lineno">  154</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 3) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 32;</div>
<div class="line"><span class="lineno">  155</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 4) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 7;</div>
<div class="line"><span class="lineno">  156</span>    }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    <span class="comment">// Leftover intervals</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> = n - 1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>;</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> == 3) {</div>
<div class="line"><span class="lineno">  161</span>        <span class="comment">// Simpson&#39;s 3/8 rule: (3h/8) * [1, 3, 3, 1]</span></div>
<div class="line"><span class="lineno">  162</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a> = 3.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 8.0;</div>
<div class="line"><span class="lineno">  163</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a>;</div>
<div class="line"><span class="lineno">  164</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a> * 3;</div>
<div class="line"><span class="lineno">  165</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a> * 3;</div>
<div class="line"><span class="lineno">  166</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 3) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a>;</div>
<div class="line"><span class="lineno">  167</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> == 2) {</div>
<div class="line"><span class="lineno">  168</span>        <span class="comment">// Simpson&#39;s 1/3 rule: (h/3) * [1, 4, 1]</span></div>
<div class="line"><span class="lineno">  169</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c13</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 3.0;</div>
<div class="line"><span class="lineno">  170</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c13</a>;</div>
<div class="line"><span class="lineno">  171</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c13</a> * 4;</div>
<div class="line"><span class="lineno">  172</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c13</a>;</div>
<div class="line"><span class="lineno">  173</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> == 1) {</div>
<div class="line"><span class="lineno">  174</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  175</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  176</span>    }</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    <span class="comment">// Jacobian: dγ = γ · d(ln γ), convert log-space weights to linear-space</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  180</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) *= grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>);</div>
<div class="line"><span class="lineno">  181</span>    }</div>
<div class="line"><span class="lineno">  182</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00024">macros.h:24</a></div></div>
<div class="ttc" id="anamespacecon_html_a07ddec20ab09a3078fce714358b65b4b"><div class="ttname"><a href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a></div><div class="ttdeci">constexpr Real h</div><div class="ttdoc">Planck constant in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00093">macros.h:93</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_a160a2956a4466e2e97a7f1c2b88626c9_cgraph.png" border="0" usemap="#aquadrature_8h_a160a2956a4466e2e97a7f1c2b88626c9_cgraph" alt=""/></div>
<map name="aquadrature_8h_a160a2956a4466e2e97a7f1c2b88626c9_cgraph" id="aquadrature_8h_a160a2956a4466e2e97a7f1c2b88626c9_cgraph">
<area shape="rect" title="Computes Boole&#39;s rule (Newton&#45;Cotes 4th order, O(h^6)) weights for a uniform log&#45;spaced grid." alt="" coords="5,5,185,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="233,5,388,31"/>
<area shape="poly" title=" " alt="" coords="186,15,219,15,219,21,186,21"/>
</map>
</div>

</div>
</div>
<a id="aa8c6daba33e031c452a1a793f84a90c2" name="aa8c6daba33e031c452a1a793f84a90c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8c6daba33e031c452a1a793f84a90c2">&#9670;&#160;</a></span>compute_midpoint_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> compute_midpoint_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundaries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>centers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Converts a boundary grid to a midpoint grid with bin widths (midpoint rule, O(h^2)). </p>
<p>Given N boundary points, produces N-1 center points (geometric mean of adjacent boundaries) and N-1 bin widths. Works with any grid (uniform, adaptive, logspace). </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00036">36</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   36</span>                                                                                           {</div>
<div class="line"><span class="lineno">   37</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundaries</a>.size();</div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">if</span> (n &lt; 2) {</div>
<div class="line"><span class="lineno">   39</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">centers</a> = Array::from_shape({0});</div>
<div class="line"><span class="lineno">   40</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a> = Array::from_shape({0});</div>
<div class="line"><span class="lineno">   41</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   42</span>    }</div>
<div class="line"><span class="lineno">   43</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a> = n - 1;</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">centers</a> = Array::from_shape({<a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a>});</div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a> = Array::from_shape({<a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a>});</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> &lt; <a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a>; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">   47</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">centers</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) = std::sqrt(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundaries</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundaries</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1));</div>
<div class="line"><span class="lineno">   48</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundaries</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">boundaries</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>);</div>
<div class="line"><span class="lineno">   49</span>    }</div>
<div class="line"><span class="lineno">   50</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_aa8c6daba33e031c452a1a793f84a90c2_cgraph.png" border="0" usemap="#aquadrature_8h_aa8c6daba33e031c452a1a793f84a90c2_cgraph" alt=""/></div>
<map name="aquadrature_8h_aa8c6daba33e031c452a1a793f84a90c2_cgraph" id="aquadrature_8h_aa8c6daba33e031c452a1a793f84a90c2_cgraph">
<area shape="rect" title="Converts a boundary grid to a midpoint grid with bin widths (midpoint rule, O(h^2))." alt="" coords="5,5,181,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="229,5,384,31"/>
<area shape="poly" title=" " alt="" coords="182,15,215,15,215,21,182,21"/>
</map>
</div>

</div>
</div>
<a id="aa1455a160700818cfb5466e5517482ee" name="aa1455a160700818cfb5466e5517482ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1455a160700818cfb5466e5517482ee">&#9670;&#160;</a></span>compute_nc7_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> compute_nc7_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes 7-point Newton-Cotes (O(h^8)) weights for a uniform log-spaced grid. </p>
<p>Groups of 6 intervals use coefficients [41, 216, 27, 272, 27, 216, 41] * h/140. Leftovers cascade: 5→6-pt, 4→Boole's, 3→Simpson 3/8, 2→Simpson 1/3, 1→trapezoidal. All weights are positive (highest NC order with this property is 8-point). </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00193">193</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  193</span>                                                                   {</div>
<div class="line"><span class="lineno">  194</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">  195</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a> = xt::zeros&lt;Real&gt;({n});</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">if</span> (n &lt; 2)</div>
<div class="line"><span class="lineno">  197</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> = std::log(grid(1) / grid(0));</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    <span class="comment">// Groups of 6 intervals (7 points): h/140 * [41, 216, 27, 272, 27, 216, 41]</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c7</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 140.0;</div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0;</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">for</span> (; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 6 &lt; n; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> += 6) {</div>
<div class="line"><span class="lineno">  205</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c7</a> * 41;</div>
<div class="line"><span class="lineno">  206</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c7</a> * 216;</div>
<div class="line"><span class="lineno">  207</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c7</a> * 27;</div>
<div class="line"><span class="lineno">  208</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 3) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c7</a> * 272;</div>
<div class="line"><span class="lineno">  209</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 4) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c7</a> * 27;</div>
<div class="line"><span class="lineno">  210</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 5) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c7</a> * 216;</div>
<div class="line"><span class="lineno">  211</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 6) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c7</a> * 41;</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> = n - 1 - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>;</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> == 5) {</div>
<div class="line"><span class="lineno">  216</span>        <span class="comment">// 6-point: 5h/288 * [19, 75, 50, 50, 75, 19]</span></div>
<div class="line"><span class="lineno">  217</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c6</a> = 5.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 288.0;</div>
<div class="line"><span class="lineno">  218</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c6</a> * 19;</div>
<div class="line"><span class="lineno">  219</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c6</a> * 75;</div>
<div class="line"><span class="lineno">  220</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c6</a> * 50;</div>
<div class="line"><span class="lineno">  221</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 3) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c6</a> * 50;</div>
<div class="line"><span class="lineno">  222</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 4) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c6</a> * 75;</div>
<div class="line"><span class="lineno">  223</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 5) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c6</a> * 19;</div>
<div class="line"><span class="lineno">  224</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> == 4) {</div>
<div class="line"><span class="lineno">  225</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> = 2.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 45.0;</div>
<div class="line"><span class="lineno">  226</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 7;</div>
<div class="line"><span class="lineno">  227</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 32;</div>
<div class="line"><span class="lineno">  228</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 12;</div>
<div class="line"><span class="lineno">  229</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 3) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 32;</div>
<div class="line"><span class="lineno">  230</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 4) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">cb</a> * 7;</div>
<div class="line"><span class="lineno">  231</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> == 3) {</div>
<div class="line"><span class="lineno">  232</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a> = 3.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 8.0;</div>
<div class="line"><span class="lineno">  233</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a>;</div>
<div class="line"><span class="lineno">  234</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a> * 3;</div>
<div class="line"><span class="lineno">  235</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a> * 3;</div>
<div class="line"><span class="lineno">  236</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 3) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c38</a>;</div>
<div class="line"><span class="lineno">  237</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> == 2) {</div>
<div class="line"><span class="lineno">  238</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c13</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 3.0;</div>
<div class="line"><span class="lineno">  239</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c13</a>;</div>
<div class="line"><span class="lineno">  240</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c13</a> * 4;</div>
<div class="line"><span class="lineno">  241</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">c13</a>;</div>
<div class="line"><span class="lineno">  242</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">remaining</a> == 1) {</div>
<div class="line"><span class="lineno">  243</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  244</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  245</span>    }</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a> &lt; n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) {</div>
<div class="line"><span class="lineno">  248</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>) *= grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">i</a>);</div>
<div class="line"><span class="lineno">  249</span>    }</div>
<div class="line"><span class="lineno">  250</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_aa1455a160700818cfb5466e5517482ee_cgraph.png" border="0" usemap="#aquadrature_8h_aa1455a160700818cfb5466e5517482ee_cgraph" alt=""/></div>
<map name="aquadrature_8h_aa1455a160700818cfb5466e5517482ee_cgraph" id="aquadrature_8h_aa1455a160700818cfb5466e5517482ee_cgraph">
<area shape="rect" title="Computes 7&#45;point Newton&#45;Cotes (O(h^8)) weights for a uniform log&#45;spaced grid." alt="" coords="5,5,172,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="220,5,375,31"/>
<area shape="poly" title=" " alt="" coords="172,15,206,15,206,21,172,21"/>
</map>
</div>

</div>
</div>
<a id="a4065ed7135838f03cf8f636b5731674e" name="a4065ed7135838f03cf8f636b5731674e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4065ed7135838f03cf8f636b5731674e">&#9670;&#160;</a></span>compute_rectangle_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> compute_rectangle_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes left-rectangle quadrature weights (O(h)). </p>
<p>w_j = grid_{j+1} - grid_j for j=0..N-2, w_{N-1} = 0. </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00059">59</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   59</span>                                                                         {</div>
<div class="line"><span class="lineno">   60</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">   61</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a> = Array::from_shape({n});</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">if</span> (n &lt; 2) {</div>
<div class="line"><span class="lineno">   63</span>        <span class="keywordflow">if</span> (n == 1)</div>
<div class="line"><span class="lineno">   64</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(0) = 0;</div>
<div class="line"><span class="lineno">   65</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   66</span>    }</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1 &lt; n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">   68</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) = grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) - grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>);</div>
<div class="line"><span class="lineno">   69</span>    }</div>
<div class="line"><span class="lineno">   70</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(n - 1) = 0;</div>
<div class="line"><span class="lineno">   71</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_a4065ed7135838f03cf8f636b5731674e_cgraph.png" border="0" usemap="#aquadrature_8h_a4065ed7135838f03cf8f636b5731674e_cgraph" alt=""/></div>
<map name="aquadrature_8h_a4065ed7135838f03cf8f636b5731674e_cgraph" id="aquadrature_8h_a4065ed7135838f03cf8f636b5731674e_cgraph">
<area shape="rect" title="Computes left&#45;rectangle quadrature weights (O(h))." alt="" coords="5,5,211,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="259,5,413,31"/>
<area shape="poly" title=" " alt="" coords="211,15,245,15,245,21,211,21"/>
</map>
</div>

</div>
</div>
<a id="a982f638aed9a35e7ed8d734cabaeba99" name="a982f638aed9a35e7ed8d734cabaeba99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a982f638aed9a35e7ed8d734cabaeba99">&#9670;&#160;</a></span>compute_simpson_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> compute_simpson_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes composite Simpson's quadrature weights for a non-uniform grid. </p>
<p>Pairs of intervals use non-uniform Simpson's 1/3 rule. If the number of intervals is odd, the last interval falls back to trapezoidal. </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00104">104</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  104</span>                                                                       {</div>
<div class="line"><span class="lineno">  105</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">  106</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a> = xt::zeros&lt;Real&gt;({n});</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">if</span> (n &lt; 2)</div>
<div class="line"><span class="lineno">  108</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="comment">// Process pairs of intervals with non-uniform Simpson&#39;s rule</span></div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 0;</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">for</span> (; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2 &lt; n; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> += 2) {</div>
<div class="line"><span class="lineno">  113</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h1</a> = grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) - grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>);</div>
<div class="line"><span class="lineno">  114</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h2</a> = grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) - grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1);</div>
<div class="line"><span class="lineno">  115</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">H</a> = <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h1</a> + <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h2</a>;</div>
<div class="line"><span class="lineno">  116</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">H</a> / 6.0 * (2.0 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h1</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h2</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h1</a>;</div>
<div class="line"><span class="lineno">  117</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">H</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">H</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">H</a> / (6.0 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h1</a> * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h2</a>);</div>
<div class="line"><span class="lineno">  118</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 2) += <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">H</a> / 6.0 * (2.0 * <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h2</a> - <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h1</a>) / <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">h2</a>;</div>
<div class="line"><span class="lineno">  119</span>    }</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="comment">// Leftover single interval: trapezoidal fallback</span></div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1 &lt; n) {</div>
<div class="line"><span class="lineno">  123</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> = grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) - grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>);</div>
<div class="line"><span class="lineno">  124</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  125</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  126</span>    }</div>
<div class="line"><span class="lineno">  127</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_a982f638aed9a35e7ed8d734cabaeba99_cgraph.png" border="0" usemap="#aquadrature_8h_a982f638aed9a35e7ed8d734cabaeba99_cgraph" alt=""/></div>
<map name="aquadrature_8h_a982f638aed9a35e7ed8d734cabaeba99_cgraph" id="aquadrature_8h_a982f638aed9a35e7ed8d734cabaeba99_cgraph">
<area shape="rect" title="Computes composite Simpson&#39;s quadrature weights for a non&#45;uniform grid." alt="" coords="5,5,204,31"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="252,5,407,31"/>
<area shape="poly" title=" " alt="" coords="204,15,238,15,238,21,204,21"/>
</map>
</div>

</div>
</div>
<a id="a70287ab6faa3f63aeec720921229fa48" name="a70287ab6faa3f63aeec720921229fa48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70287ab6faa3f63aeec720921229fa48">&#9670;&#160;</a></span>compute_trapezoidal_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">void</a> compute_trapezoidal_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes trapezoidal quadrature weights for a non-uniform grid. </p>
<p>w_0 = 0.5*(grid_1 - grid_0), w_j = 0.5*(grid_{j+1} - grid_{j-1}), w_N = 0.5*(grid_N - grid_{N-1}) </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00080">80</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>                                                                           {</div>
<div class="line"><span class="lineno">   81</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">   82</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a> = Array::from_shape({n});</div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">if</span> (n &lt; 2) {</div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">if</span> (n == 1) {</div>
<div class="line"><span class="lineno">   85</span>            <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(0) = 0;</div>
<div class="line"><span class="lineno">   86</span>        }</div>
<div class="line"><span class="lineno">   87</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   88</span>    }</div>
<div class="line"><span class="lineno">   89</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(0) = 0.5 * (grid(1) - grid(0));</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> = 1; <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1 &lt; n; ++<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) {</div>
<div class="line"><span class="lineno">   91</span>        <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a>) = 0.5 * (grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> + 1) - grid(<a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">j</a> - 1));</div>
<div class="line"><span class="lineno">   92</span>    }</div>
<div class="line"><span class="lineno">   93</span>    <a class="code hl_function" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89">weights</a>(n - 1) = 0.5 * (grid(n - 1) - grid(n - 2));</div>
<div class="line"><span class="lineno">   94</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_a70287ab6faa3f63aeec720921229fa48_cgraph.png" border="0" usemap="#aquadrature_8h_a70287ab6faa3f63aeec720921229fa48_cgraph" alt=""/></div>
<map name="aquadrature_8h_a70287ab6faa3f63aeec720921229fa48_cgraph" id="aquadrature_8h_a70287ab6faa3f63aeec720921229fa48_cgraph">
<area shape="rect" title="Computes trapezoidal quadrature weights for a non&#45;uniform grid." alt="" coords="5,5,164,45"/>
<area shape="rect" href="pybind_8cpp.html#ad93eae6422741850877b46bd61f08c89" title=" " alt="" coords="212,13,367,38"/>
<area shape="poly" title=" " alt="" coords="164,23,198,23,198,28,164,28"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="quadrature_8h.html">quadrature.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
