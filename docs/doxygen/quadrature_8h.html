<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: quadrature.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('quadrature_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">quadrature.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mesh_8h_source.html">mesh.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for quadrature.h:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h__incl.png" border="0" usemap="#aquadrature_8h" alt=""/></div>
<map name="aquadrature_8h" id="aquadrature_8h">
<area shape="rect" title=" " alt="" coords="546,5,651,31"/>
<area shape="rect" href="mesh_8h.html" title=" " alt="" coords="563,79,634,104"/>
<area shape="poly" title=" " alt="" coords="601,31,601,65,596,65,596,31"/>
<area shape="rect" title=" " alt="" coords="5,159,91,185"/>
<area shape="poly" title=" " alt="" coords="563,97,366,113,235,130,103,155,91,158,90,153,102,149,234,125,365,108,563,92"/>
<area shape="rect" title=" " alt="" coords="115,159,184,185"/>
<area shape="poly" title=" " alt="" coords="563,98,403,115,300,131,197,155,188,157,186,152,195,149,299,126,402,110,563,92"/>
<area shape="rect" title=" " alt="" coords="208,159,261,185"/>
<area shape="poly" title=" " alt="" coords="564,99,434,116,354,133,274,155,269,156,267,151,273,149,353,127,433,111,563,93"/>
<area shape="rect" title=" " alt="" coords="286,159,349,185"/>
<area shape="poly" title=" " alt="" coords="564,103,475,125,369,155,360,157,359,152,367,149,473,120,563,98"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="417,240,535,265"/>
<area shape="poly" title=" " alt="" coords="563,95,526,98,485,108,445,125,428,138,414,153,408,171,414,191,429,212,448,230,444,234,425,216,410,193,403,171,410,151,425,134,443,121,483,103,525,93,563,90"/>
<area shape="rect" title=" " alt="" coords="425,159,613,185"/>
<area shape="poly" title=" " alt="" coords="589,106,542,151,539,147,585,102"/>
<area shape="rect" href="physics_8h.html" title=" " alt="" coords="637,159,720,185"/>
<area shape="poly" title=" " alt="" coords="612,102,659,147,655,151,609,106"/>
<area shape="rect" title=" " alt="" coords="745,152,887,192"/>
<area shape="poly" title=" " alt="" coords="631,101,752,145,750,150,629,107"/>
<area shape="rect" title=" " alt="" coords="911,152,1054,192"/>
<area shape="poly" title=" " alt="" coords="635,97,898,149,897,154,634,102"/>
<area shape="rect" title=" " alt="" coords="1078,159,1255,185"/>
<area shape="poly" title=" " alt="" coords="635,94,820,115,1067,149,1096,154,1095,160,1066,155,820,121,634,99"/>
<area shape="rect" title=" " alt="" coords="1280,159,1429,185"/>
<area shape="poly" title=" " alt="" coords="634,92,898,109,1082,126,1268,149,1294,154,1293,159,1268,155,1081,131,898,114,634,97"/>
<area shape="rect" title=" " alt="" coords="1454,159,1637,185"/>
<area shape="poly" title=" " alt="" coords="634,91,965,107,1200,124,1442,149,1475,154,1474,160,1441,155,1200,130,964,113,634,96"/>
<area shape="rect" title=" " alt="" coords="384,321,443,346"/>
<area shape="poly" title=" " alt="" coords="469,267,433,312,429,308,465,264"/>
<area shape="rect" href="simulation-defaults_8h.html" title="Centralized simulation configuration defaults." alt="" coords="467,313,613,353"/>
<area shape="poly" title=" " alt="" coords="488,264,518,301,514,304,483,267"/>
<area shape="rect" title=" " alt="" coords="505,401,575,427"/>
<area shape="poly" title=" " alt="" coords="543,354,543,387,537,387,537,354"/>
<area shape="poly" title=" " alt="" coords="650,187,519,238,517,233,648,182"/>
<area shape="rect" title=" " alt="" coords="647,240,710,265"/>
<area shape="poly" title=" " alt="" coords="681,185,681,226,676,226,676,185"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h__dep__incl.png" border="0" usemap="#aquadrature_8hdep" alt=""/></div>
<map name="aquadrature_8hdep" id="aquadrature_8hdep">
<area shape="rect" title=" " alt="" coords="379,5,484,31"/>
<area shape="rect" href="inverse-compton_8h.html" title=" " alt="" coords="359,79,503,104"/>
<area shape="poly" title=" " alt="" coords="434,44,434,79,429,79,429,44"/>
<area shape="rect" href="afterglow_8h.html" title=" " alt="" coords="181,372,276,397"/>
<area shape="poly" title=" " alt="" coords="346,103,204,123,141,137,97,154,75,169,61,184,51,202,42,226,39,252,46,276,61,298,83,317,138,349,191,369,189,374,136,353,80,322,57,302,41,279,33,253,37,225,46,199,57,180,72,165,94,150,139,132,203,118,345,98"/>
<area shape="rect" href="synchrotron_8cpp.html" title=" " alt="" coords="337,445,464,471"/>
<area shape="poly" title=" " alt="" coords="497,105,546,123,594,150,614,168,630,188,641,211,645,236,645,313,640,342,626,368,606,390,581,408,523,434,465,449,463,444,521,429,579,403,603,386,622,365,635,341,639,312,639,237,636,212,626,190,610,171,591,155,544,128,495,110"/>
<area shape="rect" href="inverse-compton_8cpp.html" title=" " alt="" coords="441,299,600,324"/>
<area shape="poly" title=" " alt="" coords="472,108,502,126,531,150,556,184,569,225,571,238,569,252,554,279,535,300,531,297,549,276,563,250,566,238,563,226,551,187,527,154,499,130,469,112"/>
<area shape="rect" href="power-law-syn_8cpp.html" title=" " alt="" coords="408,225,553,251"/>
<area shape="poly" title=" " alt="" coords="469,109,493,127,511,151,515,172,511,193,492,227,488,224,506,191,510,172,506,153,489,130,466,113"/>
<area shape="rect" href="power-law-syn_8h.html" title=" " alt="" coords="366,152,497,177"/>
<area shape="poly" title=" " alt="" coords="434,118,434,152,429,152,429,118"/>
<area shape="rect" href="synchrotron_8h.html" title=" " alt="" coords="273,225,384,251"/>
<area shape="poly" title=" " alt="" coords="400,113,377,131,356,153,339,192,332,226,327,225,334,190,352,151,373,127,397,109"/>
<area shape="rect" href="smooth-power-law-syn_8h.html" title=" " alt="" coords="107,152,291,177"/>
<area shape="poly" title=" " alt="" coords="382,110,238,154,236,149,380,105"/>
<area shape="rect" href="mcmc_8h.html" title=" " alt="" coords="17,519,91,544"/>
<area shape="poly" title=" " alt="" coords="168,392,138,398,107,408,79,424,56,447,49,464,47,483,53,518,47,519,42,483,44,463,52,444,75,420,105,404,136,393,167,387"/>
<area shape="rect" href="pymodel_8cpp.html" title=" " alt="" coords="237,592,343,617"/>
<area shape="poly" title=" " alt="" coords="238,410,289,591,284,592,233,412"/>
<area shape="rect" href="pymodel_8h.html" title=" " alt="" coords="141,519,231,544"/>
<area shape="poly" title=" " alt="" coords="229,412,217,471,195,520,190,517,211,470,224,410"/>
<area shape="rect" href="shock__dispatch_8h.html" title=" " alt="" coords="67,445,201,471"/>
<area shape="poly" title=" " alt="" coords="204,408,151,447,148,443,201,403"/>
<area shape="poly" title=" " alt="" coords="270,400,374,443,372,448,268,405"/>
<area shape="rect" href="mcmc_8cpp.html" title=" " alt="" coords="5,592,95,617"/>
<area shape="poly" title=" " alt="" coords="55,558,53,592,48,592,50,558"/>
<area shape="rect" href="pybind_8cpp.html" title=" " alt="" coords="119,592,213,617"/>
<area shape="poly" title=" " alt="" coords="85,549,149,590,146,594,82,554"/>
<area shape="poly" title=" " alt="" coords="182,558,172,593,167,591,176,557"/>
<area shape="poly" title=" " alt="" coords="216,550,274,590,271,594,213,554"/>
<area shape="poly" title=" " alt="" coords="113,482,69,520,65,516,109,478"/>
<area shape="poly" title=" " alt="" coords="153,480,180,517,175,520,148,483"/>
<area shape="poly" title=" " alt="" coords="449,187,475,224,470,227,445,190"/>
<area shape="poly" title=" " alt="" coords="405,187,347,227,344,223,402,183"/>
<area shape="poly" title=" " alt="" coords="315,264,239,373,234,370,311,261"/>
<area shape="poly" title=" " alt="" coords="347,261,367,298,381,339,391,381,402,445,397,446,386,382,376,341,362,300,343,263"/>
<area shape="poly" title=" " alt="" coords="373,253,490,296,488,301,372,258"/>
<area shape="rect" href="IO_8h.html" title=" " alt="" coords="305,299,353,324"/>
<area shape="poly" title=" " alt="" coords="331,264,331,299,326,299,326,264"/>
<area shape="poly" title=" " alt="" coords="303,334,247,374,243,370,300,330"/>
<area shape="rect" href="IO_8cpp.html" title=" " alt="" coords="300,372,363,397"/>
<area shape="poly" title=" " alt="" coords="332,338,334,372,328,372,327,338"/>
<area shape="poly" title=" " alt="" coords="234,182,309,223,306,227,231,186"/>
<area shape="rect" href="smooth-power-law-syn_8cpp.html" title=" " alt="" coords="51,225,249,251"/>
<area shape="poly" title=" " alt="" coords="186,190,160,227,156,224,181,187"/>
</map>
</div>
</div>
<p><a href="quadrature_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad8e274e15883ecba8f7f8b8868512e9f" id="r_ad8e274e15883ecba8f7f8b8868512e9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#ad8e274e15883ecba8f7f8b8868512e9f">compute_bin_widths</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dg</a>)</td></tr>
<tr class="memdesc:ad8e274e15883ecba8f7f8b8868512e9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes interval widths dg(j) = grid(j+1) - grid(j) from a grid of boundaries.  <br /></td></tr>
<tr class="separator:ad8e274e15883ecba8f7f8b8868512e9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8c6daba33e031c452a1a793f84a90c2" id="r_aa8c6daba33e031c452a1a793f84a90c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#aa8c6daba33e031c452a1a793f84a90c2">compute_midpoint_grid</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundaries</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">centers</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;weights)</td></tr>
<tr class="memdesc:aa8c6daba33e031c452a1a793f84a90c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a boundary grid to a midpoint grid with bin widths (midpoint rule, O(h^2)).  <br /></td></tr>
<tr class="separator:aa8c6daba33e031c452a1a793f84a90c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4065ed7135838f03cf8f636b5731674e" id="r_a4065ed7135838f03cf8f636b5731674e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#a4065ed7135838f03cf8f636b5731674e">compute_rectangle_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;weights)</td></tr>
<tr class="memdesc:a4065ed7135838f03cf8f636b5731674e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes left-rectangle quadrature weights (O(h)).  <br /></td></tr>
<tr class="separator:a4065ed7135838f03cf8f636b5731674e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70287ab6faa3f63aeec720921229fa48" id="r_a70287ab6faa3f63aeec720921229fa48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#a70287ab6faa3f63aeec720921229fa48">compute_trapezoidal_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;weights)</td></tr>
<tr class="memdesc:a70287ab6faa3f63aeec720921229fa48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes trapezoidal quadrature weights for a non-uniform grid.  <br /></td></tr>
<tr class="separator:a70287ab6faa3f63aeec720921229fa48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a982f638aed9a35e7ed8d734cabaeba99" id="r_a982f638aed9a35e7ed8d734cabaeba99"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#a982f638aed9a35e7ed8d734cabaeba99">compute_simpson_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;weights)</td></tr>
<tr class="memdesc:a982f638aed9a35e7ed8d734cabaeba99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes composite Simpson's quadrature weights for a non-uniform grid.  <br /></td></tr>
<tr class="separator:a982f638aed9a35e7ed8d734cabaeba99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a160a2956a4466e2e97a7f1c2b88626c9" id="r_a160a2956a4466e2e97a7f1c2b88626c9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#a160a2956a4466e2e97a7f1c2b88626c9">compute_boole_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;weights)</td></tr>
<tr class="memdesc:a160a2956a4466e2e97a7f1c2b88626c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes Boole's rule (Newton-Cotes 4th order, O(h^6)) weights for a uniform log-spaced grid.  <br /></td></tr>
<tr class="separator:a160a2956a4466e2e97a7f1c2b88626c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1455a160700818cfb5466e5517482ee" id="r_aa1455a160700818cfb5466e5517482ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quadrature_8h.html#aa1455a160700818cfb5466e5517482ee">compute_nc7_weights</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;grid, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;weights)</td></tr>
<tr class="memdesc:aa1455a160700818cfb5466e5517482ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes 7-point Newton-Cotes (O(h^8)) weights for a uniform log-spaced grid.  <br /></td></tr>
<tr class="separator:aa1455a160700818cfb5466e5517482ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad8e274e15883ecba8f7f8b8868512e9f" name="ad8e274e15883ecba8f7f8b8868512e9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8e274e15883ecba8f7f8b8868512e9f">&#9670;&#160;</a></span>compute_bin_widths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> compute_bin_widths </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>dg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes interval widths dg(j) = grid(j+1) - grid(j) from a grid of boundaries. </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00017">17</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   17</span>                                                             {</div>
<div class="line"><span class="lineno">   18</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a> = grid.size();</div>
<div class="line"><span class="lineno">   19</span>    <span class="keywordflow">if</span> (m &gt;= 2) {</div>
<div class="line"><span class="lineno">   20</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dg</a> = Array::from_shape({<a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a> - 1});</div>
<div class="line"><span class="lineno">   21</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1 &lt; <a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>)</div>
<div class="line"><span class="lineno">   22</span>            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dg</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) = grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) - grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>);</div>
<div class="line"><span class="lineno">   23</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   24</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dg</a> = Array::from_shape({0});</div>
<div class="line"><span class="lineno">   25</span>    }</div>
<div class="line"><span class="lineno">   26</span>}</div>
<div class="ttc" id="anamespaceunit_html_a6b886b7bc31732cd2aee3752b854f00c"><div class="ttname"><a href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">unit::m</a></div><div class="ttdeci">constexpr Real m</div><div class="ttdoc">Meter in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00065">macros.h:65</a></div></div>
<div class="ttc" id="autilities_8h_html_ab8e81118f023df135835db8cce4f5f42"><div class="ttname"><a href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a></div><div class="ttdeci">T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00206">utilities.h:206</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_ad8e274e15883ecba8f7f8b8868512e9f_cgraph.png" border="0" usemap="#aquadrature_8h_ad8e274e15883ecba8f7f8b8868512e9f_cgraph" alt=""/></div>
<map name="aquadrature_8h_ad8e274e15883ecba8f7f8b8868512e9f_cgraph" id="aquadrature_8h_ad8e274e15883ecba8f7f8b8868512e9f_cgraph">
<area shape="rect" title="Computes interval widths dg(j) = grid(j+1) &#45; grid(j) from a grid of boundaries." alt="" coords="5,29,161,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="209,29,260,55"/>
<area shape="poly" title=" " alt="" coords="162,39,196,39,196,45,162,45"/>
<area shape="poly" title=" " alt="" coords="209,31,204,21,207,11,217,5,235,3,255,6,264,15,260,19,253,11,235,8,219,10,211,15,209,20,214,28"/>
</map>
</div>

</div>
</div>
<a id="a160a2956a4466e2e97a7f1c2b88626c9" name="a160a2956a4466e2e97a7f1c2b88626c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a160a2956a4466e2e97a7f1c2b88626c9">&#9670;&#160;</a></span>compute_boole_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> compute_boole_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes Boole's rule (Newton-Cotes 4th order, O(h^6)) weights for a uniform log-spaced grid. </p>
<p>Operates in log-space where the grid is uniform, then applies the Jacobian (gamma_i) to convert back to linear-space weights. Groups of 4 intervals use Boole's coefficients [7, 32, 12, 32, 7] * 2h/45. Leftovers use Simpson's 3/8, 1/3, or trapezoidal. </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00138">138</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  138</span>                                                                     {</div>
<div class="line"><span class="lineno">  139</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">  140</span>    weights = xt::zeros&lt;Real&gt;({n});</div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordflow">if</span> (n &lt; 2)</div>
<div class="line"><span class="lineno">  142</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    <span class="comment">// Uniform spacing in log space</span></div>
<div class="line"><span class="lineno">  145</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> = std::log(grid(1) / grid(0));</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">// Process groups of 4 intervals (5 points) with Boole&#39;s rule</span></div>
<div class="line"><span class="lineno">  148</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> = 2.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 45.0;</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0;</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">for</span> (; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 4 &lt; n; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> += 4) {</div>
<div class="line"><span class="lineno">  151</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 7;</div>
<div class="line"><span class="lineno">  152</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 32;</div>
<div class="line"><span class="lineno">  153</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 12;</div>
<div class="line"><span class="lineno">  154</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 3) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 32;</div>
<div class="line"><span class="lineno">  155</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 4) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 7;</div>
<div class="line"><span class="lineno">  156</span>    }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    <span class="comment">// Leftover intervals</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> = n - 1 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>;</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> == 3) {</div>
<div class="line"><span class="lineno">  161</span>        <span class="comment">// Simpson&#39;s 3/8 rule: (3h/8) * [1, 3, 3, 1]</span></div>
<div class="line"><span class="lineno">  162</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a> = 3.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 8.0;</div>
<div class="line"><span class="lineno">  163</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a>;</div>
<div class="line"><span class="lineno">  164</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a> * 3;</div>
<div class="line"><span class="lineno">  165</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a> * 3;</div>
<div class="line"><span class="lineno">  166</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 3) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a>;</div>
<div class="line"><span class="lineno">  167</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> == 2) {</div>
<div class="line"><span class="lineno">  168</span>        <span class="comment">// Simpson&#39;s 1/3 rule: (h/3) * [1, 4, 1]</span></div>
<div class="line"><span class="lineno">  169</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c13</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 3.0;</div>
<div class="line"><span class="lineno">  170</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c13</a>;</div>
<div class="line"><span class="lineno">  171</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c13</a> * 4;</div>
<div class="line"><span class="lineno">  172</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c13</a>;</div>
<div class="line"><span class="lineno">  173</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> == 1) {</div>
<div class="line"><span class="lineno">  174</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  175</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  176</span>    }</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    <span class="comment">// Jacobian: dγ = γ · d(ln γ), convert log-space weights to linear-space</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; n; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  180</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) *= grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>);</div>
<div class="line"><span class="lineno">  181</span>    }</div>
<div class="line"><span class="lineno">  182</span>}</div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00023">macros.h:23</a></div></div>
<div class="ttc" id="anamespacecon_html_a07ddec20ab09a3078fce714358b65b4b"><div class="ttname"><a href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">con::h</a></div><div class="ttdeci">constexpr Real h</div><div class="ttdoc">Planck constant in code units.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00092">macros.h:92</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_a160a2956a4466e2e97a7f1c2b88626c9_cgraph.png" border="0" usemap="#aquadrature_8h_a160a2956a4466e2e97a7f1c2b88626c9_cgraph" alt=""/></div>
<map name="aquadrature_8h_a160a2956a4466e2e97a7f1c2b88626c9_cgraph" id="aquadrature_8h_a160a2956a4466e2e97a7f1c2b88626c9_cgraph">
<area shape="rect" title="Computes Boole&#39;s rule (Newton&#45;Cotes 4th order, O(h^6)) weights for a uniform log&#45;spaced grid." alt="" coords="5,29,185,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="233,29,284,55"/>
<area shape="poly" title=" " alt="" coords="185,39,219,39,219,45,185,45"/>
<area shape="poly" title=" " alt="" coords="231,31,226,21,229,11,240,5,259,3,281,6,291,15,287,19,279,11,259,8,242,10,233,15,231,20,236,28"/>
</map>
</div>

</div>
</div>
<a id="aa8c6daba33e031c452a1a793f84a90c2" name="aa8c6daba33e031c452a1a793f84a90c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8c6daba33e031c452a1a793f84a90c2">&#9670;&#160;</a></span>compute_midpoint_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> compute_midpoint_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>boundaries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>centers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Converts a boundary grid to a midpoint grid with bin widths (midpoint rule, O(h^2)). </p>
<p>Given N boundary points, produces N-1 center points (geometric mean of adjacent boundaries) and N-1 bin widths. Works with any grid (uniform, adaptive, logspace). </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00036">36</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   36</span>                                                                                           {</div>
<div class="line"><span class="lineno">   37</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundaries</a>.size();</div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">if</span> (n &lt; 2) {</div>
<div class="line"><span class="lineno">   39</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">centers</a> = Array::from_shape({0});</div>
<div class="line"><span class="lineno">   40</span>        weights = Array::from_shape({0});</div>
<div class="line"><span class="lineno">   41</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   42</span>    }</div>
<div class="line"><span class="lineno">   43</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a> = n - 1;</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">centers</a> = Array::from_shape({<a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a>});</div>
<div class="line"><span class="lineno">   45</span>    weights = Array::from_shape({<a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a>});</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; <a class="code hl_variable" href="namespaceunit.html#a6b886b7bc31732cd2aee3752b854f00c">m</a>; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">   47</span>        <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">centers</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) = std::sqrt(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundaries</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundaries</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1));</div>
<div class="line"><span class="lineno">   48</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundaries</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">boundaries</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>);</div>
<div class="line"><span class="lineno">   49</span>    }</div>
<div class="line"><span class="lineno">   50</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_aa8c6daba33e031c452a1a793f84a90c2_cgraph.png" border="0" usemap="#aquadrature_8h_aa8c6daba33e031c452a1a793f84a90c2_cgraph" alt=""/></div>
<map name="aquadrature_8h_aa8c6daba33e031c452a1a793f84a90c2_cgraph" id="aquadrature_8h_aa8c6daba33e031c452a1a793f84a90c2_cgraph">
<area shape="rect" title="Converts a boundary grid to a midpoint grid with bin widths (midpoint rule, O(h^2))." alt="" coords="5,29,181,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="229,29,280,55"/>
<area shape="poly" title=" " alt="" coords="181,39,215,39,215,45,181,45"/>
<area shape="poly" title=" " alt="" coords="228,31,222,21,225,11,236,5,255,3,277,6,286,15,283,19,274,11,255,8,238,10,229,15,227,20,232,28"/>
</map>
</div>

</div>
</div>
<a id="aa1455a160700818cfb5466e5517482ee" name="aa1455a160700818cfb5466e5517482ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1455a160700818cfb5466e5517482ee">&#9670;&#160;</a></span>compute_nc7_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> compute_nc7_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes 7-point Newton-Cotes (O(h^8)) weights for a uniform log-spaced grid. </p>
<p>Groups of 6 intervals use coefficients [41, 216, 27, 272, 27, 216, 41] * h/140. Leftovers cascade: 5→6-pt, 4→Boole's, 3→Simpson 3/8, 2→Simpson 1/3, 1→trapezoidal. All weights are positive (highest NC order with this property is 8-point). </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00193">193</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  193</span>                                                                   {</div>
<div class="line"><span class="lineno">  194</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">  195</span>    weights = xt::zeros&lt;Real&gt;({n});</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">if</span> (n &lt; 2)</div>
<div class="line"><span class="lineno">  197</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> = std::log(grid(1) / grid(0));</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    <span class="comment">// Groups of 6 intervals (7 points): h/140 * [41, 216, 27, 272, 27, 216, 41]</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c7</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 140.0;</div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0;</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">for</span> (; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 6 &lt; n; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> += 6) {</div>
<div class="line"><span class="lineno">  205</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c7</a> * 41;</div>
<div class="line"><span class="lineno">  206</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c7</a> * 216;</div>
<div class="line"><span class="lineno">  207</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c7</a> * 27;</div>
<div class="line"><span class="lineno">  208</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 3) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c7</a> * 272;</div>
<div class="line"><span class="lineno">  209</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 4) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c7</a> * 27;</div>
<div class="line"><span class="lineno">  210</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 5) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c7</a> * 216;</div>
<div class="line"><span class="lineno">  211</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 6) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c7</a> * 41;</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> = n - 1 - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>;</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> == 5) {</div>
<div class="line"><span class="lineno">  216</span>        <span class="comment">// 6-point: 5h/288 * [19, 75, 50, 50, 75, 19]</span></div>
<div class="line"><span class="lineno">  217</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c6</a> = 5.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 288.0;</div>
<div class="line"><span class="lineno">  218</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c6</a> * 19;</div>
<div class="line"><span class="lineno">  219</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c6</a> * 75;</div>
<div class="line"><span class="lineno">  220</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c6</a> * 50;</div>
<div class="line"><span class="lineno">  221</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 3) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c6</a> * 50;</div>
<div class="line"><span class="lineno">  222</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 4) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c6</a> * 75;</div>
<div class="line"><span class="lineno">  223</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 5) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c6</a> * 19;</div>
<div class="line"><span class="lineno">  224</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> == 4) {</div>
<div class="line"><span class="lineno">  225</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> = 2.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 45.0;</div>
<div class="line"><span class="lineno">  226</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 7;</div>
<div class="line"><span class="lineno">  227</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 32;</div>
<div class="line"><span class="lineno">  228</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 12;</div>
<div class="line"><span class="lineno">  229</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 3) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 32;</div>
<div class="line"><span class="lineno">  230</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 4) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">cb</a> * 7;</div>
<div class="line"><span class="lineno">  231</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> == 3) {</div>
<div class="line"><span class="lineno">  232</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a> = 3.0 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 8.0;</div>
<div class="line"><span class="lineno">  233</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a>;</div>
<div class="line"><span class="lineno">  234</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a> * 3;</div>
<div class="line"><span class="lineno">  235</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a> * 3;</div>
<div class="line"><span class="lineno">  236</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 3) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c38</a>;</div>
<div class="line"><span class="lineno">  237</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> == 2) {</div>
<div class="line"><span class="lineno">  238</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c13</a> = <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> / 3.0;</div>
<div class="line"><span class="lineno">  239</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c13</a>;</div>
<div class="line"><span class="lineno">  240</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c13</a> * 4;</div>
<div class="line"><span class="lineno">  241</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">c13</a>;</div>
<div class="line"><span class="lineno">  242</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">remaining</a> == 1) {</div>
<div class="line"><span class="lineno">  243</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  244</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  245</span>    }</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; n; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  248</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) *= grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>);</div>
<div class="line"><span class="lineno">  249</span>    }</div>
<div class="line"><span class="lineno">  250</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_aa1455a160700818cfb5466e5517482ee_cgraph.png" border="0" usemap="#aquadrature_8h_aa1455a160700818cfb5466e5517482ee_cgraph" alt=""/></div>
<map name="aquadrature_8h_aa1455a160700818cfb5466e5517482ee_cgraph" id="aquadrature_8h_aa1455a160700818cfb5466e5517482ee_cgraph">
<area shape="rect" title="Computes 7&#45;point Newton&#45;Cotes (O(h^8)) weights for a uniform log&#45;spaced grid." alt="" coords="5,29,172,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="220,29,271,55"/>
<area shape="poly" title=" " alt="" coords="172,39,206,39,206,45,172,45"/>
<area shape="poly" title=" " alt="" coords="219,31,214,21,217,11,228,5,245,3,267,6,276,15,272,19,264,11,245,8,229,10,221,15,219,20,224,28"/>
</map>
</div>

</div>
</div>
<a id="a4065ed7135838f03cf8f636b5731674e" name="a4065ed7135838f03cf8f636b5731674e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4065ed7135838f03cf8f636b5731674e">&#9670;&#160;</a></span>compute_rectangle_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> compute_rectangle_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes left-rectangle quadrature weights (O(h)). </p>
<p>w_j = grid_{j+1} - grid_j for j=0..N-2, w_{N-1} = 0. </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00059">59</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   59</span>                                                                         {</div>
<div class="line"><span class="lineno">   60</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">   61</span>    weights = Array::from_shape({n});</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">if</span> (n &lt; 2) {</div>
<div class="line"><span class="lineno">   63</span>        <span class="keywordflow">if</span> (n == 1)</div>
<div class="line"><span class="lineno">   64</span>            weights(0) = 0;</div>
<div class="line"><span class="lineno">   65</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   66</span>    }</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1 &lt; n; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">   68</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) = grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) - grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>);</div>
<div class="line"><span class="lineno">   69</span>    }</div>
<div class="line"><span class="lineno">   70</span>    weights(n - 1) = 0;</div>
<div class="line"><span class="lineno">   71</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_a4065ed7135838f03cf8f636b5731674e_cgraph.png" border="0" usemap="#aquadrature_8h_a4065ed7135838f03cf8f636b5731674e_cgraph" alt=""/></div>
<map name="aquadrature_8h_a4065ed7135838f03cf8f636b5731674e_cgraph" id="aquadrature_8h_a4065ed7135838f03cf8f636b5731674e_cgraph">
<area shape="rect" title="Computes left&#45;rectangle quadrature weights (O(h))." alt="" coords="5,29,211,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="259,29,309,55"/>
<area shape="poly" title=" " alt="" coords="211,39,245,39,245,45,211,45"/>
<area shape="poly" title=" " alt="" coords="256,32,249,22,251,12,263,5,284,3,310,7,319,17,315,21,307,12,284,8,265,10,255,15,254,21,260,29"/>
</map>
</div>

</div>
</div>
<a id="a982f638aed9a35e7ed8d734cabaeba99" name="a982f638aed9a35e7ed8d734cabaeba99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a982f638aed9a35e7ed8d734cabaeba99">&#9670;&#160;</a></span>compute_simpson_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> compute_simpson_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes composite Simpson's quadrature weights for a non-uniform grid. </p>
<p>Pairs of intervals use non-uniform Simpson's 1/3 rule. If the number of intervals is odd, the last interval falls back to trapezoidal. </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00104">104</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  104</span>                                                                       {</div>
<div class="line"><span class="lineno">  105</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">  106</span>    weights = xt::zeros&lt;Real&gt;({n});</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">if</span> (n &lt; 2)</div>
<div class="line"><span class="lineno">  108</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="comment">// Process pairs of intervals with non-uniform Simpson&#39;s rule</span></div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0;</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">for</span> (; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2 &lt; n; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> += 2) {</div>
<div class="line"><span class="lineno">  113</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h1</a> = grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) - grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>);</div>
<div class="line"><span class="lineno">  114</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h2</a> = grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) - grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1);</div>
<div class="line"><span class="lineno">  115</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">H</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h1</a> + <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h2</a>;</div>
<div class="line"><span class="lineno">  116</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">H</a> / 6.0 * (2.0 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h1</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h2</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h1</a>;</div>
<div class="line"><span class="lineno">  117</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">H</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">H</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">H</a> / (6.0 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h1</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h2</a>);</div>
<div class="line"><span class="lineno">  118</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 2) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">H</a> / 6.0 * (2.0 * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h2</a> - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h1</a>) / <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">h2</a>;</div>
<div class="line"><span class="lineno">  119</span>    }</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="comment">// Leftover single interval: trapezoidal fallback</span></div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1 &lt; n) {</div>
<div class="line"><span class="lineno">  123</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a> = grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) - grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>);</div>
<div class="line"><span class="lineno">  124</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  125</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) += 0.5 * <a class="code hl_variable" href="namespacecon.html#a07ddec20ab09a3078fce714358b65b4b">h</a>;</div>
<div class="line"><span class="lineno">  126</span>    }</div>
<div class="line"><span class="lineno">  127</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_a982f638aed9a35e7ed8d734cabaeba99_cgraph.png" border="0" usemap="#aquadrature_8h_a982f638aed9a35e7ed8d734cabaeba99_cgraph" alt=""/></div>
<map name="aquadrature_8h_a982f638aed9a35e7ed8d734cabaeba99_cgraph" id="aquadrature_8h_a982f638aed9a35e7ed8d734cabaeba99_cgraph">
<area shape="rect" title="Computes composite Simpson&#39;s quadrature weights for a non&#45;uniform grid." alt="" coords="5,29,204,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="252,29,303,55"/>
<area shape="poly" title=" " alt="" coords="204,39,238,39,238,45,204,45"/>
<area shape="poly" title=" " alt="" coords="250,32,243,22,246,12,258,5,277,3,302,7,311,16,307,20,299,11,277,8,259,10,250,15,248,21,254,28"/>
</map>
</div>

</div>
</div>
<a id="a70287ab6faa3f63aeec720921229fa48" name="a70287ab6faa3f63aeec720921229fa48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70287ab6faa3f63aeec720921229fa48">&#9670;&#160;</a></span>compute_trapezoidal_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> compute_trapezoidal_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes trapezoidal quadrature weights for a non-uniform grid. </p>
<p>w_0 = 0.5*(grid_1 - grid_0), w_j = 0.5*(grid_{j+1} - grid_{j-1}), w_N = 0.5*(grid_N - grid_{N-1}) </p>

<p class="definition">Definition at line <a class="el" href="quadrature_8h_source.html#l00080">80</a> of file <a class="el" href="quadrature_8h_source.html">quadrature.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>                                                                           {</div>
<div class="line"><span class="lineno">   81</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = grid.size();</div>
<div class="line"><span class="lineno">   82</span>    weights = Array::from_shape({n});</div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">if</span> (n &lt; 2) {</div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">if</span> (n == 1) {</div>
<div class="line"><span class="lineno">   85</span>            weights(0) = 0;</div>
<div class="line"><span class="lineno">   86</span>        }</div>
<div class="line"><span class="lineno">   87</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   88</span>    }</div>
<div class="line"><span class="lineno">   89</span>    weights(0) = 0.5 * (grid(1) - grid(0));</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 1; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1 &lt; n; ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">   91</span>        weights(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) = 0.5 * (grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> + 1) - grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> - 1));</div>
<div class="line"><span class="lineno">   92</span>    }</div>
<div class="line"><span class="lineno">   93</span>    weights(n - 1) = 0.5 * (grid(n - 1) - grid(n - 2));</div>
<div class="line"><span class="lineno">   94</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="quadrature_8h_a70287ab6faa3f63aeec720921229fa48_cgraph.png" border="0" usemap="#aquadrature_8h_a70287ab6faa3f63aeec720921229fa48_cgraph" alt=""/></div>
<map name="aquadrature_8h_a70287ab6faa3f63aeec720921229fa48_cgraph" id="aquadrature_8h_a70287ab6faa3f63aeec720921229fa48_cgraph">
<area shape="rect" title="Computes trapezoidal quadrature weights for a non&#45;uniform grid." alt="" coords="5,22,164,62"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="212,29,263,55"/>
<area shape="poly" title=" " alt="" coords="164,39,198,39,198,45,164,45"/>
<area shape="poly" title=" " alt="" coords="212,31,206,21,209,11,220,5,237,3,258,6,267,15,264,19,256,11,237,8,222,10,213,15,212,20,216,28"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="quadrature_8h.html">quadrature.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
