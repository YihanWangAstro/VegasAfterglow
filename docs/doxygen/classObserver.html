<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VegasAfterglow: Observer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">VegasAfterglow
   </div>
   <div id="projectbrief">A high-performance C++ framework for modeling gamma-ray burst afterglows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classObserver.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classObserver-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Observer Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Represents an observer in the GRB afterglow simulation.  
 <a href="classObserver.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="observer_8h_source.html">observer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acb0af5014875c6ec7465cccc85e4f39b" id="r_acb0af5014875c6ec7465cccc85e4f39b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classObserver.html#acb0af5014875c6ec7465cccc85e4f39b">Observer</a> ()=<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">default</a></td></tr>
<tr class="memdesc:acb0af5014875c6ec7465cccc85e4f39b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <br /></td></tr>
<tr class="separator:acb0af5014875c6ec7465cccc85e4f39b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e6b3154ceb89b3ff90758b874c2016d" id="r_a7e6b3154ceb89b3ff90758b874c2016d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classObserver.html#a7e6b3154ceb89b3ff90758b874c2016d">observe</a> (<a class="el" href="classCoord.html">Coord</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>, <a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">luminosity_dist</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">redshift</a>)</td></tr>
<tr class="memdesc:a7e6b3154ceb89b3ff90758b874c2016d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the <a class="el" href="classObserver.html" title="Represents an observer in the GRB afterglow simulation.">Observer</a> for flux calculation.  <br /></td></tr>
<tr class="separator:a7e6b3154ceb89b3ff90758b874c2016d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20935ae9f08821dd146a71d1c6a3175d" id="r_a20935ae9f08821dd146a71d1c6a3175d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classObserver.html#a20935ae9f08821dd146a71d1c6a3175d">observe_at</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="el" href="classCoord.html">Coord</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>, <a class="el" href="classShock.html">Shock</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">luminosity_dist</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">redshift</a>)</td></tr>
<tr class="memdesc:a20935ae9f08821dd146a71d1c6a3175d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the <a class="el" href="classObserver.html" title="Represents an observer in the GRB afterglow simulation.">Observer</a> for flux calculation at specific observation times.  <br /></td></tr>
<tr class="separator:a20935ae9f08821dd146a71d1c6a3175d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a781d46ba549ae9a7ec4e3049a735586f" id="r_a781d46ba549ae9a7ec4e3049a735586f"><td class="memTemplParams" colspan="2">template&lt;typename... PhotonGrid&gt; </td></tr>
<tr class="memitem:a781d46ba549ae9a7ec4e3049a735586f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classObserver.html#a781d46ba549ae9a7ec4e3049a735586f">specific_flux</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;... <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>)</td></tr>
<tr class="memdesc:a781d46ba549ae9a7ec4e3049a735586f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the specific flux at a single observed frequency.  <br /></td></tr>
<tr class="separator:a781d46ba549ae9a7ec4e3049a735586f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63679ba1972c386be330f8b51397b9a4" id="r_a63679ba1972c386be330f8b51397b9a4"><td class="memTemplParams" colspan="2">template&lt;typename... PhotonGrid&gt; </td></tr>
<tr class="memitem:a63679ba1972c386be330f8b51397b9a4"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classObserver.html#a63679ba1972c386be330f8b51397b9a4">specific_flux</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;... <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>)</td></tr>
<tr class="memdesc:a63679ba1972c386be330f8b51397b9a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the specific flux at multiple observed frequencies.  <br /></td></tr>
<tr class="separator:a63679ba1972c386be330f8b51397b9a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ed98be9897dfa8c217cc59370a148f" id="r_ae0ed98be9897dfa8c217cc59370a148f"><td class="memTemplParams" colspan="2">template&lt;typename... PhotonGrid&gt; </td></tr>
<tr class="memitem:ae0ed98be9897dfa8c217cc59370a148f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classObserver.html#ae0ed98be9897dfa8c217cc59370a148f">specific_flux_series</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;... <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>)</td></tr>
<tr class="memdesc:ae0ed98be9897dfa8c217cc59370a148f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the specific flux at a single observed frequency for multiple observation times.  <br /></td></tr>
<tr class="separator:ae0ed98be9897dfa8c217cc59370a148f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fc133aa2f06b425634470424da9daa3" id="r_a9fc133aa2f06b425634470424da9daa3"><td class="memTemplParams" colspan="2">template&lt;typename... PhotonGrid&gt; </td></tr>
<tr class="memitem:a9fc133aa2f06b425634470424da9daa3"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classObserver.html#a9fc133aa2f06b425634470424da9daa3">flux</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">band_freq</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;... <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>)</td></tr>
<tr class="memdesc:a9fc133aa2f06b425634470424da9daa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the integrated flux over a frequency band.  <br /></td></tr>
<tr class="separator:a9fc133aa2f06b425634470424da9daa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ed4fb8ae8b336286c176423401ba30" id="r_ac9ed4fb8ae8b336286c176423401ba30"><td class="memTemplParams" colspan="2">template&lt;typename... PhotonGrid&gt; </td></tr>
<tr class="memitem:ac9ed4fb8ae8b336286c176423401ba30"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classObserver.html#ac9ed4fb8ae8b336286c176423401ba30">spectra</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">freqs</a>, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;... <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>)</td></tr>
<tr class="memdesc:ac9ed4fb8ae8b336286c176423401ba30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the spectrum at multiple observation times.  <br /></td></tr>
<tr class="separator:ac9ed4fb8ae8b336286c176423401ba30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16bf4c5175405ae1c88a78b8afdd8c4" id="r_af16bf4c5175405ae1c88a78b8afdd8c4"><td class="memTemplParams" colspan="2">template&lt;typename... PhotonGrid&gt; </td></tr>
<tr class="memitem:af16bf4c5175405ae1c88a78b8afdd8c4"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classObserver.html#af16bf4c5175405ae1c88a78b8afdd8c4">spectrum</a> (<a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">freqs</a>, <a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;... <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>)</td></tr>
<tr class="memdesc:af16bf4c5175405ae1c88a78b8afdd8c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the spectrum at a single observation time.  <br /></td></tr>
<tr class="separator:af16bf4c5175405ae1c88a78b8afdd8c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90f4a0a86f9e4a702cfc3a13e7c9c153" id="r_a90f4a0a86f9e4a702cfc3a13e7c9c153"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classObserver.html#a90f4a0a86f9e4a702cfc3a13e7c9c153">update_required</a> (<a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> &amp;required, <a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;<a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>)</td></tr>
<tr class="memdesc:a90f4a0a86f9e4a702cfc3a13e7c9c153"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the required grid points for observation.  <br /></td></tr>
<tr class="separator:a90f4a0a86f9e4a702cfc3a13e7c9c153"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a7b83dbbff538d3f079f8e662d3686ada" id="r_a7b83dbbff538d3f079f8e662d3686ada"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classObserver.html#a7b83dbbff538d3f079f8e662d3686ada">time</a></td></tr>
<tr class="memdesc:a7b83dbbff538d3f079f8e662d3686ada"><td class="mdescLeft">&#160;</td><td class="mdescRight">Grid of observation times.  <br /></td></tr>
<tr class="separator:a7b83dbbff538d3f079f8e662d3686ada"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Represents an observer in the GRB afterglow simulation. </p>
<p>This class handles the calculation of observed quantities such as specific flux, integrated flux, and spectra. It accounts for relativistic effects (Doppler boosting), cosmological effects (redshift), and geometric effects (solid angle). The observer can be placed at any viewing angle relative to the jet axis. </p>

<p class="definition">Definition at line <a class="el" href="observer_8h_source.html#l00028">28</a> of file <a class="el" href="observer_8h_source.html">observer.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="acb0af5014875c6ec7465cccc85e4f39b" name="acb0af5014875c6ec7465cccc85e4f39b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb0af5014875c6ec7465cccc85e4f39b">&#9670;&#160;</a></span>Observer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Observer::Observer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default constructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9fc133aa2f06b425634470424da9daa3" name="a9fc133aa2f06b425634470424da9daa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fc133aa2f06b425634470424da9daa3">&#9670;&#160;</a></span>flux()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... PhotonGrid&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> Observer::flux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>band_freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;...&#160;</td>
          <td class="paramname"><em>photons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the integrated flux over a frequency band. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">PhotonGrid</td><td>Types of photon grid objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">band_freq</td><td>Array of frequency band boundaries </td></tr>
    <tr><td class="paramname">photons</td><td>Parameter pack of photon grid objects</td></tr>
  </table>
  </dd>
</dl>
<p>Computes the integrated flux over a frequency band specified by band_freq. It converts band boundaries to center frequencies, computes the specific flux at each frequency, and integrates (sums) the flux contributions weighted by the frequency bin widths. </p><dl class="section return"><dt>Returns</dt><dd>Array of integrated flux values at each observation time </dd></dl>

<p class="definition">Definition at line <a class="el" href="observer_8h_source.html#l00406">406</a> of file <a class="el" href="observer_8h_source.html">observer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  406</span>                                                                                             {</div>
<div class="line"><span class="lineno">  407</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a> = <a class="code hl_function" href="mesh_8h.html#aba66986baad5475a202c20a92bda036e">boundary_to_center_log</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">band_freq</a>);</div>
<div class="line"><span class="lineno">  408</span>    <a class="code hl_typedef" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a> = <a class="code hl_function" href="classObserver.html#a781d46ba549ae9a7ec4e3049a735586f">specific_flux</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>...);</div>
<div class="line"><span class="lineno">  409</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="classObserver.html#a9fc133aa2f06b425634470424da9daa3">flux</a>({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>.size()}, 0);</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>) {</div>
<div class="line"><span class="lineno">  411</span>        <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dnu</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">band_freq</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> + 1) - <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">band_freq</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>);</div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; <a class="code hl_function" href="classObserver.html#a9fc133aa2f06b425634470424da9daa3">flux</a>.size(); ++<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) {</div>
<div class="line"><span class="lineno">  413</span>            <a class="code hl_function" href="classObserver.html#a9fc133aa2f06b425634470424da9daa3">flux</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>) += <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">dnu</a> * <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>);</div>
<div class="line"><span class="lineno">  414</span>        }</div>
<div class="line"><span class="lineno">  415</span>    }</div>
<div class="line"><span class="lineno">  416</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classObserver.html#a9fc133aa2f06b425634470424da9daa3">flux</a>;</div>
<div class="line"><span class="lineno">  417</span>}</div>
<div class="ttc" id="aclassObserver_html_a781d46ba549ae9a7ec4e3049a735586f"><div class="ttname"><a href="classObserver.html#a781d46ba549ae9a7ec4e3049a735586f">Observer::specific_flux</a></div><div class="ttdeci">Array specific_flux(Array const &amp;t_obs, Real nu_obs, PhotonGrid const &amp;... photons)</div><div class="ttdoc">Computes the specific flux at a single observed frequency.</div><div class="ttdef"><b>Definition</b> <a href="observer_8h_source.html#l00391">observer.h:391</a></div></div>
<div class="ttc" id="aclassObserver_html_a9fc133aa2f06b425634470424da9daa3"><div class="ttname"><a href="classObserver.html#a9fc133aa2f06b425634470424da9daa3">Observer::flux</a></div><div class="ttdeci">Array flux(Array const &amp;t_obs, Array const &amp;band_freq, PhotonGrid const &amp;... photons)</div><div class="ttdoc">Computes the integrated flux over a frequency band.</div><div class="ttdef"><b>Definition</b> <a href="observer_8h_source.html#l00406">observer.h:406</a></div></div>
<div class="ttc" id="amacros_8h_html_a4b04262b81aa7d31eb5d2f607e2a35de"><div class="ttname"><a href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type alias for floating-point precision used throughout the code.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00022">macros.h:22</a></div></div>
<div class="ttc" id="amesh_8h_html_aba66986baad5475a202c20a92bda036e"><div class="ttname"><a href="mesh_8h.html#aba66986baad5475a202c20a92bda036e">boundary_to_center_log</a></div><div class="ttdeci">void boundary_to_center_log(Arr1 const &amp;boundary, Arr2 &amp;center)</div><div class="ttdoc">Converts boundary values to center values using geometric mean (logarithmic interpolation)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00186">mesh.h:186</a></div></div>
<div class="ttc" id="amesh_8h_html_ae7ec6be5d638ad03ae6697ff2b71ef91"><div class="ttname"><a href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a></div><div class="ttdeci">xt::xtensor&lt; Real, 2 &gt; MeshGrid</div><div class="ttdoc">Type alias for 2D grids (e.g., spatial coordinates)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00039">mesh.h:39</a></div></div>
<div class="ttc" id="amesh_8h_html_afd05120c4d579ec7fa4906f677781a83"><div class="ttname"><a href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a></div><div class="ttdeci">xt::xtensor&lt; Real, 1 &gt; Array</div><div class="ttdoc">Type alias for 1D arrays (e.g., time points)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00037">mesh.h:37</a></div></div>
<div class="ttc" id="autilities_8h_html_ab8e81118f023df135835db8cce4f5f42"><div class="ttname"><a href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">max</a></div><div class="ttdeci">T max(T value)</div><div class="ttdoc">Returns the value of a single parameter.</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00287">utilities.h:287</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_a9fc133aa2f06b425634470424da9daa3_cgraph.png" border="0" usemap="#aclassObserver_a9fc133aa2f06b425634470424da9daa3_cgraph" alt=""/></div>
<map name="aclassObserver_a9fc133aa2f06b425634470424da9daa3_cgraph" id="aclassObserver_a9fc133aa2f06b425634470424da9daa3_cgraph">
<area shape="rect" title="Computes the integrated flux over a frequency band." alt="" coords="5,56,119,81"/>
<area shape="poly" title=" " alt="" coords="30,57,24,48,27,38,40,32,62,29,88,33,99,42,96,46,86,38,62,35,42,37,31,41,29,47,35,54"/>
<area shape="rect" href="mesh_8h.html#aba66986baad5475a202c20a92bda036e" title="Converts boundary values to center values using geometric mean (logarithmic interpolation)" alt="" coords="167,5,345,31"/>
<area shape="poly" title=" " alt="" coords="111,53,193,32,194,37,112,58"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="393,93,444,119"/>
<area shape="poly" title=" " alt="" coords="119,70,346,91,380,97,379,102,345,97,119,75"/>
<area shape="rect" href="classObserver.html#a781d46ba549ae9a7ec4e3049a735586f" title="Computes the specific flux at a single observed frequency." alt="" coords="171,131,341,156"/>
<area shape="poly" title=" " alt="" coords="97,79,211,123,209,128,95,84"/>
<area shape="poly" title=" " alt="" coords="391,95,386,85,389,75,400,69,419,67,441,70,451,79,447,83,439,75,419,72,402,74,393,79,391,84,396,92"/>
<area shape="poly" title=" " alt="" coords="311,128,379,112,380,117,313,133"/>
<area shape="poly" title=" " alt="" coords="229,132,223,122,226,113,237,106,256,104,278,107,288,116,284,120,276,112,256,109,239,111,230,116,228,122,233,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_a9fc133aa2f06b425634470424da9daa3_icgraph.png" border="0" usemap="#aclassObserver_a9fc133aa2f06b425634470424da9daa3_icgraph" alt=""/></div>
<map name="aclassObserver_a9fc133aa2f06b425634470424da9daa3_icgraph" id="aclassObserver_a9fc133aa2f06b425634470424da9daa3_icgraph">
<area shape="rect" title="Computes the integrated flux over a frequency band." alt="" coords="5,29,119,55"/>
<area shape="poly" title=" " alt="" coords="81,18,75,11,62,8,51,10,45,14,44,20,47,28,42,30,38,21,40,12,49,5,62,3,78,6,85,14"/>
</map>
</div>

</div>
</div>
<a id="a7e6b3154ceb89b3ff90758b874c2016d" name="a7e6b3154ceb89b3ff90758b874c2016d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e6b3154ceb89b3ff90758b874c2016d">&#9670;&#160;</a></span>observe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> Observer::observe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCoord.html">Coord</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>luminosity_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>redshift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the <a class="el" href="classObserver.html" title="Represents an observer in the GRB afterglow simulation.">Observer</a> for flux calculation. </p>
<p>Initializes the observation time and Doppler factor grids, as well as the emission surface. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coord</td><td>Coordinate grid containing angular information </td></tr>
    <tr><td class="paramname">shock</td><td><a class="el" href="classShock.html" title="Represents a shock wave in an astrophysical environment.">Shock</a> object containing the evolution data </td></tr>
    <tr><td class="paramname">luminosity_dist</td><td>Luminosity distance to the source </td></tr>
    <tr><td class="paramname">redshift</td><td>Redshift of the source </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="observer_8cpp_source.html#l00158">158</a> of file <a class="el" href="observer_8cpp_source.html">observer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  158</span>                                                                                                  {</div>
<div class="line"><span class="lineno">  159</span>    build_time_grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">luminosity_dist</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">redshift</a>);</div>
<div class="line"><span class="lineno">  160</span>    calc_obs_solid_angle(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  161</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_a7e6b3154ceb89b3ff90758b874c2016d_cgraph.png" border="0" usemap="#aclassObserver_a7e6b3154ceb89b3ff90758b874c2016d_cgraph" alt=""/></div>
<map name="aclassObserver_a7e6b3154ceb89b3ff90758b874c2016d_cgraph" id="aclassObserver_a7e6b3154ceb89b3ff90758b874c2016d_cgraph">
<area shape="rect" title="Sets up the Observer for flux calculation." alt="" coords="5,29,147,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="195,29,245,55"/>
<area shape="poly" title=" " alt="" coords="147,39,181,39,181,45,147,45"/>
<area shape="poly" title=" " alt="" coords="195,30,190,21,193,11,203,5,220,3,240,6,249,15,245,18,237,11,220,8,205,10,197,15,196,20,200,28"/>
</map>
</div>

</div>
</div>
<a id="a20935ae9f08821dd146a71d1c6a3175d" name="a20935ae9f08821dd146a71d1c6a3175d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20935ae9f08821dd146a71d1c6a3175d">&#9670;&#160;</a></span>observe_at()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> Observer::observe_at </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCoord.html">Coord</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classShock.html">Shock</a> &amp;&#160;</td>
          <td class="paramname"><em>shock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>luminosity_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>redshift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the <a class="el" href="classObserver.html" title="Represents an observer in the GRB afterglow simulation.">Observer</a> for flux calculation at specific observation times. </p>
<p>Similar to <a class="el" href="classObserver.html#a7e6b3154ceb89b3ff90758b874c2016d" title="Sets up the Observer for flux calculation.">observe()</a>, but also marks required grid points for the given observation times. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">coord</td><td>Coordinate grid containing angular information </td></tr>
    <tr><td class="paramname">shock</td><td><a class="el" href="classShock.html" title="Represents a shock wave in an astrophysical environment.">Shock</a> object containing the evolution data (modified to mark required points) </td></tr>
    <tr><td class="paramname">luminosity_dist</td><td>Luminosity distance to the source </td></tr>
    <tr><td class="paramname">redshift</td><td>Redshift of the source </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="observer_8cpp_source.html#l00163">163</a> of file <a class="el" href="observer_8cpp_source.html">observer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  163</span>                                                                                                                   {</div>
<div class="line"><span class="lineno">  164</span>    build_time_grid(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">luminosity_dist</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">redshift</a>);</div>
<div class="line"><span class="lineno">  165</span>    xt::view(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.required, xt::all(), xt::all(), xt::all()) = 0;</div>
<div class="line"><span class="lineno">  166</span>    <a class="code hl_function" href="classObserver.html#a90f4a0a86f9e4a702cfc3a13e7c9c153">update_required</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>.required, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>);</div>
<div class="line"><span class="lineno">  167</span>    calc_obs_solid_angle(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coord</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">shock</a>);</div>
<div class="line"><span class="lineno">  168</span>}</div>
<div class="ttc" id="aclassObserver_html_a90f4a0a86f9e4a702cfc3a13e7c9c153"><div class="ttname"><a href="classObserver.html#a90f4a0a86f9e4a702cfc3a13e7c9c153">Observer::update_required</a></div><div class="ttdeci">void update_required(MaskGrid &amp;required, Array const &amp;t_obs)</div><div class="ttdoc">Updates the required grid points for observation.</div><div class="ttdef"><b>Definition</b> <a href="observer_8cpp_source.html#l00107">observer.cpp:107</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_a20935ae9f08821dd146a71d1c6a3175d_cgraph.png" border="0" usemap="#aclassObserver_a20935ae9f08821dd146a71d1c6a3175d_cgraph" alt=""/></div>
<map name="aclassObserver_a20935ae9f08821dd146a71d1c6a3175d_cgraph" id="aclassObserver_a20935ae9f08821dd146a71d1c6a3175d_cgraph">
<area shape="rect" title="Sets up the Observer for flux calculation at specific observation times." alt="" coords="5,5,167,31"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="591,31,641,56"/>
<area shape="poly" title=" " alt="" coords="167,10,340,7,442,11,543,22,578,29,577,35,542,27,442,16,340,12,167,15"/>
<area shape="rect" href="classObserver.html#a90f4a0a86f9e4a702cfc3a13e7c9c153" title="Updates the required grid points for observation." alt="" coords="215,31,409,56"/>
<area shape="poly" title=" " alt="" coords="167,24,201,28,201,34,166,30"/>
<area shape="poly" title=" " alt="" coords="596,32,592,22,594,13,602,6,616,4,632,7,639,16,635,19,629,12,616,9,604,11,599,16,597,22,601,29"/>
<area shape="poly" title=" " alt="" coords="410,41,577,41,577,46,410,46"/>
<area shape="rect" href="observer_8h.html#aa53249b087b9b9d83f4c06e808deeed9" title="Helper function that advances an iterator through an array until the value exceeds the target." alt="" coords="457,81,543,107"/>
<area shape="poly" title=" " alt="" coords="361,54,445,76,443,82,359,59"/>
<area shape="poly" title=" " alt="" coords="529,79,577,57,579,62,531,84"/>
</map>
</div>

</div>
</div>
<a id="a63679ba1972c386be330f8b51397b9a4" name="a63679ba1972c386be330f8b51397b9a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63679ba1972c386be330f8b51397b9a4">&#9670;&#160;</a></span>specific_flux() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... PhotonGrid&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> Observer::specific_flux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>nu_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;...&#160;</td>
          <td class="paramname"><em>photons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the specific flux at multiple observed frequencies. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">PhotonGrid</td><td>Types of photon grid objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">nu_obs</td><td>Array of observed frequencies </td></tr>
    <tr><td class="paramname">photons</td><td>Parameter pack of photon grid objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D grid of specific flux values (frequency Ã— time)</dd></dl>
<p>Returns the specific flux (as a MeshGrid) for multiple observed frequencies (nu_obs) by computing the specific flux for each frequency and assembling the results into a grid. This method accounts for relativistic beaming and cosmological effects. </p>

<p class="definition">Definition at line <a class="el" href="observer_8h_source.html#l00311">311</a> of file <a class="el" href="observer_8h_source.html">observer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  311</span>                                                                                                      {</div>
<div class="line"><span class="lineno">  312</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_len</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>.size();</div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_len</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>.size();</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_obs</a> = xt::log2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>);</div>
<div class="line"><span class="lineno">  316</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_nu</a> = xt::log2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>);</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    <a class="code hl_typedef" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a>({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_len</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_len</a>}, 0);</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>    InterpState <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">state</a>;</div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">l</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">l</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_len</a>; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">l</a>++) {</div>
<div class="line"><span class="lineno">  322</span>        <span class="comment">// Loop over effective phi and theta grid points.</span></div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; eff_phi_grid; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>++) {</div>
<div class="line"><span class="lineno">  324</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_grid; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>++) {</div>
<div class="line"><span class="lineno">  325</span>                <span class="comment">// Skip observation times that are below the grid&#39;s start time</span></div>
<div class="line"><span class="lineno">  326</span>                <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a> = 0;</div>
<div class="line"><span class="lineno">  327</span>                <a class="code hl_function" href="observer_8h.html#aa53249b087b9b9d83f4c06e808deeed9">iterate_to</a>(lg2_t(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, 0), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_obs</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>);</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_grid - 1 &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_len</a>; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>++) {</div>
<div class="line"><span class="lineno">  330</span>                    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_hi</a> = lg2_t(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> + 1);</div>
<div class="line"><span class="lineno">  331</span>                    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_hi</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_obs</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>)) {</div>
<div class="line"><span class="lineno">  332</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  333</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  334</span>                        <span class="keywordflow">if</span> (set_boundaries(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">state</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_nu</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">l</a>], <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>...)) {</div>
<div class="line"><span class="lineno">  335</span>                            <span class="keywordflow">for</span> (; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_len</a> &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_obs</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>) &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_hi</a>; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>++) {</div>
<div class="line"><span class="lineno">  336</span>                                <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">l</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>) += interpolate(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">state</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_obs</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>));</div>
<div class="line"><span class="lineno">  337</span>                            }</div>
<div class="line"><span class="lineno">  338</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  339</span>                            <a class="code hl_function" href="observer_8h.html#aa53249b087b9b9d83f4c06e808deeed9">iterate_to</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_hi</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_obs</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>);</div>
<div class="line"><span class="lineno">  340</span>                        }</div>
<div class="line"><span class="lineno">  341</span>                    }</div>
<div class="line"><span class="lineno">  342</span>                }</div>
<div class="line"><span class="lineno">  343</span>            }</div>
<div class="line"><span class="lineno">  344</span>        }</div>
<div class="line"><span class="lineno">  345</span>    }</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>    <span class="comment">// Normalize the flux by the factor (1+z)/(4pi*lumi_dist^2).</span></div>
<div class="line"><span class="lineno">  348</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coef</a> = one_plus_z / (4 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> * lumi_dist * lumi_dist);</div>
<div class="line"><span class="lineno">  349</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a> *= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coef</a>;</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a>;</div>
<div class="line"><span class="lineno">  352</span>}</div>
<div class="ttc" id="anamespacecon_html_aa0ccd904b754d0f907898a942516d121"><div class="ttname"><a href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a></div><div class="ttdeci">constexpr Real pi</div><div class="ttdoc">Pi.</div><div class="ttdef"><b>Definition</b> <a href="macros_8h_source.html#l00091">macros.h:91</a></div></div>
<div class="ttc" id="aobserver_8h_html_aa53249b087b9b9d83f4c06e808deeed9"><div class="ttname"><a href="observer_8h.html#aa53249b087b9b9d83f4c06e808deeed9">iterate_to</a></div><div class="ttdeci">void iterate_to(Real value, Array const &amp;arr, size_t &amp;it) noexcept</div><div class="ttdoc">Helper function that advances an iterator through an array until the value exceeds the target.</div><div class="ttdef"><b>Definition</b> <a href="observer_8h_source.html#l00273">observer.h:273</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_a63679ba1972c386be330f8b51397b9a4_cgraph.png" border="0" usemap="#aclassObserver_a63679ba1972c386be330f8b51397b9a4_cgraph" alt=""/></div>
<map name="aclassObserver_a63679ba1972c386be330f8b51397b9a4_cgraph" id="aclassObserver_a63679ba1972c386be330f8b51397b9a4_cgraph">
<area shape="rect" title="Computes the specific flux at multiple observed frequencies." alt="" coords="5,31,175,56"/>
<area shape="rect" href="observer_8h.html#aa53249b087b9b9d83f4c06e808deeed9" title="Helper function that advances an iterator through an array until the value exceeds the target." alt="" coords="223,5,308,31"/>
<area shape="poly" title=" " alt="" coords="175,28,209,23,210,29,176,34"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="356,31,407,56"/>
<area shape="poly" title=" " alt="" coords="175,41,342,41,342,46,175,46"/>
<area shape="poly" title=" " alt="" coords="309,25,343,32,342,38,308,30"/>
<area shape="poly" title=" " alt="" coords="361,32,357,22,359,13,368,6,381,4,397,7,404,16,400,19,395,12,381,9,370,11,364,16,363,22,366,29"/>
</map>
</div>

</div>
</div>
<a id="a781d46ba549ae9a7ec4e3049a735586f" name="a781d46ba549ae9a7ec4e3049a735586f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a781d46ba549ae9a7ec4e3049a735586f">&#9670;&#160;</a></span>specific_flux() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... PhotonGrid&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> Observer::specific_flux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>nu_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;...&#160;</td>
          <td class="paramname"><em>photons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the specific flux at a single observed frequency. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">PhotonGrid</td><td>Types of photon grid objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">nu_obs</td><td>Observed frequency </td></tr>
    <tr><td class="paramname">photons</td><td>Parameter pack of photon grid objects</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the specific flux (as an Array) for a single observed frequency (nu_obs) by computing the specific flux over the observation times. </p><dl class="section return"><dt>Returns</dt><dd>Array of specific flux values at each observation time </dd></dl>

<p class="definition">Definition at line <a class="el" href="observer_8h_source.html#l00391">391</a> of file <a class="el" href="observer_8h_source.html">observer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  391</span>                                                                                           {</div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">return</span> xt::view(<a class="code hl_function" href="classObserver.html#a781d46ba549ae9a7ec4e3049a735586f">specific_flux</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>}), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>...), 0);</div>
<div class="line"><span class="lineno">  393</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_a781d46ba549ae9a7ec4e3049a735586f_cgraph.png" border="0" usemap="#aclassObserver_a781d46ba549ae9a7ec4e3049a735586f_cgraph" alt=""/></div>
<map name="aclassObserver_a781d46ba549ae9a7ec4e3049a735586f_cgraph" id="aclassObserver_a781d46ba549ae9a7ec4e3049a735586f_cgraph">
<area shape="rect" title="Computes the specific flux at a single observed frequency." alt="" coords="5,29,175,55"/>
<area shape="poly" title=" " alt="" coords="63,31,58,21,61,11,72,5,90,3,112,6,121,15,117,19,109,11,90,8,74,10,65,15,63,20,68,28"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="223,29,273,55"/>
<area shape="poly" title=" " alt="" coords="175,39,208,39,208,45,175,45"/>
<area shape="poly" title=" " alt="" coords="221,31,216,21,219,11,230,5,248,3,270,6,279,15,275,19,267,11,248,8,232,10,223,15,221,20,226,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_a781d46ba549ae9a7ec4e3049a735586f_icgraph.png" border="0" usemap="#aclassObserver_a781d46ba549ae9a7ec4e3049a735586f_icgraph" alt=""/></div>
<map name="aclassObserver_a781d46ba549ae9a7ec4e3049a735586f_icgraph" id="aclassObserver_a781d46ba549ae9a7ec4e3049a735586f_icgraph">
<area shape="rect" title="Computes the specific flux at a single observed frequency." alt="" coords="389,55,559,80"/>
<area shape="poly" title=" " alt="" coords="510,45,500,37,474,33,453,35,442,40,439,46,445,53,441,56,434,46,438,36,451,30,474,28,502,32,513,41"/>
<area shape="rect" href="classObserver.html#a9fc133aa2f06b425634470424da9daa3" title="Computes the integrated flux over a frequency band." alt="" coords="216,29,329,55"/>
<area shape="poly" title=" " alt="" coords="375,58,330,52,330,46,376,52"/>
<area shape="rect" href="classObserver.html#ac9ed4fb8ae8b336286c176423401ba30" title="Computes the spectrum at multiple observation times." alt="" coords="204,79,341,104"/>
<area shape="poly" title=" " alt="" coords="376,82,342,86,342,80,375,76"/>
<area shape="poly" title=" " alt="" coords="307,19,297,11,273,8,252,10,242,15,239,20,245,28,241,31,234,21,238,11,251,5,273,3,299,6,310,15"/>
<area shape="rect" href="classObserver.html#af16bf4c5175405ae1c88a78b8afdd8c4" title="Computes the spectrum at a single observation time." alt="" coords="5,79,156,104"/>
<area shape="poly" title=" " alt="" coords="190,94,156,94,156,89,190,89"/>
</map>
</div>

</div>
</div>
<a id="ae0ed98be9897dfa8c217cc59370a148f" name="ae0ed98be9897dfa8c217cc59370a148f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ed98be9897dfa8c217cc59370a148f">&#9670;&#160;</a></span>specific_flux_series()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... PhotonGrid&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> Observer::specific_flux_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>nu_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;...&#160;</td>
          <td class="paramname"><em>photons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the specific flux at a single observed frequency for multiple observation times. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">PhotonGrid</td><td>Types of photon grid objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">nu_obs</td><td>Observed frequency </td></tr>
    <tr><td class="paramname">photons</td><td>Parameter pack of photon grid objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of specific flux values at each observation time for a single observed frequency </dd></dl>

<p class="definition">Definition at line <a class="el" href="observer_8h_source.html#l00355">355</a> of file <a class="el" href="observer_8h_source.html">observer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  355</span>                                                                                                          {</div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_len</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>.size();</div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_len</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>.size();</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_len</a> != <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_len</a>) {</div>
<div class="line"><span class="lineno">  360</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;nu_obs and t_obs must have the same length&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  361</span>    }</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_obs</a> = xt::log2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>);</div>
<div class="line"><span class="lineno">  364</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_nu</a> = xt::log2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">nu_obs</a>);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a>({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_len</a>}, 0);</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; eff_phi_grid; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>++) {</div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_grid; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>++) {</div>
<div class="line"><span class="lineno">  370</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_len</a>; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>++) {</div>
<div class="line"><span class="lineno">  371</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_grid - 1; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>++) {</div>
<div class="line"><span class="lineno">  372</span>                    <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_obs</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>) &lt;= lg2_t(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> + 1)) {</div>
<div class="line"><span class="lineno">  373</span>                        InterpState <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">state</a>;</div>
<div class="line"><span class="lineno">  374</span>                        <span class="keywordflow">if</span> (set_boundaries(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">state</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_nu</a>[<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>], <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>...)) {</div>
<div class="line"><span class="lineno">  375</span>                            <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>) += interpolate(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">state</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">lg2_t_obs</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>));</div>
<div class="line"><span class="lineno">  376</span>                        }</div>
<div class="line"><span class="lineno">  377</span>                    }</div>
<div class="line"><span class="lineno">  378</span>                }</div>
<div class="line"><span class="lineno">  379</span>            }</div>
<div class="line"><span class="lineno">  380</span>        }</div>
<div class="line"><span class="lineno">  381</span>    }</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="comment">// Normalize the flux by the factor (1+z)/(4pi*lumi_dist^2).</span></div>
<div class="line"><span class="lineno">  384</span>    <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coef</a> = one_plus_z / (4 * <a class="code hl_variable" href="namespacecon.html#aa0ccd904b754d0f907898a942516d121">con::pi</a> * lumi_dist * lumi_dist);</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a> *= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">coef</a>;</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">F_nu</a>;</div>
<div class="line"><span class="lineno">  388</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_ae0ed98be9897dfa8c217cc59370a148f_cgraph.png" border="0" usemap="#aclassObserver_ae0ed98be9897dfa8c217cc59370a148f_cgraph" alt=""/></div>
<map name="aclassObserver_ae0ed98be9897dfa8c217cc59370a148f_cgraph" id="aclassObserver_ae0ed98be9897dfa8c217cc59370a148f_cgraph">
<area shape="rect" title="Computes the specific flux at a single observed frequency for multiple observation times." alt="" coords="5,22,144,62"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="192,29,243,55"/>
<area shape="poly" title=" " alt="" coords="144,39,178,39,178,45,144,45"/>
<area shape="poly" title=" " alt="" coords="193,30,188,21,191,11,201,5,217,3,237,6,245,15,242,18,234,11,217,8,203,10,195,15,194,20,198,28"/>
</map>
</div>

</div>
</div>
<a id="ac9ed4fb8ae8b336286c176423401ba30" name="ac9ed4fb8ae8b336286c176423401ba30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9ed4fb8ae8b336286c176423401ba30">&#9670;&#160;</a></span>spectra()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... PhotonGrid&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#ae7ec6be5d638ad03ae6697ff2b71ef91">MeshGrid</a> Observer::spectra </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>freqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;...&#160;</td>
          <td class="paramname"><em>photons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the spectrum at multiple observation times. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">PhotonGrid</td><td>Types of photon grid objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freqs</td><td>Array of frequencies </td></tr>
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
    <tr><td class="paramname">photons</td><td>Parameter pack of photon grid objects</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the spectra (as a MeshGrid) for multiple observation times by computing the specific flux for each frequency and transposing the result to get freq Ã— time format. </p><dl class="section return"><dt>Returns</dt><dd>2D grid of spectra (frequency Ã— time) </dd></dl>

<p class="definition">Definition at line <a class="el" href="observer_8h_source.html#l00401">401</a> of file <a class="el" href="observer_8h_source.html">observer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  401</span>                                                                                               {</div>
<div class="line"><span class="lineno">  402</span>    <span class="keywordflow">return</span> xt::transpose(<a class="code hl_function" href="classObserver.html#a781d46ba549ae9a7ec4e3049a735586f">specific_flux</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">freqs</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>...));</div>
<div class="line"><span class="lineno">  403</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_ac9ed4fb8ae8b336286c176423401ba30_cgraph.png" border="0" usemap="#aclassObserver_ac9ed4fb8ae8b336286c176423401ba30_cgraph" alt=""/></div>
<map name="aclassObserver_ac9ed4fb8ae8b336286c176423401ba30_cgraph" id="aclassObserver_ac9ed4fb8ae8b336286c176423401ba30_cgraph">
<area shape="rect" title="Computes the spectrum at multiple observation times." alt="" coords="5,29,143,55"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="408,29,459,55"/>
<area shape="poly" title=" " alt="" coords="143,31,191,27,275,24,360,27,395,32,394,37,360,33,275,29,191,33,143,36"/>
<area shape="rect" href="classObserver.html#a781d46ba549ae9a7ec4e3049a735586f" title="Computes the specific flux at a single observed frequency." alt="" coords="191,67,360,92"/>
<area shape="poly" title=" " alt="" coords="144,52,194,62,193,67,143,57"/>
<area shape="poly" title=" " alt="" coords="407,31,401,21,404,11,415,5,433,3,455,6,464,15,461,19,453,11,433,8,417,10,408,15,407,20,411,28"/>
<area shape="poly" title=" " alt="" coords="329,64,394,48,395,54,330,69"/>
<area shape="poly" title=" " alt="" coords="249,68,243,58,246,49,257,42,275,40,297,43,306,52,303,56,295,48,275,45,259,47,250,52,249,58,253,65"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_ac9ed4fb8ae8b336286c176423401ba30_icgraph.png" border="0" usemap="#aclassObserver_ac9ed4fb8ae8b336286c176423401ba30_icgraph" alt=""/></div>
<map name="aclassObserver_ac9ed4fb8ae8b336286c176423401ba30_icgraph" id="aclassObserver_ac9ed4fb8ae8b336286c176423401ba30_icgraph">
<area shape="rect" title="Computes the spectrum at multiple observation times." alt="" coords="204,5,341,31"/>
<area shape="rect" href="classObserver.html#af16bf4c5175405ae1c88a78b8afdd8c4" title="Computes the spectrum at a single observation time." alt="" coords="5,5,156,31"/>
<area shape="poly" title=" " alt="" coords="190,21,156,21,156,15,190,15"/>
</map>
</div>

</div>
</div>
<a id="af16bf4c5175405ae1c88a78b8afdd8c4" name="af16bf4c5175405ae1c88a78b8afdd8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af16bf4c5175405ae1c88a78b8afdd8c4">&#9670;&#160;</a></span>spectrum()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... PhotonGrid&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> Observer::spectrum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>freqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a>&#160;</td>
          <td class="paramname"><em>t_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">PhotonGrid</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;...&#160;</td>
          <td class="paramname"><em>photons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the spectrum at a single observation time. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">PhotonGrid</td><td>Types of photon grid objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freqs</td><td>Array of frequencies </td></tr>
    <tr><td class="paramname">t_obs</td><td>Single observation time </td></tr>
    <tr><td class="paramname">photons</td><td>Parameter pack of photon grid objects</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the spectrum (as an Array) at a single observation time by computing the specific flux for each frequency in the given array. </p><dl class="section return"><dt>Returns</dt><dd>Array containing the spectrum at the given time </dd></dl>

<p class="definition">Definition at line <a class="el" href="observer_8h_source.html#l00396">396</a> of file <a class="el" href="observer_8h_source.html">observer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  396</span>                                                                                     {</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">return</span> xt::view(<a class="code hl_function" href="classObserver.html#ac9ed4fb8ae8b336286c176423401ba30">spectra</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">freqs</a>, <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a>({<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>}), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">photons</a>...), 0);</div>
<div class="line"><span class="lineno">  398</span>}</div>
<div class="ttc" id="aclassObserver_html_ac9ed4fb8ae8b336286c176423401ba30"><div class="ttname"><a href="classObserver.html#ac9ed4fb8ae8b336286c176423401ba30">Observer::spectra</a></div><div class="ttdeci">MeshGrid spectra(Array const &amp;freqs, Array const &amp;t_obs, PhotonGrid const &amp;... photons)</div><div class="ttdoc">Computes the spectrum at multiple observation times.</div><div class="ttdef"><b>Definition</b> <a href="observer_8h_source.html#l00401">observer.h:401</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_af16bf4c5175405ae1c88a78b8afdd8c4_cgraph.png" border="0" usemap="#aclassObserver_af16bf4c5175405ae1c88a78b8afdd8c4_cgraph" alt=""/></div>
<map name="aclassObserver_af16bf4c5175405ae1c88a78b8afdd8c4_cgraph" id="aclassObserver_af16bf4c5175405ae1c88a78b8afdd8c4_cgraph">
<area shape="rect" title="Computes the spectrum at a single observation time." alt="" coords="5,5,156,31"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="607,31,657,56"/>
<area shape="poly" title=" " alt="" coords="156,11,340,7,450,11,559,22,594,29,593,35,558,27,449,16,340,12,156,16"/>
<area shape="rect" href="classObserver.html#ac9ed4fb8ae8b336286c176423401ba30" title="Computes the spectrum at multiple observation times." alt="" coords="204,31,341,56"/>
<area shape="poly" title=" " alt="" coords="157,25,190,30,190,35,156,31"/>
<area shape="poly" title=" " alt="" coords="605,32,600,22,603,13,614,6,632,4,654,7,663,16,659,20,651,12,632,9,616,11,607,16,605,22,610,29"/>
<area shape="poly" title=" " alt="" coords="342,41,593,41,593,46,342,46"/>
<area shape="rect" href="classObserver.html#a781d46ba549ae9a7ec4e3049a735586f" title="Computes the specific flux at a single observed frequency." alt="" coords="389,105,559,131"/>
<area shape="poly" title=" " alt="" coords="309,54,427,98,425,103,307,59"/>
<area shape="poly" title=" " alt="" coords="501,103,593,58,595,63,503,108"/>
<area shape="poly" title=" " alt="" coords="447,107,442,97,445,87,456,81,474,79,496,82,505,91,501,95,493,87,474,84,458,86,449,91,447,96,452,104"/>
</map>
</div>

</div>
</div>
<a id="a90f4a0a86f9e4a702cfc3a13e7c9c153" name="a90f4a0a86f9e4a702cfc3a13e7c9c153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90f4a0a86f9e4a702cfc3a13e7c9c153">&#9670;&#160;</a></span>update_required()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">void</a> Observer::update_required </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afb738e18bf395ef0903c8c5d6f37c47f">MaskGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>required</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="el" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">const</a> &amp;&#160;</td>
          <td class="paramname"><em>t_obs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the required grid points for observation. </p>
<p>Identifies grid points needed for interpolation at requested observation times. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">required</td><td>Mask grid to mark required points (modified in-place) </td></tr>
    <tr><td class="paramname">t_obs</td><td>Array of observation times </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="observer_8cpp_source.html#l00107">107</a> of file <a class="el" href="observer_8cpp_source.html">observer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  107</span>                                                                     {</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_size</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>.size();</div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_typedef" href="mesh_8h.html#afd05120c4d579ec7fa4906f677781a83">Array</a> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log2_t_obs</a> = xt::log2(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs</a>);</div>
<div class="line"><span class="lineno">  110</span>    <span class="comment">// Loop over effective phi and theta grid points.</span></div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> &lt; eff_phi_grid; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>++) {</div>
<div class="line"><span class="lineno">  112</span>        <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i_eff</a> = <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a> * jet_3d;</div>
<div class="line"><span class="lineno">  113</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a> &lt; theta_grid; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>++) {</div>
<div class="line"><span class="lineno">  114</span>            <span class="comment">// Skip observation times that are below the grid&#39;s start time</span></div>
<div class="line"><span class="lineno">  115</span>            <span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a> = 0;</div>
<div class="line"><span class="lineno">  116</span>            <a class="code hl_function" href="observer_8h.html#aa53249b087b9b9d83f4c06e808deeed9">iterate_to</a>(lg2_t(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, 0), <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log2_t_obs</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>);</div>
<div class="line"><span class="lineno">  117</span>            <span class="comment">// find the grid points that are required for the interpolation.</span></div>
<div class="line"><span class="lineno">  118</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> = 0; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> &lt; t_grid - 1 &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_obs_size</a>; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>++) {</div>
<div class="line"><span class="lineno">  119</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_lo</a> = lg2_t(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>);</div>
<div class="line"><span class="lineno">  120</span>                <a class="code hl_typedef" href="macros_8h.html#a4b04262b81aa7d31eb5d2f607e2a35de">Real</a> <span class="keyword">const</span> <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_hi</a> = lg2_t(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> + 1);</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_lo</a> &lt; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log2_t_obs</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>) &amp;&amp; <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log2_t_obs</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>) &lt;= <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_hi</a>) {</div>
<div class="line"><span class="lineno">  123</span>                    required(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i_eff</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a>) = 1;</div>
<div class="line"><span class="lineno">  124</span>                    required(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">i_eff</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">j</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">k</a> + 1) = 1;</div>
<div class="line"><span class="lineno">  125</span>                }</div>
<div class="line"><span class="lineno">  126</span>                <a class="code hl_function" href="observer_8h.html#aa53249b087b9b9d83f4c06e808deeed9">iterate_to</a>(<a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_hi</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">log2_t_obs</a>, <a class="code hl_function" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42">t_idx</a>);</div>
<div class="line"><span class="lineno">  127</span>            }</div>
<div class="line"><span class="lineno">  128</span>        }</div>
<div class="line"><span class="lineno">  129</span>    }</div>
<div class="line"><span class="lineno">  130</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_a90f4a0a86f9e4a702cfc3a13e7c9c153_cgraph.png" border="0" usemap="#aclassObserver_a90f4a0a86f9e4a702cfc3a13e7c9c153_cgraph" alt=""/></div>
<map name="aclassObserver_a90f4a0a86f9e4a702cfc3a13e7c9c153_cgraph" id="aclassObserver_a90f4a0a86f9e4a702cfc3a13e7c9c153_cgraph">
<area shape="rect" title="Updates the required grid points for observation." alt="" coords="5,31,200,56"/>
<area shape="rect" href="observer_8h.html#aa53249b087b9b9d83f4c06e808deeed9" title="Helper function that advances an iterator through an array until the value exceeds the target." alt="" coords="248,5,333,31"/>
<area shape="poly" title=" " alt="" coords="197,28,234,23,235,28,198,33"/>
<area shape="rect" href="utilities_8h.html#ab8e81118f023df135835db8cce4f5f42" title="Returns the value of a single parameter." alt="" coords="381,31,432,56"/>
<area shape="poly" title=" " alt="" coords="200,41,367,41,367,46,200,46"/>
<area shape="poly" title=" " alt="" coords="334,25,368,32,367,38,333,30"/>
<area shape="poly" title=" " alt="" coords="387,32,383,22,385,13,393,6,407,4,423,7,430,16,426,19,420,12,407,9,395,11,389,16,388,22,391,29"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classObserver_a90f4a0a86f9e4a702cfc3a13e7c9c153_icgraph.png" border="0" usemap="#aclassObserver_a90f4a0a86f9e4a702cfc3a13e7c9c153_icgraph" alt=""/></div>
<map name="aclassObserver_a90f4a0a86f9e4a702cfc3a13e7c9c153_icgraph" id="aclassObserver_a90f4a0a86f9e4a702cfc3a13e7c9c153_icgraph">
<area shape="rect" title="Updates the required grid points for observation." alt="" coords="215,5,409,31"/>
<area shape="rect" href="classObserver.html#a20935ae9f08821dd146a71d1c6a3175d" title="Sets up the Observer for flux calculation at specific observation times." alt="" coords="5,5,167,31"/>
<area shape="poly" title=" " alt="" coords="201,21,167,21,167,15,201,15"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7b83dbbff538d3f079f8e662d3686ada" name="a7b83dbbff538d3f079f8e662d3686ada"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b83dbbff538d3f079f8e662d3686ada">&#9670;&#160;</a></span>time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mesh_8h.html#a6b76cc05bedc7fd9499c0bd3eec3bcb5">MeshGrid3d</a> Observer::time</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Grid of observation times. </p>

<p class="definition">Definition at line <a class="el" href="observer_8h_source.html#l00034">34</a> of file <a class="el" href="observer_8h_source.html">observer.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="observer_8h_source.html">observer.h</a></li>
<li><a class="el" href="observer_8cpp_source.html">observer.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classObserver.html">Observer</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
