

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>C++ API Reference &mdash; VegasAfterglow 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=20074c1a" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=c0df17a3" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=c0df17a3" />

  
    <link rel="shortcut icon" href="_static/logo.svg"/>
    <link rel="canonical" href="https://yihanwangastro.github.io/VegasAfterglow/docs/cpp_api.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/js/custom.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Troubleshooting" href="troubleshooting.html" />
    <link rel="prev" title="Python API Reference" href="python_api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            VegasAfterglow
              <img src="_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="mcmc_fitting.html">MCMC Parameter Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="redback_integration.html">Parameter Estimation with Redback</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter_reference.html">Parameter Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validation &amp; Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api.html">Python API Reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">C++ API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-components">Key Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-c-api">Using the C++ API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#including-headers">Including Headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-custom-applications">Building Custom Applications</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#c-api-documentation">C++ API Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jet-models">Jet Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49TophatJet"><code class="docutils literal notranslate"><span class="pre">TophatJet</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9TophatJet9TophatJetE4Real4Real4Realb4Real"><code class="docutils literal notranslate"><span class="pre">TophatJet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK9TophatJet5eps_kE4Real4Real"><code class="docutils literal notranslate"><span class="pre">eps_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK9TophatJet6Gamma0E4Real4Real"><code class="docutils literal notranslate"><span class="pre">Gamma0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9TophatJet2T0E"><code class="docutils literal notranslate"><span class="pre">T0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9TophatJet9spreadingE"><code class="docutils literal notranslate"><span class="pre">spreading</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411GaussianJet"><code class="docutils literal notranslate"><span class="pre">GaussianJet</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11GaussianJet11GaussianJetE4Real4Real4Realb4Real"><code class="docutils literal notranslate"><span class="pre">GaussianJet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK11GaussianJet5eps_kE4Real4Real"><code class="docutils literal notranslate"><span class="pre">eps_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK11GaussianJet6Gamma0E4Real4Real"><code class="docutils literal notranslate"><span class="pre">Gamma0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11GaussianJet2T0E"><code class="docutils literal notranslate"><span class="pre">T0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11GaussianJet9spreadingE"><code class="docutils literal notranslate"><span class="pre">spreading</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411PowerLawJet"><code class="docutils literal notranslate"><span class="pre">PowerLawJet</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11PowerLawJet11PowerLawJetE4Real4Real4Real4Real4Realb4Real"><code class="docutils literal notranslate"><span class="pre">PowerLawJet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK11PowerLawJet5eps_kE4Real4Real"><code class="docutils literal notranslate"><span class="pre">eps_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK11PowerLawJet6Gamma0E4Real4Real"><code class="docutils literal notranslate"><span class="pre">Gamma0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11PowerLawJet2T0E"><code class="docutils literal notranslate"><span class="pre">T0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11PowerLawJet9spreadingE"><code class="docutils literal notranslate"><span class="pre">spreading</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv46Ejecta"><code class="docutils literal notranslate"><span class="pre">Ejecta</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Ejecta6EjectaE10BinaryFunc10BinaryFunc10BinaryFunc11TernaryFunc11TernaryFuncb4Real"><code class="docutils literal notranslate"><span class="pre">Ejecta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Ejecta6EjectaEv"><code class="docutils literal notranslate"><span class="pre">Ejecta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Ejecta5eps_kE"><code class="docutils literal notranslate"><span class="pre">eps_k</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Ejecta6Gamma0E"><code class="docutils literal notranslate"><span class="pre">Gamma0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Ejecta6sigma0E"><code class="docutils literal notranslate"><span class="pre">sigma0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Ejecta7deps_dtE"><code class="docutils literal notranslate"><span class="pre">deps_dt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Ejecta5dm_dtE"><code class="docutils literal notranslate"><span class="pre">dm_dt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Ejecta2T0E"><code class="docutils literal notranslate"><span class="pre">T0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Ejecta9spreadingE"><code class="docutils literal notranslate"><span class="pre">spreading</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ambient-medium">Ambient Medium</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv43ISM"><code class="docutils literal notranslate"><span class="pre">ISM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N3ISM3ISME4Real"><code class="docutils literal notranslate"><span class="pre">ISM()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK3ISM3rhoE4Real4Real4Real"><code class="docutils literal notranslate"><span class="pre">rho()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK3ISM4massE4Real"><code class="docutils literal notranslate"><span class="pre">mass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N3ISM9isotropicE"><code class="docutils literal notranslate"><span class="pre">isotropic</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv44Wind"><code class="docutils literal notranslate"><span class="pre">Wind</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4Wind4WindE4Real4Real4Real"><code class="docutils literal notranslate"><span class="pre">Wind()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4Wind3rhoE4Real4Real4Real"><code class="docutils literal notranslate"><span class="pre">rho()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4Wind4massE4Real"><code class="docutils literal notranslate"><span class="pre">mass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4Wind7A_paramEv"><code class="docutils literal notranslate"><span class="pre">A_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4Wind13rho_ism_paramEv"><code class="docutils literal notranslate"><span class="pre">rho_ism_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4Wind9r02_paramEv"><code class="docutils literal notranslate"><span class="pre">r02_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4Wind9isotropicE"><code class="docutils literal notranslate"><span class="pre">isotropic</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv46Medium"><code class="docutils literal notranslate"><span class="pre">Medium</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Medium6MediumE11TernaryFuncb"><code class="docutils literal notranslate"><span class="pre">Medium()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Medium6MediumEv"><code class="docutils literal notranslate"><span class="pre">Medium()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Medium3rhoE"><code class="docutils literal notranslate"><span class="pre">rho</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Medium9isotropicE"><code class="docutils literal notranslate"><span class="pre">isotropic</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#radiation-processes">Radiation Processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412SynElectrons"><code class="docutils literal notranslate"><span class="pre">SynElectrons</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK12SynElectrons15compute_N_gammaE4Real"><code class="docutils literal notranslate"><span class="pre">compute_N_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK12SynElectrons18compute_column_denE4Real"><code class="docutils literal notranslate"><span class="pre">compute_column_den()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons7gamma_mE"><code class="docutils literal notranslate"><span class="pre">gamma_m</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons7gamma_cE"><code class="docutils literal notranslate"><span class="pre">gamma_c</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons7gamma_aE"><code class="docutils literal notranslate"><span class="pre">gamma_a</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons7gamma_ME"><code class="docutils literal notranslate"><span class="pre">gamma_M</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons1pE"><code class="docutils literal notranslate"><span class="pre">p</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons3N_eE"><code class="docutils literal notranslate"><span class="pre">N_e</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons10column_denE"><code class="docutils literal notranslate"><span class="pre">column_den</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons3Y_cE"><code class="docutils literal notranslate"><span class="pre">Y_c</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons6regimeE"><code class="docutils literal notranslate"><span class="pre">regime</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12SynElectrons2YsE"><code class="docutils literal notranslate"><span class="pre">Ys</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415InverseComptonY"><code class="docutils literal notranslate"><span class="pre">InverseComptonY</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15InverseComptonY15InverseComptonYE4Real4Real4Real4Real4Realb"><code class="docutils literal notranslate"><span class="pre">InverseComptonY()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15InverseComptonY15InverseComptonYEv"><code class="docutils literal notranslate"><span class="pre">InverseComptonY()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK15InverseComptonY14gamma_spectrumE4Real"><code class="docutils literal notranslate"><span class="pre">gamma_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK15InverseComptonY11nu_spectrumE4Real"><code class="docutils literal notranslate"><span class="pre">nu_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15InverseComptonY21update_cooling_breaksE4Real4Real"><code class="docutils literal notranslate"><span class="pre">update_cooling_breaks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15InverseComptonY11gamma_m_hatE"><code class="docutils literal notranslate"><span class="pre">gamma_m_hat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15InverseComptonY11gamma_c_hatE"><code class="docutils literal notranslate"><span class="pre">gamma_c_hat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15InverseComptonY10gamma_selfE"><code class="docutils literal notranslate"><span class="pre">gamma_self</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15InverseComptonY6gamma0E"><code class="docutils literal notranslate"><span class="pre">gamma0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15InverseComptonY3Y_TE"><code class="docutils literal notranslate"><span class="pre">Y_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15InverseComptonY6regimeE"><code class="docutils literal notranslate"><span class="pre">regime</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#shock-dynamics">Shock Dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv45Shock"><code class="docutils literal notranslate"><span class="pre">Shock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock5ShockE6size_t6size_t6size_tRK9RadParams"><code class="docutils literal notranslate"><span class="pre">Shock()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock5ShockEv"><code class="docutils literal notranslate"><span class="pre">Shock()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK5Shock5shapeEv"><code class="docutils literal notranslate"><span class="pre">shape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock6resizeE6size_t6size_t6size_t"><code class="docutils literal notranslate"><span class="pre">resize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I00EN5Shock15detect_symmetryEvRK5CoordRK6EjectaRK6Medium"><code class="docutils literal notranslate"><span class="pre">detect_symmetry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock16broadcast_groupsERK5Array"><code class="docutils literal notranslate"><span class="pre">broadcast_groups()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock6t_comvE"><code class="docutils literal notranslate"><span class="pre">t_comv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock1rE"><code class="docutils literal notranslate"><span class="pre">r</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock5thetaE"><code class="docutils literal notranslate"><span class="pre">theta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock5GammaE"><code class="docutils literal notranslate"><span class="pre">Gamma</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock8Gamma_thE"><code class="docutils literal notranslate"><span class="pre">Gamma_th</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock1BE"><code class="docutils literal notranslate"><span class="pre">B</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock3N_pE"><code class="docutils literal notranslate"><span class="pre">N_p</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock13injection_idxE"><code class="docutils literal notranslate"><span class="pre">injection_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock3radE"><code class="docutils literal notranslate"><span class="pre">rad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock8symmetryE"><code class="docutils literal notranslate"><span class="pre">symmetry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Shock10theta_repsE"><code class="docutils literal notranslate"><span class="pre">theta_reps</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I00E14SimpleShockEqn"><code class="docutils literal notranslate"><span class="pre">SimpleShockEqn</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N14SimpleShockEqn5StateE"><code class="docutils literal notranslate"><span class="pre">State</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N14SimpleShockEqn14SimpleShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real"><code class="docutils literal notranslate"><span class="pre">SimpleShockEqn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK14SimpleShockEqnclERK5StateR5State4Real"><code class="docutils literal notranslate"><span class="pre">operator()()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK14SimpleShockEqn14set_init_stateER5State4Real"><code class="docutils literal notranslate"><span class="pre">set_init_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N14SimpleShockEqn6mediumE"><code class="docutils literal notranslate"><span class="pre">medium</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N14SimpleShockEqn6ejectaE"><code class="docutils literal notranslate"><span class="pre">ejecta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N14SimpleShockEqn3phiE"><code class="docutils literal notranslate"><span class="pre">phi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N14SimpleShockEqn6theta0E"><code class="docutils literal notranslate"><span class="pre">theta0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N14SimpleShockEqn3radE"><code class="docutils literal notranslate"><span class="pre">rad</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I00E15ForwardShockEqn"><code class="docutils literal notranslate"><span class="pre">ForwardShockEqn</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15ForwardShockEqn5StateE"><code class="docutils literal notranslate"><span class="pre">State</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15ForwardShockEqn15ForwardShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real"><code class="docutils literal notranslate"><span class="pre">ForwardShockEqn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK15ForwardShockEqnclERK5StateR5State4Real"><code class="docutils literal notranslate"><span class="pre">operator()()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK15ForwardShockEqn14set_init_stateER5State4Real"><code class="docutils literal notranslate"><span class="pre">set_init_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15ForwardShockEqn6mediumE"><code class="docutils literal notranslate"><span class="pre">medium</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15ForwardShockEqn6ejectaE"><code class="docutils literal notranslate"><span class="pre">ejecta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15ForwardShockEqn3phiE"><code class="docutils literal notranslate"><span class="pre">phi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15ForwardShockEqn6theta0E"><code class="docutils literal notranslate"><span class="pre">theta0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N15ForwardShockEqn3radE"><code class="docutils literal notranslate"><span class="pre">rad</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I00E10FRShockEqn"><code class="docutils literal notranslate"><span class="pre">FRShockEqn</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn5StateE"><code class="docutils literal notranslate"><span class="pre">State</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn10FRShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParamsRK9RadParams"><code class="docutils literal notranslate"><span class="pre">FRShockEqn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqnclERK5StateR5State4Real"><code class="docutils literal notranslate"><span class="pre">operator()()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK10FRShockEqn14set_init_stateER5State4Real"><code class="docutils literal notranslate"><span class="pre">set_init_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK10FRShockEqn19compute_shell_sigmaERK5State"><code class="docutils literal notranslate"><span class="pre">compute_shell_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn16save_cross_stateERK5State"><code class="docutils literal notranslate"><span class="pre">save_cross_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK10FRShockEqn20injection_efficiencyERK5State"><code class="docutils literal notranslate"><span class="pre">injection_efficiency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK10FRShockEqn17crossing_completeERK5State4Real"><code class="docutils literal notranslate"><span class="pre">crossing_complete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn6mediumE"><code class="docutils literal notranslate"><span class="pre">medium</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn6ejectaE"><code class="docutils literal notranslate"><span class="pre">ejecta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn7rad_fwdE"><code class="docutils literal notranslate"><span class="pre">rad_fwd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn7rad_rvsE"><code class="docutils literal notranslate"><span class="pre">rad_rvs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn3phiE"><code class="docutils literal notranslate"><span class="pre">phi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn6theta0E"><code class="docutils literal notranslate"><span class="pre">theta0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn6Gamma4E"><code class="docutils literal notranslate"><span class="pre">Gamma4</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn3u_xE"><code class="docutils literal notranslate"><span class="pre">u_x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn3r_xE"><code class="docutils literal notranslate"><span class="pre">r_x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn12B3_ordered_xE"><code class="docutils literal notranslate"><span class="pre">B3_ordered_x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn9V3_comv_xE"><code class="docutils literal notranslate"><span class="pre">V3_comv_x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N10FRShockEqn6rho3_xE"><code class="docutils literal notranslate"><span class="pre">rho3_x</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#physics-and-utilities">Physics and Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48Observer"><code class="docutils literal notranslate"><span class="pre">Observer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8Observer8ObserverEv"><code class="docutils literal notranslate"><span class="pre">Observer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8Observer7observeERK5CoordRK5Shock4Real4Real"><code class="docutils literal notranslate"><span class="pre">observe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN8Observer13specific_fluxE5ArrayRK5Array4RealR10PhotonGrid"><code class="docutils literal notranslate"><span class="pre">specific_flux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN8Observer13specific_fluxE8MeshGridRK5ArrayRK5ArrayR10PhotonGrid"><code class="docutils literal notranslate"><span class="pre">specific_flux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN8Observer20specific_flux_seriesE5ArrayRK5ArrayRK5ArrayR10PhotonGrid"><code class="docutils literal notranslate"><span class="pre">specific_flux_series()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN8Observer4fluxE5ArrayRK5ArrayRK5ArrayR10PhotonGrid"><code class="docutils literal notranslate"><span class="pre">flux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN8Observer7spectraE8MeshGridRK5ArrayRK5ArrayR10PhotonGrid"><code class="docutils literal notranslate"><span class="pre">spectra()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN8Observer8spectrumE5ArrayRK5Array4RealR10PhotonGrid"><code class="docutils literal notranslate"><span class="pre">spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8Observer15update_requiredER8MaskGridRK5Array"><code class="docutils literal notranslate"><span class="pre">update_required()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8Observer4timeE"><code class="docutils literal notranslate"><span class="pre">time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8Observer5lg2_tE"><code class="docutils literal notranslate"><span class="pre">lg2_t</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8Observer11lg2_dopplerE"><code class="docutils literal notranslate"><span class="pre">lg2_doppler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8Observer15lg2_geom_factorE"><code class="docutils literal notranslate"><span class="pre">lg2_geom_factor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8Observer10one_plus_zE"><code class="docutils literal notranslate"><span class="pre">one_plus_z</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv45Coord"><code class="docutils literal notranslate"><span class="pre">Coord</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Coord5CoordEv"><code class="docutils literal notranslate"><span class="pre">Coord()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK5Coord5shapeEv"><code class="docutils literal notranslate"><span class="pre">shape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Coord3phiE"><code class="docutils literal notranslate"><span class="pre">phi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Coord5thetaE"><code class="docutils literal notranslate"><span class="pre">theta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Coord1tE"><code class="docutils literal notranslate"><span class="pre">t</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Coord10theta_viewE"><code class="docutils literal notranslate"><span class="pre">theta_view</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N5Coord8phi_viewE"><code class="docutils literal notranslate"><span class="pre">phi_view</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#documenting-c-code">Documenting C++ Code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#class-and-function-documentation">Class and Function Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#member-variable-documentation">Member Variable Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#template-function-documentation">Template Function Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inline-function-documentation">Inline Function Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#c-20-attribute-documentation">C++20 Attribute Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#special-member-function-documentation">Special Member Function Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#private-member-documentation">Private Member Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-class">Example Class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VegasAfterglow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">C++ API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cpp_api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="c-api-reference">
<h1>C++ API Reference<a class="headerlink" href="#c-api-reference" title="Link to this heading"></a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id1">Overview</a></p></li>
<li><p><a class="reference internal" href="#key-components" id="id2">Key Components</a></p></li>
<li><p><a class="reference internal" href="#using-the-c-api" id="id3">Using the C++ API</a></p>
<ul>
<li><p><a class="reference internal" href="#including-headers" id="id4">Including Headers</a></p></li>
<li><p><a class="reference internal" href="#building-custom-applications" id="id5">Building Custom Applications</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#c-api-documentation" id="id6">C++ API Documentation</a></p></li>
<li><p><a class="reference internal" href="#jet-models" id="id7">Jet Models</a></p></li>
<li><p><a class="reference internal" href="#ambient-medium" id="id8">Ambient Medium</a></p></li>
<li><p><a class="reference internal" href="#radiation-processes" id="id9">Radiation Processes</a></p></li>
<li><p><a class="reference internal" href="#shock-dynamics" id="id10">Shock Dynamics</a></p></li>
<li><p><a class="reference internal" href="#physics-and-utilities" id="id11">Physics and Utilities</a></p></li>
<li><p><a class="reference internal" href="#performance-considerations" id="id12">Performance Considerations</a></p></li>
<li><p><a class="reference internal" href="#documenting-c-code" id="id13">Documenting C++ Code</a></p>
<ul>
<li><p><a class="reference internal" href="#class-and-function-documentation" id="id14">Class and Function Documentation</a></p></li>
<li><p><a class="reference internal" href="#member-variable-documentation" id="id15">Member Variable Documentation</a></p></li>
<li><p><a class="reference internal" href="#template-function-documentation" id="id16">Template Function Documentation</a></p></li>
<li><p><a class="reference internal" href="#inline-function-documentation" id="id17">Inline Function Documentation</a></p></li>
<li><p><a class="reference internal" href="#c-20-attribute-documentation" id="id18">C++20 Attribute Documentation</a></p></li>
<li><p><a class="reference internal" href="#special-member-function-documentation" id="id19">Special Member Function Documentation</a></p></li>
<li><p><a class="reference internal" href="#private-member-documentation" id="id20">Private Member Documentation</a></p></li>
<li><p><a class="reference internal" href="#example-class" id="id21">Example Class</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>VegasAfterglow’s C++ core provides high-performance computation capabilities for GRB afterglow modeling. This section documents the C++ API for advanced users and developers who want to work directly with the C++ library. The library requires a C++20 compatible compiler.</p>
</section>
<section id="key-components">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Key Components</a><a class="headerlink" href="#key-components" title="Link to this heading"></a></h2>
<p>The C++ API is organized into several core components:</p>
<ul class="simple">
<li><p><strong>Jet Models</strong>: Implementations of different jet structure models (top-hat, Gaussian, power-law, and user-defined)</p></li>
<li><p><strong>Ambient Medium</strong>: Classes for modeling the circumburst environment (ISM, wind, and user-defined)</p></li>
<li><p><strong>Radiation Processes</strong>: Components for synchrotron emission, synchrotron self-absorption, and inverse Compton (with Klein-Nishina corrections)</p></li>
<li><p><strong>Shock Dynamics</strong>: Forward and reverse shock physics with accurate evolution across relativistic and non-relativistic regimes</p></li>
<li><p><strong>Observer Effects</strong>: Classes for handling off-axis viewing angles and relativistic beaming</p></li>
<li><p><strong>Utilities</strong>: Helper functions and mathematical tools for GRB afterglow calculations</p></li>
</ul>
</section>
<section id="using-the-c-api">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Using the C++ API</a><a class="headerlink" href="#using-the-c-api" title="Link to this heading"></a></h2>
<p>After compiling the library, you can create custom applications that use VegasAfterglow’s core functionality:</p>
<section id="including-headers">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Including Headers</a><a class="headerlink" href="#including-headers" title="Link to this heading"></a></h3>
<p>To use VegasAfterglow directly from C++, include the main header:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;afterglow.h&quot;</span><span class="c1">              // Main header for afterglow models</span>
</pre></div>
</div>
</section>
<section id="building-custom-applications">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Building Custom Applications</a><a class="headerlink" href="#building-custom-applications" title="Link to this heading"></a></h3>
<p>Compile your C++ application, linking against the VegasAfterglow library:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>g++<span class="w"> </span>-std<span class="o">=</span>c++20<span class="w"> </span>-I/path/to/VegasAfterglow/include<span class="w"> </span>-L/path/to/VegasAfterglow/lib<span class="w"> </span>-o<span class="w"> </span>my_program<span class="w"> </span>my_program.cpp<span class="w"> </span>-lvegasafterglow
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Replace <code class="docutils literal notranslate"><span class="pre">/path/to/VegasAfterglow/</span></code> with the actual path to your VegasAfterglow installation.</p>
</div>
</section>
</section>
<section id="c-api-documentation">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">C++ API Documentation</a><a class="headerlink" href="#c-api-documentation" title="Link to this heading"></a></h2>
</section>
<section id="jet-models">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Jet Models</a><a class="headerlink" href="#jet-models" title="Link to this heading"></a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv49TophatJet">
<span id="_CPPv39TophatJet"></span><span id="_CPPv29TophatJet"></span><span id="TophatJet"></span><span class="target" id="VegasAfterglowclassTophatJet"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TophatJet</span></span></span><a class="headerlink" href="#_CPPv49TophatJet" title="Link to this definition"></a><br /></dt>
<dd><p>Implements a tophat jet profile where properties are uniform within a core angle theta_c and zero outside. </p>
<p>This class provides a simple model for GRB jets with sharp edges, characterized by isotropic equivalent energy E_iso and initial Lorentz factor Gamma0 within the core angle. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N9TophatJet9TophatJetE4Real4Real4Realb4Real">
<span id="_CPPv3N9TophatJet9TophatJetE4Real4Real4Realb4Real"></span><span id="_CPPv2N9TophatJet9TophatJetE4Real4Real4Realb4Real"></span><span id="TophatJet::TophatJet__Real.Real.Real.b.Real"></span><span class="target" id="VegasAfterglowclassTophatJet_1abe166f2a89874e03542d6e2d042826d2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TophatJet</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta_c</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">E_iso</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Gamma0</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">spreading</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">T0</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="w"> </span><span class="o"><span class="pre">*</span></span><span class="w"> </span><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">sec</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N9TophatJet9TophatJetE4Real4Real4Realb4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor: Initialize with core angle, isotropic energy, and initial Lorentz factor. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta_c</strong> – Core angle of the jet </p></li>
<li><p><strong>E_iso</strong> – Isotropic equivalent energy </p></li>
<li><p><strong>Gamma0</strong> – Initial Lorentz factor </p></li>
<li><p><strong>T0</strong> – Duration of the ejecta </p></li>
<li><p><strong>spreading</strong> – Flag indicating if the ejecta spreads laterally during evolution </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK9TophatJet5eps_kE4Real4Real">
<span id="_CPPv3NK9TophatJet5eps_kE4Real4Real"></span><span id="_CPPv2NK9TophatJet5eps_kE4Real4Real"></span><span id="TophatJet::eps_k__Real.RealC"></span><span class="target" id="VegasAfterglowclassTophatJet_1a5e878a0b40f3dcd67094fb2141e19925"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">eps_k</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK9TophatJet5eps_kE4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Energy per solid angle as a function of phi and theta. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> – Azimuthal angle (unused) </p></li>
<li><p><strong>theta</strong> – Polar angle </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Energy per solid angle (eps_k_ if theta &lt; theta_c_, 0 otherwise) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK9TophatJet6Gamma0E4Real4Real">
<span id="_CPPv3NK9TophatJet6Gamma0E4Real4Real"></span><span id="_CPPv2NK9TophatJet6Gamma0E4Real4Real"></span><span id="TophatJet::Gamma0__Real.RealC"></span><span class="target" id="VegasAfterglowclassTophatJet_1a89374a73ef8bbaec174846b778ccfb6f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gamma0</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK9TophatJet6Gamma0E4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Initial Lorentz factor as a function of phi and theta. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> – Azimuthal angle (unused) </p></li>
<li><p><strong>theta</strong> – Polar angle </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lorentz factor (Gamma0_ if theta &lt; theta_c_, 1 otherwise) </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9TophatJet2T0E">
<span id="_CPPv3N9TophatJet2T0E"></span><span id="_CPPv2N9TophatJet2T0E"></span><span id="TophatJet::T0__Real"></span><span class="target" id="VegasAfterglowclassTophatJet_1a8646027b99fed9bb2e206956ff284c84"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="w"> </span><span class="o"><span class="pre">*</span></span><span class="w"> </span><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">sec</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N9TophatJet2T0E" title="Link to this definition"></a><br /></dt>
<dd><p>Duration of the ejecta in seconds. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9TophatJet9spreadingE">
<span id="_CPPv3N9TophatJet9spreadingE"></span><span id="_CPPv2N9TophatJet9spreadingE"></span><span id="TophatJet::spreading__b"></span><span class="target" id="VegasAfterglowclassTophatJet_1aff514e356b2b7c08acaf3608baa261d0"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spreading</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">false</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N9TophatJet9spreadingE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating if the ejecta spreads laterally during evolution. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv411GaussianJet">
<span id="_CPPv311GaussianJet"></span><span id="_CPPv211GaussianJet"></span><span id="GaussianJet"></span><span class="target" id="VegasAfterglowclassGaussianJet"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GaussianJet</span></span></span><a class="headerlink" href="#_CPPv411GaussianJet" title="Link to this definition"></a><br /></dt>
<dd><p>Implements a Gaussian jet profile where properties follow a Gaussian distribution with angles. </p>
<p>This class provides a smooth model for GRB jets, characterized by core angle theta_c, isotropic equivalent energy E_iso, and initial Lorentz factor Gamma0 at the center. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N11GaussianJet11GaussianJetE4Real4Real4Realb4Real">
<span id="_CPPv3N11GaussianJet11GaussianJetE4Real4Real4Realb4Real"></span><span id="_CPPv2N11GaussianJet11GaussianJetE4Real4Real4Realb4Real"></span><span id="GaussianJet::GaussianJet__Real.Real.Real.b.Real"></span><span class="target" id="VegasAfterglowclassGaussianJet_1adbfec46147c6fd9f22258acade623122"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GaussianJet</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta_c</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">E_iso</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Gamma0</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">spreading</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">T0</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="w"> </span><span class="o"><span class="pre">*</span></span><span class="w"> </span><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">sec</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N11GaussianJet11GaussianJetE4Real4Real4Realb4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor: Initialize with core angle, isotropic energy, and initial Lorentz factor. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta_c</strong> – Core angle of the jet </p></li>
<li><p><strong>E_iso</strong> – Isotropic equivalent energy </p></li>
<li><p><strong>Gamma0</strong> – Initial Lorentz factor </p></li>
<li><p><strong>T0</strong> – Duration of the ejecta </p></li>
<li><p><strong>spreading</strong> – Flag indicating if the ejecta spreads laterally during evolution </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK11GaussianJet5eps_kE4Real4Real">
<span id="_CPPv3NK11GaussianJet5eps_kE4Real4Real"></span><span id="_CPPv2NK11GaussianJet5eps_kE4Real4Real"></span><span id="GaussianJet::eps_k__Real.RealC"></span><span class="target" id="VegasAfterglowclassGaussianJet_1a17e4cc949abbbd26b44b0b96c938eefb"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">eps_k</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK11GaussianJet5eps_kE4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Energy per solid angle as a function of phi and theta, with Gaussian falloff. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> – Azimuthal angle (unused) </p></li>
<li><p><strong>theta</strong> – Polar angle </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Energy per solid angle with Gaussian angular dependence </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK11GaussianJet6Gamma0E4Real4Real">
<span id="_CPPv3NK11GaussianJet6Gamma0E4Real4Real"></span><span id="_CPPv2NK11GaussianJet6Gamma0E4Real4Real"></span><span id="GaussianJet::Gamma0__Real.RealC"></span><span class="target" id="VegasAfterglowclassGaussianJet_1a9c76f0d0e02fd686f7b081962275d49b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gamma0</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK11GaussianJet6Gamma0E4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Initial Lorentz factor as a function of phi and theta, with Gaussian falloff. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> – Azimuthal angle (unused) </p></li>
<li><p><strong>theta</strong> – Polar angle </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lorentz factor with Gaussian angular dependence </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11GaussianJet2T0E">
<span id="_CPPv3N11GaussianJet2T0E"></span><span id="_CPPv2N11GaussianJet2T0E"></span><span id="GaussianJet::T0__Real"></span><span class="target" id="VegasAfterglowclassGaussianJet_1ac044ed063b0720f124551a728ce1ac67"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="w"> </span><span class="o"><span class="pre">*</span></span><span class="w"> </span><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">sec</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N11GaussianJet2T0E" title="Link to this definition"></a><br /></dt>
<dd><p>Duration of the ejecta in seconds. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11GaussianJet9spreadingE">
<span id="_CPPv3N11GaussianJet9spreadingE"></span><span id="_CPPv2N11GaussianJet9spreadingE"></span><span id="GaussianJet::spreading__b"></span><span class="target" id="VegasAfterglowclassGaussianJet_1a9ee23bc79cff844132e7eeb55e174d49"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spreading</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">false</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N11GaussianJet9spreadingE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating if the ejecta spreads laterally during evolution. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv411PowerLawJet">
<span id="_CPPv311PowerLawJet"></span><span id="_CPPv211PowerLawJet"></span><span id="PowerLawJet"></span><span class="target" id="VegasAfterglowclassPowerLawJet"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PowerLawJet</span></span></span><a class="headerlink" href="#_CPPv411PowerLawJet" title="Link to this definition"></a><br /></dt>
<dd><p>Implements a power-law jet profile where properties follow a power-law distribution with angles. </p>
<p>This class provides a model for GRB jets with a power-law decay, characterized by core angle theta_c, isotropic equivalent energy E_iso, initial Lorentz factor Gamma0, and power-law index k. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N11PowerLawJet11PowerLawJetE4Real4Real4Real4Real4Realb4Real">
<span id="_CPPv3N11PowerLawJet11PowerLawJetE4Real4Real4Real4Real4Realb4Real"></span><span id="_CPPv2N11PowerLawJet11PowerLawJetE4Real4Real4Real4Real4Realb4Real"></span><span id="PowerLawJet::PowerLawJet__Real.Real.Real.Real.Real.b.Real"></span><span class="target" id="VegasAfterglowclassPowerLawJet_1aa990b4da203279631440b271b0338257"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PowerLawJet</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta_c</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">E_iso</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Gamma0</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k_e</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k_g</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">spreading</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">T0</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="w"> </span><span class="o"><span class="pre">*</span></span><span class="w"> </span><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">sec</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N11PowerLawJet11PowerLawJetE4Real4Real4Real4Real4Realb4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor: Initialize with core angle, isotropic energy, initial Lorentz factor, and power-law index. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta_c</strong> – Core angle of the jet </p></li>
<li><p><strong>E_iso</strong> – Isotropic equivalent energy </p></li>
<li><p><strong>Gamma0</strong> – Initial Lorentz factor </p></li>
<li><p><strong>k_e</strong> – Power-law index </p></li>
<li><p><strong>k_g</strong> – Power-law index </p></li>
<li><p><strong>T0</strong> – Duration of the ejecta </p></li>
<li><p><strong>spreading</strong> – Flag indicating if the ejecta spreads laterally during evolution </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK11PowerLawJet5eps_kE4Real4Real">
<span id="_CPPv3NK11PowerLawJet5eps_kE4Real4Real"></span><span id="_CPPv2NK11PowerLawJet5eps_kE4Real4Real"></span><span id="PowerLawJet::eps_k__Real.RealC"></span><span class="target" id="VegasAfterglowclassPowerLawJet_1a6f2b4379fe8d70409ba7ceef5804aca4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">eps_k</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK11PowerLawJet5eps_kE4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Energy per solid angle as a function of phi and theta, with power-law falloff. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> – Azimuthal angle (unused) </p></li>
<li><p><strong>theta</strong> – Polar angle </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Energy per solid angle with power-law angular dependence </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK11PowerLawJet6Gamma0E4Real4Real">
<span id="_CPPv3NK11PowerLawJet6Gamma0E4Real4Real"></span><span id="_CPPv2NK11PowerLawJet6Gamma0E4Real4Real"></span><span id="PowerLawJet::Gamma0__Real.RealC"></span><span class="target" id="VegasAfterglowclassPowerLawJet_1a476eed410b28500b7209768b81434502"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gamma0</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK11PowerLawJet6Gamma0E4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Initial Lorentz factor as a function of phi and theta, with power-law falloff. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> – Azimuthal angle (unused) </p></li>
<li><p><strong>theta</strong> – Polar angle </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lorentz factor with power-law angular dependence </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11PowerLawJet2T0E">
<span id="_CPPv3N11PowerLawJet2T0E"></span><span id="_CPPv2N11PowerLawJet2T0E"></span><span id="PowerLawJet::T0__Real"></span><span class="target" id="VegasAfterglowclassPowerLawJet_1aefe6b9e991605a6b451090adad143e39"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="w"> </span><span class="o"><span class="pre">*</span></span><span class="w"> </span><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">sec</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N11PowerLawJet2T0E" title="Link to this definition"></a><br /></dt>
<dd><p>Duration of the ejecta in seconds. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11PowerLawJet9spreadingE">
<span id="_CPPv3N11PowerLawJet9spreadingE"></span><span id="_CPPv2N11PowerLawJet9spreadingE"></span><span id="PowerLawJet::spreading__b"></span><span class="target" id="VegasAfterglowclassPowerLawJet_1a783b242334d9723f19a3f724b65629b5"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spreading</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">false</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N11PowerLawJet9spreadingE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating if the ejecta spreads laterally during evolution. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv46Ejecta">
<span id="_CPPv36Ejecta"></span><span id="_CPPv26Ejecta"></span><span id="Ejecta"></span><span class="target" id="VegasAfterglowclassEjecta"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Ejecta</span></span></span><a class="headerlink" href="#_CPPv46Ejecta" title="Link to this definition"></a><br /></dt>
<dd><p>Represents generic ejecta properties for a simulation. </p>
<p>Uses ternary functions (TernaryFunc) to accept user-defined ejecta that describes various quantities as functions of phi, theta, and time. This class encapsulates all the properties of the material ejected in a gamma-ray burst, including its energy, magnetization, and Lorentz factor profiles. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Ejecta6EjectaE10BinaryFunc10BinaryFunc10BinaryFunc11TernaryFunc11TernaryFuncb4Real">
<span id="_CPPv3N6Ejecta6EjectaE10BinaryFunc10BinaryFunc10BinaryFunc11TernaryFunc11TernaryFuncb4Real"></span><span id="_CPPv2N6Ejecta6EjectaE10BinaryFunc10BinaryFunc10BinaryFunc11TernaryFunc11TernaryFuncb4Real"></span><span id="Ejecta::Ejecta__BinaryFunc.BinaryFunc.BinaryFunc.TernaryFunc.TernaryFunc.b.Real"></span><span class="target" id="VegasAfterglowclassEjecta_1a3ba7d93839cd4a8a3b3f4c5ec5e66efa"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Ejecta</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">BinaryFunc</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eps_k</span></span>, <span class="n"><span class="pre">BinaryFunc</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Gamma0</span></span>, <span class="n"><span class="pre">BinaryFunc</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma0</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">zero_2d</span></span>, <span class="n"><span class="pre">TernaryFunc</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">deps_dt</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">zero_3d</span></span>, <span class="n"><span class="pre">TernaryFunc</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dm_dt</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">zero_3d</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">spreading</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">T0</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="w"> </span><span class="o"><span class="pre">*</span></span><span class="w"> </span><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">sec</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N6Ejecta6EjectaE10BinaryFunc10BinaryFunc10BinaryFunc11TernaryFunc11TernaryFuncb4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor: Initialize with core angle, isotropic energy, and initial Lorentz factor. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps_k</strong> – Energy per unit solid angle as a function of (phi, theta) </p></li>
<li><p><strong>Gamma0</strong> – Lorentz factor as a function of (phi, theta) </p></li>
<li><p><strong>sigma0</strong> – Magnetization parameter as a function of (phi, theta) </p></li>
<li><p><strong>deps_dt</strong> – Energy injection rate per solid angle as a function of (phi, theta, t) </p></li>
<li><p><strong>dm_dt</strong> – Mass injection rate per unit solid angle as a function of (phi, theta, t) </p></li>
<li><p><strong>T0</strong> – Duration of the ejecta </p></li>
<li><p><strong>spreading</strong> – Flag indicating if the ejecta spreads laterally during evolution </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Ejecta6EjectaEv">
<span id="_CPPv3N6Ejecta6EjectaEv"></span><span id="_CPPv2N6Ejecta6EjectaEv"></span><span id="Ejecta::Ejecta"></span><span class="target" id="VegasAfterglowclassEjecta_1a240a0ed7fbc307a27d92ffa3d8057107"></span><span class="sig-name descname"><span class="n"><span class="pre">Ejecta</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N6Ejecta6EjectaEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N6Ejecta5eps_kE">
<span id="_CPPv3N6Ejecta5eps_kE"></span><span id="_CPPv2N6Ejecta5eps_kE"></span><span id="Ejecta::eps_k__BinaryFunc"></span><span class="target" id="VegasAfterglowclassEjecta_1a1952705ec5647300cd09255dcfc786cd"></span><span class="n"><span class="pre">BinaryFunc</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">eps_k</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">zero_2d</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N6Ejecta5eps_kE" title="Link to this definition"></a><br /></dt>
<dd><p>Initial energy per unit solid angle as a function of (phi, theta) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N6Ejecta6Gamma0E">
<span id="_CPPv3N6Ejecta6Gamma0E"></span><span id="_CPPv2N6Ejecta6Gamma0E"></span><span id="Ejecta::Gamma0__BinaryFunc"></span><span class="target" id="VegasAfterglowclassEjecta_1a6993f0ec67bf03b7c80e9a7c10e65640"></span><span class="n"><span class="pre">BinaryFunc</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gamma0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">one_2d</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N6Ejecta6Gamma0E" title="Link to this definition"></a><br /></dt>
<dd><p>Lorentz factor profile in the ejecta as a function of (phi, theta) Default is uniform (one) across all angles. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N6Ejecta6sigma0E">
<span id="_CPPv3N6Ejecta6sigma0E"></span><span id="_CPPv2N6Ejecta6sigma0E"></span><span id="Ejecta::sigma0__BinaryFunc"></span><span class="target" id="VegasAfterglowclassEjecta_1abc25c1fa9cdee20b4431cf94796dcbef"></span><span class="n"><span class="pre">BinaryFunc</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sigma0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">zero_2d</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N6Ejecta6sigma0E" title="Link to this definition"></a><br /></dt>
<dd><p>Initial magnetization parameter as a function of (phi, theta) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N6Ejecta7deps_dtE">
<span id="_CPPv3N6Ejecta7deps_dtE"></span><span id="_CPPv2N6Ejecta7deps_dtE"></span><span id="Ejecta::deps_dt__TernaryFunc"></span><span class="target" id="VegasAfterglowclassEjecta_1a1cd7491361913dd37cf4efe8e3a0376a"></span><span class="n"><span class="pre">TernaryFunc</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">deps_dt</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">zero_3d</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N6Ejecta7deps_dtE" title="Link to this definition"></a><br /></dt>
<dd><p>Energy injection rate per solid angle as a function of (phi, theta, t) Default is no energy injection (zero) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N6Ejecta5dm_dtE">
<span id="_CPPv3N6Ejecta5dm_dtE"></span><span id="_CPPv2N6Ejecta5dm_dtE"></span><span id="Ejecta::dm_dt__TernaryFunc"></span><span class="target" id="VegasAfterglowclassEjecta_1a74ab20785693d39f5ec9a13edf2c0cd7"></span><span class="n"><span class="pre">TernaryFunc</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dm_dt</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">zero_3d</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N6Ejecta5dm_dtE" title="Link to this definition"></a><br /></dt>
<dd><p>Mass injection rate per unit solid angle as a function of (phi, theta, t) Default is no mass injection (zero) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N6Ejecta2T0E">
<span id="_CPPv3N6Ejecta2T0E"></span><span id="_CPPv2N6Ejecta2T0E"></span><span id="Ejecta::T0__Real"></span><span class="target" id="VegasAfterglowclassEjecta_1a4317c1c49676662f347708942bc61bdf"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="w"> </span><span class="o"><span class="pre">*</span></span><span class="w"> </span><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">sec</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N6Ejecta2T0E" title="Link to this definition"></a><br /></dt>
<dd><p>Duration of the ejecta in seconds. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N6Ejecta9spreadingE">
<span id="_CPPv3N6Ejecta9spreadingE"></span><span id="_CPPv2N6Ejecta9spreadingE"></span><span id="Ejecta::spreading__b"></span><span class="target" id="VegasAfterglowclassEjecta_1a8de0be09be7bd262e246c756699addd0"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spreading</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">false</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N6Ejecta9spreadingE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating if the ejecta spreads laterally during evolution. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="ambient-medium">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Ambient Medium</a><a class="headerlink" href="#ambient-medium" title="Link to this heading"></a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv43ISM">
<span id="_CPPv33ISM"></span><span id="_CPPv23ISM"></span><span id="ISM"></span><span class="target" id="VegasAfterglowclassISM"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ISM</span></span></span><a class="headerlink" href="#_CPPv43ISM" title="Link to this definition"></a><br /></dt>
<dd><p>Implements a uniform interstellar medium (<a class="reference internal" href="#VegasAfterglowclassISM"><span class="std std-ref">ISM</span></a>) with constant density. </p>
<p>Provides methods to compute density at any position. The <a class="reference internal" href="#VegasAfterglowclassISM"><span class="std std-ref">ISM</span></a> is characterized by the particle number density n_ism. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3ISM3ISME4Real">
<span id="_CPPv3N3ISM3ISME4Real"></span><span id="_CPPv2N3ISM3ISME4Real"></span><span id="ISM::ISM__Real"></span><span class="target" id="VegasAfterglowclassISM_1a84b54625cac41da743d803e3425e5c6c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ISM</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_ism</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N3ISM3ISME4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor: Initialize with particle number density in cm^-3. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_ism</strong> – Particle number density in cm^-3 </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3ISM3rhoE4Real4Real4Real">
<span id="_CPPv3NK3ISM3rhoE4Real4Real4Real"></span><span id="_CPPv2NK3ISM3rhoE4Real4Real4Real"></span><span id="ISM::rho__Real.Real.RealC"></span><span class="target" id="VegasAfterglowclassISM_1ab288e7072dc13d792244458db8e0d6da"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rho</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK3ISM3rhoE4Real4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Return density at a given position (constant everywhere) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> – Azimuthal angle (unused) </p></li>
<li><p><strong>theta</strong> – Polar angle (unused) </p></li>
<li><p><strong>r</strong> – Radial distance (unused) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Constant density value </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3ISM4massE4Real">
<span id="_CPPv3NK3ISM4massE4Real"></span><span id="_CPPv2NK3ISM4massE4Real"></span><span id="ISM::mass__RealC"></span><span class="target" id="VegasAfterglowclassISM_1a073486fd1d4e698830831821a986de53"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mass</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK3ISM4massE4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Enclosed mass per solid angle up to radius r. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3ISM9isotropicE">
<span id="_CPPv3N3ISM9isotropicE"></span><span id="_CPPv2N3ISM9isotropicE"></span><span id="ISM::isotropic__b"></span><span class="target" id="VegasAfterglowclassISM_1a267b49a9932ce2570973700acc69fed1"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isotropic</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">true</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N3ISM9isotropicE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating if the medium is isotropic within computational domain. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv44Wind">
<span id="_CPPv34Wind"></span><span id="_CPPv24Wind"></span><span id="Wind"></span><span class="target" id="VegasAfterglowclassWind"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Wind</span></span></span><a class="headerlink" href="#_CPPv44Wind" title="Link to this definition"></a><br /></dt>
<dd><p>Implements a stellar wind medium with density proportional to 1/r². </p>
<p>Provides methods to compute density at any position. The wind is characterized by the wind parameter A_star. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4Wind4WindE4Real4Real4Real">
<span id="_CPPv3N4Wind4WindE4Real4Real4Real"></span><span id="_CPPv2N4Wind4WindE4Real4Real4Real"></span><span id="Wind::Wind__Real.Real.Real"></span><span class="target" id="VegasAfterglowclassWind_1ad1862471c40385dd0e8a7469dabcdc8e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Wind</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A_star</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_ism</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n0</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">con</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">inf</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4Wind4WindE4Real4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor: Initialize with wind parameter A_star (in standard units) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A_star</strong> – <a class="reference internal" href="#VegasAfterglowclassWind"><span class="std std-ref">Wind</span></a> density parameter in standard units </p></li>
<li><p><strong>n_ism</strong> – number density of <a class="reference internal" href="#VegasAfterglowclassISM"><span class="std std-ref">ISM</span></a> at large radii </p></li>
<li><p><strong>n0</strong> – number density of wind at small radii </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4Wind3rhoE4Real4Real4Real">
<span id="_CPPv3NK4Wind3rhoE4Real4Real4Real"></span><span id="_CPPv2NK4Wind3rhoE4Real4Real4Real"></span><span id="Wind::rho__Real.Real.RealC"></span><span class="target" id="VegasAfterglowclassWind_1ab5224ceb8e690e272e1fa39c598b1999"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rho</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4Wind3rhoE4Real4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Return density at given positions (proportional to 1/r²) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> – Azimuthal angle (unused) </p></li>
<li><p><strong>theta</strong> – Polar angle (unused) </p></li>
<li><p><strong>r</strong> – Radial distance </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Density value at radius r (= A/r²) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4Wind4massE4Real">
<span id="_CPPv3NK4Wind4massE4Real"></span><span id="_CPPv2NK4Wind4massE4Real"></span><span id="Wind::mass__RealC"></span><span class="target" id="VegasAfterglowclassWind_1a5669005931a6dcfdbf12e695144a17de"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mass</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4Wind4massE4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Enclosed mass per solid angle up to radius r. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4Wind7A_paramEv">
<span id="_CPPv3NK4Wind7A_paramEv"></span><span id="_CPPv2NK4Wind7A_paramEv"></span><span id="Wind::A_paramC"></span><span class="target" id="VegasAfterglowclassWind_1aea4c33b54df3d7473cb8f4c6635ef1b6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">A_param</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4Wind7A_paramEv" title="Link to this definition"></a><br /></dt>
<dd><p>Expose parameters for analytic integrals in hot dynamics setup paths. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4Wind13rho_ism_paramEv">
<span id="_CPPv3NK4Wind13rho_ism_paramEv"></span><span id="_CPPv2NK4Wind13rho_ism_paramEv"></span><span id="Wind::rho_ism_paramC"></span><span class="target" id="VegasAfterglowclassWind_1a709121a77f23659a33c90310438ea2fc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rho_ism_param</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4Wind13rho_ism_paramEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4Wind9r02_paramEv">
<span id="_CPPv3NK4Wind9r02_paramEv"></span><span id="_CPPv2NK4Wind9r02_paramEv"></span><span id="Wind::r02_paramC"></span><span class="target" id="VegasAfterglowclassWind_1a5e2e45b34d5135e2b245d093ea618297"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">r02_param</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4Wind9r02_paramEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4Wind9isotropicE">
<span id="_CPPv3N4Wind9isotropicE"></span><span id="_CPPv2N4Wind9isotropicE"></span><span id="Wind::isotropic__b"></span><span class="target" id="VegasAfterglowclassWind_1a0a5c1450e106c8fa6b926f185f6eb905"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isotropic</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">true</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N4Wind9isotropicE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating if the medium is isotropic within computational domain. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv46Medium">
<span id="_CPPv36Medium"></span><span id="_CPPv26Medium"></span><span id="Medium"></span><span class="target" id="VegasAfterglowclassMedium"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Medium</span></span></span><a class="headerlink" href="#_CPPv46Medium" title="Link to this definition"></a><br /></dt>
<dd><p>Represents the generic medium or any user-defined surrounding medium that the GRB jet interacts with. </p>
<p>The class provides methods to compute the density (rho) as a function of position (phi, theta, r). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Medium6MediumE11TernaryFuncb">
<span id="_CPPv3N6Medium6MediumE11TernaryFuncb"></span><span id="_CPPv2N6Medium6MediumE11TernaryFuncb"></span><span id="Medium::Medium__TernaryFunc.b"></span><span class="target" id="VegasAfterglowclassMedium_1aae76f473a83084bd5fd468106b23b8e3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Medium</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">TernaryFunc</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isotropic</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N6Medium6MediumE11TernaryFuncb" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor: Initialize with density function. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> – Density function </p></li>
<li><p><strong>isotropic</strong> – Flag indicating if the medium is isotropic within computational domain. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Medium6MediumEv">
<span id="_CPPv3N6Medium6MediumEv"></span><span id="_CPPv2N6Medium6MediumEv"></span><span id="Medium::Medium"></span><span class="target" id="VegasAfterglowclassMedium_1ab077493d8330ddd77c1ef434908adf73"></span><span class="sig-name descname"><span class="n"><span class="pre">Medium</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N6Medium6MediumEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N6Medium3rhoE">
<span id="_CPPv3N6Medium3rhoE"></span><span id="_CPPv2N6Medium3rhoE"></span><span id="Medium::rho__TernaryFunc"></span><span class="target" id="VegasAfterglowclassMedium_1a419de8e407c9c9f75d1b76fdedf5d3eb"></span><span class="n"><span class="pre">TernaryFunc</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rho</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">zero_3d</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N6Medium3rhoE" title="Link to this definition"></a><br /></dt>
<dd><p>Density function that returns the mass density at a given position (phi, theta, r) The function is initialized to zero by default. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N6Medium9isotropicE">
<span id="_CPPv3N6Medium9isotropicE"></span><span id="_CPPv2N6Medium9isotropicE"></span><span id="Medium::isotropic__b"></span><span class="target" id="VegasAfterglowclassMedium_1a47df3f80b9a5c6e3a2c459b00d4faaa1"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isotropic</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">false</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N6Medium9isotropicE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating if the medium is isotropic within computational domain. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="radiation-processes">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Radiation Processes</a><a class="headerlink" href="#radiation-processes" title="Link to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygenstruct: Cannot find class “SynPhotons” in doxygen xml output for project “VegasAfterglow” from directory: ../doxygen/xml</p>
</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv412SynElectrons">
<span id="_CPPv312SynElectrons"></span><span id="_CPPv212SynElectrons"></span><span id="SynElectrons"></span><span class="target" id="VegasAfterglowstructSynElectrons"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SynElectrons</span></span></span><a class="headerlink" href="#_CPPv412SynElectrons" title="Link to this definition"></a><br /></dt>
<dd><p>Collaboration diagram for SynElectrons:</p>
<figure class="align-default">
<div align="center" class="align-center"><div class="graphviz"><img src="_images/graphviz-1d6e3c74125bec9a35347006d606cd975d66aaca.png" alt="digraph {
    graph [bgcolor=&quot;#00000000&quot;]
    node [shape=rectangle style=filled fillcolor=&quot;#FFFFFF&quot; font=Helvetica padding=2]
    edge [color=&quot;#1414CE&quot;]
    &quot;2&quot; [label=&quot;InverseComptonY&quot; tooltip=&quot;InverseComptonY&quot;]
    &quot;1&quot; [label=&quot;SynElectrons&quot; tooltip=&quot;SynElectrons&quot; fillcolor=&quot;#BFBFBF&quot;]
    &quot;1&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;usage&quot;]
}" class="graphviz" /></div>
</div>
</figure>
<p>Represents synchrotron-emitting electrons in the comoving frame along with their energy distribution and properties. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK12SynElectrons15compute_N_gammaE4Real">
<span id="_CPPv3NK12SynElectrons15compute_N_gammaE4Real"></span><span id="_CPPv2NK12SynElectrons15compute_N_gammaE4Real"></span><span id="SynElectrons::compute_N_gamma__RealC"></span><span class="target" id="VegasAfterglowstructSynElectrons_1ad16be18e12bddcebbcf69f16b0de4483"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_N_gamma</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">gamma</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK12SynElectrons15compute_N_gammaE4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the comoving electron number (PER SOLID ANGLE) spectrum at a specific Lorentz factor. </p>
<p>Includes corrections for inverse Compton cooling effects above the cooling Lorentz factor. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gamma</strong> – Electron Lorentz factor </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Column number density at the specified Lorentz factor </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK12SynElectrons18compute_column_denE4Real">
<span id="_CPPv3NK12SynElectrons18compute_column_denE4Real"></span><span id="_CPPv2NK12SynElectrons18compute_column_denE4Real"></span><span id="SynElectrons::compute_column_den__RealC"></span><span class="target" id="VegasAfterglowstructSynElectrons_1a9c0f1754d804880a70f31945eb03cf00"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_column_den</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">gamma</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK12SynElectrons18compute_column_denE4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the column number density of the electron distribution. </p>
<p>Uses the electron energy spectrum to compute the column number density. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Column number density of the electron distribution </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons7gamma_mE">
<span id="_CPPv3N12SynElectrons7gamma_mE"></span><span id="_CPPv2N12SynElectrons7gamma_mE"></span><span id="SynElectrons::gamma_m__Real"></span><span class="target" id="VegasAfterglowstructSynElectrons_1a4cfe5375f620c71ed77acdcd743a2639"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gamma_m</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N12SynElectrons7gamma_mE" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum electron Lorentz factor. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons7gamma_cE">
<span id="_CPPv3N12SynElectrons7gamma_cE"></span><span id="_CPPv2N12SynElectrons7gamma_cE"></span><span id="SynElectrons::gamma_c__Real"></span><span class="target" id="VegasAfterglowstructSynElectrons_1a99879fd40758e9bca125100ffd799fc6"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gamma_c</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N12SynElectrons7gamma_cE" title="Link to this definition"></a><br /></dt>
<dd><p>Cooling electron Lorentz factor. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons7gamma_aE">
<span id="_CPPv3N12SynElectrons7gamma_aE"></span><span id="_CPPv2N12SynElectrons7gamma_aE"></span><span id="SynElectrons::gamma_a__Real"></span><span class="target" id="VegasAfterglowstructSynElectrons_1aa2e8c9dd55662d992284bd1baf49797c"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gamma_a</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N12SynElectrons7gamma_aE" title="Link to this definition"></a><br /></dt>
<dd><p>Self-absorption Lorentz factor. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons7gamma_ME">
<span id="_CPPv3N12SynElectrons7gamma_ME"></span><span id="_CPPv2N12SynElectrons7gamma_ME"></span><span id="SynElectrons::gamma_M__Real"></span><span class="target" id="VegasAfterglowstructSynElectrons_1aecf574c857a1b1930faf5ae00c4a9af3"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gamma_M</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N12SynElectrons7gamma_ME" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum electron Lorentz factor. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons1pE">
<span id="_CPPv3N12SynElectrons1pE"></span><span id="_CPPv2N12SynElectrons1pE"></span><span id="SynElectrons::p__Real"></span><span class="target" id="VegasAfterglowstructSynElectrons_1a25948b39422b587f0048fc5899c120c2"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">p</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">2.3</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N12SynElectrons1pE" title="Link to this definition"></a><br /></dt>
<dd><p>Power-law index for the electron energy distribution. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons3N_eE">
<span id="_CPPv3N12SynElectrons3N_eE"></span><span id="_CPPv2N12SynElectrons3N_eE"></span><span id="SynElectrons::N_e__Real"></span><span class="target" id="VegasAfterglowstructSynElectrons_1a0a1a820a33992088b5f9f324cd781d03"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">N_e</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N12SynElectrons3N_eE" title="Link to this definition"></a><br /></dt>
<dd><p>shock electron number PER SOLID ANGLE </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons10column_denE">
<span id="_CPPv3N12SynElectrons10column_denE"></span><span id="_CPPv2N12SynElectrons10column_denE"></span><span id="SynElectrons::column_den__Real"></span><span class="target" id="VegasAfterglowstructSynElectrons_1aa5320cc5590c4ce7f3e58356fa653486"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">column_den</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N12SynElectrons10column_denE" title="Link to this definition"></a><br /></dt>
<dd><p>Column number density. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons3Y_cE">
<span id="_CPPv3N12SynElectrons3Y_cE"></span><span id="_CPPv2N12SynElectrons3Y_cE"></span><span id="SynElectrons::Y_c__Real"></span><span class="target" id="VegasAfterglowstructSynElectrons_1a8f6f82711ad7212348f13d3a49c2d4b5"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Y_c</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N12SynElectrons3Y_cE" title="Link to this definition"></a><br /></dt>
<dd><p>Inverse Compton Y parameter at cooling frequency. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons6regimeE">
<span id="_CPPv3N12SynElectrons6regimeE"></span><span id="_CPPv2N12SynElectrons6regimeE"></span><span id="SynElectrons::regime__s"></span><span class="target" id="VegasAfterglowstructSynElectrons_1a921f1ee7f5bf087c1bd255da68091460"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">regime</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N12SynElectrons6regimeE" title="Link to this definition"></a><br /></dt>
<dd><p>Regime indicator (1-6, determines spectral shape) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12SynElectrons2YsE">
<span id="_CPPv3N12SynElectrons2YsE"></span><span id="_CPPv2N12SynElectrons2YsE"></span><span id="SynElectrons::Ys__InverseComptonY"></span><span class="target" id="VegasAfterglowstructSynElectrons_1a96402c1ba35b1a66de649f47f9a4e3b5"></span><a class="reference internal" href="#_CPPv415InverseComptonY" title="InverseComptonY"><span class="n"><span class="pre">InverseComptonY</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Ys</span></span></span><a class="headerlink" href="#_CPPv4N12SynElectrons2YsE" title="Link to this definition"></a><br /></dt>
<dd><p><a class="reference internal" href="#VegasAfterglowstructInverseComptonY"><span class="std std-ref">InverseComptonY</span></a> parameters for this electron population. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv415InverseComptonY">
<span id="_CPPv315InverseComptonY"></span><span id="_CPPv215InverseComptonY"></span><span id="InverseComptonY"></span><span class="target" id="VegasAfterglowstructInverseComptonY"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InverseComptonY</span></span></span><a class="headerlink" href="#_CPPv415InverseComptonY" title="Link to this definition"></a><br /></dt>
<dd><p>Handles Inverse Compton Y parameter calculations and related threshold values. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N15InverseComptonY15InverseComptonYE4Real4Real4Real4Real4Realb">
<span id="_CPPv3N15InverseComptonY15InverseComptonYE4Real4Real4Real4Real4Realb"></span><span id="_CPPv2N15InverseComptonY15InverseComptonYE4Real4Real4Real4Real4Realb"></span><span id="InverseComptonY::InverseComptonY__Real.Real.Real.Real.Real.b"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1a2e2ffd78dd60c7da21a052b443bd51b3"></span><span class="sig-name descname"><span class="n"><span class="pre">InverseComptonY</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">gamma_m</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">gamma_c</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">p</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">B</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Y_T</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">is_KN</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N15InverseComptonY15InverseComptonYE4Real4Real4Real4Real4Realb" title="Link to this definition"></a><br /></dt>
<dd><p>Initializes an <a class="reference internal" href="#VegasAfterglowstructInverseComptonY"><span class="std std-ref">InverseComptonY</span></a> object with frequency thresholds, magnetic field and Y parameter. </p>
<p>Computes characteristic gamma values and corresponding frequencies, then determines cooling regime. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gamma_m</strong> – Characteristic Lorentz factor for the minimum Lorentz factor </p></li>
<li><p><strong>gamma_c</strong> – Characteristic Lorentz factor for the cooling Lorentz factor </p></li>
<li><p><strong>p</strong> – Spectral index of electron distribution </p></li>
<li><p><strong>B</strong> – Magnetic field strength </p></li>
<li><p><strong>Y_T</strong> – Thomson scattering Y parameter </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N15InverseComptonY15InverseComptonYEv">
<span id="_CPPv3N15InverseComptonY15InverseComptonYEv"></span><span id="_CPPv2N15InverseComptonY15InverseComptonYEv"></span><span id="InverseComptonY::InverseComptonY"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1a8ddd88e2b0ae996e2bf8a79630653392"></span><span class="sig-name descname"><span class="n"><span class="pre">InverseComptonY</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N15InverseComptonY15InverseComptonYEv" title="Link to this definition"></a><br /></dt>
<dd><p>Default constructor that initializes all member variables to zero. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK15InverseComptonY14gamma_spectrumE4Real">
<span id="_CPPv3NK15InverseComptonY14gamma_spectrumE4Real"></span><span id="_CPPv2NK15InverseComptonY14gamma_spectrumE4Real"></span><span id="InverseComptonY::gamma_spectrum__RealC"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1a10d6b44bd159fd7fe8e5a3f1d6be453c"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gamma_spectrum</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">gamma</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK15InverseComptonY14gamma_spectrumE4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the effective Y parameter for a given Lorentz factor and spectral index. </p>
<p>Different scaling relations apply depending on the cooling regime and gamma value. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gamma</strong> – Electron Lorentz factor </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The effective Y parameter at the given gamma </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK15InverseComptonY11nu_spectrumE4Real">
<span id="_CPPv3NK15InverseComptonY11nu_spectrumE4Real"></span><span id="_CPPv2NK15InverseComptonY11nu_spectrumE4Real"></span><span id="InverseComptonY::nu_spectrum__RealC"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1a8a52b79880e15b9768ae1a81d0f4d65a"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nu_spectrum</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nu</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK15InverseComptonY11nu_spectrumE4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the effective Y parameter for a given seed photon frequency. </p>
<p>Different scaling relations apply depending on the cooling regime and frequency value. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nu</strong> – Seed photon frequency </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The effective Y parameter at the given frequency </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N15InverseComptonY21update_cooling_breaksE4Real4Real">
<span id="_CPPv3N15InverseComptonY21update_cooling_breaksE4Real4Real"></span><span id="_CPPv2N15InverseComptonY21update_cooling_breaksE4Real4Real"></span><span id="InverseComptonY::update_cooling_breaks__Real.Real"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1ab690b3be057dce6c2bc6b86b91447aca"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">update_cooling_breaks</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">gamma_c</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Y_T</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N15InverseComptonY21update_cooling_breaksE4Real4Real" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InverseComptonY11gamma_m_hatE">
<span id="_CPPv3N15InverseComptonY11gamma_m_hatE"></span><span id="_CPPv2N15InverseComptonY11gamma_m_hatE"></span><span id="InverseComptonY::gamma_m_hat__Real"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1af6a7be13a431ffc3963d3469e2aa5756"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gamma_m_hat</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15InverseComptonY11gamma_m_hatE" title="Link to this definition"></a><br /></dt>
<dd><p>Lorentz factor threshold for minimum energy electrons. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InverseComptonY11gamma_c_hatE">
<span id="_CPPv3N15InverseComptonY11gamma_c_hatE"></span><span id="_CPPv2N15InverseComptonY11gamma_c_hatE"></span><span id="InverseComptonY::gamma_c_hat__Real"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1ae72722cbf94768206fb546cfaae1e151"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gamma_c_hat</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15InverseComptonY11gamma_c_hatE" title="Link to this definition"></a><br /></dt>
<dd><p>Lorentz factor threshold for cooling electrons. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InverseComptonY10gamma_selfE">
<span id="_CPPv3N15InverseComptonY10gamma_selfE"></span><span id="_CPPv2N15InverseComptonY10gamma_selfE"></span><span id="InverseComptonY::gamma_self__Real"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1a7b16ff50be7bdedcb6fdf752948ccd5c"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gamma_self</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15InverseComptonY10gamma_selfE" title="Link to this definition"></a><br /></dt>
<dd><p>Lorentz factor threshold for gamma_self = gamma_self_hat. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InverseComptonY6gamma0E">
<span id="_CPPv3N15InverseComptonY6gamma0E"></span><span id="_CPPv2N15InverseComptonY6gamma0E"></span><span id="InverseComptonY::gamma0__Real"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1a91efedc89c793094c335a70df6f8d8bc"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gamma0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15InverseComptonY6gamma0E" title="Link to this definition"></a><br /></dt>
<dd><p>Lorentz factor threshold for Y(gamma0) = 1. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InverseComptonY3Y_TE">
<span id="_CPPv3N15InverseComptonY3Y_TE"></span><span id="_CPPv2N15InverseComptonY3Y_TE"></span><span id="InverseComptonY::Y_T__Real"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1a3b05a1e8119feb60443f3617d7924de7"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Y_T</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15InverseComptonY3Y_TE" title="Link to this definition"></a><br /></dt>
<dd><p>Thomson scattering Y parameter. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InverseComptonY6regimeE">
<span id="_CPPv3N15InverseComptonY6regimeE"></span><span id="_CPPv2N15InverseComptonY6regimeE"></span><span id="InverseComptonY::regime__s"></span><span class="target" id="VegasAfterglowstructInverseComptonY_1ab895ebc5dcf0238a117c7f55260a50c5"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">regime</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15InverseComptonY6regimeE" title="Link to this definition"></a><br /></dt>
<dd><p>Indicator for the operating regime (1=fast IC cooling, 2=slow IC cooling, 3=special case) </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="shock-dynamics">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Shock Dynamics</a><a class="headerlink" href="#shock-dynamics" title="Link to this heading"></a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv45Shock">
<span id="_CPPv35Shock"></span><span id="_CPPv25Shock"></span><span id="Shock"></span><span class="target" id="VegasAfterglowclassShock"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Shock</span></span></span><a class="headerlink" href="#_CPPv45Shock" title="Link to this definition"></a><br /></dt>
<dd><p>Collaboration diagram for Shock:</p>
<figure class="align-default">
<div align="center" class="align-center"><div class="graphviz"><img src="_images/graphviz-959d3f71b035980fedabbee2589f82b292501be8.png" alt="digraph {
    graph [bgcolor=&quot;#00000000&quot;]
    node [shape=rectangle style=filled fillcolor=&quot;#FFFFFF&quot; font=Helvetica padding=2]
    edge [color=&quot;#1414CE&quot;]
    &quot;2&quot; [label=&quot;RadParams&quot; tooltip=&quot;RadParams&quot;]
    &quot;1&quot; [label=&quot;Shock&quot; tooltip=&quot;Shock&quot; fillcolor=&quot;#BFBFBF&quot;]
    &quot;1&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;usage&quot;]
}" class="graphviz" /></div>
</div>
</figure>
<p>Represents a shock wave in an astrophysical environment. </p>
<p>The class stores physical properties of the shock across a 3D grid defined by azimuthal angle (phi), polar angle (theta), and time bins. Provides methods for shock calculations, including relativistic jump conditions, magnetic field calculations, and energy density computations. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock5ShockE6size_t6size_t6size_tRK9RadParams">
<span id="_CPPv3N5Shock5ShockE6size_t6size_t6size_tRK9RadParams"></span><span id="_CPPv2N5Shock5ShockE6size_t6size_t6size_tRK9RadParams"></span><span id="Shock::Shock__s.s.s.RadParamsCR"></span><span class="target" id="VegasAfterglowclassShock_1ac4cbdd70892414adbdb7fc01071e49e0"></span><span class="sig-name descname"><span class="n"><span class="pre">Shock</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi_size</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta_size</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_size</span></span>, <span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rad_params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5Shock5ShockE6size_t6size_t6size_tRK9RadParams" title="Link to this definition"></a><br /></dt>
<dd><p>Constructs a <a class="reference internal" href="#VegasAfterglowclassShock"><span class="std std-ref">Shock</span></a> object with the given grid dimensions and energy fractions. </p>
<p>Initializes various 3D grids for storing physical properties of the shock, including comoving time, radius, Lorentz factors, magnetic fields, and downstream densities. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi_size</strong> – Number of grid points in the phi direction </p></li>
<li><p><strong>theta_size</strong> – Number of grid points in theta direction </p></li>
<li><p><strong>t_size</strong> – Number of grid points in time direction </p></li>
<li><p><strong>rad_params</strong> – Radiation parameters </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock5ShockEv">
<span id="_CPPv3N5Shock5ShockEv"></span><span id="_CPPv2N5Shock5ShockEv"></span><span id="Shock::Shock"></span><span class="target" id="VegasAfterglowclassShock_1a0bdc1bfb873fe39ba4d4fcbded4666f2"></span><span class="sig-name descname"><span class="n"><span class="pre">Shock</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N5Shock5ShockEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK5Shock5shapeEv">
<span id="_CPPv3NK5Shock5shapeEv"></span><span id="_CPPv2NK5Shock5shapeEv"></span><span id="Shock::shapeC"></span><span class="target" id="VegasAfterglowclassShock_1a182095c7ca3cfd83d9d22d2627c10466"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">shape</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK5Shock5shapeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns grid dimensions as a tuple. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock6resizeE6size_t6size_t6size_t">
<span id="_CPPv3N5Shock6resizeE6size_t6size_t6size_t"></span><span id="_CPPv2N5Shock6resizeE6size_t6size_t6size_t"></span><span id="Shock::resize__s.s.s"></span><span class="target" id="VegasAfterglowclassShock_1a21251939d5191865d40e31bd3155ec3a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">resize</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi_size</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta_size</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5Shock6resizeE6size_t6size_t6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Resizes all grid components of the <a class="reference internal" href="#VegasAfterglowclassShock"><span class="std std-ref">Shock</span></a> object to new dimensions. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi_size</strong> – New number of grid points in the phi direction </p></li>
<li><p><strong>theta_size</strong> – New number of grid points in theta direction </p></li>
<li><p><strong>t_size</strong> – New number of grid points in time direction </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN5Shock15detect_symmetryEvRK5CoordRK6EjectaRK6Medium">
<span id="_CPPv3I00EN5Shock15detect_symmetryERK5CoordRK6EjectaRK6Medium"></span><span id="_CPPv2I00EN5Shock15detect_symmetryERK5CoordRK6EjectaRK6Medium"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Ejecta</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Medium</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassShock_1a2847e025181ab708c820a67258b9c4c3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">detect_symmetry</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv45Coord" title="Coord"><span class="n"><span class="pre">Coord</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coord</span></span>, <a class="reference internal" href="#_CPPv4I00EN5Shock15detect_symmetryEvRK5CoordRK6EjectaRK6Medium" title="Shock::detect_symmetry::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">jet</span></span>, <a class="reference internal" href="#_CPPv4I00EN5Shock15detect_symmetryEvRK5CoordRK6EjectaRK6Medium" title="Shock::detect_symmetry::Medium"><span class="n"><span class="pre">Medium</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">medium</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN5Shock15detect_symmetryEvRK5CoordRK6EjectaRK6Medium" title="Link to this definition"></a><br /></dt>
<dd><p>Auto-detect symmetry by comparing jet initial conditions at consecutive theta grid points. </p>
<p>Sets symmetry and theta_reps. Falls back to structured if jet is spreading or medium is anisotropic. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock16broadcast_groupsERK5Array">
<span id="_CPPv3N5Shock16broadcast_groupsERK5Array"></span><span id="_CPPv2N5Shock16broadcast_groupsERK5Array"></span><span id="Shock::broadcast_groups__ArrayCR"></span><span class="target" id="VegasAfterglowclassShock_1ae152bec8a9248d39aa1642b650791476"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">broadcast_groups</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theta_coords</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5Shock16broadcast_groupsERK5Array" title="Link to this definition"></a><br /></dt>
<dd><p>Broadcasts computed dynamics to all grid points based on detected symmetry. </p>
<p>For isotropic, copies (0,0) to all (0,j), then phi=0 to all phi. For piecewise, copies each representative theta to its group, then phi=0 to all phi. For phi_symmetric, only broadcasts phi=0 to all phi (all thetas already computed). </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta_coords</strong> – 1D array of theta coordinate values. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock6t_comvE">
<span id="_CPPv3N5Shock6t_comvE"></span><span id="_CPPv2N5Shock6t_comvE"></span><span id="Shock::t_comv__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassShock_1a2f750335b1c4474905426fd1a78b006a"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">t_comv</span></span></span><a class="headerlink" href="#_CPPv4N5Shock6t_comvE" title="Link to this definition"></a><br /></dt>
<dd><p>Comoving time. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock1rE">
<span id="_CPPv3N5Shock1rE"></span><span id="_CPPv2N5Shock1rE"></span><span id="Shock::r__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassShock_1ad2c035218f2e59c0e84c40fa96ff5497"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">r</span></span></span><a class="headerlink" href="#_CPPv4N5Shock1rE" title="Link to this definition"></a><br /></dt>
<dd><p>Radius. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock5thetaE">
<span id="_CPPv3N5Shock5thetaE"></span><span id="_CPPv2N5Shock5thetaE"></span><span id="Shock::theta__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassShock_1a144dc338f3f004d48e5b629479e782be"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">theta</span></span></span><a class="headerlink" href="#_CPPv4N5Shock5thetaE" title="Link to this definition"></a><br /></dt>
<dd><p>Theta for jet spreading. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock5GammaE">
<span id="_CPPv3N5Shock5GammaE"></span><span id="_CPPv2N5Shock5GammaE"></span><span id="Shock::Gamma__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassShock_1af26b390f5806dc838dd5a2f63c1b0bd9"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gamma</span></span></span><a class="headerlink" href="#_CPPv4N5Shock5GammaE" title="Link to this definition"></a><br /></dt>
<dd><p>Bulk Lorentz factor. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock8Gamma_thE">
<span id="_CPPv3N5Shock8Gamma_thE"></span><span id="_CPPv2N5Shock8Gamma_thE"></span><span id="Shock::Gamma_th__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassShock_1aff8a2f43d9c47007f042a3ed1a33f98e"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gamma_th</span></span></span><a class="headerlink" href="#_CPPv4N5Shock8Gamma_thE" title="Link to this definition"></a><br /></dt>
<dd><p>Downstream internal Lorentz factor. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock1BE">
<span id="_CPPv3N5Shock1BE"></span><span id="_CPPv2N5Shock1BE"></span><span id="Shock::B__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassShock_1a48c444d1bd42f1b933aa4282b5634bf2"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">B</span></span></span><a class="headerlink" href="#_CPPv4N5Shock1BE" title="Link to this definition"></a><br /></dt>
<dd><p>Comoving magnetic field. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock3N_pE">
<span id="_CPPv3N5Shock3N_pE"></span><span id="_CPPv2N5Shock3N_pE"></span><span id="Shock::N_p__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassShock_1a935ec9fad9c096394707e59f81d0425d"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">N_p</span></span></span><a class="headerlink" href="#_CPPv4N5Shock3N_pE" title="Link to this definition"></a><br /></dt>
<dd><p>Downstream proton number per solid angle. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock13injection_idxE">
<span id="_CPPv3N5Shock13injection_idxE"></span><span id="_CPPv2N5Shock13injection_idxE"></span><span id="Shock::injection_idx__IndexGrid"></span><span class="target" id="VegasAfterglowclassShock_1a5ffabf6d9963528567fa8d398c806a57"></span><span class="n"><span class="pre">IndexGrid</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">injection_idx</span></span></span><a class="headerlink" href="#_CPPv4N5Shock13injection_idxE" title="Link to this definition"></a><br /></dt>
<dd><p>Beyond which grid index there is no electron injection. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock3radE">
<span id="_CPPv3N5Shock3radE"></span><span id="_CPPv2N5Shock3radE"></span><span id="Shock::rad__RadParams"></span><span class="target" id="VegasAfterglowclassShock_1acc651304bf82aa85e52210074dee3673"></span><span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rad</span></span></span><a class="headerlink" href="#_CPPv4N5Shock3radE" title="Link to this definition"></a><br /></dt>
<dd><p>Radiation parameters. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock8symmetryE">
<span id="_CPPv3N5Shock8symmetryE"></span><span id="_CPPv2N5Shock8symmetryE"></span><span id="Shock::symmetry__Symmetry"></span><span class="target" id="VegasAfterglowclassShock_1a1ac94c10777cd8af8a4dd62611eabc44"></span><span class="n"><span class="pre">Symmetry</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">symmetry</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="n"><span class="pre">Symmetry</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">structured</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N5Shock8symmetryE" title="Link to this definition"></a><br /></dt>
<dd><p>Auto-detected symmetry level. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Shock10theta_repsE">
<span id="_CPPv3N5Shock10theta_repsE"></span><span id="_CPPv2N5Shock10theta_repsE"></span><span id="Shock::theta_reps__std::vector:s:"></span><span class="target" id="VegasAfterglowclassShock_1ab02b946caaaff18a4396581efabc28d2"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">theta_reps</span></span></span><a class="headerlink" href="#_CPPv4N5Shock10theta_repsE" title="Link to this definition"></a><br /></dt>
<dd><p>Representative theta indices (contiguous groups) </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I00E14SimpleShockEqn">
<span id="_CPPv3I00E14SimpleShockEqn"></span><span id="_CPPv2I00E14SimpleShockEqn"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Ejecta</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Medium</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassSimpleShockEqn"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SimpleShockEqn</span></span></span><a class="headerlink" href="#_CPPv4I00E14SimpleShockEqn" title="Link to this definition"></a><br /></dt>
<dd><p>Collaboration diagram for SimpleShockEqn:</p>
<figure class="align-default">
<div align="center" class="align-center"><div class="graphviz"><img src="_images/graphviz-c862140313940c15101d7b3290f3a855e3bc18e6.png" alt="digraph {
    graph [bgcolor=&quot;#00000000&quot;]
    node [shape=rectangle style=filled fillcolor=&quot;#FFFFFF&quot; font=Helvetica padding=2]
    edge [color=&quot;#1414CE&quot;]
    &quot;3&quot; [label=&quot;Ejecta&quot; tooltip=&quot;Ejecta&quot;]
    &quot;2&quot; [label=&quot;Medium&quot; tooltip=&quot;Medium&quot;]
    &quot;4&quot; [label=&quot;RadParams&quot; tooltip=&quot;RadParams&quot;]
    &quot;1&quot; [label=&quot;SimpleShockEqn&lt; Ejecta, Medium &gt;&quot; tooltip=&quot;SimpleShockEqn&lt; Ejecta, Medium &gt;&quot; fillcolor=&quot;#BFBFBF&quot;]
    &quot;1&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;usage&quot;]
    &quot;1&quot; -&gt; &quot;3&quot; [dir=forward tooltip=&quot;usage&quot;]
    &quot;1&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;usage&quot;]
}" class="graphviz" /></div>
</div>
</figure>
<p>Represents the forward shock equation for a given Jet. </p>
<p>It defines a state vector and overloads operator() to compute the derivatives of the state with respect to time t. It also declares helper functions for the derivatives. Simple version from Huang et al. 2000 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N14SimpleShockEqn5StateE">
<span id="_CPPv3N14SimpleShockEqn5StateE"></span><span id="_CPPv2N14SimpleShockEqn5StateE"></span><span class="target" id="VegasAfterglowclassSimpleShockEqn_1ae3d27565ef359199ca90c3703987f22a"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">State</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">SimpleState</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E14SimpleShockEqn" title="SimpleShockEqn::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N14SimpleShockEqn5StateE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N14SimpleShockEqn14SimpleShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real">
<span id="_CPPv3N14SimpleShockEqn14SimpleShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real"></span><span id="_CPPv2N14SimpleShockEqn14SimpleShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real"></span><span id="SimpleShockEqn::SimpleShockEqn__MediumCR.EjectaCR.Real.Real.RadParamsCR.Real"></span><span class="target" id="VegasAfterglowclassSimpleShockEqn_1a2ad30f482d445461e6d230c052205763"></span><span class="sig-name descname"><span class="n"><span class="pre">SimpleShockEqn</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E14SimpleShockEqn" title="SimpleShockEqn::Medium"><span class="n"><span class="pre">Medium</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">medium</span></span>, <a class="reference internal" href="#_CPPv4I00E14SimpleShockEqn" title="SimpleShockEqn::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ejecta</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span>, <span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rad_params</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta_s</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N14SimpleShockEqn14SimpleShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Initializes a <a class="reference internal" href="#VegasAfterglowclassSimpleShockEqn"><span class="std std-ref">SimpleShockEqn</span></a> object with medium, ejecta, and other parameters. </p>
<p>Creates a new shock equation object with references to the medium and ejecta along with the angular coordinates and energy fraction. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>medium</strong> – The medium through which the shock propagates </p></li>
<li><p><strong>ejecta</strong> – The ejecta driving the shock </p></li>
<li><p><strong>phi</strong> – Azimuthal angle </p></li>
<li><p><strong>theta</strong> – Polar angle </p></li>
<li><p><strong>rad_params</strong> – Radiation parameters </p></li>
<li><p><strong>theta_s</strong> – Critical angle for jet spreading </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK14SimpleShockEqnclERK5StateR5State4Real">
<span id="_CPPv3NK14SimpleShockEqnclERK5StateR5State4Real"></span><span id="_CPPv2NK14SimpleShockEqnclERK5StateR5State4Real"></span><span id="SimpleShockEqn::call-operator__StateCR.StateR.RealC"></span><span class="target" id="VegasAfterglowclassSimpleShockEqn_1aee403b3fa4ba1baf1ae64e2d008aa80f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">()</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N14SimpleShockEqn5StateE" title="SimpleShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span>, <a class="reference internal" href="#_CPPv4N14SimpleShockEqn5StateE" title="SimpleShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">diff</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK14SimpleShockEqnclERK5StateR5State4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the derivatives of the state variables with respect to engine time t. </p>
<p>Implements the system of ODEs for the simple shock model. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – Current state of the system </p></li>
<li><p><strong>diff</strong> – Output derivatives to be populated </p></li>
<li><p><strong>t</strong> – Current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK14SimpleShockEqn14set_init_stateER5State4Real">
<span id="_CPPv3NK14SimpleShockEqn14set_init_stateER5State4Real"></span><span id="_CPPv2NK14SimpleShockEqn14set_init_stateER5State4Real"></span><span id="SimpleShockEqn::set_init_state__StateR.RealC"></span><span class="target" id="VegasAfterglowclassSimpleShockEqn_1a8ba76df69c46f5d81f512a95fa9f59d4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_init_state</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N14SimpleShockEqn5StateE" title="SimpleShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t0</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK14SimpleShockEqn14set_init_stateER5State4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Initializes the state vector at time t0. </p>
<p>Sets appropriate initial values based on ejecta and medium properties. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – State vector to initialize </p></li>
<li><p><strong>t0</strong> – Initial time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14SimpleShockEqn6mediumE">
<span id="_CPPv3N14SimpleShockEqn6mediumE"></span><span id="_CPPv2N14SimpleShockEqn6mediumE"></span><span id="SimpleShockEqn::medium__MediumCR"></span><span class="target" id="VegasAfterglowclassSimpleShockEqn_1a542dc5b45178ca91cf1dabfc4cfa9829"></span><a class="reference internal" href="#_CPPv4I00E14SimpleShockEqn" title="SimpleShockEqn::Medium"><span class="n"><span class="pre">Medium</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">medium</span></span></span><a class="headerlink" href="#_CPPv4N14SimpleShockEqn6mediumE" title="Link to this definition"></a><br /></dt>
<dd><p>Reference to the medium properties. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14SimpleShockEqn6ejectaE">
<span id="_CPPv3N14SimpleShockEqn6ejectaE"></span><span id="_CPPv2N14SimpleShockEqn6ejectaE"></span><span id="SimpleShockEqn::ejecta__EjectaCR"></span><span class="target" id="VegasAfterglowclassSimpleShockEqn_1aa19b1598eb4774da08366de794457a0c"></span><a class="reference internal" href="#_CPPv4I00E14SimpleShockEqn" title="SimpleShockEqn::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">ejecta</span></span></span><a class="headerlink" href="#_CPPv4N14SimpleShockEqn6ejectaE" title="Link to this definition"></a><br /></dt>
<dd><p>Reference to the ejecta properties. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14SimpleShockEqn3phiE">
<span id="_CPPv3N14SimpleShockEqn3phiE"></span><span id="_CPPv2N14SimpleShockEqn3phiE"></span><span id="SimpleShockEqn::phi__RealC"></span><span class="target" id="VegasAfterglowclassSimpleShockEqn_1a3c67dad16fec24a07f41fc6476c761e5"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">phi</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N14SimpleShockEqn3phiE" title="Link to this definition"></a><br /></dt>
<dd><p>Angular coordinate phi. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14SimpleShockEqn6theta0E">
<span id="_CPPv3N14SimpleShockEqn6theta0E"></span><span id="_CPPv2N14SimpleShockEqn6theta0E"></span><span id="SimpleShockEqn::theta0__RealC"></span><span class="target" id="VegasAfterglowclassSimpleShockEqn_1ad193653f550dbdcec374e78e6aad0282"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">theta0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N14SimpleShockEqn6theta0E" title="Link to this definition"></a><br /></dt>
<dd><p>Angular coordinate theta. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14SimpleShockEqn3radE">
<span id="_CPPv3N14SimpleShockEqn3radE"></span><span id="_CPPv2N14SimpleShockEqn3radE"></span><span id="SimpleShockEqn::rad__RadParamsC"></span><span class="target" id="VegasAfterglowclassSimpleShockEqn_1a1d9196760446085c7d8dfe8b27568488"></span><span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rad</span></span></span><a class="headerlink" href="#_CPPv4N14SimpleShockEqn3radE" title="Link to this definition"></a><br /></dt>
<dd><p>Radiation parameters. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I00E15ForwardShockEqn">
<span id="_CPPv3I00E15ForwardShockEqn"></span><span id="_CPPv2I00E15ForwardShockEqn"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Ejecta</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Medium</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassForwardShockEqn"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ForwardShockEqn</span></span></span><a class="headerlink" href="#_CPPv4I00E15ForwardShockEqn" title="Link to this definition"></a><br /></dt>
<dd><p>Collaboration diagram for ForwardShockEqn:</p>
<figure class="align-default">
<div align="center" class="align-center"><div class="graphviz"><img src="_images/graphviz-22a1fb8ec4a8dabb24bde94fa53f1c3bca29987a.png" alt="digraph {
    graph [bgcolor=&quot;#00000000&quot;]
    node [shape=rectangle style=filled fillcolor=&quot;#FFFFFF&quot; font=Helvetica padding=2]
    edge [color=&quot;#1414CE&quot;]
    &quot;3&quot; [label=&quot;Ejecta&quot; tooltip=&quot;Ejecta&quot;]
    &quot;1&quot; [label=&quot;ForwardShockEqn&lt; Ejecta, Medium &gt;&quot; tooltip=&quot;ForwardShockEqn&lt; Ejecta, Medium &gt;&quot; fillcolor=&quot;#BFBFBF&quot;]
    &quot;2&quot; [label=&quot;Medium&quot; tooltip=&quot;Medium&quot;]
    &quot;4&quot; [label=&quot;RadParams&quot; tooltip=&quot;RadParams&quot;]
    &quot;1&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;usage&quot;]
    &quot;1&quot; -&gt; &quot;3&quot; [dir=forward tooltip=&quot;usage&quot;]
    &quot;1&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;usage&quot;]
}" class="graphviz" /></div>
</div>
</figure>
<p>Represents the forward shock equation for a given jet and medium. </p>
<p>It defines a state vector (with variable size based on template parameters) and overloads operator() to compute the derivatives of the state with respect to source time. It also declares helper functions for the derivatives. This class implements the physical equations governing the forward shock evolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ejecta</strong> – The ejecta class template parameter </p></li>
<li><p><strong>Medium</strong> – The medium class template parameter </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N15ForwardShockEqn5StateE">
<span id="_CPPv3N15ForwardShockEqn5StateE"></span><span id="_CPPv2N15ForwardShockEqn5StateE"></span><span class="target" id="VegasAfterglowclassForwardShockEqn_1a1841262edc07d26cffa440fab2b6f81a"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">State</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">ForwardState</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E15ForwardShockEqn" title="ForwardShockEqn::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N15ForwardShockEqn5StateE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N15ForwardShockEqn15ForwardShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real">
<span id="_CPPv3N15ForwardShockEqn15ForwardShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real"></span><span id="_CPPv2N15ForwardShockEqn15ForwardShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real"></span><span id="ForwardShockEqn::ForwardShockEqn__MediumCR.EjectaCR.Real.Real.RadParamsCR.Real"></span><span class="target" id="VegasAfterglowclassForwardShockEqn_1ab6f8ee9e3cdacb06659e0b4be35c0589"></span><span class="sig-name descname"><span class="n"><span class="pre">ForwardShockEqn</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E15ForwardShockEqn" title="ForwardShockEqn::Medium"><span class="n"><span class="pre">Medium</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">medium</span></span>, <a class="reference internal" href="#_CPPv4I00E15ForwardShockEqn" title="ForwardShockEqn::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ejecta</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span>, <span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rad_params</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta_s</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N15ForwardShockEqn15ForwardShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParams4Real" title="Link to this definition"></a><br /></dt>
<dd><p><a class="reference internal" href="#VegasAfterglowclassForwardShockEqn"><span class="std std-ref">ForwardShockEqn</span></a> constructor. </p>
<p>Initializes the forward shock equation with the given medium, ejecta, and parameters. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>medium</strong> – The medium through which the shock propagates </p></li>
<li><p><strong>ejecta</strong> – The ejecta driving the shock </p></li>
<li><p><strong>phi</strong> – Azimuthal angle </p></li>
<li><p><strong>theta</strong> – Polar angle </p></li>
<li><p><strong>rad_params</strong> – Radiation parameters </p></li>
<li><p><strong>theta_s</strong> – Critical angle for jet spreading </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK15ForwardShockEqnclERK5StateR5State4Real">
<span id="_CPPv3NK15ForwardShockEqnclERK5StateR5State4Real"></span><span id="_CPPv2NK15ForwardShockEqnclERK5StateR5State4Real"></span><span id="ForwardShockEqn::call-operator__StateCR.StateR.RealC"></span><span class="target" id="VegasAfterglowclassForwardShockEqn_1ad28b4b673744d7fbb42b21f5bc31f103"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">()</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N15ForwardShockEqn5StateE" title="ForwardShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span>, <a class="reference internal" href="#_CPPv4N15ForwardShockEqn5StateE" title="ForwardShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">diff</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK15ForwardShockEqnclERK5StateR5State4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the derivatives of the state variables with respect to engine time t. </p>
<p>Implements the system of ODEs that describe the evolution of the forward shock. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – Current state of the system </p></li>
<li><p><strong>diff</strong> – Output derivatives to be populated </p></li>
<li><p><strong>t</strong> – Current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK15ForwardShockEqn14set_init_stateER5State4Real">
<span id="_CPPv3NK15ForwardShockEqn14set_init_stateER5State4Real"></span><span id="_CPPv2NK15ForwardShockEqn14set_init_stateER5State4Real"></span><span id="ForwardShockEqn::set_init_state__StateR.RealC"></span><span class="target" id="VegasAfterglowclassForwardShockEqn_1a23e4c14098140dc9baa8590007e7c752"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_init_state</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N15ForwardShockEqn5StateE" title="ForwardShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t0</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK15ForwardShockEqn14set_init_stateER5State4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Set the initial conditions for the forward shock ODE solver. </p>
<p>Computes the initial state of the shock based on the ejecta properties and ambient medium. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – State vector to initialize </p></li>
<li><p><strong>t0</strong> – Initial time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ForwardShockEqn6mediumE">
<span id="_CPPv3N15ForwardShockEqn6mediumE"></span><span id="_CPPv2N15ForwardShockEqn6mediumE"></span><span id="ForwardShockEqn::medium__MediumCR"></span><span class="target" id="VegasAfterglowclassForwardShockEqn_1a0bec65b319edbb6294eee8057370be57"></span><a class="reference internal" href="#_CPPv4I00E15ForwardShockEqn" title="ForwardShockEqn::Medium"><span class="n"><span class="pre">Medium</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">medium</span></span></span><a class="headerlink" href="#_CPPv4N15ForwardShockEqn6mediumE" title="Link to this definition"></a><br /></dt>
<dd><p>Reference to the ambient medium properties. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ForwardShockEqn6ejectaE">
<span id="_CPPv3N15ForwardShockEqn6ejectaE"></span><span id="_CPPv2N15ForwardShockEqn6ejectaE"></span><span id="ForwardShockEqn::ejecta__EjectaCR"></span><span class="target" id="VegasAfterglowclassForwardShockEqn_1a352d442954d91c77ea11d72f9a567179"></span><a class="reference internal" href="#_CPPv4I00E15ForwardShockEqn" title="ForwardShockEqn::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">ejecta</span></span></span><a class="headerlink" href="#_CPPv4N15ForwardShockEqn6ejectaE" title="Link to this definition"></a><br /></dt>
<dd><p>Reference to the ejecta properties. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ForwardShockEqn3phiE">
<span id="_CPPv3N15ForwardShockEqn3phiE"></span><span id="_CPPv2N15ForwardShockEqn3phiE"></span><span id="ForwardShockEqn::phi__RealC"></span><span class="target" id="VegasAfterglowclassForwardShockEqn_1a12c45569bcf4bf5b83e26bd33f36abb3"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">phi</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15ForwardShockEqn3phiE" title="Link to this definition"></a><br /></dt>
<dd><p>Angular coordinate phi in the jet frame. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ForwardShockEqn6theta0E">
<span id="_CPPv3N15ForwardShockEqn6theta0E"></span><span id="_CPPv2N15ForwardShockEqn6theta0E"></span><span id="ForwardShockEqn::theta0__RealC"></span><span class="target" id="VegasAfterglowclassForwardShockEqn_1a5dc2e510565b607caa4eee42e053c8d3"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">theta0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15ForwardShockEqn6theta0E" title="Link to this definition"></a><br /></dt>
<dd><p>Initial angular coordinate theta. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ForwardShockEqn3radE">
<span id="_CPPv3N15ForwardShockEqn3radE"></span><span id="_CPPv2N15ForwardShockEqn3radE"></span><span id="ForwardShockEqn::rad__RadParamsC"></span><span class="target" id="VegasAfterglowclassForwardShockEqn_1ac16f3ded8d2abc1df25586c1fd806047"></span><span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rad</span></span></span><a class="headerlink" href="#_CPPv4N15ForwardShockEqn3radE" title="Link to this definition"></a><br /></dt>
<dd><p>Radiation parameters. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I00E10FRShockEqn">
<span id="_CPPv3I00E10FRShockEqn"></span><span id="_CPPv2I00E10FRShockEqn"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Ejecta</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Medium</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassFRShockEqn"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FRShockEqn</span></span></span><a class="headerlink" href="#_CPPv4I00E10FRShockEqn" title="Link to this definition"></a><br /></dt>
<dd><p>Collaboration diagram for FRShockEqn:</p>
<figure class="align-default">
<div align="center" class="align-center"><div class="graphviz"><img src="_images/graphviz-be587240d55cc9af42c7bf1bad23398d0b7fdb52.png" alt="digraph {
    graph [bgcolor=&quot;#00000000&quot;]
    node [shape=rectangle style=filled fillcolor=&quot;#FFFFFF&quot; font=Helvetica padding=2]
    edge [color=&quot;#1414CE&quot;]
    &quot;3&quot; [label=&quot;Ejecta&quot; tooltip=&quot;Ejecta&quot;]
    &quot;1&quot; [label=&quot;FRShockEqn&lt; Ejecta, Medium &gt;&quot; tooltip=&quot;FRShockEqn&lt; Ejecta, Medium &gt;&quot; fillcolor=&quot;#BFBFBF&quot;]
    &quot;2&quot; [label=&quot;Medium&quot; tooltip=&quot;Medium&quot;]
    &quot;4&quot; [label=&quot;RadParams&quot; tooltip=&quot;RadParams&quot;]
    &quot;1&quot; -&gt; &quot;2&quot; [dir=forward tooltip=&quot;usage&quot;]
    &quot;1&quot; -&gt; &quot;3&quot; [dir=forward tooltip=&quot;usage&quot;]
    &quot;1&quot; -&gt; &quot;4&quot; [dir=forward tooltip=&quot;usage&quot;]
}" class="graphviz" /></div>
</div>
</figure>
<p>Represents the reverse shock (or forward-reverse shock) equation for a given Jet and medium. </p>
<p>It defines a state vector (an array of 8 Reals) and overloads operator() to compute the derivatives of the state with respect to radius r. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn5StateE">
<span id="_CPPv3N10FRShockEqn5StateE"></span><span id="_CPPv2N10FRShockEqn5StateE"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1ac165008b8d8b1fa8da4700d0b24a50a2"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">State</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">ReverseState</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E10FRShockEqn" title="FRShockEqn::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn5StateE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn10FRShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParamsRK9RadParams">
<span id="_CPPv3N10FRShockEqn10FRShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParamsRK9RadParams"></span><span id="_CPPv2N10FRShockEqn10FRShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParamsRK9RadParams"></span><span id="FRShockEqn::FRShockEqn__MediumCR.EjectaCR.Real.Real.RadParamsCR.RadParamsCR"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a1c64443c6de177c68f47a6efc4c83d8c"></span><span class="sig-name descname"><span class="n"><span class="pre">FRShockEqn</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E10FRShockEqn" title="FRShockEqn::Medium"><span class="n"><span class="pre">Medium</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">medium</span></span>, <a class="reference internal" href="#_CPPv4I00E10FRShockEqn" title="FRShockEqn::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ejecta</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">theta</span></span>, <span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rad_fwd</span></span>, <span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rad_rvs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10FRShockEqn10FRShockEqnERK6MediumRK6Ejecta4Real4RealRK9RadParamsRK9RadParams" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor for the <a class="reference internal" href="#VegasAfterglowclassFRShockEqn"><span class="std std-ref">FRShockEqn</span></a> class. </p>
<p>Initializes the forward-reverse shock equation with the given medium, ejecta, and parameters. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>medium</strong> – The medium through which the shock propagates </p></li>
<li><p><strong>ejecta</strong> – The ejecta driving the shock </p></li>
<li><p><strong>phi</strong> – Azimuthal angle </p></li>
<li><p><strong>theta</strong> – Polar angle </p></li>
<li><p><strong>rad_fwd</strong> – Radiation params for forward shock </p></li>
<li><p><strong>rad_rvs</strong> – Radiation params for reverse shock </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqnclERK5StateR5State4Real">
<span id="_CPPv3N10FRShockEqnclERK5StateR5State4Real"></span><span id="_CPPv2N10FRShockEqnclERK5StateR5State4Real"></span><span id="FRShockEqn::call-operator__StateCR.StateR.Real"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a7d760924670c822878e3364890be480f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">()</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10FRShockEqn5StateE" title="FRShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span>, <a class="reference internal" href="#_CPPv4N10FRShockEqn5StateE" title="FRShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">diff</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqnclERK5StateR5State4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Implements the reverse shock ODE system. </p>
<p>Computes the derivatives of state variables with respect to time. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – Current state of the system </p></li>
<li><p><strong>diff</strong> – Output derivatives to be populated </p></li>
<li><p><strong>t</strong> – Current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10FRShockEqn14set_init_stateER5State4Real">
<span id="_CPPv3NK10FRShockEqn14set_init_stateER5State4Real"></span><span id="_CPPv2NK10FRShockEqn14set_init_stateER5State4Real"></span><span id="FRShockEqn::set_init_state__StateR.RealC"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1ae6a26a35708e078859bbe3eee5b3fa1f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_init_state</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10FRShockEqn5StateE" title="FRShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t0</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK10FRShockEqn14set_init_stateER5State4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Set the initial conditions for the reverse shock ODE. </p>
<p>Sets up initial state values and determines if the shock has already crossed. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – State vector to initialize </p></li>
<li><p><strong>t0</strong> – Initial time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10FRShockEqn19compute_shell_sigmaERK5State">
<span id="_CPPv3NK10FRShockEqn19compute_shell_sigmaERK5State"></span><span id="_CPPv2NK10FRShockEqn19compute_shell_sigmaERK5State"></span><span id="FRShockEqn::compute_shell_sigma__StateCRC"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1ac20986a5424abfef13928bd527d2639e"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_shell_sigma</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10FRShockEqn5StateE" title="FRShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK10FRShockEqn19compute_shell_sigmaERK5State" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the magnetization parameter of the shell. </p>
<p>Sigma is defined as (ε/Γmc²) - 1, where ε is the energy per solid angle. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> – Current state of the system </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The magnetization parameter of the shell </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn16save_cross_stateERK5State">
<span id="_CPPv3N10FRShockEqn16save_cross_stateERK5State"></span><span id="_CPPv2N10FRShockEqn16save_cross_stateERK5State"></span><span id="FRShockEqn::save_cross_state__StateCR"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1abf5cbd36f3e3491a01a3c5ae4f4ca5d2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">save_cross_state</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10FRShockEqn5StateE" title="FRShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10FRShockEqn16save_cross_stateERK5State" title="Link to this definition"></a><br /></dt>
<dd><p>Saves the state of the system at the crossing point. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> – Current state of the system </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10FRShockEqn20injection_efficiencyERK5State">
<span id="_CPPv3NK10FRShockEqn20injection_efficiencyERK5State"></span><span id="_CPPv2NK10FRShockEqn20injection_efficiencyERK5State"></span><span id="FRShockEqn::injection_efficiency__StateCRC"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a38222d0f19dc59063d236319bdb72eb1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">injection_efficiency</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10FRShockEqn5StateE" title="FRShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">diff</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK10FRShockEqn20injection_efficiencyERK5State" title="Link to this definition"></a><br /></dt>
<dd><p>Fraction of injection still active: 0 after injection, 1 during full injection. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10FRShockEqn17crossing_completeERK5State4Real">
<span id="_CPPv3NK10FRShockEqn17crossing_completeERK5State4Real"></span><span id="_CPPv2NK10FRShockEqn17crossing_completeERK5State4Real"></span><span id="FRShockEqn::crossing_complete__StateCR.RealC"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a9b680a05c923e467949f0fcbcec9caf3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crossing_complete</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10FRShockEqn5StateE" title="FRShockEqn::State"><span class="n"><span class="pre">State</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK10FRShockEqn17crossing_completeERK5State4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Whether reverse shock has finished crossing the ejecta. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn6mediumE">
<span id="_CPPv3N10FRShockEqn6mediumE"></span><span id="_CPPv2N10FRShockEqn6mediumE"></span><span id="FRShockEqn::medium__MediumCR"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a516430d788da457f99a0a9f913c4555c"></span><a class="reference internal" href="#_CPPv4I00E10FRShockEqn" title="FRShockEqn::Medium"><span class="n"><span class="pre">Medium</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">medium</span></span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn6mediumE" title="Link to this definition"></a><br /></dt>
<dd><p>Reference to the medium properties. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn6ejectaE">
<span id="_CPPv3N10FRShockEqn6ejectaE"></span><span id="_CPPv2N10FRShockEqn6ejectaE"></span><span id="FRShockEqn::ejecta__EjectaCR"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a8b35d4a390124d2227998eb712a098d6"></span><a class="reference internal" href="#_CPPv4I00E10FRShockEqn" title="FRShockEqn::Ejecta"><span class="n"><span class="pre">Ejecta</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">ejecta</span></span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn6ejectaE" title="Link to this definition"></a><br /></dt>
<dd><p>Reference to the jet properties. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn7rad_fwdE">
<span id="_CPPv3N10FRShockEqn7rad_fwdE"></span><span id="_CPPv2N10FRShockEqn7rad_fwdE"></span><span id="FRShockEqn::rad_fwd__RadParamsC"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1ad9ca80c3ba91ee550fd8bd151eb07f95"></span><span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rad_fwd</span></span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn7rad_fwdE" title="Link to this definition"></a><br /></dt>
<dd><p>Radiation parameters for forward shock. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn7rad_rvsE">
<span id="_CPPv3N10FRShockEqn7rad_rvsE"></span><span id="_CPPv2N10FRShockEqn7rad_rvsE"></span><span id="FRShockEqn::rad_rvs__RadParamsC"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a760309b9288aa425f01e6b08fcf56ad9"></span><span class="n"><span class="pre">RadParams</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rad_rvs</span></span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn7rad_rvsE" title="Link to this definition"></a><br /></dt>
<dd><p>Radiation parameters for reverse shock. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn3phiE">
<span id="_CPPv3N10FRShockEqn3phiE"></span><span id="_CPPv2N10FRShockEqn3phiE"></span><span id="FRShockEqn::phi__RealC"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a5046454a1ca5c2bd7dcd0e22e92e48b5"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">phi</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn3phiE" title="Link to this definition"></a><br /></dt>
<dd><p>Angular coordinate phi. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn6theta0E">
<span id="_CPPv3N10FRShockEqn6theta0E"></span><span id="_CPPv2N10FRShockEqn6theta0E"></span><span id="FRShockEqn::theta0__RealC"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a54ea36bb3fddcc4ccab1708c752e3092"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">theta0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn6theta0E" title="Link to this definition"></a><br /></dt>
<dd><p>Angular coordinate theta. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn6Gamma4E">
<span id="_CPPv3N10FRShockEqn6Gamma4E"></span><span id="_CPPv2N10FRShockEqn6Gamma4E"></span><span id="FRShockEqn::Gamma4__Real"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a69ca2d095d52823456e2c9cad98132c2"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gamma4</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn6Gamma4E" title="Link to this definition"></a><br /></dt>
<dd><p>Initial Lorentz factor of the jet. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn3u_xE">
<span id="_CPPv3N10FRShockEqn3u_xE"></span><span id="_CPPv2N10FRShockEqn3u_xE"></span><span id="FRShockEqn::u_x__Real"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a93c481f03f787c180d8e97a2b6662ad6"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">u_x</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn3u_xE" title="Link to this definition"></a><br /></dt>
<dd><p>Reverse shock crossed four-velocity. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn3r_xE">
<span id="_CPPv3N10FRShockEqn3r_xE"></span><span id="_CPPv2N10FRShockEqn3r_xE"></span><span id="FRShockEqn::r_x__Real"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1ad2816287efc4e43d9579376efb29693b"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">r_x</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn3r_xE" title="Link to this definition"></a><br /></dt>
<dd><p>Reverse shock crossed radius. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn12B3_ordered_xE">
<span id="_CPPv3N10FRShockEqn12B3_ordered_xE"></span><span id="_CPPv2N10FRShockEqn12B3_ordered_xE"></span><span id="FRShockEqn::B3_ordered_x__Real"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a73770d9614ec7f092609279fea58f66d"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">B3_ordered_x</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn12B3_ordered_xE" title="Link to this definition"></a><br /></dt>
<dd><p>Ordered magnetic field in region 3 at crossing. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn9V3_comv_xE">
<span id="_CPPv3N10FRShockEqn9V3_comv_xE"></span><span id="_CPPv2N10FRShockEqn9V3_comv_xE"></span><span id="FRShockEqn::V3_comv_x__Real"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1a444db75fb29c234c805213303b483d73"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V3_comv_x</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn9V3_comv_xE" title="Link to this definition"></a><br /></dt>
<dd><p>Comoving Volume in region 3 at crossing. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10FRShockEqn6rho3_xE">
<span id="_CPPv3N10FRShockEqn6rho3_xE"></span><span id="_CPPv2N10FRShockEqn6rho3_xE"></span><span id="FRShockEqn::rho3_x__Real"></span><span class="target" id="VegasAfterglowclassFRShockEqn_1abc84a8237f304b7b8dd366f7027bcf49"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rho3_x</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N10FRShockEqn6rho3_xE" title="Link to this definition"></a><br /></dt>
<dd><p>Density in region 3 at crossing. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="physics-and-utilities">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Physics and Utilities</a><a class="headerlink" href="#physics-and-utilities" title="Link to this heading"></a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv48Observer">
<span id="_CPPv38Observer"></span><span id="_CPPv28Observer"></span><span id="Observer"></span><span class="target" id="VegasAfterglowclassObserver"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Observer</span></span></span><a class="headerlink" href="#_CPPv48Observer" title="Link to this definition"></a><br /></dt>
<dd><p>Represents an observer in the GRB afterglow simulation. </p>
<p>This class handles the calculation of observed quantities such as specific flux, integrated flux, and spectra. It accounts for relativistic effects (Doppler boosting), cosmological effects (redshift), and geometric effects (solid angle). The observer can be placed at any viewing angle relative to the jet axis. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Observer8ObserverEv">
<span id="_CPPv3N8Observer8ObserverEv"></span><span id="_CPPv2N8Observer8ObserverEv"></span><span id="Observer::Observer"></span><span class="target" id="VegasAfterglowclassObserver_1acb0af5014875c6ec7465cccc85e4f39b"></span><span class="sig-name descname"><span class="n"><span class="pre">Observer</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N8Observer8ObserverEv" title="Link to this definition"></a><br /></dt>
<dd><p>Default constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Observer7observeERK5CoordRK5Shock4Real4Real">
<span id="_CPPv3N8Observer7observeERK5CoordRK5Shock4Real4Real"></span><span id="_CPPv2N8Observer7observeERK5CoordRK5Shock4Real4Real"></span><span id="Observer::observe__CoordCR.ShockCR.Real.Real"></span><span class="target" id="VegasAfterglowclassObserver_1a7e6b3154ceb89b3ff90758b874c2016d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">observe</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv45Coord" title="Coord"><span class="n"><span class="pre">Coord</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coord</span></span>, <a class="reference internal" href="#_CPPv45Shock" title="Shock"><span class="n"><span class="pre">Shock</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">shock</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">luminosity_dist</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">redshift</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Observer7observeERK5CoordRK5Shock4Real4Real" title="Link to this definition"></a><br /></dt>
<dd><p>Sets up the <a class="reference internal" href="#VegasAfterglowclassObserver"><span class="std std-ref">Observer</span></a> for flux calculation. </p>
<p>Initializes the observation time and Doppler factor grids, as well as the emission surface. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coord</strong> – Coordinate grid containing angular information </p></li>
<li><p><strong>shock</strong> – <a class="reference internal" href="#VegasAfterglowclassShock"><span class="std std-ref">Shock</span></a> object containing the evolution data </p></li>
<li><p><strong>luminosity_dist</strong> – Luminosity distance to the source </p></li>
<li><p><strong>redshift</strong> – Redshift of the source </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN8Observer13specific_fluxE5ArrayRK5Array4RealR10PhotonGrid">
<span id="_CPPv3I0EN8Observer13specific_fluxERK5Array4RealR10PhotonGrid"></span><span id="_CPPv2I0EN8Observer13specific_fluxERK5Array4RealR10PhotonGrid"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PhotonGrid</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassObserver_1a5350b13ae5a6c7007ba6459923573136"></span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">specific_flux</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">t_obs</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nu_obs</span></span>, <a class="reference internal" href="#_CPPv4I0EN8Observer13specific_fluxE5ArrayRK5Array4RealR10PhotonGrid" title="Observer::specific_flux::PhotonGrid"><span class="n"><span class="pre">PhotonGrid</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">photons</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN8Observer13specific_fluxE5ArrayRK5Array4RealR10PhotonGrid" title="Link to this definition"></a><br /></dt>
<dd><p>Sets up the <a class="reference internal" href="#VegasAfterglowclassObserver"><span class="std std-ref">Observer</span></a> for flux calculation at specific observation times. </p>
<p>Similar to <a class="reference internal" href="#VegasAfterglowclassObserver_1a7e6b3154ceb89b3ff90758b874c2016d"><span class="std std-ref">observe()</span></a><p>, but also marks required grid points for the given observation times.</p>
<p>Computes the specific flux at a single observed frequency</p>

Returns the specific flux (as an Array) for a single observed frequency (nu_obs) by computing the specific flux over the observation times. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_obs</strong> – Array of observation times </p></li>
<li><p><strong>coord</strong> – Coordinate grid containing angular information </p></li>
<li><p><strong>shock</strong> – <a class="reference internal" href="#VegasAfterglowclassShock"><span class="std std-ref">Shock</span></a> object containing the evolution data (modified to mark required points) </p></li>
<li><p><strong>luminosity_dist</strong> – Luminosity distance to the source </p></li>
<li><p><strong>redshift</strong> – Redshift of the source</p></li>
<li><p><strong>t_obs</strong> – Array of observation times </p></li>
<li><p><strong>nu_obs</strong> – Observed frequency </p></li>
<li><p><strong>photons</strong> – Parameter pack of photon grid objects</p></li>
</ul>
</dd>
<dt class="field-even">Template Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>PhotonGrid</strong> – Types of photon grid objects </p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of specific flux values at each observation time </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN8Observer13specific_fluxE8MeshGridRK5ArrayRK5ArrayR10PhotonGrid">
<span id="_CPPv3I0EN8Observer13specific_fluxERK5ArrayRK5ArrayR10PhotonGrid"></span><span id="_CPPv2I0EN8Observer13specific_fluxERK5ArrayRK5ArrayR10PhotonGrid"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PhotonGrid</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassObserver_1a5fe3b5d16f7cf532e20a6f600485a6b6"></span><span class="n"><span class="pre">MeshGrid</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">specific_flux</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">t_obs</span></span>, <span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nu_obs</span></span>, <a class="reference internal" href="#_CPPv4I0EN8Observer13specific_fluxE8MeshGridRK5ArrayRK5ArrayR10PhotonGrid" title="Observer::specific_flux::PhotonGrid"><span class="n"><span class="pre">PhotonGrid</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">photons</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN8Observer13specific_fluxE8MeshGridRK5ArrayRK5ArrayR10PhotonGrid" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the specific flux at multiple observed frequencies. </p>
<p>
Returns the specific flux (as a MeshGrid) for multiple observed frequencies (nu_obs) by computing the specific flux for each frequency and assembling the results into a grid. This method accounts for relativistic beaming and cosmological effects. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>PhotonGrid</strong> – Types of photon grid objects </p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>t_obs</strong> – Array of observation times </p></li>
<li><p><strong>nu_obs</strong> – Array of observed frequencies </p></li>
<li><p><strong>photons</strong> – Parameter pack of photon grid objects </p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D grid of specific flux values (frequency × time)</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN8Observer20specific_flux_seriesE5ArrayRK5ArrayRK5ArrayR10PhotonGrid">
<span id="_CPPv3I0EN8Observer20specific_flux_seriesERK5ArrayRK5ArrayR10PhotonGrid"></span><span id="_CPPv2I0EN8Observer20specific_flux_seriesERK5ArrayRK5ArrayR10PhotonGrid"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PhotonGrid</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassObserver_1a2497e02305dbf755a7d629311f8e772d"></span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">specific_flux_series</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">t_obs</span></span>, <span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nu_obs</span></span>, <a class="reference internal" href="#_CPPv4I0EN8Observer20specific_flux_seriesE5ArrayRK5ArrayRK5ArrayR10PhotonGrid" title="Observer::specific_flux_series::PhotonGrid"><span class="n"><span class="pre">PhotonGrid</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">photons</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN8Observer20specific_flux_seriesE5ArrayRK5ArrayRK5ArrayR10PhotonGrid" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the specific flux at a single observed frequency for multiple observation times. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>PhotonGrid</strong> – Types of photon grid objects </p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>t_obs</strong> – Array of observation times </p></li>
<li><p><strong>nu_obs</strong> – Observed frequency </p></li>
<li><p><strong>photons</strong> – Parameter pack of photon grid objects </p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of specific flux values at each observation time for a single observed frequency </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN8Observer4fluxE5ArrayRK5ArrayRK5ArrayR10PhotonGrid">
<span id="_CPPv3I0EN8Observer4fluxERK5ArrayRK5ArrayR10PhotonGrid"></span><span id="_CPPv2I0EN8Observer4fluxERK5ArrayRK5ArrayR10PhotonGrid"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PhotonGrid</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassObserver_1a2588a9ebaec5465d6b5bd08fadadcb99"></span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flux</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">t_obs</span></span>, <span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">band_freq</span></span>, <a class="reference internal" href="#_CPPv4I0EN8Observer4fluxE5ArrayRK5ArrayRK5ArrayR10PhotonGrid" title="Observer::flux::PhotonGrid"><span class="n"><span class="pre">PhotonGrid</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">photons</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN8Observer4fluxE5ArrayRK5ArrayRK5ArrayR10PhotonGrid" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the integrated flux over a frequency band. </p>
<p>
Computes the integrated flux over a frequency band specified by band_freq. It converts band boundaries to center frequencies, computes the specific flux at each frequency, and integrates (sums) the flux contributions weighted by the frequency bin widths. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>PhotonGrid</strong> – Types of photon grid objects </p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>t_obs</strong> – Array of observation times </p></li>
<li><p><strong>band_freq</strong> – Array of frequency band boundaries </p></li>
<li><p><strong>photons</strong> – Parameter pack of photon grid objects</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of integrated flux values at each observation time </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN8Observer7spectraE8MeshGridRK5ArrayRK5ArrayR10PhotonGrid">
<span id="_CPPv3I0EN8Observer7spectraERK5ArrayRK5ArrayR10PhotonGrid"></span><span id="_CPPv2I0EN8Observer7spectraERK5ArrayRK5ArrayR10PhotonGrid"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PhotonGrid</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassObserver_1a18a5b8ffa6dad54050d7de094c24094b"></span><span class="n"><span class="pre">MeshGrid</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spectra</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">freqs</span></span>, <span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">t_obs</span></span>, <a class="reference internal" href="#_CPPv4I0EN8Observer7spectraE8MeshGridRK5ArrayRK5ArrayR10PhotonGrid" title="Observer::spectra::PhotonGrid"><span class="n"><span class="pre">PhotonGrid</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">photons</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN8Observer7spectraE8MeshGridRK5ArrayRK5ArrayR10PhotonGrid" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the spectrum at multiple observation times. </p>
<p>
Returns the spectra (as a MeshGrid) for multiple observation times by computing the specific flux for each frequency and transposing the result to get freq × time format. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>PhotonGrid</strong> – Types of photon grid objects </p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>freqs</strong> – Array of frequencies </p></li>
<li><p><strong>t_obs</strong> – Array of observation times </p></li>
<li><p><strong>photons</strong> – Parameter pack of photon grid objects</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D grid of spectra (frequency × time) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN8Observer8spectrumE5ArrayRK5Array4RealR10PhotonGrid">
<span id="_CPPv3I0EN8Observer8spectrumERK5Array4RealR10PhotonGrid"></span><span id="_CPPv2I0EN8Observer8spectrumERK5Array4RealR10PhotonGrid"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PhotonGrid</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="VegasAfterglowclassObserver_1a096a45f3fcc7cd273c2bc89199ed74a2"></span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spectrum</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">freqs</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_obs</span></span>, <a class="reference internal" href="#_CPPv4I0EN8Observer8spectrumE5ArrayRK5Array4RealR10PhotonGrid" title="Observer::spectrum::PhotonGrid"><span class="n"><span class="pre">PhotonGrid</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">photons</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN8Observer8spectrumE5ArrayRK5Array4RealR10PhotonGrid" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the spectrum at a single observation time. </p>
<p>
Returns the spectrum (as an Array) at a single observation time by computing the specific flux for each frequency in the given array. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>PhotonGrid</strong> – Types of photon grid objects </p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>freqs</strong> – Array of frequencies </p></li>
<li><p><strong>t_obs</strong> – Single observation time </p></li>
<li><p><strong>photons</strong> – Parameter pack of photon grid objects</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array containing the spectrum at the given time </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Observer15update_requiredER8MaskGridRK5Array">
<span id="_CPPv3N8Observer15update_requiredER8MaskGridRK5Array"></span><span id="_CPPv2N8Observer15update_requiredER8MaskGridRK5Array"></span><span id="Observer::update_required__MaskGridR.ArrayCR"></span><span class="target" id="VegasAfterglowclassObserver_1a90f4a0a86f9e4a702cfc3a13e7c9c153"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">update_required</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MaskGrid</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">required</span></span>, <span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">t_obs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Observer15update_requiredER8MaskGridRK5Array" title="Link to this definition"></a><br /></dt>
<dd><p>Updates the required grid points for observation. </p>
<p>Identifies grid points needed for interpolation at requested observation times. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>required</strong> – Mask grid to mark required points (modified in-place) </p></li>
<li><p><strong>t_obs</strong> – Array of observation times </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Observer4timeE">
<span id="_CPPv3N8Observer4timeE"></span><span id="_CPPv2N8Observer4timeE"></span><span id="Observer::time__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassObserver_1a7b83dbbff538d3f079f8e662d3686ada"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">time</span></span></span><a class="headerlink" href="#_CPPv4N8Observer4timeE" title="Link to this definition"></a><br /></dt>
<dd><p>Grid of observation times. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Observer5lg2_tE">
<span id="_CPPv3N8Observer5lg2_tE"></span><span id="_CPPv2N8Observer5lg2_tE"></span><span id="Observer::lg2_t__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassObserver_1aa4f3a6cbcc458b937c75befa86e04e2d"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lg2_t</span></span></span><a class="headerlink" href="#_CPPv4N8Observer5lg2_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Log2 of observation time grid. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Observer11lg2_dopplerE">
<span id="_CPPv3N8Observer11lg2_dopplerE"></span><span id="_CPPv2N8Observer11lg2_dopplerE"></span><span id="Observer::lg2_doppler__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassObserver_1a19627eca15595c8eb01d1e1ace2ffb2a"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lg2_doppler</span></span></span><a class="headerlink" href="#_CPPv4N8Observer11lg2_dopplerE" title="Link to this definition"></a><br /></dt>
<dd><p>Log2 of Doppler factor grid. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Observer15lg2_geom_factorE">
<span id="_CPPv3N8Observer15lg2_geom_factorE"></span><span id="_CPPv2N8Observer15lg2_geom_factorE"></span><span id="Observer::lg2_geom_factor__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassObserver_1ac88ad26be273453fc4accf474b7d481c"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lg2_geom_factor</span></span></span><a class="headerlink" href="#_CPPv4N8Observer15lg2_geom_factorE" title="Link to this definition"></a><br /></dt>
<dd><p>Log2 of observe frame geometric factor (solid angle * r^2 * D^3) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Observer10one_plus_zE">
<span id="_CPPv3N8Observer10one_plus_zE"></span><span id="_CPPv2N8Observer10one_plus_zE"></span><span id="Observer::one_plus_z__Real"></span><span class="target" id="VegasAfterglowclassObserver_1ada924f16ced53ca200a9f34222c5362d"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">one_plus_z</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N8Observer10one_plus_zE" title="Link to this definition"></a><br /></dt>
<dd><p>1 + redshift </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv45Coord">
<span id="_CPPv35Coord"></span><span id="_CPPv25Coord"></span><span id="Coord"></span><span class="target" id="VegasAfterglowclassCoord"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Coord</span></span></span><a class="headerlink" href="#_CPPv45Coord" title="Link to this definition"></a><br /></dt>
<dd><p>Represents a coordinate system with arrays for phi, theta, and t. </p>
<p>This class is used to define the computational grid for GRB simulations. It stores the angular coordinates (phi, theta) and time (t) arrays, along with derived quantities needed for numerical calculations. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5Coord5CoordEv">
<span id="_CPPv3N5Coord5CoordEv"></span><span id="_CPPv2N5Coord5CoordEv"></span><span id="Coord::Coord"></span><span class="target" id="VegasAfterglowclassCoord_1a14caa1114c95058bd25e1a7ff2ad8e43"></span><span class="sig-name descname"><span class="n"><span class="pre">Coord</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N5Coord5CoordEv" title="Link to this definition"></a><br /></dt>
<dd><p>Default constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK5Coord5shapeEv">
<span id="_CPPv3NK5Coord5shapeEv"></span><span id="_CPPv2NK5Coord5shapeEv"></span><span id="Coord::shapeC"></span><span class="target" id="VegasAfterglowclassCoord_1aa6d43ba2bc7c11b17e3de19da26e4507"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">shape</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK5Coord5shapeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the dimensions of the coordinate arrays. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing (n_phi, n_theta, n_t) </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Coord3phiE">
<span id="_CPPv3N5Coord3phiE"></span><span id="_CPPv2N5Coord3phiE"></span><span id="Coord::phi__Array"></span><span class="target" id="VegasAfterglowclassCoord_1a69275c3a00649aafae77cffc3711d57f"></span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">phi</span></span></span><a class="headerlink" href="#_CPPv4N5Coord3phiE" title="Link to this definition"></a><br /></dt>
<dd><p>Array of azimuthal angles (phi) in radians. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Coord5thetaE">
<span id="_CPPv3N5Coord5thetaE"></span><span id="_CPPv2N5Coord5thetaE"></span><span id="Coord::theta__Array"></span><span class="target" id="VegasAfterglowclassCoord_1a0a98db1c9721e63afcfd888d78f4f5b9"></span><span class="n"><span class="pre">Array</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">theta</span></span></span><a class="headerlink" href="#_CPPv4N5Coord5thetaE" title="Link to this definition"></a><br /></dt>
<dd><p>Array of polar angles (theta) in radians. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Coord1tE">
<span id="_CPPv3N5Coord1tE"></span><span id="_CPPv2N5Coord1tE"></span><span id="Coord::t__MeshGrid3d"></span><span class="target" id="VegasAfterglowclassCoord_1a1be0d478cc7dc556eb9db65cf851da5c"></span><span class="n"><span class="pre">MeshGrid3d</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">t</span></span></span><a class="headerlink" href="#_CPPv4N5Coord1tE" title="Link to this definition"></a><br /></dt>
<dd><p>Array of engine time points. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Coord10theta_viewE">
<span id="_CPPv3N5Coord10theta_viewE"></span><span id="_CPPv2N5Coord10theta_viewE"></span><span id="Coord::theta_view__Real"></span><span class="target" id="VegasAfterglowclassCoord_1aeb5bef37e495fdeefad735154e99bf73"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">theta_view</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N5Coord10theta_viewE" title="Link to this definition"></a><br /></dt>
<dd><p>Viewing angle. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5Coord8phi_viewE">
<span id="_CPPv3N5Coord8phi_viewE"></span><span id="_CPPv2N5Coord8phi_viewE"></span><span id="Coord::phi_view__Real"></span><span class="target" id="VegasAfterglowclassCoord_1a0fc5253eabbb58010bc9ef9c9c48cc4d"></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">phi_view</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N5Coord8phi_viewE" title="Link to this definition"></a><br /></dt>
<dd><p>Viewing angle. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="performance-considerations">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Performance Considerations</a><a class="headerlink" href="#performance-considerations" title="Link to this heading"></a></h2>
<p>VegasAfterglow’s C++ core is designed for exceptional computational performance:</p>
<ul class="simple">
<li><p><strong>Memory Access Patterns</strong>: Carefully optimized to minimize cache misses</p></li>
<li><p><strong>SIMD Optimizations</strong>: Takes advantage of vectorization where possible</p></li>
<li><p><strong>Multi-threading</strong>: Core algorithms designed for parallel execution</p></li>
<li><p><strong>Avoiding Allocations</strong>: Minimal heap allocations in critical computation paths</p></li>
<li><p><strong>Computational Approximations</strong>: Efficient numerical approximations for complex computations</p></li>
</ul>
<p>These optimizations enable the generation of a 30-point single-frequency light curve in approximately 0.6 milliseconds on an Apple M2 chip with a single core, and full MCMC parameter estimation with 10,000 steps in seconds to minutes on standard laptop hardware.</p>
</section>
<section id="documenting-c-code">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Documenting C++ Code</a><a class="headerlink" href="#documenting-c-code" title="Link to this heading"></a></h2>
<p>When contributing to the C++ codebase, please follow these documentation guidelines:</p>
<section id="class-and-function-documentation">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Class and Function Documentation</a><a class="headerlink" href="#class-and-function-documentation" title="Link to this heading"></a></h3>
<p>Use Doxygen-style comments for all classes and functions:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************************************************************************************************</span>
<span class="cm"> * @brief Brief description of the function/class</span>
<span class="cm"> * @details Detailed description that provides more information</span>
<span class="cm"> *          about what this function/class does, how it works,</span>
<span class="cm"> *          and any important details users should know.</span>
<span class="cm"> *</span>
<span class="cm"> * @param param1 Description of first parameter</span>
<span class="cm"> * @param param2 Description of second parameter</span>
<span class="cm"> * @return Description of return value</span>
<span class="cm"> * @throws Description of exceptions that might be thrown</span>
<span class="cm"> * @see RelatedClass, related_function()</span>
<span class="cm"> ********************************************************************************************************************/</span>
</pre></div>
</div>
</section>
<section id="member-variable-documentation">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Member Variable Documentation</a><a class="headerlink" href="#member-variable-documentation" title="Link to this heading"></a></h3>
<p>For member variables, use inline Doxygen comments with the triple-slash syntax:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w"> </span><span class="n">energy</span><span class="p">;</span><span class="w"> </span><span class="c1">///&lt; Isotropic-equivalent energy in ergs</span>
<span class="kt">double</span><span class="w"> </span><span class="n">gamma0</span><span class="p">;</span><span class="w"> </span><span class="c1">///&lt; Initial bulk Lorentz factor</span>
</pre></div>
</div>
</section>
<section id="template-function-documentation">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Template Function Documentation</a><a class="headerlink" href="#template-function-documentation" title="Link to this heading"></a></h3>
<p>For template functions, make sure to document both the template parameters and the function parameters:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************************************************************************************************</span>
<span class="cm"> * @brief Brief description of the template function</span>
<span class="cm"> * @details Detailed description of what the template function does.</span>
<span class="cm"> *</span>
<span class="cm"> * @tparam T The type of elements in the vector</span>
<span class="cm"> * @tparam Comparator The comparison function type</span>
<span class="cm"> * @param values Vector of values to be sorted</span>
<span class="cm"> * @param comparator Comparator function to determine sorting order</span>
<span class="cm"> * @return Sorted vector of values</span>
<span class="cm"> ********************************************************************************************************************/</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Comparator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">less</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sort_values</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">Comparator</span><span class="w"> </span><span class="n">comparator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Comparator</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Implementation details</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="inline-function-documentation">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Inline Function Documentation</a><a class="headerlink" href="#inline-function-documentation" title="Link to this heading"></a></h3>
<p>For inline functions, use specialized documentation to explain why the function is inline and include important implementation details:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @brief Compute the square of a value</span>
<span class="cm"> * @inlinefunc Performance-critical function used in inner loops</span>
<span class="cm"> *</span>
<span class="cm"> * @param x The value to square</span>
<span class="cm"> * @return The squared value</span>
<span class="cm"> *</span>
<span class="cm"> * @inline_details</span>
<span class="cm"> * Uses direct multiplication instead of std::pow for better performance.</span>
<span class="cm"> * Handles both positive and negative inputs correctly.</span>
<span class="cm"> */</span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="c-20-attribute-documentation">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">C++20 Attribute Documentation</a><a class="headerlink" href="#c-20-attribute-documentation" title="Link to this heading"></a></h3>
<p>For functions with C++20 attributes, use the specialized tags:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @brief Calculate the inverse of a value</span>
<span class="cm"> * @nodiscard</span>
<span class="cm"> * @constexpr</span>
<span class="cm"> *</span>
<span class="cm"> * @param value The input value (must not be zero)</span>
<span class="cm"> * @return The inverse of the input value (1/value)</span>
<span class="cm"> * @throws std::invalid_argument if value is zero</span>
<span class="cm"> */</span>
<span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">inverse</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">invalid_argument</span><span class="p">(</span><span class="s">&quot;Cannot take inverse of zero&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="special-member-function-documentation">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Special Member Function Documentation</a><a class="headerlink" href="#special-member-function-documentation" title="Link to this heading"></a></h3>
<p>For special member functions, use the dedicated aliases:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @defaultctor</span>
<span class="cm"> * Initializes with default empty state.</span>
<span class="cm"> */</span>
<span class="n">JetModel</span><span class="p">();</span>

<span class="cm">/**</span>
<span class="cm"> * @copyctor</span>
<span class="cm"> * @param other The jet model to copy</span>
<span class="cm"> */</span>
<span class="n">JetModel</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">JetModel</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * @moveassign</span>
<span class="cm"> * @param other The jet model to move from</span>
<span class="cm"> * @return Reference to this object</span>
<span class="cm"> */</span>
<span class="n">JetModel</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">JetModel</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="private-member-documentation">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Private Member Documentation</a><a class="headerlink" href="#private-member-documentation" title="Link to this heading"></a></h3>
<p>Even though private members won’t appear in the public API documentation, they should be properly documented in the code for maintainability:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * @brief Calculate internal jet dynamics</span>
<span class="cm">     *</span>
<span class="cm">     * @param time Current simulation time</span>
<span class="cm">     * @return Energy distribution at current time</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">calculateDynamics</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">time</span><span class="p">);</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">energy_</span><span class="p">;</span><span class="w"> </span><span class="c1">///&lt; Internal energy storage</span>
</pre></div>
</div>
</section>
<section id="example-class">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Example Class</a><a class="headerlink" href="#example-class" title="Link to this heading"></a></h3>
<p>Here’s an example of a well-documented class:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************************************************************************************************</span>
<span class="cm"> * @class GaussianJet</span>
<span class="cm"> * @brief Implements a Gaussian jet profile where properties follow a Gaussian distribution with angle.</span>
<span class="cm"> * @details This class provides a smooth model for GRB jets, characterized by core angle theta_c,</span>
<span class="cm"> *          isotropic equivalent energy E_iso, and initial Lorentz factor Gamma0 at the center.</span>
<span class="cm"> ********************************************************************************************************************/</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GaussianJet</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="cm">/********************************************************************************************************************</span>
<span class="cm">     * @brief Constructor: Initialize with core angle, isotropic energy, and initial Lorentz factor</span>
<span class="cm">     * @param theta_c Core angle of the jet</span>
<span class="cm">     * @param E_iso Isotropic equivalent energy</span>
<span class="cm">     * @param Gamma0 Initial Lorentz factor</span>
<span class="cm">     ********************************************************************************************************************/</span>
<span class="w">    </span><span class="n">GaussianJet</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">theta_c</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">E_iso</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Gamma0</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/********************************************************************************************************************</span>
<span class="cm">     * @brief Energy per solid angle as a function of phi and theta, with Gaussian falloff</span>
<span class="cm">     * @param phi Azimuthal angle (unused)</span>
<span class="cm">     * @param theta Polar angle</span>
<span class="cm">     * @return Energy per solid angle with Gaussian angular dependence</span>
<span class="cm">     ********************************************************************************************************************/</span>
<span class="w">    </span><span class="n">Real</span><span class="w"> </span><span class="nf">eps_k</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">phi</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">theta</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * @brief Get the core angle of the jet</span>
<span class="cm">     * @nodiscard</span>
<span class="cm">     * @return Core angle in radians</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">getTheta_c</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * @brief Get the isotropic equivalent energy</span>
<span class="cm">     * @nodiscard</span>
<span class="cm">     * @return Energy in ergs</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">getE_iso</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * @brief Get the initial Lorentz factor</span>
<span class="cm">     * @nodiscard</span>
<span class="cm">     * @return Lorentz factor at jet core</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">getGamma0</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Implementation of inline methods would be in the .cpp file or in a separate</span>
<span class="c1">// inline header file, and should not appear in the API documentation.</span>
</pre></div>
</div>
<p>For more details on Doxygen commands, see the <a class="reference internal" href="contributing.html"><span class="doc">Contributing</span></a> page.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="python_api.html" class="btn btn-neutral float-left" title="Python API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="troubleshooting.html" class="btn btn-neutral float-right" title="Troubleshooting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, VegasAfterglow Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>